!function(){function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return i(n||e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}return e}()({1:[function(e,t,n){function r(e){for(var t={},n=e.split(/,(?=(?:[^"]|"[^"]*")*$)/),r=0,i=n.length;i>r;r++){var o=/(\w+)=["]?([^"]+)["]?$/.exec(n[r]);o&&(t[o[1]]=o[2])}return t}function i(){return a(16).toString("hex")}function o(e){e=e||{},this._genNonce=e.genNonce||i}var a=e("randombytes"),s=e("create-hash");o.Mechanism=o,o.prototype.name="DIGEST-MD5",o.prototype.clientFirst=!1,o.prototype.response=function(e){if(this._completed)return void 0;var t=e.serviceType+"/"+e.host;e.serviceName&&e.host!==e.serviceName&&(t+="/"+e.serviceName);var n=e.realm||this._realm||"",r=this._genNonce(),i="00000001",o="auth",a="";a+='username="'+e.username+'"',n&&(a+=',realm="'+n+'"'),a+=',nonce="'+this._nonce+'"',a+=',cnonce="'+r+'"',a+=",nc="+i,a+=",qop="+o,a+=',digest-uri="'+t+'"';var c=s("md5").update(e.username).update(":").update(n).update(":").update(e.password).digest(),u=s("md5").update(c).update(":").update(this._nonce).update(":").update(r);e.authzid&&u.update(":").update(e.authzid),u=u.digest("hex");var l=s("md5").update("AUTHENTICATE:").update(t);("auth-int"===o||"auth-conf"===o)&&l.update(":00000000000000000000000000000000"),l=l.digest("hex");var d=s("md5").update(u).update(":").update(this._nonce).update(":").update(i).update(":").update(r).update(":").update(o).update(":").update(l).digest("hex");return a+=",response="+d,"utf-8"===this._charset&&(a+=",charset=utf-8"),e.authzid&&(a+='authzid="'+e.authzid+'"'),a},o.prototype.challenge=function(e){var t=r(e);return this._completed=!!t.rspauth,this._realm=t.realm,this._nonce=t.nonce,this._qop=(t.qop||"auth").split(","),this._stale=t.stale,this._maxbuf=parseInt(t.maxbuf)||65536,this._charset=t.charset,this._algo=t.algorithm,this._cipher=t.cipher,this._cipher&&this._cipher.split(","),this},t.exports=o},{"create-hash":27,randombytes:192}],2:[function(e,t,n){(function(e,n){!function(){function r(e){var t=!1;return function(){if(t)throw new Error("Callback was already called.");t=!0,e.apply(i,arguments)}}var i,o,a={};i=this,null!=i&&(o=i.async),a.noConflict=function(){return i.async=o,a};var s=Object.prototype.toString,c=Array.isArray||function(e){return"[object Array]"===s.call(e)},u=function(e,t){for(var n=0;n<e.length;n+=1)t(e[n],n,e)},l=function(e,t){if(e.map)return e.map(t);var n=[];return u(e,function(e,r,i){n.push(t(e,r,i))}),n},d=function(e,t,n){return e.reduce?e.reduce(t,n):(u(e,function(e,r,i){n=t(n,e,r,i)}),n)},p=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};"undefined"!=typeof e&&e.nextTick?(a.nextTick=e.nextTick,a.setImmediate="undefined"!=typeof n?function(e){n(e)}:a.nextTick):"function"==typeof n?(a.nextTick=function(e){n(e)},a.setImmediate=a.nextTick):(a.nextTick=function(e){setTimeout(e,0)},a.setImmediate=a.nextTick),a.each=function(e,t,n){function i(t){t?(n(t),n=function(){}):(o+=1,o>=e.length&&n())}if(n=n||function(){},!e.length)return n();var o=0;u(e,function(e){t(e,r(i))})},a.forEach=a.each,a.eachSeries=function(e,t,n){if(n=n||function(){},!e.length)return n();var r=0,i=function(){t(e[r],function(t){t?(n(t),n=function(){}):(r+=1,r>=e.length?n():i())})};i()},a.forEachSeries=a.eachSeries,a.eachLimit=function(e,t,n,r){var i=f(t);i.apply(null,[e,n,r])},a.forEachLimit=a.eachLimit;var f=function(e){return function(t,n,r){if(r=r||function(){},!t.length||0>=e)return r();var i=0,o=0,a=0;!function s(){if(i>=t.length)return r();for(;e>a&&o<t.length;)o+=1,a+=1,n(t[o-1],function(e){e?(r(e),r=function(){}):(i+=1,a-=1,i>=t.length?r():s())})}()}},h=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[a.each].concat(t))}},m=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[f(e)].concat(n))}},v=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[a.eachSeries].concat(t))}},g=function(e,t,n,r){if(t=l(t,function(e,t){return{index:t,value:e}}),r){var i=[];e(t,function(e,t){n(e.value,function(n,r){i[e.index]=r,t(n)})},function(e){r(e,i)})}else e(t,function(e,t){n(e.value,function(e){t(e)})})};a.map=h(g),a.mapSeries=v(g),a.mapLimit=function(e,t,n,r){return y(t)(e,n,r)};var y=function(e){return m(e,g)};a.reduce=function(e,t,n,r){a.eachSeries(e,function(e,r){n(t,e,function(e,n){t=n,r(e)})},function(e){r(e,t)})},a.inject=a.reduce,a.foldl=a.reduce,a.reduceRight=function(e,t,n,r){var i=l(e,function(e){return e}).reverse();a.reduce(i,t,n,r)},a.foldr=a.reduceRight;var _=function(e,t,n,r){var i=[];t=l(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n&&i.push(e),t()})},function(e){r(l(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};a.filter=h(_),a.filterSeries=v(_),a.select=a.filter,a.selectSeries=a.filterSeries;var S=function(e,t,n,r){var i=[];t=l(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n||i.push(e),t()})},function(e){r(l(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};a.reject=h(S),a.rejectSeries=v(S);var b=function(e,t,n,r){e(t,function(e,t){n(e,function(n){n?(r(e),r=function(){}):t()})},function(e){r()})};a.detect=h(b),a.detectSeries=v(b),a.some=function(e,t,n){a.each(e,function(e,r){t(e,function(e){e&&(n(!0),n=function(){}),r()})},function(e){n(!1)})},a.any=a.some,a.every=function(e,t,n){a.each(e,function(e,r){t(e,function(e){e||(n(!1),n=function(){}),r()})},function(e){n(!0)})},a.all=a.every,a.sortBy=function(e,t,n){a.map(e,function(e,n){t(e,function(t,r){t?n(t):n(null,{value:e,criteria:r})})},function(e,t){if(e)return n(e);var r=function(e,t){var n=e.criteria,r=t.criteria;return r>n?-1:n>r?1:0};n(null,l(t.sort(r),function(e){return e.value}))})},a.auto=function(e,t){t=t||function(){};var n=p(e),r=n.length;if(!r)return t();var i={},o=[],s=function(e){o.unshift(e)},l=function(e){for(var t=0;t<o.length;t+=1)if(o[t]===e)return void o.splice(t,1)},f=function(){r--,u(o.slice(0),function(e){e()})};s(function(){if(!r){var e=t;t=function(){},e(null,i)}}),u(n,function(n){var r=c(e[n])?e[n]:[e[n]],o=function(e){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1&&(r=r[0]),e){var o={};u(p(i),function(e){o[e]=i[e]}),o[n]=r,t(e,o),t=function(){}}else i[n]=r,a.setImmediate(f)},h=r.slice(0,Math.abs(r.length-1))||[],m=function(){return d(h,function(e,t){return e&&i.hasOwnProperty(t)},!0)&&!i.hasOwnProperty(n)};if(m())r[r.length-1](o,i);else{var v=function(){m()&&(l(v),r[r.length-1](o,i))};s(v)}})},a.retry=function(e,t,n){var r=5,i=[];"function"==typeof e&&(n=t,t=e,e=r),e=parseInt(e,10)||r;var o=function(r,o){for(var s=function(e,t){return function(n){e(function(e,r){n(!e||t,{err:e,result:r})},o)}};e;)i.push(s(t,!(e-=1)));a.series(i,function(e,t){t=t[t.length-1],(r||n)(t.err,t.result)})};return n?o():o},a.waterfall=function(e,t){if(t=t||function(){},!c(e)){var n=new Error("First argument to waterfall must be an array of functions");return t(n)}if(!e.length)return t();var r=function(e){return function(n){if(n)t.apply(null,arguments),t=function(){};else{var i=Array.prototype.slice.call(arguments,1),o=e.next();i.push(o?r(o):t),a.setImmediate(function(){e.apply(null,i)})}}};r(a.iterator(e))()};var C=function(e,t,n){if(n=n||function(){},c(t))e.map(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var r={};e.each(p(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(e){n(e,r)})}};a.parallel=function(e,t){C({map:a.map,each:a.each},e,t)},a.parallelLimit=function(e,t,n){C({map:y(t),each:f(t)},e,n)},a.series=function(e,t){if(t=t||function(){},c(e))a.mapSeries(e,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},t);else{var n={};a.eachSeries(p(e),function(t,r){e[t](function(e){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),n[t]=i,r(e)})},function(e){t(e,n)})}},a.iterator=function(e){var t=function(n){var r=function(){return e.length&&e[n].apply(null,arguments),r.next()};return r.next=function(){return n<e.length-1?t(n+1):null},r};return t(0)},a.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var w=function(e,t,n,r){var i=[];e(t,function(e,t){n(e,function(e,n){i=i.concat(n||[]),t(e)})},function(e){r(e,i)})};a.concat=h(w),a.concatSeries=v(w),a.whilst=function(e,t,n){e()?t(function(r){return r?n(r):void a.whilst(e,t,n)}):n()},a.doWhilst=function(e,t,n){e(function(r){if(r)return n(r);var i=Array.prototype.slice.call(arguments,1);t.apply(null,i)?a.doWhilst(e,t,n):n()})},a.until=function(e,t,n){e()?n():t(function(r){return r?n(r):void a.until(e,t,n)})},a.doUntil=function(e,t,n){e(function(r){if(r)return n(r);var i=Array.prototype.slice.call(arguments,1);t.apply(null,i)?n():a.doUntil(e,t,n)})},a.queue=function(e,t){function n(e,t,n,r){return e.started||(e.started=!0),c(t)||(t=[t]),0==t.length?a.setImmediate(function(){e.drain&&e.drain()}):void u(t,function(t){var i={data:t,callback:"function"==typeof r?r:null};n?e.tasks.unshift(i):e.tasks.push(i),e.saturated&&e.tasks.length===e.concurrency&&e.saturated(),a.setImmediate(e.process)})}void 0===t&&(t=1);var i=0,o={tasks:[],concurrency:t,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(e,t){n(o,e,!1,t)},kill:function(){o.drain=null,o.tasks=[]},unshift:function(e,t){n(o,e,!0,t)},process:function(){if(!o.paused&&i<o.concurrency&&o.tasks.length){var t=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),i+=1;var n=function(){i-=1,t.callback&&t.callback.apply(t,arguments),o.drain&&o.tasks.length+i===0&&o.drain(),o.process()},a=r(n);e(t.data,a)}},length:function(){return o.tasks.length},running:function(){return i},idle:function(){return o.tasks.length+i===0},pause:function(){o.paused!==!0&&(o.paused=!0)},resume:function(){if(o.paused!==!1){o.paused=!1;for(var e=1;e<=o.concurrency;e++)a.setImmediate(o.process)}}};return o},a.priorityQueue=function(e,t){function n(e,t){return e.priority-t.priority}function r(e,t,n){for(var r=-1,i=e.length-1;i>r;){var o=r+(i-r+1>>>1);n(t,e[o])>=0?r=o:i=o-1}return r}function i(e,t,i,o){return e.started||(e.started=!0),c(t)||(t=[t]),0==t.length?a.setImmediate(function(){e.drain&&e.drain()}):void u(t,function(t){var s={data:t,priority:i,callback:"function"==typeof o?o:null};e.tasks.splice(r(e.tasks,s,n)+1,0,s),e.saturated&&e.tasks.length===e.concurrency&&e.saturated(),a.setImmediate(e.process)})}var o=a.queue(e,t);return o.push=function(e,t,n){i(o,e,t,n)},delete o.unshift,o},a.cargo=function(e,t){var n=!1,r=[],i={tasks:r,payload:t,saturated:null,empty:null,drain:null,drained:!0,push:function(e,n){c(e)||(e=[e]),u(e,function(e){r.push({data:e,callback:"function"==typeof n?n:null}),i.drained=!1,i.saturated&&r.length===t&&i.saturated()}),a.setImmediate(i.process)},process:function o(){if(!n){if(0===r.length)return i.drain&&!i.drained&&i.drain(),void(i.drained=!0);var a="number"==typeof t?r.splice(0,t):r.splice(0,r.length),s=l(a,function(e){return e.data});i.empty&&i.empty(),n=!0,e(s,function(){n=!1;var e=arguments;u(a,function(t){t.callback&&t.callback.apply(null,e)}),o()})}},length:function(){return r.length},running:function(){return n}};return i};var E=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[e]&&u(n,function(t){console[e](t)}))}]))}};a.log=E("log"),a.dir=E("dir"),a.memoize=function(e,t){var n={},r={};t=t||function(e){return e};var i=function(){var i=Array.prototype.slice.call(arguments),o=i.pop(),s=t.apply(null,i);s in n?a.nextTick(function(){o.apply(null,n[s])}):s in r?r[s].push(o):(r[s]=[o],e.apply(null,i.concat([function(){n[s]=arguments;var e=r[s];delete r[s];for(var t=0,i=e.length;i>t;t++)e[t].apply(null,arguments)}])))};return i.memo=n,i.unmemoized=e,i},a.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},a.times=function(e,t,n){for(var r=[],i=0;e>i;i++)r.push(i);return a.map(r,t,n)},a.timesSeries=function(e,t,n){for(var r=[],i=0;e>i;i++)r.push(i);return a.mapSeries(r,t,n)},a.seq=function(){var e=arguments;return function(){var t=this,n=Array.prototype.slice.call(arguments),r=n.pop();a.reduce(e,n,function(e,n,r){n.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);r(e,t)}]))},function(e,n){r.apply(t,[e].concat(n))})}},a.compose=function(){return a.seq.apply(null,Array.prototype.reverse.call(arguments))};var R=function(e,t){var n=function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();return e(t,function(e,t){e.apply(n,r.concat([t]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return n.apply(this,r)}return n};a.applyEach=h(R),a.applyEachSeries=v(R),a.forever=function(e,t){function n(r){if(r){if(t)return t(r);throw r}e(n)}n()},"undefined"!=typeof t&&t.exports?t.exports=a:"undefined"!=typeof define&&define.amd?define([],function(){return a}):i.async=a}()}).call(this,e("_process"),e("timers").setImmediate)},{_process:8,timers:303}],3:[function(e,t,n){t.exports={"default":e("core-js/library/fn/object/assign"),__esModule:!0}},{"core-js/library/fn/object/assign":12}],4:[function(e,t,n){"use strict";n["default"]=function(e){return e&&e.__esModule?e:{"default":e}},n.__esModule=!0},{}],5:[function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function i(e){var t=r(e),n=t[0],i=t[1];return 3*(n+i)/4-i}function o(e,t,n){return 3*(t+n)/4-n}function a(e){for(var t,n=r(e),i=n[0],a=n[1],s=new p(o(e,i,a)),c=0,u=a>0?i-4:i,l=0;u>l;l+=4)t=d[e.charCodeAt(l)]<<18|d[e.charCodeAt(l+1)]<<12|d[e.charCodeAt(l+2)]<<6|d[e.charCodeAt(l+3)],s[c++]=t>>16&255,s[c++]=t>>8&255,s[c++]=255&t;return 2===a&&(t=d[e.charCodeAt(l)]<<2|d[e.charCodeAt(l+1)]>>4,s[c++]=255&t),1===a&&(t=d[e.charCodeAt(l)]<<10|d[e.charCodeAt(l+1)]<<4|d[e.charCodeAt(l+2)]>>2,s[c++]=t>>8&255,s[c++]=255&t),s}function s(e){return l[e>>18&63]+l[e>>12&63]+l[e>>6&63]+l[63&e]}function c(e,t,n){for(var r,i=[],o=t;n>o;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(s(r));return i.join("")}function u(e){for(var t,n=e.length,r=n%3,i=[],o=16383,a=0,s=n-r;s>a;a+=o)i.push(c(e,a,a+o>s?s:a+o));return 1===r?(t=e[n-1],i.push(l[t>>2]+l[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(l[t>>10]+l[t>>4&63]+l[t<<2&63]+"=")),i.join("")}n.byteLength=i,n.toByteArray=a,n.fromByteArray=u;for(var l=[],d=[],p="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,m=f.length;m>h;++h)l[h]=f[h],d[f.charCodeAt(h)]=h;d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63},{}],6:[function(e,t,n){(function(e){function n(t,n){e.isBuffer(t)||(t=new e(t)),e.isBuffer(n)||(n=new e(n));var r=[];if(t.length>n.length)for(var i=0;i<n.length;i++)r.push(t[i]^n[i]);else for(var i=0;i<t.length;i++)r.push(t[i]^n[i]);return new e(r)}t.exports=n}).call(this,e("buffer").Buffer)},{buffer:9}],7:[function(e,t,n){},{}],8:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(d===setTimeout)return setTimeout(e,0);if((d===r||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function a(e){if(p===clearTimeout)return clearTimeout(e);if((p===i||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function s(){v&&h&&(v=!1,h.length?m=h.concat(m):g=-1,m.length&&c())}function c(){if(!v){var e=o(s);v=!0;for(var t=m.length;t;){for(h=m,m=[];++g<t;)h&&h[g].run();g=-1,t=m.length}h=null,v=!1,a(e)}}function u(e,t){this.fun=e,this.array=t}function l(){}var d,p,f=t.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:r}catch(e){d=r}try{p="function"==typeof clearTimeout?clearTimeout:i}catch(e){p=i}}();var h,m=[],v=!1,g=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new u(e,t)),1!==m.length||v||o(c)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],9:[function(e,t,n){(function(t){"use strict";function r(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}function i(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(i()<t)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=a.prototype):(null===e&&(e=new a(t)),e.length=t),e}function a(e,t,n){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return s(this,e,t,n)}function s(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?f(e,t,n,r):"string"==typeof t?d(e,t,n):h(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(0>e)throw new RangeError('"size" argument must not be negative')}function u(e,t,n,r){return c(t),0>=t?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}function l(e,t){if(c(t),e=o(e,0>t?0:0|m(t)),!a.TYPED_ARRAY_SUPPORT)for(var n=0;t>n;++n)e[n]=0;return e}function d(e,t,n){if(("string"!=typeof n||""===n)&&(n="utf8"),!a.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(t,n);e=o(e,r);var i=e.write(t,n);return i!==r&&(e=e.slice(0,i)),e}function p(e,t){var n=t.length<0?0:0|m(t.length);e=o(e,n);for(var r=0;n>r;r+=1)e[r]=255&t[r];return e}function f(e,t,n,r){if(t.byteLength,0>n||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),a.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=a.prototype):e=p(e,t),e}function h(e,t){if(a.isBuffer(t)){var n=0|m(t.length);return e=o(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||$(t.length)?o(e,0):p(e,t);if("Buffer"===t.type&&Z(t.data))return p(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function m(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function v(e){return+e!=e&&(e=0),a.alloc(+e)}function g(e,t){if(a.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return X(e).length;default:if(r)return W(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,n){var r=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),0>=n)return"";if(n>>>=0,t>>>=0,t>=n)return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,n);case"utf8":case"utf-8":return L(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return M(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function _(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function S(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:-2147483648>n&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),0>n&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(0>n){if(!i)return-1;n=0}if("string"==typeof t&&(t=a.from(t,r)),a.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"==typeof t)return t=255&t,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){function o(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,s=e.length,c=t.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}var u;if(i){var l=-1;for(u=n;s>u;u++)if(o(e,u)===o(t,-1===l?0:u-l)){if(-1===l&&(l=u),u-l+1===c)return l*a}else-1!==l&&(u-=u-l),l=-1}else for(n+c>s&&(n=s-c),u=n;u>=0;u--){for(var d=!0,p=0;c>p;p++)if(o(e,u+p)!==o(t,p)){d=!1;break}if(d)return u}return-1}function C(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;r>a;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function w(e,t,n,r){return Y(W(t,e.length-n),e,n,r)}function E(e,t,n,r){return Y(z(t),e,n,r)}function R(e,t,n,r){return E(e,t,n,r)}function P(e,t,n,r){return Y(X(t),e,n,r)}function x(e,t,n,r){return Y(H(t,e.length-n),e,n,r)}function T(e,t,n){return Q.fromByteArray(0===t&&n===e.length?e:e.slice(t,n))}function L(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;n>i;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(n>=i+s){var c,u,l,d;switch(s){case 1:128>o&&(a=o);break;case 2:c=e[i+1],128===(192&c)&&(d=(31&o)<<6|63&c,d>127&&(a=d));break;case 3:c=e[i+1],u=e[i+2],128===(192&c)&&128===(192&u)&&(d=(15&o)<<12|(63&c)<<6|63&u,d>2047&&(55296>d||d>57343)&&(a=d));break;case 4:c=e[i+1],u=e[i+2],l=e[i+3],128===(192&c)&&128===(192&u)&&128===(192&l)&&(d=(15&o)<<18|(63&c)<<12|(63&u)<<6|63&l,d>65535&&1114112>d&&(a=d))}}null===a?(a=65533,s=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),i+=s}return O(r)}function O(e){var t=e.length;if(ee>=t)return String.fromCharCode.apply(String,e);for(var n="",r=0;t>r;)n+=String.fromCharCode.apply(String,e.slice(r,r+=ee));return n}function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;n>i;++i)r+=String.fromCharCode(127&e[i]);return r}function M(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;n>i;++i)r+=String.fromCharCode(e[i]);return r}function A(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=t;n>o;++o)i+=J(e[o]);return i}function D(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function k(e,t,n){if(e%1!==0||0>e)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function j(e,t,n,r,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||o>t)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function N(e,t,n,r){0>t&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);o>i;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function V(e,t,n,r){0>t&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);o>i;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function U(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}function B(e,t,n,r,i){return i||U(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),K.write(e,t,n,r,23,4),n+4}function F(e,t,n,r,i){return i||U(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),K.write(e,t,n,r,52,8),n+8}function G(e){if(e=q(e).replace(te,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function q(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function J(e){return 16>e?"0"+e.toString(16):e.toString(16)}function W(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],a=0;r>a;++a){if(n=e.charCodeAt(a),n>55295&&57344>n){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(56320>n){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=(i-55296<<10|n-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,128>n){if((t-=1)<0)break;o.push(n)}else if(2048>n){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(65536>n){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(1114112>n))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function H(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function X(e){return Q.toByteArray(G(e))}function Y(e,t,n,r){for(var i=0;r>i&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function $(e){return e!==e}var Q=e("base64-js"),K=e("ieee754"),Z=e("isarray");n.Buffer=a,n.SlowBuffer=v,n.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:r(),n.kMaxLength=i(),a.poolSize=8192,a._augment=function(e){return e.__proto__=a.prototype,e},a.from=function(e,t,n){return s(null,e,t,n)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(e,t,n){return u(null,e,t,n)},a.allocUnsafe=function(e){return l(null,e)},a.allocUnsafeSlow=function(e){return l(null,e)},a.isBuffer=function(e){return!(null==e||!e._isBuffer)},a.compare=function(e,t){if(!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);o>i;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return r>n?-1:n>r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Z(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=a.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},a.byteLength=g,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;e>t;t+=2)_(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;e>t;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;e>t;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},a.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?L(this,0,e):y.apply(this,arguments)},a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:0===a.compare(this,e)},a.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},a.prototype.compare=function(e,t,n,r,i){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),0>t||n>e.length||0>r||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var o=i-r,s=n-t,c=Math.min(o,s),u=this.slice(r,i),l=e.slice(t,n),d=0;c>d;++d)if(u[d]!==l[d]){o=u[d],s=l[d];break}return s>o?-1:o>s?1:0},a.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},a.prototype.indexOf=function(e,t,n){return S(this,e,t,n,!0)},a.prototype.lastIndexOf=function(e,t,n){return S(this,e,t,n,!1)},a.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t=0|t,isFinite(n)?(n=0|n,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(0>n||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return C(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return E(this,e,t,n);case"latin1":case"binary":return R(this,e,t,n);case"base64":return P(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ee=4096;a.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),e>t&&(t=e);var r;if(a.TYPED_ARRAY_SUPPORT)r=this.subarray(e,t),r.__proto__=a.prototype;else{var i=t-e;r=new a(i,void 0);for(var o=0;i>o;++o)r[o]=this[o+e]}return r},a.prototype.readUIntLE=function(e,t,n){e=0|e,t=0|t,n||k(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},a.prototype.readUIntBE=function(e,t,n){e=0|e,t=0|t,n||k(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},a.prototype.readUInt8=function(e,t){return t||k(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return t||k(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return t||k(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return t||k(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return t||k(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,n){e=0|e,t=0|t,n||k(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),
r},a.prototype.readIntBE=function(e,t,n){e=0|e,t=0|t,n||k(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return t||k(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){t||k(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(e,t){t||k(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(e,t){return t||k(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return t||k(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return t||k(e,4,this.length),K.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return t||k(e,4,this.length),K.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return t||k(e,8,this.length),K.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return t||k(e,8,this.length),K.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t=0|t,n=0|n,!r){var i=Math.pow(2,8*n)-1;j(this,e,t,n,i,0)}var o=1,a=0;for(this[t]=255&e;++a<n&&(o*=256);)this[t+a]=e/o&255;return t+n},a.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t=0|t,n=0|n,!r){var i=Math.pow(2,8*n)-1;j(this,e,t,n,i,0)}var o=n-1,a=1;for(this[t+o]=255&e;--o>=0&&(a*=256);)this[t+o]=e/a&255;return t+n},a.prototype.writeUInt8=function(e,t,n){return e=+e,t=0|t,n||j(this,e,t,1,255,0),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,n){return e=+e,t=0|t,n||j(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},a.prototype.writeUInt16BE=function(e,t,n){return e=+e,t=0|t,n||j(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},a.prototype.writeUInt32LE=function(e,t,n){return e=+e,t=0|t,n||j(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):V(this,e,t,!0),t+4},a.prototype.writeUInt32BE=function(e,t,n){return e=+e,t=0|t,n||j(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},a.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t=0|t,!r){var i=Math.pow(2,8*n-1);j(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)0>e&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t=0|t,!r){var i=Math.pow(2,8*n-1);j(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)0>e&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e=+e,t=0|t,n||j(this,e,t,1,127,-128),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e=+e,t=0|t,n||j(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},a.prototype.writeInt16BE=function(e,t,n){return e=+e,t=0|t,n||j(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},a.prototype.writeInt32LE=function(e,t,n){return e=+e,t=0|t,n||j(this,e,t,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):V(this,e,t,!0),t+4},a.prototype.writeInt32BE=function(e,t,n){return e=+e,t=0|t,n||j(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):V(this,e,t,!1),t+4},a.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&n>r&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>r)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&t>n&&r>t)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(1e3>o||!a.TYPED_ARRAY_SUPPORT)for(i=0;o>i;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},a.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);256>i&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e=255&e);if(0>t||this.length<t||this.length<n)throw new RangeError("Out of range index");if(t>=n)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var o;if("number"==typeof e)for(o=t;n>o;++o)this[o]=e;else{var s=a.isBuffer(e)?e:W(new a(e,r).toString()),c=s.length;for(o=0;n-t>o;++o)this[o+t]=s[o%c]}return this};var te=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":5,ieee754:45,isarray:10}],10:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],11:[function(e,t,n){function r(e){o.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this["final"]=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}var i=e("safe-buffer").Buffer,o=e("stream").Transform,a=e("string_decoder").StringDecoder,s=e("inherits");s(r,o),r.prototype.update=function(e,t,n){"string"==typeof e&&(e=i.from(e,t));var r=this._update(e);return this.hashMode?this:(n&&(r=this._toString(r,n)),r)},r.prototype.setAutoPadding=function(){},r.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},r.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},r.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},r.prototype._transform=function(e,t,n){var r;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(i){r=i}finally{n(r)}},r.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(n){t=n}e(t)},r.prototype._finalOrDigest=function(e){var t=this.__final()||i.alloc(0);return e&&(t=this._toString(t,e,!0)),t},r.prototype._toString=function(e,t,n){if(this._decoder||(this._decoder=new a(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var r=this._decoder.write(e);return n&&(r+=this._decoder.end()),r},t.exports=r},{inherits:46,"safe-buffer":211,stream:301,string_decoder:302}],12:[function(e,t,n){e("../../modules/es6.object.assign"),t.exports=e("../../modules/$.core").Object.assign},{"../../modules/$.core":15,"../../modules/es6.object.assign":25}],13:[function(e,t,n){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],14:[function(e,t,n){var r={}.toString;t.exports=function(e){return r.call(e).slice(8,-1)}},{}],15:[function(e,t,n){var r=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=r)},{}],16:[function(e,t,n){var r=e("./$.a-function");t.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},{"./$.a-function":13}],17:[function(e,t,n){t.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],18:[function(e,t,n){var r=e("./$.global"),i=e("./$.core"),o=e("./$.ctx"),a="prototype",s=function(e,t,n){var c,u,l,d=e&s.F,p=e&s.G,f=e&s.S,h=e&s.P,m=e&s.B,v=e&s.W,g=p?i:i[t]||(i[t]={}),y=p?r:f?r[t]:(r[t]||{})[a];p&&(n=t);for(c in n)u=!d&&y&&c in y,u&&c in g||(l=u?y[c]:n[c],g[c]=p&&"function"!=typeof y[c]?n[c]:m&&u?o(l,r):v&&y[c]==l?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[a]=e[a],t}(l):h&&"function"==typeof l?o(Function.call,l):l,h&&((g[a]||(g[a]={}))[c]=l))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,t.exports=s},{"./$.core":15,"./$.ctx":16,"./$.global":20}],19:[function(e,t,n){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],20:[function(e,t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},{}],21:[function(e,t,n){var r=e("./$.cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},{"./$.cof":14}],22:[function(e,t,n){var r=Object;t.exports={create:r.create,getProto:r.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:r.getOwnPropertyDescriptor,setDesc:r.defineProperty,setDescs:r.defineProperties,getKeys:r.keys,getNames:r.getOwnPropertyNames,getSymbols:r.getOwnPropertySymbols,each:[].forEach}},{}],23:[function(e,t,n){var r=e("./$"),i=e("./$.to-object"),o=e("./$.iobject");t.exports=e("./$.fails")(function(){var e=Object.assign,t={},n={},r=Symbol(),i="abcdefghijklmnopqrst";return t[r]=7,i.split("").forEach(function(e){n[e]=e}),7!=e({},t)[r]||Object.keys(e({},n)).join("")!=i})?function(e,t){for(var n=i(e),a=arguments,s=a.length,c=1,u=r.getKeys,l=r.getSymbols,d=r.isEnum;s>c;)for(var p,f=o(a[c++]),h=l?u(f).concat(l(f)):u(f),m=h.length,v=0;m>v;)d.call(f,p=h[v++])&&(n[p]=f[p]);return n}:Object.assign},{"./$":22,"./$.fails":19,"./$.iobject":21,"./$.to-object":24}],24:[function(e,t,n){var r=e("./$.defined");t.exports=function(e){return Object(r(e))}},{"./$.defined":17}],25:[function(e,t,n){var r=e("./$.export");r(r.S+r.F,"Object",{assign:e("./$.object-assign")})},{"./$.export":18,"./$.object-assign":23}],26:[function(e,t,n){(function(e){function t(e){return Array.isArray?Array.isArray(e):"[object Array]"===v(e)}function r(e){return"boolean"==typeof e}function i(e){return null===e}function o(e){return null==e}function a(e){return"number"==typeof e}function s(e){return"string"==typeof e}function c(e){return"symbol"==typeof e}function u(e){return void 0===e}function l(e){return"[object RegExp]"===v(e)}function d(e){return"object"==typeof e&&null!==e}function p(e){return"[object Date]"===v(e)}function f(e){return"[object Error]"===v(e)||e instanceof Error}function h(e){return"function"==typeof e}function m(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function v(e){return Object.prototype.toString.call(e)}n.isArray=t,n.isBoolean=r,n.isNull=i,n.isNullOrUndefined=o,n.isNumber=a,n.isString=s,n.isSymbol=c,n.isUndefined=u,n.isRegExp=l,n.isObject=d,n.isDate=p,n.isError=f,n.isFunction=h,n.isPrimitive=m,n.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":48}],27:[function(e,t,n){"use strict";function r(e){c.call(this,"digest"),this._hash=e}var i=e("inherits"),o=e("md5.js"),a=e("ripemd160"),s=e("sha.js"),c=e("cipher-base");i(r,c),r.prototype._update=function(e){this._hash.update(e)},r.prototype._final=function(){return this._hash.digest()},t.exports=function(e){return e=e.toLowerCase(),"md5"===e?new o:"rmd160"===e||"ripemd160"===e?new a:new r(s(e))}},{"cipher-base":11,inherits:46,"md5.js":188,ripemd160:208,"sha.js":232}],28:[function(e,t,n){var r=e("md5.js");t.exports=function(e){return(new r).update(e).digest()}},{"md5.js":188}],29:[function(e,t,n){"use strict";function r(e,t){a.call(this,"digest"),"string"==typeof t&&(t=s.from(t));var n="sha512"===e||"sha384"===e?128:64;if(this._alg=e,this._key=t,t.length>n){var r="rmd160"===e?new u:l(e);t=r.update(t).digest()}else t.length<n&&(t=s.concat([t,d],n));for(var i=this._ipad=s.allocUnsafe(n),o=this._opad=s.allocUnsafe(n),c=0;n>c;c++)i[c]=54^t[c],o[c]=92^t[c];this._hash="rmd160"===e?new u:l(e),this._hash.update(i)}var i=e("inherits"),o=e("./legacy"),a=e("cipher-base"),s=e("safe-buffer").Buffer,c=e("create-hash/md5"),u=e("ripemd160"),l=e("sha.js"),d=s.alloc(128);i(r,a),r.prototype._update=function(e){this._hash.update(e)},r.prototype._final=function(){var e=this._hash.digest(),t="rmd160"===this._alg?new u:l(this._alg);return t.update(this._opad).update(e).digest()},t.exports=function(e,t){return e=e.toLowerCase(),"rmd160"===e||"ripemd160"===e?new r("rmd160",t):"md5"===e?new o(c,t):new r(e,t)}},{"./legacy":30,"cipher-base":11,"create-hash/md5":28,inherits:46,ripemd160:208,"safe-buffer":211,"sha.js":232}],30:[function(e,t,n){"use strict";function r(e,t){a.call(this,"digest"),"string"==typeof t&&(t=o.from(t)),this._alg=e,this._key=t,t.length>c?t=e(t):t.length<c&&(t=o.concat([t,s],c));for(var n=this._ipad=o.allocUnsafe(c),r=this._opad=o.allocUnsafe(c),i=0;c>i;i++)n[i]=54^t[i],r[i]=92^t[i];this._hash=[n]}var i=e("inherits"),o=e("safe-buffer").Buffer,a=e("cipher-base"),s=o.alloc(128),c=64;i(r,a),r.prototype._update=function(e){this._hash.push(e)},r.prototype._final=function(){var e=this._alg(o.concat(this._hash));return this._alg(o.concat([this._opad,e]))},t.exports=r},{"cipher-base":11,inherits:46,"safe-buffer":211}],31:[function(e,t,n){(function(r,i){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.ES6Promise=r()}(this,function(){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function o(e){Y=e}function a(e){$=e}function s(){return function(){return r.nextTick(p)}}function c(){return"undefined"!=typeof X?function(){X(p)}:d()}function u(){var e=0,t=new Z(p),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function l(){var e=new MessageChannel;return e.port1.onmessage=p,function(){return e.port2.postMessage(0)}}function d(){var e=setTimeout;return function(){return e(p,1)}}function p(){for(var e=0;H>e;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}H=0}function f(){try{var t=e,n=t("vertx");return X=n.runOnLoop||n.runOnContext,c()}catch(r){return d()}}function h(e,t){var n=arguments,r=this,i=new this.constructor(v);void 0===i[ie]&&k(i);var o=r._state;return o?!function(){var e=n[o-1];$(function(){return M(o,i,e,r._result)})}():T(r,i,e,t),i}function m(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(v);return E(n,e),n}function v(){}function g(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function _(e){try{return e.then}catch(t){return ce.error=t,ce}}function S(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function b(e,t,n){$(function(e){var r=!1,i=S(n,t,function(n){r||(r=!0,t!==n?E(e,n):P(e,n))},function(t){r||(r=!0,x(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,x(e,i))},e)}function C(e,t){t._state===ae?P(e,t._result):t._state===se?x(e,t._result):T(t,void 0,function(t){return E(e,t)},function(t){return x(e,t)})}function w(e,t,r){t.constructor===e.constructor&&r===h&&t.constructor.resolve===m?C(e,t):r===ce?x(e,ce.error):void 0===r?P(e,t):n(r)?b(e,t,r):P(e,t)}function E(e,n){e===n?x(e,g()):t(n)?w(e,n,_(n)):P(e,n)}function R(e){e._onerror&&e._onerror(e._result),L(e)}function P(e,t){e._state===oe&&(e._result=t,e._state=ae,0!==e._subscribers.length&&$(L,e))}function x(e,t){e._state===oe&&(e._state=se,e._result=t,$(R,e))}function T(e,t,n,r){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+ae]=n,i[o+se]=r,0===o&&e._state&&$(L,e)}function L(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)r=t[a],i=t[a+n],r?M(n,r,i,o):i(o);e._subscribers.length=0}}function O(){this.error=null}function I(e,t){try{return e(t)}catch(n){return ue.error=n,ue}}function M(e,t,r,i){var o=n(r),a=void 0,s=void 0,c=void 0,u=void 0;if(o){if(a=I(r,i),a===ue?(u=!0,s=a.error,a=null):c=!0,t===a)return void x(t,y())}else a=i,c=!0;t._state!==oe||(o&&c?E(t,a):u?x(t,s):e===ae?P(t,a):e===se&&x(t,a))}function A(e,t){try{t(function(t){E(e,t)},function(t){x(e,t)})}catch(n){x(e,n)}}function D(){return le++}function k(e){e[ie]=le++,e._state=void 0,e._result=void 0,e._subscribers=[]}function j(e,t){this._instanceConstructor=e,this.promise=new e(v),this.promise[ie]||k(this.promise),z(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&P(this.promise,this._result))):x(this.promise,N())}function N(){return new Error("Array Methods must be provided an Array")}function V(e){return new j(this,e).promise}function U(e){var t=this;return new t(z(e)?function(n,r){for(var i=e.length,o=0;i>o;o++)t.resolve(e[o]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function B(e){var t=this,n=new t(v);return x(n,e),n}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function G(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function q(e){this[ie]=D(),this._result=this._state=void 0,this._subscribers=[],v!==e&&("function"!=typeof e&&F(),this instanceof q?A(this,e):G())}function J(){var e=void 0;if("undefined"!=typeof i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast)return}e.Promise=q}var W=void 0;W=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var z=W,H=0,X=void 0,Y=void 0,$=function(e,t){ne[H]=e,ne[H+1]=t,H+=2,2===H&&(Y?Y(p):re())},Q="undefined"!=typeof window?window:void 0,K=Q||{},Z=K.MutationObserver||K.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof r&&"[object process]"==={}.toString.call(r),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),re=void 0;re=ee?s():Z?u():te?l():void 0===Q&&"function"==typeof e?f():d();var ie=Math.random().toString(36).substring(16),oe=void 0,ae=1,se=2,ce=new O,ue=new O,le=0;return j.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===oe&&e>n;n++)this._eachEntry(t[n],n)},j.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===m){var i=_(e);if(i===h&&e._state!==oe)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===q){var o=new n(v);w(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},j.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===oe&&(this._remaining--,e===se?x(r,n):this._result[t]=n),0===this._remaining&&P(r,this._result)},j.prototype._willSettleAt=function(e,t){var n=this;T(e,void 0,function(e){return n._settledAt(ae,t,e)},function(e){return n._settledAt(se,t,e)})},q.all=V,q.race=U,q.resolve=m,q.reject=B,q._setScheduler=o,q._setAsap=a,q._asap=$,q.prototype={constructor:q,then:h,"catch":function(e){return this.then(null,e)}},q.polyfill=J,q.Promise=q,q})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:8}],32:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,o,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(n=this._events[e],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(a(n))for(o=Array.prototype.slice.call(arguments,1),u=n.slice(),r=u.length,c=0;r>c;c++)u[c].apply(this,o);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=o;s-->0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],33:[function(e,t,n){var r=[],i=r.forEach,o=r.slice;t.exports=function(e){return i.call(o.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e}},{}],34:[function(e,t,n){function r(e){o.call(this);var t=e||{};this.config={chunksize:16384,pacing:0};var n;for(n in t)this.config[n]=t[n];this.file=null,this.channel=null}function i(){o.call(this),this.receiveBuffer=[],this.received=0,this.metadata={},this.channel=null}var o=e("wildemitter"),a=e("util");a.inherits(r,o),r.prototype.send=function(e,t){var n=this;this.file=e,this.channel=t;var r="number"!=typeof t.bufferedAmountLowThreshold,i=0,o=function(){var a=new window.FileReader;a.onload=function(){return function(a){n.channel.send(a.target.result),n.emit("progress",i,e.size,a.target.result),e.size>i+a.target.result.byteLength?r?window.setTimeout(o,n.config.pacing):t.bufferedAmount<=t.bufferedAmountLowThreshold&&window.setTimeout(o,0):(n.emit("progress",e.size,e.size,null),n.emit("sentFile")),i+=n.config.chunksize}}(e);var s=e.slice(i,i+n.config.chunksize);a.readAsArrayBuffer(s)};r||(t.bufferedAmountLowThreshold=8*this.config.chunksize,t.addEventListener("bufferedamountlow",o)),window.setTimeout(o,0)},a.inherits(i,o),i.prototype.receive=function(e,t){var n=this;e&&(this.metadata=e),this.channel=t,t.binaryType="arraybuffer",this.channel.onmessage=function(e){var t=e.data.byteLength;n.received+=t,n.receiveBuffer.push(e.data),n.emit("progress",n.received,n.metadata.size,e.data),n.received===n.metadata.size?(n.emit("receivedFile",new window.Blob(n.receiveBuffer),n.metadata),n.receiveBuffer=[]):n.received>n.metadata.size&&(console.error("received more than expected, discarding..."),n.receiveBuffer=[])}},t.exports={},t.exports.support="undefined"!=typeof window&&window&&window.File&&window.FileReader&&window.Blob,t.exports.Sender=r,t.exports.Receiver=i},{util:309,wildemitter:36}],35:[function(e,t,n){function r(e){o.call(this);var t=this;this.base=new c.Sender(e);var n=e||{};n.hash||(n.hash="sha-1"),this.hash=s.createHash(n.hash),this.base.on("progress",function(e,n,r){t.emit("progress",e,n,r),r&&t.hash.update(new Uint8Array(r))}),this.base.on("sentFile",function(){t.emit("sentFile",{hash:t.hash.digest("hex"),algo:n.hash})})}function i(e){o.call(this);var t=this;this.base=new c.Receiver(e);var n=e||{};n.hash||(n.hash="sha-1"),this.hash=s.createHash(n.hash),this.base.on("progress",function(e,n,r){t.emit("progress",e,n,r),r&&t.hash.update(new Uint8Array(r))}),this.base.on("receivedFile",function(e,n){n.actualhash=t.hash.digest("hex"),t.emit("receivedFile",e,n)})}var o=e("wildemitter"),a=e("util"),s=e("iana-hashes"),c=e("./filetransfer");a.inherits(r,o),r.prototype.send=function(){this.base.send.apply(this.base,arguments)},a.inherits(i,o),i.prototype.receive=function(){this.base.receive.apply(this.base,arguments)},Object.defineProperty(i.prototype,"metadata",{get:function(){return this.base.metadata},set:function(e){this.base.metadata=e}}),t.exports={},t.exports.support=c.support,t.exports.Sender=r,t.exports.Receiver=i},{"./filetransfer":34,"iana-hashes":43,util:309,wildemitter:36}],36:[function(e,t,n){function r(){}t.exports=r,r.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var r=3===arguments.length,i=r?arguments[1]:void 0,o=r?arguments[2]:arguments[1];return o._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(o),this},t.once=function(e,t,n){function r(){i.off(e,r),s.apply(this,arguments)}var i=this,o=3===arguments.length,a=o?arguments[1]:void 0,s=o?arguments[2]:arguments[1];return this.on(e,a,r),this},t.releaseGroup=function(e){this.callbacks=this.callbacks||{};var t,n,r,i;for(t in this.callbacks)for(i=this.callbacks[t],n=0,r=i.length;r>n;n++)i[n]._groupName===e&&(i.splice(n,1),n--,r--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,r=this.callbacks[e];return r?1===arguments.length?(delete this.callbacks[e],this):(n=r.indexOf(t),r.splice(n,1),0===r.length&&delete this.callbacks[e],this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,r,i=[].slice.call(arguments,1),o=this.callbacks[e],a=this.getWildcardCallbacks(e);if(o)for(r=o.slice(),t=0,n=r.length;n>t&&r[t];++t)r[t].apply(this,i);if(a)for(n=a.length,r=a.slice(),t=0,n=r.length;n>t&&r[t];++t)r[t].apply(this,[e].concat(i));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},r.mixin(r)},{}],37:[function(e,t,n){function r(e,t,n){if(!s(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===c.call(e)?i(e,t,n):"string"==typeof e?o(e,t,n):a(e,t,n)}function i(e,t,n){for(var r=0,i=e.length;i>r;r++)u.call(e,r)&&t.call(n,e[r],r,e)}function o(e,t,n){for(var r=0,i=e.length;i>r;r++)t.call(n,e.charAt(r),r,e)}function a(e,t,n){for(var r in e)u.call(e,r)&&t.call(n,e[r],r,e)}var s=e("is-function");t.exports=r;var c=Object.prototype.toString,u=Object.prototype.hasOwnProperty},{"is-function":49}],38:[function(e,t,n){(function(e){var n;n="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],39:[function(e,t,n){"use strict";function r(e,t){if(!o.isBuffer(e)&&"string"!=typeof e)throw new TypeError(t+" must be a string or a buffer")}function i(e){a.call(this),this._block=o.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}var o=e("safe-buffer").Buffer,a=e("stream").Transform,s=e("inherits");s(i,a),i.prototype._transform=function(e,t,n){var r=null;try{this.update(e,t)}catch(i){r=i}n(r)},i.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(n){t=n}e(t)},i.prototype.update=function(e,t){if(r(e,"Data"),this._finalized)throw new Error("Digest already called");o.isBuffer(e)||(e=o.from(e,t));for(var n=this._block,i=0;this._blockOffset+e.length-i>=this._blockSize;){for(var a=this._blockOffset;a<this._blockSize;)n[a++]=e[i++];this._update(),this._blockOffset=0}for(;i<e.length;)n[this._blockOffset++]=e[i++];for(var s=0,c=8*e.length;c>0;++s)this._length[s]+=c,c=this._length[s]/4294967296|0,c>0&&(this._length[s]-=4294967296*c);return this},i.prototype._update=function(){throw new Error("_update is not implemented")},i.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var n=0;4>n;++n)this._length[n]=0;return t},i.prototype._digest=function(){throw new Error("_digest is not implemented")},t.exports=i},{inherits:46,"safe-buffer":211,stream:301}],40:[function(e,t,n){"use strict";var r=e("async"),i=e("request"),o=e("jxt").createRegistry();o.use(e("./lib/xrd")),t.exports=function(e,t){"string"==typeof e&&(e={host:e});var n={ssl:!0,json:!0,xrd:!0};for(var a in e)n[a]=e[a];var s=n.ssl?"https://":"http://";r.parallel([function(e){i(s+n.host+"/.well-known/host-meta.json",function(t,n,r){if(t)return e(null);var i;try{i=JSON.parse(r)}catch(o){i=null}return e(i)})},function(e){i(s+n.host+"/.well-known/host-meta",function(t,n,r){if(t)return e(null);var i=o.parse(r);return e(i.toJSON())})}],function(e){e?t(null,e):t("no-host-meta")})}},{"./lib/xrd":41,async:42,jxt:143,request:329}],41:[function(e,t,n){"use strict";var r=e("jxt"),i="http://docs.oasis-open.org/ns/xri/xrd-1.0";t.exports=function(e){var t={get:function(){for(var e={},t=r.find(this.xml,i,"Property"),n=0,o=t.length;o>n;n++){var a=t[n],s=r.getAttribute(a,"type");e[s]=a.textContent}return e}},n=e.define({name:"xrd",namespace:i,element:"XRD",fields:{subject:r.subText(i,"Subject"),expires:r.dateSub(i,"Expires"),aliases:r.multiSubText(i,"Alias"),properties:t}}),o=e.define({name:"_xrdlink",namespace:i,element:"Link",fields:{rel:r.attribute("rel"),href:r.attribute("href"),type:r.attribute("type"),template:r.attribute("template"),titles:r.subLangText(i,"Title","default"),properties:t}});return e.extend(n,o,"links"),n}},{jxt:143}],42:[function(e,t,n){(function(e,r,i){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(e.async=e.async||{})}(this,function(n){
"use strict";function o(e,t){t=0|t;for(var n=Math.max(e.length-t,0),r=Array(n),i=0;n>i;i++)r[i]=e[t+i];return r}function a(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function s(e){setTimeout(e,0)}function c(e){return function(t){var n=o(arguments,1);e(function(){t.apply(null,n)})}}function u(e){return lt(function(t,n){var r;try{r=e.apply(this,t)}catch(i){return n(i)}a(r)&&"function"==typeof r.then?r.then(function(e){l(n,null,e)},function(e){l(n,e.message?e:new Error(e))}):n(null,r)})}function l(e,t,n){try{e(t,n)}catch(r){ft(d,r)}}function d(e){throw e}function p(e){return ht&&"AsyncFunction"===e[Symbol.toStringTag]}function f(e){return p(e)?u(e):e}function h(e){return function(t){var n=o(arguments,1),r=lt(function(n,r){var i=this;return e(t,function(e,t){f(e).apply(i,n.concat(t))},r)});return n.length?r.apply(this,n):r}}function m(e){var t=St.call(e,Ct),n=e[Ct];try{e[Ct]=void 0;var r=!0}catch(i){}var o=bt.call(e);return r&&(t?e[Ct]=n:delete e[Ct]),o}function v(e){return Et.call(e)}function g(e){return null==e?void 0===e?Pt:Rt:xt&&xt in Object(e)?m(e):v(e)}function y(e){if(!a(e))return!1;var t=g(e);return t==Lt||t==Ot||t==Tt||t==It}function _(e){return"number"==typeof e&&e>-1&&e%1==0&&Mt>=e}function S(e){return null!=e&&_(e.length)&&!y(e)}function b(){}function C(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}function w(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function E(e){return null!=e&&"object"==typeof e}function R(e){return E(e)&&g(e)==jt}function P(){return!1}function x(e,t){var n=typeof e;return t=null==t?Xt:t,!!t&&("number"==n||"symbol"!=n&&Yt.test(e))&&e>-1&&e%1==0&&t>e}function T(e){return E(e)&&_(e.length)&&!!bn[g(e)]}function L(e){return function(t){return e(t)}}function O(e,t){var n=Ft(e),r=!n&&Bt(e),i=!n&&!r&&Ht(e),o=!n&&!r&&!i&&Tn(e),a=n||r||i||o,s=a?w(e.length,String):[],c=s.length;for(var u in e)!t&&!On.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||x(u,c))||s.push(u);return s}function I(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||In;return e===n}function M(e,t){return function(n){return e(t(n))}}function A(e){if(!I(e))return Mn(e);var t=[];for(var n in Object(e))Dn.call(e,n)&&"constructor"!=n&&t.push(n);return t}function D(e){return S(e)?O(e):A(e)}function k(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}function j(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}function N(e){var t=D(e),n=-1,r=t.length;return function(){var i=t[++n];return r>n?{value:e[i],key:i}:null}}function V(e){if(S(e))return k(e);var t=kt(e);return t?j(t):N(e)}function U(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function B(e){return function(t,n,r){function i(e,t){if(c-=1,e)s=!0,r(e);else{if(t===At||s&&0>=c)return s=!0,r(null);u||o()}}function o(){for(u=!0;e>c&&!s;){var t=a();if(null===t)return s=!0,void(0>=c&&r(null));c+=1,n(t.value,t.key,U(i))}u=!1}if(r=C(r||b),0>=e||!t)return r(null);var a=V(t),s=!1,c=0,u=!1;o()}}function F(e,t,n,r){B(t)(e,f(n),r)}function G(e,t){return function(n,r,i){return e(n,t,r,i)}}function q(e,t,n){function r(e,t){e?n(e):(++o===a||t===At)&&n(null)}n=C(n||b);var i=0,o=0,a=e.length;for(0===a&&n(null);a>i;i++)t(e[i],i,U(r))}function J(e){return function(t,n,r){return e(jn,t,f(n),r)}}function W(e,t,n,r){r=r||b,t=t||[];var i=[],o=0,a=f(n);e(t,function(e,t,n){var r=o++;a(e,function(e,t){i[r]=t,n(e)})},function(e){r(e,i)})}function z(e){return function(t,n,r,i){return e(B(n),t,f(r),i)}}function H(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function X(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(n(o[c],c,o)===!1)break}return t}}function Y(e,t){return e&&Gn(e,t,D)}function $(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Q(e){return e!==e}function K(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function Z(e,t,n){return t===t?K(e,t,n):$(e,Q,n)}function ee(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function te(e){return"symbol"==typeof e||E(e)&&g(e)==Jn}function ne(e){if("string"==typeof e)return e;if(Ft(e))return ee(e,ne)+"";if(te(e))return Hn?Hn.call(e):"";var t=e+"";return"0"==t&&1/e==-Wn?"-0":t}function re(e,t,n){var r=-1,i=e.length;0>t&&(t=-t>i?0:i+t),n=n>i?i:n,0>n&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}function ie(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:re(e,t,n)}function oe(e,t){for(var n=e.length;n--&&Z(t,e[n],0)>-1;);return n}function ae(e,t){for(var n=-1,r=e.length;++n<r&&Z(t,e[n],0)>-1;);return n}function se(e){return e.split("")}function ce(e){return tr.test(e)}function ue(e){return e.match(br)||[]}function le(e){return ce(e)?ue(e):se(e)}function de(e){return null==e?"":ne(e)}function pe(e,t,n){if(e=de(e),e&&(n||void 0===t))return e.replace(Cr,"");if(!e||!(t=ne(t)))return e;var r=le(e),i=le(t),o=ae(r,i),a=oe(r,i)+1;return ie(r,o,a).join("")}function fe(e){return e=e.toString().replace(Pr,""),e=e.match(wr)[2].replace(" ",""),e=e?e.split(Er):[],e=e.map(function(e){return pe(e.replace(Rr,""))})}function he(e,t){var n={};Y(e,function(e,t){function r(t,n){var r=ee(i,function(e){return t[e]});r.push(n),f(e).apply(null,r)}var i,o=p(e),a=!o&&1===e.length||o&&0===e.length;if(Ft(e))i=e.slice(0,-1),e=e[e.length-1],n[t]=i.concat(i.length>0?r:e);else if(a)n[t]=e;else{if(i=fe(e),0===e.length&&!o&&0===i.length)throw new Error("autoInject task functions require explicit parameters.");o||i.pop(),n[t]=i.concat(r)}}),qn(n,t)}function me(){this.head=this.tail=null,this.length=0}function ve(e,t){e.length=1,e.head=e.tail=t}function ge(e,t,n){function r(e,t,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(l.started=!0,Ft(e)||(e=[e]),0===e.length&&l.idle())return ft(function(){l.drain()});for(var r=0,i=e.length;i>r;r++){var o={data:e[r],callback:n||b};t?l._tasks.unshift(o):l._tasks.push(o)}c||(c=!0,ft(function(){c=!1,l.process()}))}function i(e){return function(t){a-=1;for(var n=0,r=e.length;r>n;n++){var i=e[n],o=Z(s,i,0);0===o?s.shift():o>0&&s.splice(o,1),i.callback.apply(i,arguments),null!=t&&l.error(t,i.data)}a<=l.concurrency-l.buffer&&l.unsaturated(),l.idle()&&l.drain(),l.process()}}if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var o=f(e),a=0,s=[],c=!1,u=!1,l={_tasks:new me,concurrency:t,payload:n,saturated:b,unsaturated:b,buffer:t/4,empty:b,drain:b,error:b,started:!1,paused:!1,push:function(e,t){r(e,!1,t)},kill:function(){l.drain=b,l._tasks.empty()},unshift:function(e,t){r(e,!0,t)},remove:function(e){l._tasks.remove(e)},process:function(){if(!u){for(u=!0;!l.paused&&a<l.concurrency&&l._tasks.length;){var e=[],t=[],n=l._tasks.length;l.payload&&(n=Math.min(n,l.payload));for(var r=0;n>r;r++){var c=l._tasks.shift();e.push(c),s.push(c),t.push(c.data)}a+=1,0===l._tasks.length&&l.empty(),a===l.concurrency&&l.saturated();var d=U(i(e));o(t,d)}u=!1}},length:function(){return l._tasks.length},running:function(){return a},workersList:function(){return s},idle:function(){return l._tasks.length+a===0},pause:function(){l.paused=!0},resume:function(){l.paused!==!1&&(l.paused=!1,ft(l.process))}};return l}function ye(e,t){return ge(e,1,t)}function _e(e,t,n,r){r=C(r||b);var i=f(n);Tr(e,function(e,n,r){i(t,e,function(e,n){t=n,r(e)})},function(e){r(e,t)})}function Se(){var e=ee(arguments,f);return function(){var t=o(arguments),n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=b,_e(e,t,function(e,t,r){t.apply(n,e.concat(function(e){var t=o(arguments,1);r(e,t)}))},function(e,t){r.apply(n,[e].concat(t))})}}function be(e){return e}function Ce(e,t){return function(n,r,i,o){o=o||b;var a,s=!1;n(r,function(n,r,o){i(n,function(r,i){r?o(r):e(i)&&!a?(s=!0,a=t(!0,n),o(null,At)):o()})},function(e){e?o(e):o(null,s?a:t(!1))})}}function we(e,t){return t}function Ee(e){return function(t){var n=o(arguments,1);n.push(function(t){var n=o(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&H(n,function(t){console[e](t)}))}),f(t).apply(null,n)}}function Re(e,t,n){function r(e){if(e)return n(e);var t=o(arguments,1);t.push(i),s.apply(this,t)}function i(e,t){return e?n(e):t?void a(r):n(null)}n=U(n||b);var a=f(e),s=f(t);i(null,!0)}function Pe(e,t,n){n=U(n||b);var r=f(e),i=function(e){if(e)return n(e);var a=o(arguments,1);return t.apply(this,a)?r(i):void n.apply(null,[null].concat(a))};r(i)}function xe(e,t,n){Pe(e,function(){return!t.apply(this,arguments)},n)}function Te(e,t,n){function r(e){return e?n(e):void a(i)}function i(e,t){return e?n(e):t?void o(r):n(null)}n=U(n||b);var o=f(t),a=f(e);a(i)}function Le(e){return function(t,n,r){return e(t,r)}}function Oe(e,t,n){jn(e,Le(f(t)),n)}function Ie(e,t,n,r){B(t)(e,Le(f(n)),r)}function Me(e){return p(e)?e:lt(function(t,n){var r=!0;t.push(function(){var e=arguments;r?ft(function(){n.apply(null,e)}):n.apply(null,e)}),e.apply(this,t),r=!1})}function Ae(e){return!e}function De(e){return function(t){return null==t?void 0:t[e]}}function ke(e,t,n,r){var i=new Array(t.length);e(t,function(e,t,r){n(e,function(e,n){i[t]=!!n,r(e)})},function(e){if(e)return r(e);for(var n=[],o=0;o<t.length;o++)i[o]&&n.push(t[o]);r(null,n)})}function je(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n,o){n?r(n):(o&&i.push({index:t,value:e}),r())})},function(e){e?r(e):r(null,ee(i.sort(function(e,t){return e.index-t.index}),De("value")))})}function Ne(e,t,n,r){var i=S(t)?ke:je;i(e,t,f(n),r||b)}function Ve(e,t){function n(e){return e?r(e):void i(n)}var r=U(t||b),i=f(Me(e));n()}function Ue(e,t,n,r){r=C(r||b);var i={},o=f(n);F(e,t,function(e,t,n){o(e,t,function(e,r){return e?n(e):(i[t]=r,void n())})},function(e){r(e,i)})}function Be(e,t){return t in e}function Fe(e,t){var n=Object.create(null),r=Object.create(null);t=t||be;var i=f(e),a=lt(function(e,a){var s=t.apply(null,e);Be(n,s)?ft(function(){a.apply(null,n[s])}):Be(r,s)?r[s].push(a):(r[s]=[a],i.apply(null,e.concat(function(){var e=o(arguments);n[s]=e;var t=r[s];delete r[s];for(var i=0,a=t.length;a>i;i++)t[i].apply(null,e)})))});return a.memo=n,a.unmemoized=e,a}function Ge(e,t,n){n=n||b;var r=S(t)?[]:{};e(t,function(e,t,n){f(e)(function(e,i){arguments.length>2&&(i=o(arguments,1)),r[t]=i,n(e)})},function(e){n(e,r)})}function qe(e,t){Ge(jn,e,t)}function Je(e,t,n){Ge(B(t),e,n)}function We(e,t){if(t=C(t||b),!Ft(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,r=e.length;r>n;n++)f(e[n])(t)}function ze(e,t,n,r){var i=o(e).reverse();_e(i,t,n,r)}function He(e){var t=f(e);return lt(function(e,n){return e.push(function(e,t){if(e)n(null,{error:e});else{var r;r=arguments.length<=2?t:o(arguments,1),n(null,{value:r})}}),t.apply(this,e)})}function Xe(e){var t;return Ft(e)?t=ee(e,He):(t={},Y(e,function(e,n){t[n]=He.call(this,e)})),t}function Ye(e,t,n,r){Ne(e,t,function(e,t){n(e,function(e,n){t(e,!n)})},r)}function $e(e){return function(){return e}}function Qe(e,t,n){function r(e,t){if("object"==typeof t)e.times=+t.times||o,e.intervalFunc="function"==typeof t.interval?t.interval:$e(+t.interval||a),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||o}}function i(){c(function(e){e&&u++<s.times&&("function"!=typeof s.errorFilter||s.errorFilter(e))?setTimeout(i,s.intervalFunc(u)):n.apply(null,arguments)})}var o=5,a=0,s={times:o,intervalFunc:$e(a)};if(arguments.length<3&&"function"==typeof e?(n=t||b,t=e):(r(s,e),n=n||b),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var c=f(t),u=1;i()}function Ke(e,t){Ge(Tr,e,t)}function Ze(e,t,n){function r(e,t){var n=e.criteria,r=t.criteria;return r>n?-1:n>r?1:0}var i=f(t);Nn(e,function(e,t){i(e,function(n,r){return n?t(n):void t(null,{value:e,criteria:r})})},function(e,t){return e?n(e):void n(null,ee(t.sort(r),De("value")))})}function et(e,t,n){var r=f(e);return lt(function(i,o){function a(){var t=e.name||"anonymous",r=new Error('Callback function "'+t+'" timed out.');r.code="ETIMEDOUT",n&&(r.info=n),c=!0,o(r)}var s,c=!1;i.push(function(){c||(o.apply(null,arguments),clearTimeout(s))}),s=setTimeout(a,t),r.apply(null,i)})}function tt(e,t,n,r){for(var i=-1,o=ui(ci((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}function nt(e,t,n,r){var i=f(n);Un(tt(0,e,1),t,i,r)}function rt(e,t,n,r){arguments.length<=3&&(r=n,n=t,t=Ft(e)?[]:{}),r=C(r||b);var i=f(n);jn(e,function(e,n,r){i(t,e,n,r)},function(e){r(e,t)})}function it(e,t){var n,r=null;t=t||b,Ur(e,function(e,t){f(e)(function(e,i){n=arguments.length>2?o(arguments,1):i,r=e,t(!e)})},function(){t(r,n)})}function ot(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function at(e,t,n){n=U(n||b);var r=f(t);if(!e())return n(null);var i=function(t){if(t)return n(t);if(e())return r(i);var a=o(arguments,1);n.apply(null,[null].concat(a))};r(i)}function st(e,t,n){at(function(){return!e.apply(this,arguments)},t,n)}var ct,ut=function(e){var t=o(arguments,1);return function(){var n=o(arguments);return e.apply(null,t.concat(n))}},lt=function(e){return function(){var t=o(arguments),n=t.pop();e.call(this,t,n)}},dt="function"==typeof i&&i,pt="object"==typeof e&&"function"==typeof e.nextTick;ct=dt?i:pt?e.nextTick:s;var ft=c(ct),ht="function"==typeof Symbol,mt="object"==typeof r&&r&&r.Object===Object&&r,vt="object"==typeof self&&self&&self.Object===Object&&self,gt=mt||vt||Function("return this")(),yt=gt.Symbol,_t=Object.prototype,St=_t.hasOwnProperty,bt=_t.toString,Ct=yt?yt.toStringTag:void 0,wt=Object.prototype,Et=wt.toString,Rt="[object Null]",Pt="[object Undefined]",xt=yt?yt.toStringTag:void 0,Tt="[object AsyncFunction]",Lt="[object Function]",Ot="[object GeneratorFunction]",It="[object Proxy]",Mt=9007199254740991,At={},Dt="function"==typeof Symbol&&Symbol.iterator,kt=function(e){return Dt&&e[Dt]&&e[Dt]()},jt="[object Arguments]",Nt=Object.prototype,Vt=Nt.hasOwnProperty,Ut=Nt.propertyIsEnumerable,Bt=R(function(){return arguments}())?R:function(e){return E(e)&&Vt.call(e,"callee")&&!Ut.call(e,"callee")},Ft=Array.isArray,Gt="object"==typeof n&&n&&!n.nodeType&&n,qt=Gt&&"object"==typeof t&&t&&!t.nodeType&&t,Jt=qt&&qt.exports===Gt,Wt=Jt?gt.Buffer:void 0,zt=Wt?Wt.isBuffer:void 0,Ht=zt||P,Xt=9007199254740991,Yt=/^(?:0|[1-9]\d*)$/,$t="[object Arguments]",Qt="[object Array]",Kt="[object Boolean]",Zt="[object Date]",en="[object Error]",tn="[object Function]",nn="[object Map]",rn="[object Number]",on="[object Object]",an="[object RegExp]",sn="[object Set]",cn="[object String]",un="[object WeakMap]",ln="[object ArrayBuffer]",dn="[object DataView]",pn="[object Float32Array]",fn="[object Float64Array]",hn="[object Int8Array]",mn="[object Int16Array]",vn="[object Int32Array]",gn="[object Uint8Array]",yn="[object Uint8ClampedArray]",_n="[object Uint16Array]",Sn="[object Uint32Array]",bn={};bn[pn]=bn[fn]=bn[hn]=bn[mn]=bn[vn]=bn[gn]=bn[yn]=bn[_n]=bn[Sn]=!0,bn[$t]=bn[Qt]=bn[ln]=bn[Kt]=bn[dn]=bn[Zt]=bn[en]=bn[tn]=bn[nn]=bn[rn]=bn[on]=bn[an]=bn[sn]=bn[cn]=bn[un]=!1;var Cn="object"==typeof n&&n&&!n.nodeType&&n,wn=Cn&&"object"==typeof t&&t&&!t.nodeType&&t,En=wn&&wn.exports===Cn,Rn=En&&mt.process,Pn=function(){try{var e=wn&&wn.require&&wn.require("util").types;return e?e:Rn&&Rn.binding&&Rn.binding("util")}catch(t){}}(),xn=Pn&&Pn.isTypedArray,Tn=xn?L(xn):T,Ln=Object.prototype,On=Ln.hasOwnProperty,In=Object.prototype,Mn=M(Object.keys,Object),An=Object.prototype,Dn=An.hasOwnProperty,kn=G(F,1/0),jn=function(e,t,n){var r=S(e)?q:kn;r(e,f(t),n)},Nn=J(W),Vn=h(Nn),Un=z(W),Bn=G(Un,1),Fn=h(Bn),Gn=X(),qn=function(e,t,n){function r(e,t){y.push(function(){c(e,t)})}function i(){if(0===y.length&&0===m)return n(null,h);for(;y.length&&t>m;){var e=y.shift();e()}}function a(e,t){var n=g[e];n||(n=g[e]=[]),n.push(t)}function s(e){var t=g[e]||[];H(t,function(e){e()}),i()}function c(e,t){if(!v){var r=U(function(t,r){if(m--,arguments.length>2&&(r=o(arguments,1)),t){var i={};Y(h,function(e,t){i[t]=e}),i[e]=r,v=!0,g=Object.create(null),n(t,i)}else h[e]=r,s(e)});m++;var i=f(t[t.length-1]);t.length>1?i(h,r):i(r)}}function u(){for(var e,t=0;_.length;)e=_.pop(),t++,H(l(e),function(e){0===--S[e]&&_.push(e)});if(t!==p)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function l(t){var n=[];return Y(e,function(e,r){Ft(e)&&Z(e,t,0)>=0&&n.push(r)}),n}"function"==typeof t&&(n=t,t=null),n=C(n||b);var d=D(e),p=d.length;if(!p)return n(null);t||(t=p);var h={},m=0,v=!1,g=Object.create(null),y=[],_=[],S={};Y(e,function(t,n){if(!Ft(t))return r(n,[t]),void _.push(n);var i=t.slice(0,t.length-1),o=i.length;return 0===o?(r(n,t),void _.push(n)):(S[n]=o,void H(i,function(s){if(!e[s])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+s+"` in "+i.join(", "));a(s,function(){o--,0===o&&r(n,t)})}))}),u(),i()},Jn="[object Symbol]",Wn=1/0,zn=yt?yt.prototype:void 0,Hn=zn?zn.toString:void 0,Xn="\\ud800-\\udfff",Yn="\\u0300-\\u036f",$n="\\ufe20-\\ufe2f",Qn="\\u20d0-\\u20ff",Kn=Yn+$n+Qn,Zn="\\ufe0e\\ufe0f",er="\\u200d",tr=RegExp("["+er+Xn+Kn+Zn+"]"),nr="\\ud800-\\udfff",rr="\\u0300-\\u036f",ir="\\ufe20-\\ufe2f",or="\\u20d0-\\u20ff",ar=rr+ir+or,sr="\\ufe0e\\ufe0f",cr="["+nr+"]",ur="["+ar+"]",lr="\\ud83c[\\udffb-\\udfff]",dr="(?:"+ur+"|"+lr+")",pr="[^"+nr+"]",fr="(?:\\ud83c[\\udde6-\\uddff]){2}",hr="[\\ud800-\\udbff][\\udc00-\\udfff]",mr="\\u200d",vr=dr+"?",gr="["+sr+"]?",yr="(?:"+mr+"(?:"+[pr,fr,hr].join("|")+")"+gr+vr+")*",_r=gr+vr+yr,Sr="(?:"+[pr+ur+"?",ur,fr,hr,cr].join("|")+")",br=RegExp(lr+"(?="+lr+")|"+Sr+_r,"g"),Cr=/^\s+|\s+$/g,wr=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Er=/,/,Rr=/(=.+)?(\s*)$/,Pr=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;me.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},me.prototype.empty=function(){for(;this.head;)this.shift();return this},me.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},me.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},me.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):ve(this,e)},me.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):ve(this,e)},me.prototype.shift=function(){return this.head&&this.removeLink(this.head)},me.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},me.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,n=0;n<this.length;n++)e[n]=t.data,t=t.next;return e},me.prototype.remove=function(e){for(var t=this.head;t;){var n=t.next;e(t)&&this.removeLink(t),t=n}return this};var xr,Tr=G(F,1),Lr=function(){return Se.apply(null,o(arguments).reverse())},Or=Array.prototype.concat,Ir=function(e,t,n,r){r=r||b;var i=f(n);Un(e,t,function(e,t){i(e,function(e){return e?t(e):t(null,o(arguments,1))})},function(e,t){for(var n=[],i=0;i<t.length;i++)t[i]&&(n=Or.apply(n,t[i]));return r(e,n)})},Mr=G(Ir,1/0),Ar=G(Ir,1),Dr=function(){var e=o(arguments),t=[null].concat(e);return function(){var e=arguments[arguments.length-1];return e.apply(this,t)}},kr=J(Ce(be,we)),jr=z(Ce(be,we)),Nr=G(jr,1),Vr=Ee("dir"),Ur=G(Ie,1),Br=J(Ce(Ae,Ae)),Fr=z(Ce(Ae,Ae)),Gr=G(Fr,1),qr=J(Ne),Jr=z(Ne),Wr=G(Jr,1),zr=function(e,t,n,r){r=r||b;var i=f(n);Un(e,t,function(e,t){i(e,function(n,r){return n?t(n):t(null,{key:r,val:e})})},function(e,t){for(var n={},i=Object.prototype.hasOwnProperty,o=0;o<t.length;o++)if(t[o]){var a=t[o].key,s=t[o].val;i.call(n,a)?n[a].push(s):n[a]=[s]}return r(e,n)})},Hr=G(zr,1/0),Xr=G(zr,1),Yr=Ee("log"),$r=G(Ue,1/0),Qr=G(Ue,1);xr=pt?e.nextTick:dt?i:s;var Kr=c(xr),Zr=function(e,t){var n=f(e);return ge(function(e,t){n(e[0],t)},t,1)},ei=function(e,t){var n=Zr(e,t);return n.push=function(e,t,r){if(null==r&&(r=b),"function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,Ft(e)||(e=[e]),0===e.length)return ft(function(){n.drain()});t=t||0;for(var i=n._tasks.head;i&&t>=i.priority;)i=i.next;for(var o=0,a=e.length;a>o;o++){var s={data:e[o],priority:t,callback:r};i?n._tasks.insertBefore(i,s):n._tasks.push(s)}ft(n.process)},delete n.unshift,n},ti=J(Ye),ni=z(Ye),ri=G(ni,1),ii=function(e,t){t||(t=e,e=null);var n=f(t);return lt(function(t,r){function i(e){n.apply(null,t.concat(e))}e?Qe(e,i,r):Qe(i,r)})},oi=J(Ce(Boolean,be)),ai=z(Ce(Boolean,be)),si=G(ai,1),ci=Math.ceil,ui=Math.max,li=G(nt,1/0),di=G(nt,1),pi=function(e,t){function n(t){var n=f(e[i++]);t.push(U(r)),n.apply(null,t)}function r(r){return r||i===e.length?t.apply(null,arguments):void n(o(arguments,1))}if(t=C(t||b),!Ft(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var i=0;n([])},fi={apply:ut,applyEach:Vn,applyEachSeries:Fn,asyncify:u,auto:qn,autoInject:he,cargo:ye,compose:Lr,concat:Mr,concatLimit:Ir,concatSeries:Ar,constant:Dr,detect:kr,detectLimit:jr,detectSeries:Nr,dir:Vr,doDuring:Re,doUntil:xe,doWhilst:Pe,during:Te,each:Oe,eachLimit:Ie,eachOf:jn,eachOfLimit:F,eachOfSeries:Tr,eachSeries:Ur,ensureAsync:Me,every:Br,everyLimit:Fr,everySeries:Gr,filter:qr,filterLimit:Jr,filterSeries:Wr,forever:Ve,groupBy:Hr,groupByLimit:zr,groupBySeries:Xr,log:Yr,map:Nn,mapLimit:Un,mapSeries:Bn,mapValues:$r,mapValuesLimit:Ue,mapValuesSeries:Qr,memoize:Fe,nextTick:Kr,parallel:qe,parallelLimit:Je,priorityQueue:ei,queue:Zr,race:We,reduce:_e,reduceRight:ze,reflect:He,reflectAll:Xe,reject:ti,rejectLimit:ni,rejectSeries:ri,retry:Qe,retryable:ii,seq:Se,series:Ke,setImmediate:ft,some:oi,someLimit:ai,someSeries:si,sortBy:Ze,timeout:et,times:li,timesLimit:nt,timesSeries:di,transform:rt,tryEach:it,unmemoize:ot,until:st,waterfall:pi,whilst:at,all:Br,allLimit:Fr,allSeries:Gr,any:oi,anyLimit:ai,anySeries:si,find:kr,findLimit:jr,findSeries:Nr,forEach:Oe,forEachSeries:Ur,forEachLimit:Ie,forEachOf:jn,forEachOfSeries:Tr,forEachOfLimit:F,inject:_e,foldl:_e,foldr:ze,select:qr,selectLimit:Jr,selectSeries:Wr,wrapSync:u};n["default"]=fi,n.apply=ut,n.applyEach=Vn,n.applyEachSeries=Fn,n.asyncify=u,n.auto=qn,n.autoInject=he,n.cargo=ye,n.compose=Lr,n.concat=Mr,n.concatLimit=Ir,n.concatSeries=Ar,n.constant=Dr,n.detect=kr,n.detectLimit=jr,n.detectSeries=Nr,n.dir=Vr,n.doDuring=Re,n.doUntil=xe,n.doWhilst=Pe,n.during=Te,n.each=Oe,n.eachLimit=Ie,n.eachOf=jn,n.eachOfLimit=F,n.eachOfSeries=Tr,n.eachSeries=Ur,n.ensureAsync=Me,n.every=Br,n.everyLimit=Fr,n.everySeries=Gr,n.filter=qr,n.filterLimit=Jr,n.filterSeries=Wr,n.forever=Ve,n.groupBy=Hr,n.groupByLimit=zr,n.groupBySeries=Xr,n.log=Yr,n.map=Nn,n.mapLimit=Un,n.mapSeries=Bn,n.mapValues=$r,n.mapValuesLimit=Ue,n.mapValuesSeries=Qr,n.memoize=Fe,n.nextTick=Kr,n.parallel=qe,n.parallelLimit=Je,n.priorityQueue=ei,n.queue=Zr,n.race=We,n.reduce=_e,n.reduceRight=ze,n.reflect=He,n.reflectAll=Xe,n.reject=ti,n.rejectLimit=ni,n.rejectSeries=ri,n.retry=Qe,n.retryable=ii,n.seq=Se,n.series=Ke,n.setImmediate=ft,n.some=oi,n.someLimit=ai,n.someSeries=si,n.sortBy=Ze,n.timeout=et,n.times=li,n.timesLimit=nt,n.timesSeries=di,n.transform=rt,n.tryEach=it,n.unmemoize=ot,n.until=st,n.waterfall=pi,n.whilst=at,n.all=Br,n.allLimit=Fr,n.allSeries=Gr,n.any=oi,n.anyLimit=ai,n.anySeries=si,n.find=kr,n.findLimit=jr,n.findSeries=Nr,n.forEach=Oe,n.forEachSeries=Ur,n.forEachLimit=Ie,n.forEachOf=jn,n.forEachOfSeries=Tr,n.forEachOfLimit=F,n.inject=_e,n.foldl=_e,n.foldr=ze,n.select=qr,n.selectLimit=Jr,n.selectSeries=Wr,n.wrapSync=u,Object.defineProperty(n,"__esModule",{value:!0})})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:8,timers:303}],43:[function(e,t,n){var r=e("create-hash"),i=e("create-hmac"),o=e("./lib/get-hashes"),a={md2:"md2",md5:"md5","sha-1":"sha1","sha-224":"sha224","sha-256":"sha256","sha-384":"sha384","sha-512":"sha512"},s=Object.keys(a);n.getHashes=function(){for(var e=[],t=o(),n=0,r=s.length;r>n;n++)t.indexOf(a[s[n]])>=0&&e.push(s[n]);return e},n.createHash=function(e){return e=e.toLowerCase(),a[e]&&(e=a[e]),r(e)},n.createHmac=function(e,t){return e=e.toLowerCase(),a[e]&&(e=a[e]),i(e,t)}},{"./lib/get-hashes":44,"create-hash":27,"create-hmac":29}],44:[function(e,t,n){t.exports=function(){return["sha1","sha224","sha256","sha384","sha512","md5","rmd160"]}},{}],45:[function(e,t,n){n.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,d=n?i-1:0,p=n?-1:1,f=e[t+d];for(d+=p,o=f&(1<<-l)-1,f>>=-l,l+=s;l>0;o=256*o+e[t+d],d+=p,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+d],d+=p,l-=8);if(0===o)o=1-u;else{if(o===c)return a?0/0:(f?-1:1)*(1/0);a+=Math.pow(2,r),o-=u}return(f?-1:1)*a*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,d=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,h=r?1:-1,m=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),t+=a+d>=1?p/c:p*Math.pow(2,1-d),t*c>=2&&(a++,c/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*c-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+f]=255&s,f+=h,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+f]=255&a,f+=h,a/=256,u-=8);e[n+f-h]|=128*m}},{}],46:[function(e,t,n){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],47:[function(e,t,n){function r(e,t){for(var n=[],r=0;r<e.length;r++)i(t,e[r])>-1&&n.push(e[r]);return n}function i(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}t.exports=r,r.big=function(e,t){for(var n=[],r={},i=0;i<t.length;i++)r[t[i]]=!0;for(var i=0;i<e.length;i++)r[e[i]]&&n.push(e[i]);return n}},{}],48:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function i(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}t.exports=function(e){return null!=e&&(r(e)||i(e)||!!e._isBuffer)}},{}],49:[function(e,t,n){function r(e){var t=i.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}t.exports=r;var i=Object.prototype.toString},{}],50:[function(e,t,n){function r(e){a.call(this,e),this.pc=new s({iceServers:e.iceServers||[],useJingle:!0},e.constraints||{}),this.pc.on("ice",this.onIceCandidate.bind(this)),this.pc.on("iceConnectionStateChange",this.onIceStateChange.bind(this)),this.pc.on("addChannel",this.onChannelAdded.bind(this)),this.sender=null,this.receiver=null}var i=e("util"),o=e("extend-object"),a=e("jingle-session"),s=(e("webrtc-adapter"),e("rtcpeerconnection")),c=e("filetransfer/hashed");i.inherits(r,a),r.prototype=o(r.prototype,{start:function(e){var t=this;this.state="pending",this.pc.isInitiator=!0,this.sender=new c.Sender,this.sender.on("progress",function(e,n){t._log("info","Send progress "+e+"/"+n)}),this.sender.on("sentFile",function(e){t._log("info","Sent file",e.name);var n=t.pc.localDescription.contents[0];delete n.transport,n.application={applicationType:"filetransfer",offer:{hash:{algo:e.algo,value:e.hash}}},t.send("description-info",{contents:[n]}),t.emit("sentFile",t,e)});var n=this.pc.createDataChannel("filetransfer");n.onopen=function(){t.sender.send(e,n)};var r={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};this.pc.offer(r,function(n,r){return n?(t._log("error","Could not create WebRTC offer",n),t.end("failed-application",!0)):(r.jingle.contents[0].application={applicationType:"filetransfer",offer:{date:e.lastModifiedDate,name:e.name,size:e.size,hash:{algo:"sha-1",value:""}}},void t.send("session-initiate",r.jingle))})},accept:function(){var e=this;this._log("info","Accepted incoming session"),this.state="active",this.pc.answer(function(t,n){return t?(e._log("error","Could not create WebRTC answer",t),e.end("failed-application")):void e.send("session-accept",n.jingle)})},end:function(e,t){this.pc.close(),a.prototype.end.call(this,e,t)},maybeReceivedFile:function(){this.receiver.metadata.hash.value&&(this.receiver.metadata.hash.value===this.receiver.metadata.actualhash?(this._log("info","File hash matches"),this.emit("receivedFile",this,this.receivedFile,this.receiver.metadata),this.end("success")):(this._log("error","File hash does not match"),this.end("media-error")))},onIceCandidate:function(e){this._log("info","Discovered new ICE candidate",e.jingle),this.send("transport-info",e.jingle)},onIceStateChange:function(){switch(this.pc.iceConnectionState){case"checking":this.connectionState="connecting";break;case"completed":case"connected":this.connectionState="connected";break;case"disconnected":this.connectionState="stable"===this.pc.signalingState?"interrupted":"disconnected";break;case"failed":this.connectionState="failed",this.end("failed-transport");break;case"closed":this.connectionState="disconnected"}},onChannelAdded:function(e){this.receiver.receive(null,e)},onSessionInitiate:function(e,t){var n=this;this._log("info","Initiating incoming session"),this.state="pending",this.pc.isInitiator=!1;var r=e.contents[0].application;this.receiver=new c.Receiver({hash:r.offer.hash.algo}),this.receiver.on("progress",function(e,t){n._log("info","Receive progress "+e+"/"+t)}),this.receiver.on("receivedFile",function(e){n.receivedFile=e,n.maybeReceivedFile()}),this.receiver.metadata=r.offer,e.contents[0].application={applicationType:"datachannel"},this.pc.handleOffer({type:"offer",jingle:e},function(e){return e?(n._log("error","Could not create WebRTC answer"),t({condition:"general-error"})):void t()})},onSessionAccept:function(e,t){var n=this;this.state="active",e.contents[0].application={applicationType:"datachannel"},this.pc.handleAnswer({type:"answer",jingle:e},function(e){return e?(n._log("error","Could not process WebRTC answer"),t({condition:"general-error"})):(n.emit("accepted",n),void t())})},onSessionTerminate:function(e,t){this._log("info","Terminating session"),this.pc.close(),a.prototype.end.call(this,e.reason,!0),t()},onDescriptionInfo:function(e,t){var n=e.contents[0].application.offer.hash;this.receiver.metadata.hash=n,this.receiver.metadata.actualhash&&this.maybeReceivedFile(),t()},onTransportInfo:function(e,t){this.pc.processIce(e,function(){t()})}}),t.exports=r},{"extend-object":33,"filetransfer/hashed":35,"jingle-session":52,rtcpeerconnection:53,util:309,"webrtc-adapter":54}],51:[function(e,t,n){(function(e,r,i){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(e.async=e.async||{})}(this,function(n){"use strict";function o(e,t){t=0|t;for(var n=Math.max(e.length-t,0),r=Array(n),i=0;n>i;i++)r[i]=e[t+i];return r}function a(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function s(e){setTimeout(e,0)}function c(e){return function(t){var n=o(arguments,1);e(function(){t.apply(null,n)})}}function u(e){return lt(function(t,n){var r;try{r=e.apply(this,t)}catch(i){return n(i)}a(r)&&"function"==typeof r.then?r.then(function(e){l(n,null,e)},function(e){l(n,e.message?e:new Error(e))}):n(null,r)})}function l(e,t,n){try{e(t,n)}catch(r){ft(d,r)}}function d(e){throw e}function p(e){return ht&&"AsyncFunction"===e[Symbol.toStringTag]}function f(e){return p(e)?u(e):e}function h(e){return function(t){var n=o(arguments,1),r=lt(function(n,r){var i=this;return e(t,function(e,t){f(e).apply(i,n.concat(t))},r)});return n.length?r.apply(this,n):r}}function m(e){var t=St.call(e,Ct),n=e[Ct];try{e[Ct]=void 0;var r=!0}catch(i){}var o=bt.call(e);return r&&(t?e[Ct]=n:delete e[Ct]),o}function v(e){return Et.call(e)}function g(e){
return null==e?void 0===e?Pt:Rt:xt&&xt in Object(e)?m(e):v(e)}function y(e){if(!a(e))return!1;var t=g(e);return t==Lt||t==Ot||t==Tt||t==It}function _(e){return"number"==typeof e&&e>-1&&e%1==0&&Mt>=e}function S(e){return null!=e&&_(e.length)&&!y(e)}function b(){}function C(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}function w(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function E(e){return null!=e&&"object"==typeof e}function R(e){return E(e)&&g(e)==jt}function P(){return!1}function x(e,t){var n=typeof e;return t=null==t?Xt:t,!!t&&("number"==n||"symbol"!=n&&Yt.test(e))&&e>-1&&e%1==0&&t>e}function T(e){return E(e)&&_(e.length)&&!!bn[g(e)]}function L(e){return function(t){return e(t)}}function O(e,t){var n=Ft(e),r=!n&&Bt(e),i=!n&&!r&&Ht(e),o=!n&&!r&&!i&&Tn(e),a=n||r||i||o,s=a?w(e.length,String):[],c=s.length;for(var u in e)!t&&!On.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||x(u,c))||s.push(u);return s}function I(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||In;return e===n}function M(e,t){return function(n){return e(t(n))}}function A(e){if(!I(e))return Mn(e);var t=[];for(var n in Object(e))Dn.call(e,n)&&"constructor"!=n&&t.push(n);return t}function D(e){return S(e)?O(e):A(e)}function k(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}function j(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}function N(e){var t=D(e),n=-1,r=t.length;return function(){var i=t[++n];return r>n?{value:e[i],key:i}:null}}function V(e){if(S(e))return k(e);var t=kt(e);return t?j(t):N(e)}function U(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function B(e){return function(t,n,r){function i(e,t){if(c-=1,e)s=!0,r(e);else{if(t===At||s&&0>=c)return s=!0,r(null);u||o()}}function o(){for(u=!0;e>c&&!s;){var t=a();if(null===t)return s=!0,void(0>=c&&r(null));c+=1,n(t.value,t.key,U(i))}u=!1}if(r=C(r||b),0>=e||!t)return r(null);var a=V(t),s=!1,c=0,u=!1;o()}}function F(e,t,n,r){B(t)(e,f(n),r)}function G(e,t){return function(n,r,i){return e(n,t,r,i)}}function q(e,t,n){function r(e,t){e?n(e):(++o===a||t===At)&&n(null)}n=C(n||b);var i=0,o=0,a=e.length;for(0===a&&n(null);a>i;i++)t(e[i],i,U(r))}function J(e){return function(t,n,r){return e(jn,t,f(n),r)}}function W(e,t,n,r){r=r||b,t=t||[];var i=[],o=0,a=f(n);e(t,function(e,t,n){var r=o++;a(e,function(e,t){i[r]=t,n(e)})},function(e){r(e,i)})}function z(e){return function(t,n,r,i){return e(B(n),t,f(r),i)}}function H(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function X(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(n(o[c],c,o)===!1)break}return t}}function Y(e,t){return e&&Gn(e,t,D)}function $(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Q(e){return e!==e}function K(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function Z(e,t,n){return t===t?K(e,t,n):$(e,Q,n)}function ee(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function te(e){return"symbol"==typeof e||E(e)&&g(e)==Jn}function ne(e){if("string"==typeof e)return e;if(Ft(e))return ee(e,ne)+"";if(te(e))return Hn?Hn.call(e):"";var t=e+"";return"0"==t&&1/e==-Wn?"-0":t}function re(e,t,n){var r=-1,i=e.length;0>t&&(t=-t>i?0:i+t),n=n>i?i:n,0>n&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}function ie(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:re(e,t,n)}function oe(e,t){for(var n=e.length;n--&&Z(t,e[n],0)>-1;);return n}function ae(e,t){for(var n=-1,r=e.length;++n<r&&Z(t,e[n],0)>-1;);return n}function se(e){return e.split("")}function ce(e){return tr.test(e)}function ue(e){return e.match(br)||[]}function le(e){return ce(e)?ue(e):se(e)}function de(e){return null==e?"":ne(e)}function pe(e,t,n){if(e=de(e),e&&(n||void 0===t))return e.replace(Cr,"");if(!e||!(t=ne(t)))return e;var r=le(e),i=le(t),o=ae(r,i),a=oe(r,i)+1;return ie(r,o,a).join("")}function fe(e){return e=e.toString().replace(Pr,""),e=e.match(wr)[2].replace(" ",""),e=e?e.split(Er):[],e=e.map(function(e){return pe(e.replace(Rr,""))})}function he(e,t){var n={};Y(e,function(e,t){function r(t,n){var r=ee(i,function(e){return t[e]});r.push(n),f(e).apply(null,r)}var i,o=p(e),a=!o&&1===e.length||o&&0===e.length;if(Ft(e))i=e.slice(0,-1),e=e[e.length-1],n[t]=i.concat(i.length>0?r:e);else if(a)n[t]=e;else{if(i=fe(e),0===e.length&&!o&&0===i.length)throw new Error("autoInject task functions require explicit parameters.");o||i.pop(),n[t]=i.concat(r)}}),qn(n,t)}function me(){this.head=this.tail=null,this.length=0}function ve(e,t){e.length=1,e.head=e.tail=t}function ge(e,t,n){function r(e,t,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(l.started=!0,Ft(e)||(e=[e]),0===e.length&&l.idle())return ft(function(){l.drain()});for(var r=0,i=e.length;i>r;r++){var o={data:e[r],callback:n||b};t?l._tasks.unshift(o):l._tasks.push(o)}c||(c=!0,ft(function(){c=!1,l.process()}))}function i(e){return function(t){a-=1;for(var n=0,r=e.length;r>n;n++){var i=e[n],o=Z(s,i,0);0===o?s.shift():o>0&&s.splice(o,1),i.callback.apply(i,arguments),null!=t&&l.error(t,i.data)}a<=l.concurrency-l.buffer&&l.unsaturated(),l.idle()&&l.drain(),l.process()}}if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var o=f(e),a=0,s=[],c=!1,u=!1,l={_tasks:new me,concurrency:t,payload:n,saturated:b,unsaturated:b,buffer:t/4,empty:b,drain:b,error:b,started:!1,paused:!1,push:function(e,t){r(e,!1,t)},kill:function(){l.drain=b,l._tasks.empty()},unshift:function(e,t){r(e,!0,t)},remove:function(e){l._tasks.remove(e)},process:function(){if(!u){for(u=!0;!l.paused&&a<l.concurrency&&l._tasks.length;){var e=[],t=[],n=l._tasks.length;l.payload&&(n=Math.min(n,l.payload));for(var r=0;n>r;r++){var c=l._tasks.shift();e.push(c),s.push(c),t.push(c.data)}a+=1,0===l._tasks.length&&l.empty(),a===l.concurrency&&l.saturated();var d=U(i(e));o(t,d)}u=!1}},length:function(){return l._tasks.length},running:function(){return a},workersList:function(){return s},idle:function(){return l._tasks.length+a===0},pause:function(){l.paused=!0},resume:function(){l.paused!==!1&&(l.paused=!1,ft(l.process))}};return l}function ye(e,t){return ge(e,1,t)}function _e(e,t,n,r){r=C(r||b);var i=f(n);Tr(e,function(e,n,r){i(t,e,function(e,n){t=n,r(e)})},function(e){r(e,t)})}function Se(){var e=ee(arguments,f);return function(){var t=o(arguments),n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=b,_e(e,t,function(e,t,r){t.apply(n,e.concat(function(e){var t=o(arguments,1);r(e,t)}))},function(e,t){r.apply(n,[e].concat(t))})}}function be(e){return e}function Ce(e,t){return function(n,r,i,o){o=o||b;var a,s=!1;n(r,function(n,r,o){i(n,function(r,i){r?o(r):e(i)&&!a?(s=!0,a=t(!0,n),o(null,At)):o()})},function(e){e?o(e):o(null,s?a:t(!1))})}}function we(e,t){return t}function Ee(e){return function(t){var n=o(arguments,1);n.push(function(t){var n=o(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&H(n,function(t){console[e](t)}))}),f(t).apply(null,n)}}function Re(e,t,n){function r(e){if(e)return n(e);var t=o(arguments,1);t.push(i),s.apply(this,t)}function i(e,t){return e?n(e):t?void a(r):n(null)}n=U(n||b);var a=f(e),s=f(t);i(null,!0)}function Pe(e,t,n){n=U(n||b);var r=f(e),i=function(e){if(e)return n(e);var a=o(arguments,1);return t.apply(this,a)?r(i):void n.apply(null,[null].concat(a))};r(i)}function xe(e,t,n){Pe(e,function(){return!t.apply(this,arguments)},n)}function Te(e,t,n){function r(e){return e?n(e):void a(i)}function i(e,t){return e?n(e):t?void o(r):n(null)}n=U(n||b);var o=f(t),a=f(e);a(i)}function Le(e){return function(t,n,r){return e(t,r)}}function Oe(e,t,n){jn(e,Le(f(t)),n)}function Ie(e,t,n,r){B(t)(e,Le(f(n)),r)}function Me(e){return p(e)?e:lt(function(t,n){var r=!0;t.push(function(){var e=arguments;r?ft(function(){n.apply(null,e)}):n.apply(null,e)}),e.apply(this,t),r=!1})}function Ae(e){return!e}function De(e){return function(t){return null==t?void 0:t[e]}}function ke(e,t,n,r){var i=new Array(t.length);e(t,function(e,t,r){n(e,function(e,n){i[t]=!!n,r(e)})},function(e){if(e)return r(e);for(var n=[],o=0;o<t.length;o++)i[o]&&n.push(t[o]);r(null,n)})}function je(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n,o){n?r(n):(o&&i.push({index:t,value:e}),r())})},function(e){e?r(e):r(null,ee(i.sort(function(e,t){return e.index-t.index}),De("value")))})}function Ne(e,t,n,r){var i=S(t)?ke:je;i(e,t,f(n),r||b)}function Ve(e,t){function n(e){return e?r(e):void i(n)}var r=U(t||b),i=f(Me(e));n()}function Ue(e,t,n,r){r=C(r||b);var i={},o=f(n);F(e,t,function(e,t,n){o(e,t,function(e,r){return e?n(e):(i[t]=r,void n())})},function(e){r(e,i)})}function Be(e,t){return t in e}function Fe(e,t){var n=Object.create(null),r=Object.create(null);t=t||be;var i=f(e),a=lt(function(e,a){var s=t.apply(null,e);Be(n,s)?ft(function(){a.apply(null,n[s])}):Be(r,s)?r[s].push(a):(r[s]=[a],i.apply(null,e.concat(function(){var e=o(arguments);n[s]=e;var t=r[s];delete r[s];for(var i=0,a=t.length;a>i;i++)t[i].apply(null,e)})))});return a.memo=n,a.unmemoized=e,a}function Ge(e,t,n){n=n||b;var r=S(t)?[]:{};e(t,function(e,t,n){f(e)(function(e,i){arguments.length>2&&(i=o(arguments,1)),r[t]=i,n(e)})},function(e){n(e,r)})}function qe(e,t){Ge(jn,e,t)}function Je(e,t,n){Ge(B(t),e,n)}function We(e,t){if(t=C(t||b),!Ft(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,r=e.length;r>n;n++)f(e[n])(t)}function ze(e,t,n,r){var i=o(e).reverse();_e(i,t,n,r)}function He(e){var t=f(e);return lt(function(e,n){return e.push(function(e,t){if(e)n(null,{error:e});else{var r;r=arguments.length<=2?t:o(arguments,1),n(null,{value:r})}}),t.apply(this,e)})}function Xe(e){var t;return Ft(e)?t=ee(e,He):(t={},Y(e,function(e,n){t[n]=He.call(this,e)})),t}function Ye(e,t,n,r){Ne(e,t,function(e,t){n(e,function(e,n){t(e,!n)})},r)}function $e(e){return function(){return e}}function Qe(e,t,n){function r(e,t){if("object"==typeof t)e.times=+t.times||o,e.intervalFunc="function"==typeof t.interval?t.interval:$e(+t.interval||a),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||o}}function i(){c(function(e){e&&u++<s.times&&("function"!=typeof s.errorFilter||s.errorFilter(e))?setTimeout(i,s.intervalFunc(u)):n.apply(null,arguments)})}var o=5,a=0,s={times:o,intervalFunc:$e(a)};if(arguments.length<3&&"function"==typeof e?(n=t||b,t=e):(r(s,e),n=n||b),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var c=f(t),u=1;i()}function Ke(e,t){Ge(Tr,e,t)}function Ze(e,t,n){function r(e,t){var n=e.criteria,r=t.criteria;return r>n?-1:n>r?1:0}var i=f(t);Nn(e,function(e,t){i(e,function(n,r){return n?t(n):void t(null,{value:e,criteria:r})})},function(e,t){return e?n(e):void n(null,ee(t.sort(r),De("value")))})}function et(e,t,n){var r=f(e);return lt(function(i,o){function a(){var t=e.name||"anonymous",r=new Error('Callback function "'+t+'" timed out.');r.code="ETIMEDOUT",n&&(r.info=n),c=!0,o(r)}var s,c=!1;i.push(function(){c||(o.apply(null,arguments),clearTimeout(s))}),s=setTimeout(a,t),r.apply(null,i)})}function tt(e,t,n,r){for(var i=-1,o=ui(ci((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}function nt(e,t,n,r){var i=f(n);Un(tt(0,e,1),t,i,r)}function rt(e,t,n,r){arguments.length<=3&&(r=n,n=t,t=Ft(e)?[]:{}),r=C(r||b);var i=f(n);jn(e,function(e,n,r){i(t,e,n,r)},function(e){r(e,t)})}function it(e,t){var n,r=null;t=t||b,Ur(e,function(e,t){f(e)(function(e,i){n=arguments.length>2?o(arguments,1):i,r=e,t(!e)})},function(){t(r,n)})}function ot(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function at(e,t,n){n=U(n||b);var r=f(t);if(!e())return n(null);var i=function(t){if(t)return n(t);if(e())return r(i);var a=o(arguments,1);n.apply(null,[null].concat(a))};r(i)}function st(e,t,n){at(function(){return!e.apply(this,arguments)},t,n)}var ct,ut=function(e){var t=o(arguments,1);return function(){var n=o(arguments);return e.apply(null,t.concat(n))}},lt=function(e){return function(){var t=o(arguments),n=t.pop();e.call(this,t,n)}},dt="function"==typeof i&&i,pt="object"==typeof e&&"function"==typeof e.nextTick;ct=dt?i:pt?e.nextTick:s;var ft=c(ct),ht="function"==typeof Symbol,mt="object"==typeof r&&r&&r.Object===Object&&r,vt="object"==typeof self&&self&&self.Object===Object&&self,gt=mt||vt||Function("return this")(),yt=gt.Symbol,_t=Object.prototype,St=_t.hasOwnProperty,bt=_t.toString,Ct=yt?yt.toStringTag:void 0,wt=Object.prototype,Et=wt.toString,Rt="[object Null]",Pt="[object Undefined]",xt=yt?yt.toStringTag:void 0,Tt="[object AsyncFunction]",Lt="[object Function]",Ot="[object GeneratorFunction]",It="[object Proxy]",Mt=9007199254740991,At={},Dt="function"==typeof Symbol&&Symbol.iterator,kt=function(e){return Dt&&e[Dt]&&e[Dt]()},jt="[object Arguments]",Nt=Object.prototype,Vt=Nt.hasOwnProperty,Ut=Nt.propertyIsEnumerable,Bt=R(function(){return arguments}())?R:function(e){return E(e)&&Vt.call(e,"callee")&&!Ut.call(e,"callee")},Ft=Array.isArray,Gt="object"==typeof n&&n&&!n.nodeType&&n,qt=Gt&&"object"==typeof t&&t&&!t.nodeType&&t,Jt=qt&&qt.exports===Gt,Wt=Jt?gt.Buffer:void 0,zt=Wt?Wt.isBuffer:void 0,Ht=zt||P,Xt=9007199254740991,Yt=/^(?:0|[1-9]\d*)$/,$t="[object Arguments]",Qt="[object Array]",Kt="[object Boolean]",Zt="[object Date]",en="[object Error]",tn="[object Function]",nn="[object Map]",rn="[object Number]",on="[object Object]",an="[object RegExp]",sn="[object Set]",cn="[object String]",un="[object WeakMap]",ln="[object ArrayBuffer]",dn="[object DataView]",pn="[object Float32Array]",fn="[object Float64Array]",hn="[object Int8Array]",mn="[object Int16Array]",vn="[object Int32Array]",gn="[object Uint8Array]",yn="[object Uint8ClampedArray]",_n="[object Uint16Array]",Sn="[object Uint32Array]",bn={};bn[pn]=bn[fn]=bn[hn]=bn[mn]=bn[vn]=bn[gn]=bn[yn]=bn[_n]=bn[Sn]=!0,bn[$t]=bn[Qt]=bn[ln]=bn[Kt]=bn[dn]=bn[Zt]=bn[en]=bn[tn]=bn[nn]=bn[rn]=bn[on]=bn[an]=bn[sn]=bn[cn]=bn[un]=!1;var Cn="object"==typeof n&&n&&!n.nodeType&&n,wn=Cn&&"object"==typeof t&&t&&!t.nodeType&&t,En=wn&&wn.exports===Cn,Rn=En&&mt.process,Pn=function(){try{var e=wn&&wn.require&&wn.require("util").types;return e?e:Rn&&Rn.binding&&Rn.binding("util")}catch(t){}}(),xn=Pn&&Pn.isTypedArray,Tn=xn?L(xn):T,Ln=Object.prototype,On=Ln.hasOwnProperty,In=Object.prototype,Mn=M(Object.keys,Object),An=Object.prototype,Dn=An.hasOwnProperty,kn=G(F,1/0),jn=function(e,t,n){var r=S(e)?q:kn;r(e,f(t),n)},Nn=J(W),Vn=h(Nn),Un=z(W),Bn=G(Un,1),Fn=h(Bn),Gn=X(),qn=function(e,t,n){function r(e,t){y.push(function(){c(e,t)})}function i(){if(0===y.length&&0===m)return n(null,h);for(;y.length&&t>m;){var e=y.shift();e()}}function a(e,t){var n=g[e];n||(n=g[e]=[]),n.push(t)}function s(e){var t=g[e]||[];H(t,function(e){e()}),i()}function c(e,t){if(!v){var r=U(function(t,r){if(m--,arguments.length>2&&(r=o(arguments,1)),t){var i={};Y(h,function(e,t){i[t]=e}),i[e]=r,v=!0,g=Object.create(null),n(t,i)}else h[e]=r,s(e)});m++;var i=f(t[t.length-1]);t.length>1?i(h,r):i(r)}}function u(){for(var e,t=0;_.length;)e=_.pop(),t++,H(l(e),function(e){0===--S[e]&&_.push(e)});if(t!==p)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function l(t){var n=[];return Y(e,function(e,r){Ft(e)&&Z(e,t,0)>=0&&n.push(r)}),n}"function"==typeof t&&(n=t,t=null),n=C(n||b);var d=D(e),p=d.length;if(!p)return n(null);t||(t=p);var h={},m=0,v=!1,g=Object.create(null),y=[],_=[],S={};Y(e,function(t,n){if(!Ft(t))return r(n,[t]),void _.push(n);var i=t.slice(0,t.length-1),o=i.length;return 0===o?(r(n,t),void _.push(n)):(S[n]=o,void H(i,function(s){if(!e[s])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+s+"` in "+i.join(", "));a(s,function(){o--,0===o&&r(n,t)})}))}),u(),i()},Jn="[object Symbol]",Wn=1/0,zn=yt?yt.prototype:void 0,Hn=zn?zn.toString:void 0,Xn="\\ud800-\\udfff",Yn="\\u0300-\\u036f",$n="\\ufe20-\\ufe2f",Qn="\\u20d0-\\u20ff",Kn=Yn+$n+Qn,Zn="\\ufe0e\\ufe0f",er="\\u200d",tr=RegExp("["+er+Xn+Kn+Zn+"]"),nr="\\ud800-\\udfff",rr="\\u0300-\\u036f",ir="\\ufe20-\\ufe2f",or="\\u20d0-\\u20ff",ar=rr+ir+or,sr="\\ufe0e\\ufe0f",cr="["+nr+"]",ur="["+ar+"]",lr="\\ud83c[\\udffb-\\udfff]",dr="(?:"+ur+"|"+lr+")",pr="[^"+nr+"]",fr="(?:\\ud83c[\\udde6-\\uddff]){2}",hr="[\\ud800-\\udbff][\\udc00-\\udfff]",mr="\\u200d",vr=dr+"?",gr="["+sr+"]?",yr="(?:"+mr+"(?:"+[pr,fr,hr].join("|")+")"+gr+vr+")*",_r=gr+vr+yr,Sr="(?:"+[pr+ur+"?",ur,fr,hr,cr].join("|")+")",br=RegExp(lr+"(?="+lr+")|"+Sr+_r,"g"),Cr=/^\s+|\s+$/g,wr=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Er=/,/,Rr=/(=.+)?(\s*)$/,Pr=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;me.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},me.prototype.empty=function(){for(;this.head;)this.shift();return this},me.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},me.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},me.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):ve(this,e)},me.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):ve(this,e)},me.prototype.shift=function(){return this.head&&this.removeLink(this.head)},me.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},me.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,n=0;n<this.length;n++)e[n]=t.data,t=t.next;return e},me.prototype.remove=function(e){for(var t=this.head;t;){var n=t.next;e(t)&&this.removeLink(t),t=n}return this};var xr,Tr=G(F,1),Lr=function(){return Se.apply(null,o(arguments).reverse())},Or=Array.prototype.concat,Ir=function(e,t,n,r){r=r||b;var i=f(n);Un(e,t,function(e,t){i(e,function(e){return e?t(e):t(null,o(arguments,1))})},function(e,t){for(var n=[],i=0;i<t.length;i++)t[i]&&(n=Or.apply(n,t[i]));return r(e,n)})},Mr=G(Ir,1/0),Ar=G(Ir,1),Dr=function(){var e=o(arguments),t=[null].concat(e);return function(){var e=arguments[arguments.length-1];return e.apply(this,t)}},kr=J(Ce(be,we)),jr=z(Ce(be,we)),Nr=G(jr,1),Vr=Ee("dir"),Ur=G(Ie,1),Br=J(Ce(Ae,Ae)),Fr=z(Ce(Ae,Ae)),Gr=G(Fr,1),qr=J(Ne),Jr=z(Ne),Wr=G(Jr,1),zr=function(e,t,n,r){r=r||b;var i=f(n);Un(e,t,function(e,t){i(e,function(n,r){return n?t(n):t(null,{key:r,val:e})})},function(e,t){for(var n={},i=Object.prototype.hasOwnProperty,o=0;o<t.length;o++)if(t[o]){var a=t[o].key,s=t[o].val;i.call(n,a)?n[a].push(s):n[a]=[s]}return r(e,n)})},Hr=G(zr,1/0),Xr=G(zr,1),Yr=Ee("log"),$r=G(Ue,1/0),Qr=G(Ue,1);xr=pt?e.nextTick:dt?i:s;var Kr=c(xr),Zr=function(e,t){var n=f(e);return ge(function(e,t){n(e[0],t)},t,1)},ei=function(e,t){var n=Zr(e,t);return n.push=function(e,t,r){if(null==r&&(r=b),"function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,Ft(e)||(e=[e]),0===e.length)return ft(function(){n.drain()});t=t||0;for(var i=n._tasks.head;i&&t>=i.priority;)i=i.next;for(var o=0,a=e.length;a>o;o++){var s={data:e[o],priority:t,callback:r};i?n._tasks.insertBefore(i,s):n._tasks.push(s)}ft(n.process)},delete n.unshift,n},ti=J(Ye),ni=z(Ye),ri=G(ni,1),ii=function(e,t){t||(t=e,e=null);var n=f(t);return lt(function(t,r){function i(e){n.apply(null,t.concat(e))}e?Qe(e,i,r):Qe(i,r)})},oi=J(Ce(Boolean,be)),ai=z(Ce(Boolean,be)),si=G(ai,1),ci=Math.ceil,ui=Math.max,li=G(nt,1/0),di=G(nt,1),pi=function(e,t){function n(t){var n=f(e[i++]);t.push(U(r)),n.apply(null,t)}function r(r){return r||i===e.length?t.apply(null,arguments):void n(o(arguments,1))}if(t=C(t||b),!Ft(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var i=0;n([])},fi={apply:ut,applyEach:Vn,applyEachSeries:Fn,asyncify:u,auto:qn,autoInject:he,cargo:ye,compose:Lr,concat:Mr,concatLimit:Ir,concatSeries:Ar,constant:Dr,detect:kr,detectLimit:jr,detectSeries:Nr,dir:Vr,doDuring:Re,doUntil:xe,doWhilst:Pe,during:Te,each:Oe,eachLimit:Ie,eachOf:jn,eachOfLimit:F,eachOfSeries:Tr,eachSeries:Ur,ensureAsync:Me,every:Br,everyLimit:Fr,everySeries:Gr,filter:qr,filterLimit:Jr,filterSeries:Wr,forever:Ve,groupBy:Hr,groupByLimit:zr,groupBySeries:Xr,log:Yr,map:Nn,mapLimit:Un,mapSeries:Bn,mapValues:$r,mapValuesLimit:Ue,mapValuesSeries:Qr,memoize:Fe,nextTick:Kr,parallel:qe,parallelLimit:Je,priorityQueue:ei,queue:Zr,race:We,reduce:_e,reduceRight:ze,reflect:He,reflectAll:Xe,reject:ti,rejectLimit:ni,rejectSeries:ri,retry:Qe,retryable:ii,seq:Se,series:Ke,setImmediate:ft,some:oi,someLimit:ai,someSeries:si,sortBy:Ze,timeout:et,times:li,timesLimit:nt,timesSeries:di,transform:rt,tryEach:it,unmemoize:ot,until:st,waterfall:pi,whilst:at,all:Br,allLimit:Fr,allSeries:Gr,any:oi,anyLimit:ai,anySeries:si,find:kr,findLimit:jr,findSeries:Nr,forEach:Oe,forEachSeries:Ur,forEachLimit:Ie,forEachOf:jn,forEachOfSeries:Tr,forEachOfLimit:F,inject:_e,foldl:_e,foldr:ze,select:qr,selectLimit:Jr,selectSeries:Wr,wrapSync:u};n["default"]=fi,n.apply=ut,n.applyEach=Vn,n.applyEachSeries=Fn,n.asyncify=u,n.auto=qn,n.autoInject=he,n.cargo=ye,n.compose=Lr,n.concat=Mr,n.concatLimit=Ir,n.concatSeries=Ar,n.constant=Dr,n.detect=kr,n.detectLimit=jr,n.detectSeries=Nr,n.dir=Vr,n.doDuring=Re,n.doUntil=xe,n.doWhilst=Pe,n.during=Te,n.each=Oe,n.eachLimit=Ie,n.eachOf=jn,n.eachOfLimit=F,n.eachOfSeries=Tr,n.eachSeries=Ur,n.ensureAsync=Me,n.every=Br,n.everyLimit=Fr,n.everySeries=Gr,n.filter=qr,n.filterLimit=Jr,n.filterSeries=Wr,n.forever=Ve,n.groupBy=Hr,n.groupByLimit=zr,n.groupBySeries=Xr,n.log=Yr,n.map=Nn,n.mapLimit=Un,n.mapSeries=Bn,n.mapValues=$r,n.mapValuesLimit=Ue,n.mapValuesSeries=Qr,n.memoize=Fe,n.nextTick=Kr,n.parallel=qe,n.parallelLimit=Je,n.priorityQueue=ei,n.queue=Zr,n.race=We,n.reduce=_e,n.reduceRight=ze,n.reflect=He,n.reflectAll=Xe,n.reject=ti,n.rejectLimit=ni,n.rejectSeries=ri,n.retry=Qe,n.retryable=ii,n.seq=Se,n.series=Ke,n.setImmediate=ft,n.some=oi,n.someLimit=ai,n.someSeries=si,n.sortBy=Ze,n.timeout=et,n.times=li,n.timesLimit=nt,n.timesSeries=di,n.transform=rt,n.tryEach=it,n.unmemoize=ot,n.until=st,n.waterfall=pi,n.whilst=at,n.all=Br,n.allLimit=Fr,n.allSeries=Gr,n.any=oi,n.anyLimit=ai,n.anySeries=si,n.find=kr,n.findLimit=jr,n.findSeries=Nr,n.forEach=Oe,n.forEachSeries=Ur,n.forEachLimit=Ie,n.forEachOf=jn,n.forEachOfSeries=Tr,n.forEachOfLimit=F,n.inject=_e,n.foldl=_e,n.foldr=ze,n.select=qr,n.selectLimit=Jr,n.selectSeries=Wr,n.wrapSync=u,Object.defineProperty(n,"__esModule",{value:!0})})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:8,timers:303}],52:[function(e,t,n){function r(e){c.call(this);var t=this;this.sid=e.sid||o.v4(),this.peer=e.peer,this.peerID=e.peerID||this.peer.full||this.peer,this.isInitiator=e.initiator||!1,this.parent=e.parent,this.state="starting",this.connectionState="starting",this.pendingApplicationTypes=e.applicationTypes||[],this.pendingAction=!1,this.processingQueue=a.queue(function(e,n){if(t.ended)return n();var r=e.action,i=e.changes,o=e.cb;return t._log("debug",r),u[r]?void t[u[r]](i,function(e,t){return o(e,t),n()}):(t._log("error","Invalid action: "+r),o({condition:"bad-request"}),n())})}var i=e("util"),o=e("uuid"),a=e("async"),s=e("extend-object"),c=e("wildemitter"),u={"content-accept":"onContentAccept","content-add":"onContentAdd","content-modify":"onContentModify","content-reject":"onContentReject","content-remove":"onContentRemove","description-info":"onDescriptionInfo","security-info":"onSecurityInfo","session-accept":"onSessionAccept","session-info":"onSessionInfo","session-initiate":"onSessionInitiate","session-terminate":"onSessionTerminate","transport-accept":"onTransportAccept","transport-info":"onTransportInfo","transport-reject":"onTransportReject","transport-replace":"onTransportReplace","source-add":"onSourceAdd","source-remove":"onSourceRemove"};i.inherits(r,c),Object.keys(u).forEach(function(e){var t=u[e];r.prototype[t]=function(t,n){this._log("error","Unsupported action: "+e),n()}}),Object.defineProperties(r.prototype,{state:{get:function(){return this._sessionState},set:function(e){if(e!==this._sessionState){var t=this._sessionState;this._log("info","Changing session state to: "+e),this._sessionState=e,this.emit("change:sessionState",this,e),this.emit("change:"+e,this,!0),t&&this.emit("change:"+t,this,!1)}}},connectionState:{get:function(){return this._connectionState},set:function(e){if(e!==this._connectionState){var t=this._connectionState;this._log("info","Changing connection state to: "+e),this._connectionState=e,this.emit("change:connectionState",this,e),this.emit("change:"+e,this,!0),t&&this.emit("change:"+t,this,!1)}}},starting:{get:function(){return"starting"===this._sessionState}},pending:{get:function(){return"pending"===this._sessionState}},active:{get:function(){return"active"===this._sessionState}},ended:{get:function(){return"ended"===this._sessionState}},connected:{get:function(){return"connected"===this._connectionState}},connecting:{get:function(){return"connecting"===this._connectionState}},disconnected:{get:function(){return"disconnected"===this._connectionState}},interrupted:{get:function(){return"interrupted"===this._connectionState}}}),r.prototype=s(r.prototype,{_log:function(e,t){t=this.sid+": "+t,this.emit("log:"+e,t)},send:function(e,t){t=t||{},t.sid=this.sid,t.action=e;var n={"session-inititate":!0,"session-accept":!0,"content-add":!0,"content-remove":!0,"content-reject":!0,"content-accept":!0,"content-modify":!0,"transport-replace":!0,"transport-reject":!0,"transport-accept":!0,"source-add":!0,"source-remove":!0};this.pendingAction=n[e]?e:!1,this.emit("send",{to:this.peer,id:o.v4(),type:"set",jingle:t})},process:function(e,t,n){this.processingQueue.push({action:e,changes:t,cb:n})},start:function(){this._log("error","Can not start base sessions"),this.end("unsupported-applications",!0)},accept:function(){this._log("error","Can not accept base sessions"),this.end("unsupported-applications")},cancel:function(){this.end("cancel")},decline:function(){this.end("decline")},end:function(e,t){this.state="ended",this.processingQueue.kill(),e||(e="success"),"string"==typeof e&&(e={condition:e}),t||this.send("session-terminate",{reason:e}),this.emit("terminated",this,e)},onSessionTerminate:function(e,t){this.end(e.reason,!0),t()},onSessionInfo:function(e,t){var n={sid:!0,action:!0,initiator:!0,responder:!0},r=!1;Object.keys(e).forEach(function(e){n[e]||(r=!0)}),r?t({type:"modify",condition:"feature-not-implemented",jingleCondition:"unsupported-info"}):t()},onDescriptionInfo:function(e,t){t({type:"modify",condition:"feature-not-implemented",jingleCondition:"unsupported-info"})},onTransportInfo:function(e,t){t({type:"modify",condition:"feature-not-implemented",jingleCondition:"unsupported-info"})},onContentAdd:function(e,t){t(),this.send("content-reject",{reason:{condition:"failed-application",text:"content-add is not supported"}})},onTransportReplace:function(e,t){t(),this.send("transport-reject",{reason:{condition:"failed-application",text:"transport-replace is not supported"}})}}),t.exports=r},{async:51,"extend-object":33,util:309,uuid:310,wildemitter:64}],53:[function(e,t,n){function r(e,t){var n,r=this;a.call(this),e=e||{},e.iceServers=e.iceServers||[];var i=s.browserDetails.browser;this.enableChromeNativeSimulcast=!1,t&&t.optional&&"chrome"===i&&null===navigator.appVersion.match(/Chromium\//)&&t.optional.forEach(function(e){e.enableChromeNativeSimulcast&&(r.enableChromeNativeSimulcast=!0)}),this.enableMultiStreamHacks=!1,t&&t.optional&&"chrome"===i&&t.optional.forEach(function(e){e.enableMultiStreamHacks&&(r.enableMultiStreamHacks=!0)}),this.restrictBandwidth=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetRestrictBandwidth&&(r.restrictBandwidth=e.andyetRestrictBandwidth)}),this.batchIceCandidates=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetBatchIce&&(r.batchIceCandidates=e.andyetBatchIce)}),this.batchedIceCandidates=[],t&&t.optional&&"chrome"===i&&t.optional.forEach(function(e){e.andyetFasterICE&&(r.eliminateDuplicateCandidates=e.andyetFasterICE)}),t&&t.optional&&t.optional.forEach(function(e){e.andyetDontSignalCandidates&&(r.dontSignalCandidates=e.andyetDontSignalCandidates)}),this.assumeSetLocalSuccess=!1,t&&t.optional&&t.optional.forEach(function(e){e.andyetAssumeSetLocalSuccess&&(r.assumeSetLocalSuccess=e.andyetAssumeSetLocalSuccess)}),"firefox"===i&&t&&t.optional&&(this.wtFirefox=0,t.optional.forEach(function(e){e.andyetFirefoxMakesMeSad&&(r.wtFirefox=e.andyetFirefoxMakesMeSad,r.wtFirefox>0&&(r.firefoxcandidatebuffer=[]))})),this.pc=new RTCPeerConnection(e,t),this.getLocalStreams=this.pc.getLocalStreams.bind(this.pc),this.getRemoteStreams=this.pc.getRemoteStreams.bind(this.pc),this.addStream=this.pc.addStream.bind(this.pc),this.removeStream=function(e){"function"==typeof r.pc.removeStream?r.pc.removeStream.apply(r.pc,arguments):"function"==typeof r.pc.removeTrack&&e.getTracks().forEach(function(e){r.pc.removeTrack(e)})},"function"==typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc)),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onremovetrack=this.emit.bind(this,"removeTrack"),this.pc.onaddstream=this.emit.bind(this,"addStream"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.localDescription={contents:[]},this.remoteDescription={contents:[]},this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1},this.iceCredentials={local:{},remote:{}};for(n in e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){var t=e.logger||console;t.log("PeerConnection event:",arguments)}),this.hadLocalStunCandidate=!1,this.hadRemoteStunCandidate=!1,this.hadLocalRelayCandidate=!1,this.hadRemoteRelayCandidate=!1,this.hadLocalIPv6Candidate=!1,this.hadRemoteIPv6Candidate=!1,this._remoteDataChannels=[],this._localDataChannels=[],this._candidateBuffer=[]}var i=e("util"),o=e("sdp-jingle-json"),a=e("wildemitter"),s=e("webrtc-adapter"),c=e("lodash.clonedeep");i.inherits(r,a),Object.defineProperty(r.prototype,"signalingState",{get:function(){return this.pc.signalingState}}),Object.defineProperty(r.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}}),r.prototype._role=function(){return this.isInitiator?"initiator":"responder"},r.prototype.addStream=function(e){this.localStream=e,this.pc.addStream(e)},r.prototype._checkLocalCandidate=function(e){var t=o.toCandidateJSON(e);"srflx"==t.type?this.hadLocalStunCandidate=!0:"relay"==t.type&&(this.hadLocalRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)},r.prototype._checkRemoteCandidate=function(e){var t=o.toCandidateJSON(e);"srflx"==t.type?this.hadRemoteStunCandidate=!0:"relay"==t.type&&(this.hadRemoteRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)},r.prototype.processIce=function(e,t){t=t||function(){};var n=this;if("closed"===this.pc.signalingState)return t();if(e.contents||e.jingle&&e.jingle.contents){var r=this.remoteDescription.contents.map(function(e){return e.name}),i=e.contents||e.jingle.contents;i.forEach(function(e){var i=e.transport||{},a=i.candidates||[],s=r.indexOf(e.name),c=e.name,u=n.remoteDescription.contents.find(function(t){return t.name===e.name}),l=function(){a.forEach(function(e){var t=o.toCandidateSDP(e)+"\r\n";n.pc.addIceCandidate(new RTCIceCandidate({candidate:t,sdpMLineIndex:s,sdpMid:c}),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(t)}),t()};if(n.iceCredentials.remote[e.name]&&i.ufrag&&n.iceCredentials.remote[e.name].ufrag!==i.ufrag)if(u){
u.transport.ufrag=i.ufrag,u.transport.pwd=i.pwd;var d={type:"offer",jingle:n.remoteDescription};d.sdp=o.toSessionSDP(d.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.pc.setRemoteDescription(new RTCSessionDescription(d),function(){l()},function(e){n.emit("error",e)})}else n.emit("error","ice restart failed to find matching content");else l()})}else{if(e.candidate&&0!==e.candidate.candidate.indexOf("a=")&&(e.candidate.candidate="a="+e.candidate.candidate),this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(e.candidate),t();n.pc.addIceCandidate(new RTCIceCandidate(e.candidate),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate.candidate),t()}},r.prototype.offer=function(e,t){var n=this,r=2===arguments.length,i=r&&e?e:{offerToReceiveAudio:1,offerToReceiveVideo:1};return t=r?t:e,t=t||function(){},"closed"===this.pc.signalingState?t("Already closed"):void this.pc.createOffer(function(e){var r={type:"offer",sdp:e.sdp};n.assumeSetLocalSuccess&&(n.emit("offer",r),t(null,r)),n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){var i;n.config.useJingle&&(i=o.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),i.sid=n.config.sid,n.localDescription=i,i.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),r.jingle=i),r.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("offer",r),t(null,r))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},i)},r.prototype.handleOffer=function(e,t){t=t||function(){};var n=this;if(e.type="offer",e.jingle){if(this.enableChromeNativeSimulcast&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.application.googConferenceFlag=!0)}),this.enableMultiStreamHacks&&e.jingle.contents.forEach(function(e){if("video"===e.name){var t=e.application.sources||[];(0===t.length||"3735928559"!==t[0].ssrc)&&(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),e.application.sources=t)}}),n.restrictBandwidth>0&&e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name){var r=e.jingle.contents[1],i=r.application&&r.application.bandwidth&&r.application.bandwidth.bandwidth;i||(e.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:n.restrictBandwidth.toString()},e.sdp=o.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}))}e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),e.sdp=o.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle}e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){t()},t)},r.prototype.answerAudioOnly=function(e){var t={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}};this._answer(t,e)},r.prototype.answerBroadcastOnly=function(e){var t={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};this._answer(t,e)},r.prototype.answer=function(e,t){var n=2===arguments.length,r=n?t:e,i=n&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};this._answer(i,r)},r.prototype.handleAnswer=function(e,t){t=t||function(){};var n=this;e.jingle&&(e.sdp=o.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle,e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})})),e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){n.wtFirefox&&window.setTimeout(function(){n.firefoxcandidatebuffer.forEach(function(e){n.pc.addIceCandidate(new RTCIceCandidate(e),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate)}),n.firefoxcandidatebuffer=null},n.wtFirefox),t(null)},t)},r.prototype.close=function(){this.pc.close(),this._localDataChannels=[],this._remoteDataChannels=[],this.emit("close")},r.prototype._answer=function(e,t){t=t||function(){};var n=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");return"closed"===this.pc.signalingState?t("Already closed"):void n.pc.createAnswer(function(e){var r=[];if(n.enableChromeNativeSimulcast&&(e.jingle=o.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name)){var i=e.jingle.contents[1].application.sourceGroups||[],a=!1;if(i.forEach(function(e){"SIM"==e.semantics&&(a=!0)}),!a&&e.jingle.contents[1].application.sources.length){var s=JSON.parse(JSON.stringify(e.jingle.contents[1].application.sources[0]));s.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(s),r.push(e.jingle.contents[1].application.sources[0].ssrc),r.push(s.ssrc),i.push({semantics:"SIM",sources:r});var u=JSON.parse(JSON.stringify(s));u.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(u),i.push({semantics:"FID",sources:[s.ssrc,u.ssrc]}),e.jingle.contents[1].application.sourceGroups=i,e.sdp=o.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"})}}var l={type:"answer",sdp:e.sdp};if(n.assumeSetLocalSuccess){var d=c(l);n.emit("answer",d),t(null,d)}n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){if(n.config.useJingle){var r=o.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});r.sid=n.config.sid,n.localDescription=r,l.jingle=r}if(n.enableChromeNativeSimulcast&&(l.jingle||(l.jingle=o.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})),l.jingle.contents[1].application.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),l.sdp=o.toSessionSDP(l.jingle,{sid:n.sdpSessionID,role:n._role(),direction:"outgoing"})),l.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),!n.assumeSetLocalSuccess){var i=c(l);n.emit("answer",i),t(null,i)}},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},e)},r.prototype._onIce=function(e){var t=this;if(e.candidate){if(this.dontSignalCandidates)return;var n=e.candidate,r={candidate:{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex}};this._checkLocalCandidate(n.candidate);var i,a,s=o.toCandidateJSON(n.candidate);if(this.eliminateDuplicateCandidates&&"relay"===s.type&&(i=this._candidateBuffer.filter(function(e){return"relay"===e.type}).map(function(e){return e.foundation+":"+e.component}),a=i.indexOf(s.foundation+":"+s.component),a>-1&&s.priority>>24>=i[a].priority>>24))return;if("max-bundle"===this.config.bundlePolicy&&(i=this._candidateBuffer.filter(function(e){return s.type===e.type}).map(function(e){return e.address+":"+e.port}),a=i.indexOf(s.address+":"+s.port),a>-1))return;if("require"===this.config.rtcpMuxPolicy&&"2"===s.component)return;if(this._candidateBuffer.push(s),t.config.useJingle){if(n.sdpMid||(n.sdpMid=t.pc.remoteDescription&&"offer"===t.pc.remoteDescription.type?t.remoteDescription.contents[n.sdpMLineIndex].name:t.localDescription.contents[n.sdpMLineIndex].name),!t.iceCredentials.local[n.sdpMid]){var c=o.toSessionJSON(t.pc.localDescription.sdp,{role:t._role(),direction:"outgoing"});c.contents.forEach(function(e){var n=e.transport||{};n.ufrag&&(t.iceCredentials.local[e.name]={ufrag:n.ufrag,pwd:n.pwd})})}if(r.jingle={contents:[{name:n.sdpMid,creator:t._role(),transport:{transportType:"iceUdp",ufrag:t.iceCredentials.local[n.sdpMid].ufrag,pwd:t.iceCredentials.local[n.sdpMid].pwd,candidates:[s]}}]},t.batchIceCandidates>0)return 0===t.batchedIceCandidates.length&&window.setTimeout(function(){var e={};t.batchedIceCandidates.forEach(function(t){t=t.contents[0],e[t.name]||(e[t.name]=t),e[t.name].transport.candidates.push(t.transport.candidates[0])});var n={jingle:{contents:[]}};Object.keys(e).forEach(function(t){n.jingle.contents.push(e[t])}),t.batchedIceCandidates=[],t.emit("ice",n)},t.batchIceCandidates),void t.batchedIceCandidates.push(r.jingle)}this.emit("ice",r)}else this.emit("endOfCandidates")},r.prototype._onDataChannel=function(e){var t=e.channel;this._remoteDataChannels.push(t),this.emit("addChannel",t)},r.prototype.createDataChannel=function(e,t){var n=this.pc.createDataChannel(e,t);return this._localDataChannels.push(n),n},r.prototype.getStats=function(){if("function"!=typeof arguments[0])return this.pc.getStats.apply(this.pc,arguments);var e=arguments[0];this.pc.getStats().then(function(t){e(null,t)},function(t){e(t)})},t.exports=r},{"lodash.clonedeep":164,"sdp-jingle-json":225,util:309,"webrtc-adapter":54,wildemitter:64}],54:[function(e,t,n){"use strict";!function(){var n=e("./utils"),r=n.log,i=n.browserDetails;t.exports.browserDetails=i,t.exports.extractVersion=n.extractVersion,t.exports.disableLog=n.disableLog;var o=e("./chrome/chrome_shim")||null,a=e("./edge/edge_shim")||null,s=e("./firefox/firefox_shim")||null,c=e("./safari/safari_shim")||null;switch(i.browser){case"chrome":if(!o||!o.shimPeerConnection)return void r("Chrome shim is not included in this adapter release.");r("adapter.js shimming chrome."),t.exports.browserShim=o,o.shimGetUserMedia(),o.shimMediaStream(),n.shimCreateObjectURL(),o.shimSourceObject(),o.shimPeerConnection(),o.shimOnTrack(),o.shimGetSendersWithDtmf();break;case"firefox":if(!s||!s.shimPeerConnection)return void r("Firefox shim is not included in this adapter release.");r("adapter.js shimming firefox."),t.exports.browserShim=s,s.shimGetUserMedia(),n.shimCreateObjectURL(),s.shimSourceObject(),s.shimPeerConnection(),s.shimOnTrack();break;case"edge":if(!a||!a.shimPeerConnection)return void r("MS edge shim is not included in this adapter release.");r("adapter.js shimming edge."),t.exports.browserShim=a,a.shimGetUserMedia(),n.shimCreateObjectURL(),a.shimPeerConnection(),a.shimReplaceTrack();break;case"safari":if(!c)return void r("Safari shim is not included in this adapter release.");r("adapter.js shimming safari."),t.exports.browserShim=c,c.shimCallbacksAPI(),c.shimAddStream(),c.shimOnAddStream(),c.shimGetUserMedia();break;default:r("Unsupported browser!")}}()},{"./chrome/chrome_shim":55,"./edge/edge_shim":57,"./firefox/firefox_shim":60,"./safari/safari_shim":62,"./utils":63}],55:[function(e,t,n){"use strict";var r=e("../utils.js").log,i=e("../utils.js").browserDetails,o={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){var t=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",function(n){var r;r=RTCPeerConnection.prototype.getReceivers?t.getReceivers().find(function(e){return e.track.id===n.track.id}):{track:n.track};var i=new Event("track");i.track=n.track,i.receiver=r,i.streams=[e.stream],t.dispatchEvent(i)}),e.stream.getTracks().forEach(function(n){var r;r=RTCPeerConnection.prototype.getReceivers?t.getReceivers().find(function(e){return e.track.id===n.id}):{track:n};var i=new Event("track");i.track=n,i.receiver=r,i.streams=[e.stream],this.dispatchEvent(i)}.bind(this))}.bind(this))}})},shimGetSendersWithDtmf:function(){if("object"==typeof window&&window.RTCPeerConnection&&!("getSenders"in RTCPeerConnection.prototype)&&"createDTMFSender"in RTCPeerConnection.prototype){RTCPeerConnection.prototype.getSenders=function(){return this._senders||[]};var e=RTCPeerConnection.prototype.addStream,t=RTCPeerConnection.prototype.removeStream;RTCPeerConnection.prototype.addTrack||(RTCPeerConnection.prototype.addTrack=function(e,t){var n=this;if("closed"===n.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(function(t){return t===e}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");n._senders=n._senders||[];var i=n._senders.find(function(t){return t.track===e});if(i)throw new DOMException("Track already exists.","InvalidAccessError");n._streams=n._streams||{};var o=n._streams[t.id];if(o)o.addTrack(e),n.removeStream(o),n.addStream(o);else{var a=new MediaStream([e]);n._streams[t.id]=a,n.addStream(a)}var s={track:e,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===e.kind?n.createDTMFSender(e):null),this._dtmf}};return n._senders.push(s),s}),RTCPeerConnection.prototype.addStream=function(t){var n=this;n._senders=n._senders||[],e.apply(n,[t]),t.getTracks().forEach(function(e){n._senders.push({track:e,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===e.kind?n.createDTMFSender(e):null),this._dtmf}})})},RTCPeerConnection.prototype.removeStream=function(e){var n=this;n._senders=n._senders||[],t.apply(n,[e]),e.getTracks().forEach(function(e){var t=n._senders.find(function(t){return t.track===e});t&&n._senders.splice(n._senders.indexOf(t),1)})}}},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;return this._srcObject=e,this.src&&URL.revokeObjectURL(this.src),e?(this.src=URL.createObjectURL(e),e.addEventListener("addtrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)}),void e.addEventListener("removetrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)})):void(this.src="")}}))},shimPeerConnection:function(){if(window.RTCPeerConnection){var e=RTCPeerConnection;window.RTCPeerConnection=function(t,n){if(t&&t.iceServers){for(var r=[],i=0;i<t.iceServers.length;i++){var o=t.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(console.warn("RTCIceServer.url is deprecated! Use urls instead."),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,r.push(o)):r.push(t.iceServers[i])}t.iceServers=r}return new e(t,n)},window.RTCPeerConnection.prototype=e.prototype,Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return e.generateCertificate}})}else window.RTCPeerConnection=function(e,t){return r("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy),new webkitRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}});var t=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,n,r){var i=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof arguments[0]))return t.apply(this,[]);var a=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){var c=function(e){o[1](s(a(e)))};return t.apply(this,[c,arguments[0]])}return new Promise(function(e,n){t.apply(i,[function(t){e(s(a(t)))},n])}).then(n,r)},i.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){var e=arguments,n=this,r=new Promise(function(r,i){t.apply(n,[e[0],r,i])});return e.length<2?r:r.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),i.version<52&&["createOffer","createAnswer"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(r,i){t.apply(e,[r,i,n])})}return t.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var n=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};t.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimGetSendersWithDtmf:o.shimGetSendersWithDtmf,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils.js":63,"./getusermedia":56}],56:[function(e,t,n){"use strict";var r=e("../utils.js").log,i=e("../utils.js").browserDetails;t.exports=function(){var e=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),o={},o[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},t=function(t,n){if(t=JSON.parse(JSON.stringify(t)),t&&t.audio&&(t.audio=e(t.audio)),t&&"object"==typeof t.video){var o=t.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});var a=i.version<61;if(!(!o||"user"!==o.exact&&"environment"!==o.exact&&"user"!==o.ideal&&"environment"!==o.ideal||navigator.mediaDevices.getSupportedConstraints&&navigator.mediaDevices.getSupportedConstraints().facingMode&&!a)){delete t.video.facingMode;var s;if("environment"===o.exact||"environment"===o.ideal?s=["back","rear"]:("user"===o.exact||"user"===o.ideal)&&(s=["front"]),s)return navigator.mediaDevices.enumerateDevices().then(function(i){i=i.filter(function(e){return"videoinput"===e.kind});var a=i.find(function(e){return s.some(function(t){return-1!==e.label.toLowerCase().indexOf(t)})});return!a&&i.length&&-1!==s.indexOf("back")&&(a=i[i.length-1]),a&&(t.video.deviceId=o.exact?{exact:a.deviceId}:{ideal:a.deviceId}),t.video=e(t.video),r("chrome: "+JSON.stringify(t)),n(t)})}t.video=e(t.video)}return r("chrome: "+JSON.stringify(t)),n(t)},n=function(e){return{name:{ConstraintNotSatisfiedError:"OverconstrainedError",PermissionDeniedError:"NotAllowedError",TrackStartError:"NotReadableError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},o=function(e,r,i){t(e,function(e){navigator.webkitGetUserMedia(e,r,function(e){i(n(e))})})};navigator.getUserMedia=o;var a=function(e){return new Promise(function(t,n){navigator.getUserMedia(e,t,n)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:a,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),navigator.mediaDevices.getUserMedia){var s=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return t(e,function(e){return s(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(n(e))})})}}else navigator.mediaDevices.getUserMedia=function(e){return a(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){r("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){r("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":63}],57:[function(e,t,n){"use strict";var r=e("../utils").browserDetails,i=e("./rtcpeerconnection_shim");t.exports={shimGetUserMedia:e("./getusermedia"),shimPeerConnection:function(){if(window.RTCIceGatherer&&(window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e}),r.version<15025)){var e=Object.getOwnPropertyDescriptor(MediaStreamTrack.prototype,"enabled");Object.defineProperty(MediaStreamTrack.prototype,"enabled",{set:function(t){e.set.call(this,t);var n=new Event("enabled");n.enabled=t,this.dispatchEvent(n)}})}window.RTCPeerConnection=i(r.version)},shimReplaceTrack:function(){!window.RTCRtpSender||"replaceTrack"in RTCRtpSender.prototype||(RTCRtpSender.prototype.replaceTrack=RTCRtpSender.prototype.setTrack)}}},{"../utils":63,"./getusermedia":58,"./rtcpeerconnection_shim":59}],58:[function(e,t,n){"use strict";t.exports=function(){var e=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}},t=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(n){return t(n)["catch"](function(t){return Promise.reject(e(t))})}}},{}],59:[function(e,t,n){"use strict";function r(e){var t=e.filter(function(e){return"audio"===e.kind}),n=e.filter(function(e){return"video"===e.kind});for(e=[];t.length||n.length;)t.length&&e.push(t.shift()),n.length&&e.push(n.shift());return e}function i(e,t){var n=!1;return e=JSON.parse(JSON.stringify(e)),e.filter(function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter(function(e){var r=0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!n;return r?(n=!0,!0):0===e.indexOf("stun:")&&t>=14393}),delete e.url,e.urls=i?r[0]:r,!!r.length}return!1})}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach(function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;a=JSON.parse(JSON.stringify(a)),a.numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}var s=e("sdp");t.exports=function(e){var t=function(t){var n=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){n[e]=r[e].bind(r)}),this.needNegotiation=!1,this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onicegatheringstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.canTrickleIceCandidates=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return n.localStreams},this.getRemoteStreams=function(){return n.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},t&&t.iceTransportPolicy)switch(t.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=t.iceTransportPolicy}this.usingBundle=t&&"max-bundle"===t.bundlePolicy,t&&t.iceServers&&(this.iceOptions.iceServers=i(t.iceServers,e)),this._config=t||{},this.transceivers=[],this._localIceCandidatesBuffer=[]};return t.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this.dispatchEvent(e),null!==this.onicegatheringstatechange&&this.onicegatheringstatechange(e)},t.prototype._emitBufferedCandidates=function(){var e=this,t=s.splitSections(e.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(n){var r=!n.candidate||0===Object.keys(n.candidate).length;if(r)for(var i=1;i<t.length;i++)-1===t[i].indexOf("\r\na=end-of-candidates\r\n")&&(t[i]+="a=end-of-candidates\r\n");else t[n.candidate.sdpMLineIndex+1]+="a="+n.candidate.candidate+"\r\n";if(e.localDescription.sdp=t.join(""),e.dispatchEvent(n),null!==e.onicecandidate&&e.onicecandidate(n),!n.candidate&&"complete"!==e.iceGatheringState){var o=e.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});o&&"complete"!==e.iceGatheringStateChange&&(e.iceGatheringState="complete",e._emitGatheringStateChange())}}),this._localIceCandidatesBuffer=[]},t.prototype.getConfiguration=function(){return this._config},t.prototype._createTransceiver=function(e){var t=this.transceivers.length>0,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,wantReceive:!0};if(this.usingBundle&&t)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var r=this._createIceAndDtlsTransports();n.iceTransport=r.iceTransport,n.dtlsTransport=r.dtlsTransport}return this.transceivers.push(n),n},t.prototype.addTrack=function(e,t){for(var n,r=0;r<this.transceivers.length;r++)this.transceivers[r].track||this.transceivers[r].kind!==e.kind||(n=this.transceivers[r]);return n||(n=this._createTransceiver(e.kind)),n.track=e,n.stream=t,n.rtpSender=new RTCRtpSender(e,n.dtlsTransport),this._maybeFireNegotiationNeeded(),n.rtpSender},t.prototype.addStream=function(t){var n=this;if(e>=15025)this.localStreams.push(t),t.getTracks().forEach(function(e){n.addTrack(e,t)});else{var r=t.clone();t.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),r.getTracks().forEach(function(e){n.addTrack(e,r)}),this.localStreams.push(r)}this._maybeFireNegotiationNeeded()},t.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);t>-1&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},t.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},t.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},t.prototype._createIceGatherer=function(e,t){var n=this,r=new RTCIceGatherer(n.iceOptions);return r.onlocalcandidate=function(i){var o=new Event("icecandidate");o.candidate={sdpMid:e,sdpMLineIndex:t};var a=i.candidate,c=!a||0===Object.keys(a).length;c?void 0===r.state&&(r.state="completed"):(a.component=1,o.candidate.candidate=s.writeCandidate(a));var u=s.splitSections(n.localDescription.sdp);u[o.candidate.sdpMLineIndex+1]+=c?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",n.localDescription.sdp=u.join("");var l=n._pendingOffer?n._pendingOffer:n.transceivers,d=l.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});switch(n.iceGatheringState){case"new":c||n._localIceCandidatesBuffer.push(o),c&&d&&n._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case"gathering":n._emitBufferedCandidates(),c||(n.dispatchEvent(o),null!==n.onicecandidate&&n.onicecandidate(o)),d&&(n.dispatchEvent(new Event("icecandidate")),null!==n.onicecandidate&&n.onicecandidate(new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange());break;case"complete":}},r},t.prototype._createIceAndDtlsTransports=function(){var e=this,t=new RTCIceTransport(null);t.onicestatechange=function(){e._updateConnectionState()};var n=new RTCDtlsTransport(t);return n.ondtlsstatechange=function(){e._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:n}},t.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlssttatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},t.prototype._transceive=function(t,n,r){var i=o(t.localCapabilities,t.remoteCapabilities);n&&t.rtpSender&&(i.encodings=t.sendEncodingParameters,i.rtcp={cname:s.localCName,compound:t.rtcpParameters.compound},t.recvEncodingParameters.length&&(i.rtcp.ssrc=t.recvEncodingParameters[0].ssrc),t.rtpSender.send(i)),r&&t.rtpReceiver&&("video"===t.kind&&t.recvEncodingParameters&&15019>e&&t.recvEncodingParameters.forEach(function(e){delete e.rtx}),i.encodings=t.recvEncodingParameters,i.rtcp={cname:t.rtcpParameters.cname,compound:t.rtcpParameters.compound},t.sendEncodingParameters.length&&(i.rtcp.ssrc=t.sendEncodingParameters[0].ssrc),t.rtpReceiver.receive(i))},t.prototype.setLocalDescription=function(e){var t=this;if(!a("setLocalDescription",e.type,this.signalingState)){var n=new Error("Can not set local "+e.type+" in state "+this.signalingState);return n.name="InvalidStateError",arguments.length>2&&"function"==typeof arguments[2]&&window.setTimeout(arguments[2],0,n),Promise.reject(n)}var r,i;if("offer"===e.type)this._pendingOffer&&(r=s.splitSections(e.sdp),i=r.shift(),r.forEach(function(e,n){var r=s.parseRtpParameters(e);t._pendingOffer[n].localCapabilities=r}),this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===e.type){
r=s.splitSections(t.remoteDescription.sdp),i=r.shift();var c=s.matchPrefix(i,"a=ice-lite").length>0;r.forEach(function(e,n){var r=t.transceivers[n],a=r.iceGatherer,u=r.iceTransport,l=r.dtlsTransport,d=r.localCapabilities,p=r.remoteCapabilities,f=s.isRejected(e);if(!f&&!r.isDatachannel){var h=s.getIceParameters(e,i),m=s.getDtlsParameters(e,i);c&&(m.role="server"),t.usingBundle&&0!==n||(u.start(a,h,c?"controlling":"controlled"),l.start(m));var v=o(d,p);t._transceive(r,v.codecs.length>0,!1)}})}switch(this.localDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var u=arguments.length>1&&"function"==typeof arguments[1];if(u){var l=arguments[1];window.setTimeout(function(){l(),"new"===t.iceGatheringState&&(t.iceGatheringState="gathering",t._emitGatheringStateChange()),t._emitBufferedCandidates()},0)}var d=Promise.resolve();return d.then(function(){u||("new"===t.iceGatheringState&&(t.iceGatheringState="gathering",t._emitGatheringStateChange()),window.setTimeout(t._emitBufferedCandidates.bind(t),500))}),d},t.prototype.setRemoteDescription=function(t){var n=this;if(!a("setRemoteDescription",t.type,this.signalingState)){var r=new Error("Can not set remote "+t.type+" in state "+this.signalingState);return r.name="InvalidStateError",arguments.length>2&&"function"==typeof arguments[2]&&window.setTimeout(arguments[2],0,r),Promise.reject(r)}var i={},o=[],c=s.splitSections(t.sdp),u=c.shift(),l=s.matchPrefix(u,"a=ice-lite").length>0,d=s.matchPrefix(u,"a=group:BUNDLE ").length>0;this.usingBundle=d;var p=s.matchPrefix(u,"a=ice-options:")[0];switch(this.canTrickleIceCandidates=p?p.substr(14).split(" ").indexOf("trickle")>=0:!1,c.forEach(function(r,a){var c=s.splitLines(r),p=s.getKind(r),f=s.isRejected(r),h=c[0].substr(2).split(" ")[2],m=s.getDirection(r,u),v=s.parseMsid(r),g=s.getMid(r)||s.generateIdentifier();if("application"===p&&"DTLS/SCTP"===h)return void(n.transceivers[a]={mid:g,isDatachannel:!0});var y,_,S,b,C,w,E,R,P,x,T,L=s.parseRtpParameters(r);f||(x=s.getIceParameters(r,u),T=s.getDtlsParameters(r,u),T.role="client"),E=s.parseRtpEncodingParameters(r);var O=s.parseRtcpParameters(r),I=s.matchPrefix(r,"a=end-of-candidates",u).length>0,M=s.matchPrefix(r,"a=candidate:").map(function(e){return s.parseCandidate(e)}).filter(function(e){return"1"===e.component||1===e.component});"offer"!==t.type||f?"answer"!==t.type||f||(d&&a>0&&(n._disposeIceAndDtlsTransports(a),n.transceivers[a].iceGatherer=n.transceivers[0].iceGatherer,n.transceivers[a].iceTransport=n.transceivers[0].iceTransport,n.transceivers[a].dtlsTransport=n.transceivers[0].dtlsTransport,n.transceivers[a].rtpSender&&n.transceivers[a].rtpSender.setTransport(n.transceivers[0].dtlsTransport),n.transceivers[a].rtpReceiver&&n.transceivers[a].rtpReceiver.setTransport(n.transceivers[0].dtlsTransport)),y=n.transceivers[a],_=y.iceGatherer,S=y.iceTransport,b=y.dtlsTransport,C=y.rtpReceiver,w=y.sendEncodingParameters,R=y.localCapabilities,n.transceivers[a].recvEncodingParameters=E,n.transceivers[a].remoteCapabilities=L,n.transceivers[a].rtcpParameters=O,(l||I)&&M.length&&S.setRemoteCandidates(M),d&&0!==a||(S.start(_,x,"controlling"),b.start(T)),n._transceive(y,"sendrecv"===m||"recvonly"===m,"sendrecv"===m||"sendonly"===m),!C||"sendrecv"!==m&&"sendonly"!==m?delete y.rtpReceiver:(P=C.track,v?(i[v.stream]||(i[v.stream]=new MediaStream),i[v.stream].addTrack(P),o.push([P,C,i[v.stream]])):(i["default"]||(i["default"]=new MediaStream),i["default"].addTrack(P),o.push([P,C,i["default"]])))):(y=n.transceivers[a]||n._createTransceiver(p),y.mid=g,y.iceGatherer||(y.iceGatherer=d&&a>0?n.transceivers[0].iceGatherer:n._createIceGatherer(g,a)),!I||d&&0!==a||y.iceTransport.setRemoteCandidates(M),R=RTCRtpReceiver.getCapabilities(p),15019>e&&(R.codecs=R.codecs.filter(function(e){return"rtx"!==e.name})),w=[{ssrc:1001*(2*a+2)}],("sendrecv"===m||"sendonly"===m)&&(C=new RTCRtpReceiver(y.dtlsTransport,p),P=C.track,v?(i[v.stream]||(i[v.stream]=new MediaStream,Object.defineProperty(i[v.stream],"id",{get:function(){return v.stream}})),Object.defineProperty(P,"id",{get:function(){return v.track}}),i[v.stream].addTrack(P),o.push([P,C,i[v.stream]])):(i["default"]||(i["default"]=new MediaStream),i["default"].addTrack(P),o.push([P,C,i["default"]]))),y.localCapabilities=R,y.remoteCapabilities=L,y.rtpReceiver=C,y.rtcpParameters=O,y.sendEncodingParameters=w,y.recvEncodingParameters=E,n._transceive(n.transceivers[a],!1,"sendrecv"===m||"sendonly"===m))}),this.remoteDescription={type:t.type,sdp:t.sdp},t.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+t.type+'"')}return Object.keys(i).forEach(function(e){var t=i[e];if(t.getTracks().length){n.remoteStreams.push(t);var r=new Event("addstream");r.stream=t,n.dispatchEvent(r),null!==n.onaddstream&&window.setTimeout(function(){n.onaddstream(r)},0),o.forEach(function(e){var r=e[0],i=e[1];if(t.id===e[2].id){var o=new Event("track");o.track=r,o.receiver=i,o.streams=[t],n.dispatchEvent(o),null!==n.ontrack&&window.setTimeout(function(){n.ontrack(o)},0)}})}}),window.setTimeout(function(){n&&n.transceivers&&n.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},t.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},t.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this.dispatchEvent(t),null!==this.onsignalingstatechange&&this.onsignalingstatechange(t)},t.prototype._maybeFireNegotiationNeeded=function(){var e=this;"stable"===this.signalingState&&this.needNegotiation!==!0&&(this.needNegotiation=!0,window.setTimeout(function(){if(e.needNegotiation!==!1){e.needNegotiation=!1;var t=new Event("negotiationneeded");e.dispatchEvent(t),null!==e.onnegotiationneeded&&e.onnegotiationneeded(t)}},0))},t.prototype._updateConnectionState=function(){var e,t=this,n={"new":0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};if(this.transceivers.forEach(function(e){n[e.iceTransport.state]++,n[e.dtlsTransport.state]++}),n.connected+=n.completed,e="new",n.failed>0?e="failed":n.connecting>0||n.checking>0?e="connecting":n.disconnected>0?e="disconnected":n["new"]>0?e="new":(n.connected>0||n.completed>0)&&(e="connected"),e!==t.iceConnectionState){t.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this.dispatchEvent(r),null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange(r)}},t.prototype.createOffer=function(){var t=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");var n;1===arguments.length&&"function"!=typeof arguments[0]?n=arguments[0]:3===arguments.length&&(n=arguments[2]);var i=this.transceivers.filter(function(e){return"audio"===e.kind}).length,o=this.transceivers.filter(function(e){return"video"===e.kind}).length;if(n){if(n.mandatory||n.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==n.offerToReceiveAudio&&(i=n.offerToReceiveAudio===!0?1:n.offerToReceiveAudio===!1?0:n.offerToReceiveAudio),void 0!==n.offerToReceiveVideo&&(o=n.offerToReceiveVideo===!0?1:n.offerToReceiveVideo===!1?0:n.offerToReceiveVideo)}for(this.transceivers.forEach(function(e){"audio"===e.kind?(i--,0>i&&(e.wantReceive=!1)):"video"===e.kind&&(o--,0>o&&(e.wantReceive=!1))});i>0||o>0;)i>0&&(this._createTransceiver("audio"),i--),o>0&&(this._createTransceiver("video"),o--);var a=r(this.transceivers),c=s.writeSessionBoilerplate();a.forEach(function(n,r){var i=n.track,o=n.kind,c=s.generateIdentifier();n.mid=c,n.iceGatherer||(n.iceGatherer=t.usingBundle&&r>0?a[0].iceGatherer:t._createIceGatherer(c,r));var u=RTCRtpSender.getCapabilities(o);15019>e&&(u.codecs=u.codecs.filter(function(e){return"rtx"!==e.name})),u.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1")});var l=[{ssrc:1001*(2*r+1)}];i&&e>=15019&&"video"===o&&(l[0].rtx={ssrc:1001*(2*r+1)+1}),n.wantReceive&&(n.rtpReceiver=new RTCRtpReceiver(n.dtlsTransport,o)),n.localCapabilities=u,n.sendEncodingParameters=l}),"max-compat"!==this._config.bundlePolicy&&(c+="a=group:BUNDLE "+a.map(function(e){return e.mid}).join(" ")+"\r\n"),c+="a=ice-options:trickle\r\n",a.forEach(function(e,t){c+=s.writeMediaSection(e,e.localCapabilities,"offer",e.stream),c+="a=rtcp-rsize\r\n"}),this._pendingOffer=a;var u=new RTCSessionDescription({type:"offer",sdp:c});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,u),Promise.resolve(u)},t.prototype.createAnswer=function(){var t=s.writeSessionBoilerplate();this.usingBundle&&(t+="a=group:BUNDLE "+this.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),this.transceivers.forEach(function(n,r){if(n.isDatachannel)return void(t+="m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+n.mid+"\r\n");if(n.stream){var i;"audio"===n.kind?i=n.stream.getAudioTracks()[0]:"video"===n.kind&&(i=n.stream.getVideoTracks()[0]),i&&e>=15019&&"video"===n.kind&&(n.sendEncodingParameters[0].rtx={ssrc:1001*(2*r+2)+1})}var a=o(n.localCapabilities,n.remoteCapabilities),c=a.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length;!c&&n.sendEncodingParameters[0].rtx&&delete n.sendEncodingParameters[0].rtx,t+=s.writeMediaSection(n,a,"answer",n.stream),n.rtcpParameters&&n.rtcpParameters.reducedSize&&(t+="a=rtcp-rsize\r\n")});var n=new RTCSessionDescription({type:"answer",sdp:t});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,n),Promise.resolve(n)},t.prototype.addIceCandidate=function(e){if(e){var t=e.sdpMLineIndex;if(e.sdpMid)for(var n=0;n<this.transceivers.length;n++)if(this.transceivers[n].mid===e.sdpMid){t=n;break}var r=this.transceivers[t];if(r){var i=Object.keys(e.candidate).length>0?s.parseCandidate(e.candidate):{};if("tcp"===i.protocol&&(0===i.port||9===i.port))return Promise.resolve();if(i.component&&"1"!==i.component&&1!==i.component)return Promise.resolve();r.iceTransport.addRemoteCandidate(i);var o=s.splitSections(this.remoteDescription.sdp);o[t+1]+=(i.type?e.candidate.trim():"a=end-of-candidates")+"\r\n",this.remoteDescription.sdp=o.join("")}}else for(var a=0;a<this.transceivers.length;a++)if(this.transceivers[a].iceTransport.addRemoteCandidate({}),this.usingBundle)return Promise.resolve();return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},t.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(n){t[n]&&e.push(t[n].getStats())})});var t=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1],n=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};return new Promise(function(r){var i=new Map;Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){e[t].type=n(e[t]),i.set(t,e[t])})}),t&&window.setTimeout(t,0,i),r(i)})})},t}},{sdp:230}],60:[function(e,t,n){"use strict";var r=e("../utils").browserDetails,i={shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(){if("object"==typeof window&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(r.version<38&&e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];if(o.hasOwnProperty("urls"))for(var a=0;a<o.urls.length;a++){var s={url:o.urls[a]};0===o.urls[a].indexOf("turn")&&(s.username=o.username,s.credential=o.credential),n.push(s)}else n.push(e.iceServers[i])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var t=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t},n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,o,a){return i.apply(this,[e||null]).then(function(e){if(r.version<48&&(e=t(e)),r.version<53&&!o)try{e.forEach(function(e){e.type=n[e.type]||e.type})}catch(i){if("TypeError"!==i.name)throw i;e.forEach(function(t,r){e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(o,a)}}}};t.exports={shimOnTrack:i.shimOnTrack,shimSourceObject:i.shimSourceObject,shimPeerConnection:i.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":63,"./getusermedia":61}],61:[function(e,t,n){"use strict";var r=e("../utils").log,i=e("../utils").browserDetails;t.exports=function(){var e=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},t=function(t,n,o){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if((void 0!==r.min||void 0!==r.max||void 0!==r.exact)&&t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};i[n]="number"==typeof r.ideal?{min:r.ideal,max:r.ideal}:r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}}),t.length&&(e.require=t),e};return t=JSON.parse(JSON.stringify(t)),i.version<38&&(r("spec: "+JSON.stringify(t)),t.audio&&(t.audio=a(t.audio)),t.video&&(t.video=a(t.video)),r("ff37: "+JSON.stringify(t))),navigator.mozGetUserMedia(t,n,function(t){o(e(t))})},n=function(e){return new Promise(function(n,r){t(e,n,r)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:n,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})},i.version<41){var o=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return o().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(i.version<49){var a=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return a(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return e},function(t){return Promise.reject(e(t))})}}navigator.getUserMedia=function(e,n,r){return i.version<44?t(e,n,r):(console.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia"),void navigator.mediaDevices.getUserMedia(e).then(n,r))}}},{"../utils":63}],62:[function(e,t,n){"use strict";var r={shimAddStream:function(){"object"!=typeof window||!window.RTCPeerConnection||"addStream"in window.RTCPeerConnection.prototype||(RTCPeerConnection.prototype.addStream=function(e){var t=this;e.getTracks().forEach(function(n){t.addTrack(n,e)})})},shimOnAddStream:function(){"object"!=typeof window||!window.RTCPeerConnection||"onaddstream"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){var t=e.streams[0];if(this._streams||(this._streams=[]),!(this._streams.indexOf(t)>=0)){this._streams.push(t);var n=new Event("addstream");n.stream=e.streams[0],this.dispatchEvent(n)}}.bind(this))}})},shimCallbacksAPI:function(){if("object"==typeof window&&window.RTCPeerConnection){var e=RTCPeerConnection.prototype,t=e.createOffer,n=e.createAnswer,r=e.setLocalDescription,i=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(e,n){var r=arguments.length>=2?arguments[2]:arguments[0],i=t.apply(this,[r]);return n?(i.then(e,n),Promise.resolve()):i},e.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var a=function(e,t,n){var i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};e.setLocalDescription=a,a=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},e.setRemoteDescription=a,a=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},e.addIceCandidate=a}},shimGetUserMedia:function(){navigator.getUserMedia||(navigator.webkitGetUserMedia?navigator.getUserMedia=navigator.webkitGetUserMedia.bind(navigator):navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(navigator.getUserMedia=function(e,t,n){navigator.mediaDevices.getUserMedia(e).then(t,n)}.bind(navigator)))}};t.exports={shimCallbacksAPI:r.shimCallbacksAPI,shimAddStream:r.shimAddStream,shimOnAddStream:r.shimOnAddStream,shimGetUserMedia:r.shimGetUserMedia}},{}],63:[function(e,t,n){"use strict";var r=!0,i={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},log:function(){if("object"==typeof window){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(){var e={};if(e.browser=null,e.version=null,"undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/(\d+)\./,1);else if(navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!navigator.userAgent.match(/Version\/(\d+).(\d+)/))return e.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}else if(navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!navigator.mediaDevices||!navigator.userAgent.match(/AppleWebKit\/(\d+)\./))return e.browser="Not a supported browser.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/(\d+)\./,1)}return e},shimCreateObjectURL:function(){if(!("object"==typeof window&&window.HTMLMediaElement&&"srcObject"in window.HTMLMediaElement.prototype))return void 0;var e=URL.createObjectURL.bind(URL),t=URL.revokeObjectURL.bind(URL),n=new Map,r=0;URL.createObjectURL=function(t){if("getTracks"in t){var i="polyblob:"+ ++r;return n.set(i,t),console.log("URL.createObjectURL(stream) is deprecated! Use elem.srcObject = stream instead!"),i}return e(t)},URL.revokeObjectURL=function(e){t(e),n["delete"](e)};var i=Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,"src");Object.defineProperty(window.HTMLMediaElement.prototype,"src",{get:function(){return i.get.apply(this)},set:function(e){return this.srcObject=n.get(e)||null,i.set.apply(this,[e])}});var o=HTMLMediaElement.prototype.setAttribute;HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=n.get(arguments[1])||null),o.apply(this,arguments)}}};t.exports={log:i.log,disableLog:i.disableLog,browserDetails:i.detectBrowser(),extractVersion:i.extractVersion,shimCreateObjectURL:i.shimCreateObjectURL,detectBrowser:i.detectBrowser.bind(i)}},{}],64:[function(e,t,n){arguments[4][36][0].apply(n,arguments)},{dup:36}],65:[function(e,t,n){function r(e){e.signalEndOfCandidates=!0,this.waitForEndOfCandidates=!0,this.candidates=[],s.call(this,e),this.pc=new c({iceServers:e.iceServers||[],useJingle:!0},e.constraints||{}),this.pc.on("ice",this.onIceCandidate.bind(this,e)),this.pc.on("endOfCandidates",this.onIceEndOfCandidates.bind(this,e)),this.pc.on("iceConnectionStateChange",this.onIceStateChange.bind(this)),this.pc.on("addStream",this.onAddStream.bind(this)),this.pc.on("removeStream",this.onRemoveStream.bind(this)),this.pc.on("addChannel",this.onAddChannel.bind(this)),e.stream&&this.addStream(e.stream),this._ringing=!1,this._afterConstruction&&this._afterConstruction()}function i(){console.warn("Please move `"+i.caller.name+"` to JingleMediaSession.ts if you are adding code that uses it")}{var o=e("util"),a=e("extend-object"),s=e("jingle-session"),c=e("rtcpeerconnection"),u=e("lodash");e("async")}r.Extend=function(e){u.extend(r.prototype,e),r.prototype._super=s.prototype},o.inherits(r,s),Object.defineProperties(r.prototype,{ringing:{get:function(){return this._ringing},set:function(e){e!==this._ringing&&(this._ringing=e,this.emit("change:ringing",e))}},streams:{get:function(){return"closed"!==this.pc.signalingState?this.pc.getRemoteStreams():[]}}}),r.prototype=a(r.prototype,{accept:function(e,t){i();var n=this;this._candidates=[],1===arguments.length&&"function"==typeof e&&(t=e,e={}),t=t||function(){},e=e||{},n.constraints=e.constraints||{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},this._log("info","Accepted incoming session"),this.state="active",this.pc.answer(n.constraints,function(e,r){return e?(n._log("error","Could not create WebRTC answer",e),n.end("failed-application")):(r.jingle.contents.forEach(n._helpers.filterUnusedLabels),n.waitForEndOfCandidates?n.once("endOfCandidates",function(e){n.addAccumulatedCandidates(r.jingle),n.send("session-accept",r.jingle)}):n.send("session-accept",r.jingle),void t())})},ring:function(){i(),this._log("info","Ringing on incoming session"),this.ringing=!0,this.send("session-info",{ringing:!0})},mute:function(e,t){i(),this._log("info","Muting",t),this.send("session-info",{mute:{creator:e,name:t}})},unmute:function(e,t){i(),this._log("info","Unmuting",t),this.send("session-info",{unmute:{creator:e,name:t}})},hold:function(){i(),this._log("info","Placing on hold"),this.send("session-info",{hold:!0})},resume:function(){i(),this._log("info","Resuming from hold"),this.send("session-info",{active:!0})},addStream2:function(e,t){i(),this.addStream(e,!0,t)},removeStream2:function(e,t){i(),this.removeStream(e,!0,t)},switchStream:function(e,t,n){i();var r=this;n=n||function(){};var o=this.pc.localDescription;o.contents.forEach(function(e){delete e.transport,delete e.application.payloads}),this.pc.removeStream(e),this.send("source-remove",o),this.pc.addStream(t),this.pc.handleOffer({type:"offer",jingle:this.pc.remoteDescription},function(e){return e?(r._log("error","Could not process offer for switching streams"),n(e)):void r.pc.answer(r.constraints,function(e,t){return e?(r._log("error","Could not process answer for switching streams"),n(e)):(t.jingle.contents.forEach(function(e){delete e.transport,delete e.application.payloads}),r.send("content-add",t.jingle),void n())})})},muteAudio:function(e){i();var t=this;t._history=t._history||{};var n=t._history.lastContentModify;n&&(n.contents.forEach(function(t){"audio"===t.name&&t.application.sources.forEach(function(t){t.parameters=t.parameters?t.parameters:[],t.parameters.slice().reverse().forEach(function(e,n,r){"pause"===e.name&&t.parameters.splice(r.length-1-n,1)}),t.parameters.push({name:"pause",value:e.toString()})})}),t.send("content-modify",n))},onSessionInitiate:function(e,t){i();var n=this;this._log("info","Initiating incoming session"),this.state="pending",this.pc.isInitiator=!1,this.pc.handleOffer({type:"offer",jingle:e},function(e){return e?(n._log("error","Could not create WebRTC answer"),t({condition:"general-error"})):void t()})},onSessionTerminate:function(e,t){i();var n=this;this._log("info","Terminating session"),this.streams.forEach(function(e){n.onRemoveStream({stream:e})}),this.pc.close(),s.prototype.end.call(this,e.reason,!0),t()},onTransportInfo:function(e,t){i(),this.pc.processIce(e,function(){t()})},onAddChannel:function(e){i(),this.emit("addChannel",e)}}),t.exports=r},{async:66,"extend-object":33,"jingle-session":67,lodash:68,rtcpeerconnection:69,util:309}],66:[function(e,t,n){(function(e,r,i){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?r(n):"function"==typeof define&&define.amd?define(["exports"],r):r(e.async=e.async||{})}(this,function(n){"use strict";function o(e,t){t=0|t;for(var n=Math.max(e.length-t,0),r=Array(n),i=0;n>i;i++)r[i]=e[t+i];return r}function a(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function s(e){setTimeout(e,0)}function c(e){return function(t){var n=o(arguments,1);e(function(){t.apply(null,n)})}}function u(e){return lt(function(t,n){var r;try{r=e.apply(this,t)}catch(i){return n(i)}a(r)&&"function"==typeof r.then?r.then(function(e){l(n,null,e)},function(e){l(n,e.message?e:new Error(e))}):n(null,r)})}function l(e,t,n){try{e(t,n)}catch(r){ft(d,r)}}function d(e){throw e}function p(e){return ht&&"AsyncFunction"===e[Symbol.toStringTag]}function f(e){return p(e)?u(e):e}function h(e){return function(t){var n=o(arguments,1),r=lt(function(n,r){var i=this;return e(t,function(e,t){f(e).apply(i,n.concat(t))},r)});return n.length?r.apply(this,n):r}}function m(e){var t=St.call(e,Ct),n=e[Ct];try{e[Ct]=void 0;var r=!0}catch(i){}var o=bt.call(e);return r&&(t?e[Ct]=n:delete e[Ct]),o}function v(e){return Et.call(e)}function g(e){return null==e?void 0===e?Pt:Rt:xt&&xt in Object(e)?m(e):v(e)}function y(e){if(!a(e))return!1;var t=g(e);return t==Lt||t==Ot||t==Tt||t==It}function _(e){return"number"==typeof e&&e>-1&&e%1==0&&Mt>=e}function S(e){return null!=e&&_(e.length)&&!y(e)}function b(){}function C(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}function w(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function E(e){return null!=e&&"object"==typeof e}function R(e){return E(e)&&g(e)==jt}function P(){return!1}function x(e,t){var n=typeof e;return t=null==t?Xt:t,!!t&&("number"==n||"symbol"!=n&&Yt.test(e))&&e>-1&&e%1==0&&t>e}function T(e){return E(e)&&_(e.length)&&!!bn[g(e)]}function L(e){return function(t){return e(t)}}function O(e,t){var n=Ft(e),r=!n&&Bt(e),i=!n&&!r&&Ht(e),o=!n&&!r&&!i&&Tn(e),a=n||r||i||o,s=a?w(e.length,String):[],c=s.length;for(var u in e)!t&&!On.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||x(u,c))||s.push(u);return s}function I(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||In;return e===n}function M(e,t){return function(n){return e(t(n))}}function A(e){if(!I(e))return Mn(e);var t=[];for(var n in Object(e))Dn.call(e,n)&&"constructor"!=n&&t.push(n);return t}function D(e){return S(e)?O(e):A(e)}function k(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}function j(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}function N(e){var t=D(e),n=-1,r=t.length;return function(){var i=t[++n];return r>n?{value:e[i],key:i}:null}}function V(e){if(S(e))return k(e);var t=kt(e);return t?j(t):N(e)}function U(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function B(e){return function(t,n,r){function i(e,t){if(c-=1,e)s=!0,r(e);else{if(t===At||s&&0>=c)return s=!0,r(null);u||o()}}function o(){for(u=!0;e>c&&!s;){var t=a();if(null===t)return s=!0,void(0>=c&&r(null));c+=1,n(t.value,t.key,U(i))}u=!1}if(r=C(r||b),0>=e||!t)return r(null);var a=V(t),s=!1,c=0,u=!1;o()}}function F(e,t,n,r){B(t)(e,f(n),r)}function G(e,t){return function(n,r,i){return e(n,t,r,i)}}function q(e,t,n){function r(e,t){e?n(e):(++o===a||t===At)&&n(null)}n=C(n||b);var i=0,o=0,a=e.length;for(0===a&&n(null);a>i;i++)t(e[i],i,U(r))}function J(e){return function(t,n,r){return e(jn,t,f(n),r)}}function W(e,t,n,r){r=r||b,t=t||[];var i=[],o=0,a=f(n);e(t,function(e,t,n){var r=o++;a(e,function(e,t){i[r]=t,n(e)})},function(e){r(e,i)})}function z(e){return function(t,n,r,i){return e(B(n),t,f(r),i)}}function H(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function X(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(n(o[c],c,o)===!1)break}return t}}function Y(e,t){return e&&Gn(e,t,D)}function $(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Q(e){return e!==e}function K(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function Z(e,t,n){return t===t?K(e,t,n):$(e,Q,n)}function ee(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function te(e){return"symbol"==typeof e||E(e)&&g(e)==Jn}function ne(e){if("string"==typeof e)return e;if(Ft(e))return ee(e,ne)+"";if(te(e))return Hn?Hn.call(e):"";var t=e+"";return"0"==t&&1/e==-Wn?"-0":t}function re(e,t,n){var r=-1,i=e.length;

0>t&&(t=-t>i?0:i+t),n=n>i?i:n,0>n&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}function ie(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:re(e,t,n)}function oe(e,t){for(var n=e.length;n--&&Z(t,e[n],0)>-1;);return n}function ae(e,t){for(var n=-1,r=e.length;++n<r&&Z(t,e[n],0)>-1;);return n}function se(e){return e.split("")}function ce(e){return tr.test(e)}function ue(e){return e.match(br)||[]}function le(e){return ce(e)?ue(e):se(e)}function de(e){return null==e?"":ne(e)}function pe(e,t,n){if(e=de(e),e&&(n||void 0===t))return e.replace(Cr,"");if(!e||!(t=ne(t)))return e;var r=le(e),i=le(t),o=ae(r,i),a=oe(r,i)+1;return ie(r,o,a).join("")}function fe(e){return e=e.toString().replace(Pr,""),e=e.match(wr)[2].replace(" ",""),e=e?e.split(Er):[],e=e.map(function(e){return pe(e.replace(Rr,""))})}function he(e,t){var n={};Y(e,function(e,t){function r(t,n){var r=ee(i,function(e){return t[e]});r.push(n),f(e).apply(null,r)}var i,o=p(e),a=!o&&1===e.length||o&&0===e.length;if(Ft(e))i=e.slice(0,-1),e=e[e.length-1],n[t]=i.concat(i.length>0?r:e);else if(a)n[t]=e;else{if(i=fe(e),0===e.length&&!o&&0===i.length)throw new Error("autoInject task functions require explicit parameters.");o||i.pop(),n[t]=i.concat(r)}}),qn(n,t)}function me(){this.head=this.tail=null,this.length=0}function ve(e,t){e.length=1,e.head=e.tail=t}function ge(e,t,n){function r(e,t,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(l.started=!0,Ft(e)||(e=[e]),0===e.length&&l.idle())return ft(function(){l.drain()});for(var r=0,i=e.length;i>r;r++){var o={data:e[r],callback:n||b};t?l._tasks.unshift(o):l._tasks.push(o)}c||(c=!0,ft(function(){c=!1,l.process()}))}function i(e){return function(t){a-=1;for(var n=0,r=e.length;r>n;n++){var i=e[n],o=Z(s,i,0);0===o?s.shift():o>0&&s.splice(o,1),i.callback.apply(i,arguments),null!=t&&l.error(t,i.data)}a<=l.concurrency-l.buffer&&l.unsaturated(),l.idle()&&l.drain(),l.process()}}if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var o=f(e),a=0,s=[],c=!1,u=!1,l={_tasks:new me,concurrency:t,payload:n,saturated:b,unsaturated:b,buffer:t/4,empty:b,drain:b,error:b,started:!1,paused:!1,push:function(e,t){r(e,!1,t)},kill:function(){l.drain=b,l._tasks.empty()},unshift:function(e,t){r(e,!0,t)},remove:function(e){l._tasks.remove(e)},process:function(){if(!u){for(u=!0;!l.paused&&a<l.concurrency&&l._tasks.length;){var e=[],t=[],n=l._tasks.length;l.payload&&(n=Math.min(n,l.payload));for(var r=0;n>r;r++){var c=l._tasks.shift();e.push(c),s.push(c),t.push(c.data)}a+=1,0===l._tasks.length&&l.empty(),a===l.concurrency&&l.saturated();var d=U(i(e));o(t,d)}u=!1}},length:function(){return l._tasks.length},running:function(){return a},workersList:function(){return s},idle:function(){return l._tasks.length+a===0},pause:function(){l.paused=!0},resume:function(){l.paused!==!1&&(l.paused=!1,ft(l.process))}};return l}function ye(e,t){return ge(e,1,t)}function _e(e,t,n,r){r=C(r||b);var i=f(n);Tr(e,function(e,n,r){i(t,e,function(e,n){t=n,r(e)})},function(e){r(e,t)})}function Se(){var e=ee(arguments,f);return function(){var t=o(arguments),n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=b,_e(e,t,function(e,t,r){t.apply(n,e.concat(function(e){var t=o(arguments,1);r(e,t)}))},function(e,t){r.apply(n,[e].concat(t))})}}function be(e){return e}function Ce(e,t){return function(n,r,i,o){o=o||b;var a,s=!1;n(r,function(n,r,o){i(n,function(r,i){r?o(r):e(i)&&!a?(s=!0,a=t(!0,n),o(null,At)):o()})},function(e){e?o(e):o(null,s?a:t(!1))})}}function we(e,t){return t}function Ee(e){return function(t){var n=o(arguments,1);n.push(function(t){var n=o(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&H(n,function(t){console[e](t)}))}),f(t).apply(null,n)}}function Re(e,t,n){function r(e){if(e)return n(e);var t=o(arguments,1);t.push(i),s.apply(this,t)}function i(e,t){return e?n(e):t?void a(r):n(null)}n=U(n||b);var a=f(e),s=f(t);i(null,!0)}function Pe(e,t,n){n=U(n||b);var r=f(e),i=function(e){if(e)return n(e);var a=o(arguments,1);return t.apply(this,a)?r(i):void n.apply(null,[null].concat(a))};r(i)}function xe(e,t,n){Pe(e,function(){return!t.apply(this,arguments)},n)}function Te(e,t,n){function r(e){return e?n(e):void a(i)}function i(e,t){return e?n(e):t?void o(r):n(null)}n=U(n||b);var o=f(t),a=f(e);a(i)}function Le(e){return function(t,n,r){return e(t,r)}}function Oe(e,t,n){jn(e,Le(f(t)),n)}function Ie(e,t,n,r){B(t)(e,Le(f(n)),r)}function Me(e){return p(e)?e:lt(function(t,n){var r=!0;t.push(function(){var e=arguments;r?ft(function(){n.apply(null,e)}):n.apply(null,e)}),e.apply(this,t),r=!1})}function Ae(e){return!e}function De(e){return function(t){return null==t?void 0:t[e]}}function ke(e,t,n,r){var i=new Array(t.length);e(t,function(e,t,r){n(e,function(e,n){i[t]=!!n,r(e)})},function(e){if(e)return r(e);for(var n=[],o=0;o<t.length;o++)i[o]&&n.push(t[o]);r(null,n)})}function je(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n,o){n?r(n):(o&&i.push({index:t,value:e}),r())})},function(e){e?r(e):r(null,ee(i.sort(function(e,t){return e.index-t.index}),De("value")))})}function Ne(e,t,n,r){var i=S(t)?ke:je;i(e,t,f(n),r||b)}function Ve(e,t){function n(e){return e?r(e):void i(n)}var r=U(t||b),i=f(Me(e));n()}function Ue(e,t,n,r){r=C(r||b);var i={},o=f(n);F(e,t,function(e,t,n){o(e,t,function(e,r){return e?n(e):(i[t]=r,void n())})},function(e){r(e,i)})}function Be(e,t){return t in e}function Fe(e,t){var n=Object.create(null),r=Object.create(null);t=t||be;var i=f(e),a=lt(function(e,a){var s=t.apply(null,e);Be(n,s)?ft(function(){a.apply(null,n[s])}):Be(r,s)?r[s].push(a):(r[s]=[a],i.apply(null,e.concat(function(){var e=o(arguments);n[s]=e;var t=r[s];delete r[s];for(var i=0,a=t.length;a>i;i++)t[i].apply(null,e)})))});return a.memo=n,a.unmemoized=e,a}function Ge(e,t,n){n=n||b;var r=S(t)?[]:{};e(t,function(e,t,n){f(e)(function(e,i){arguments.length>2&&(i=o(arguments,1)),r[t]=i,n(e)})},function(e){n(e,r)})}function qe(e,t){Ge(jn,e,t)}function Je(e,t,n){Ge(B(t),e,n)}function We(e,t){if(t=C(t||b),!Ft(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,r=e.length;r>n;n++)f(e[n])(t)}function ze(e,t,n,r){var i=o(e).reverse();_e(i,t,n,r)}function He(e){var t=f(e);return lt(function(e,n){return e.push(function(e,t){if(e)n(null,{error:e});else{var r;r=arguments.length<=2?t:o(arguments,1),n(null,{value:r})}}),t.apply(this,e)})}function Xe(e){var t;return Ft(e)?t=ee(e,He):(t={},Y(e,function(e,n){t[n]=He.call(this,e)})),t}function Ye(e,t,n,r){Ne(e,t,function(e,t){n(e,function(e,n){t(e,!n)})},r)}function $e(e){return function(){return e}}function Qe(e,t,n){function r(e,t){if("object"==typeof t)e.times=+t.times||o,e.intervalFunc="function"==typeof t.interval?t.interval:$e(+t.interval||a),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||o}}function i(){c(function(e){e&&u++<s.times&&("function"!=typeof s.errorFilter||s.errorFilter(e))?setTimeout(i,s.intervalFunc(u)):n.apply(null,arguments)})}var o=5,a=0,s={times:o,intervalFunc:$e(a)};if(arguments.length<3&&"function"==typeof e?(n=t||b,t=e):(r(s,e),n=n||b),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var c=f(t),u=1;i()}function Ke(e,t){Ge(Tr,e,t)}function Ze(e,t,n){function r(e,t){var n=e.criteria,r=t.criteria;return r>n?-1:n>r?1:0}var i=f(t);Nn(e,function(e,t){i(e,function(n,r){return n?t(n):void t(null,{value:e,criteria:r})})},function(e,t){return e?n(e):void n(null,ee(t.sort(r),De("value")))})}function et(e,t,n){var r=f(e);return lt(function(i,o){function a(){var t=e.name||"anonymous",r=new Error('Callback function "'+t+'" timed out.');r.code="ETIMEDOUT",n&&(r.info=n),c=!0,o(r)}var s,c=!1;i.push(function(){c||(o.apply(null,arguments),clearTimeout(s))}),s=setTimeout(a,t),r.apply(null,i)})}function tt(e,t,n,r){for(var i=-1,o=ui(ci((t-e)/(n||1)),0),a=Array(o);o--;)a[r?o:++i]=e,e+=n;return a}function nt(e,t,n,r){var i=f(n);Un(tt(0,e,1),t,i,r)}function rt(e,t,n,r){arguments.length<=3&&(r=n,n=t,t=Ft(e)?[]:{}),r=C(r||b);var i=f(n);jn(e,function(e,n,r){i(t,e,n,r)},function(e){r(e,t)})}function it(e,t){var n,r=null;t=t||b,Ur(e,function(e,t){f(e)(function(e,i){n=arguments.length>2?o(arguments,1):i,r=e,t(!e)})},function(){t(r,n)})}function ot(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function at(e,t,n){n=U(n||b);var r=f(t);if(!e())return n(null);var i=function(t){if(t)return n(t);if(e())return r(i);var a=o(arguments,1);n.apply(null,[null].concat(a))};r(i)}function st(e,t,n){at(function(){return!e.apply(this,arguments)},t,n)}var ct,ut=function(e){var t=o(arguments,1);return function(){var n=o(arguments);return e.apply(null,t.concat(n))}},lt=function(e){return function(){var t=o(arguments),n=t.pop();e.call(this,t,n)}},dt="function"==typeof i&&i,pt="object"==typeof e&&"function"==typeof e.nextTick;ct=dt?i:pt?e.nextTick:s;var ft=c(ct),ht="function"==typeof Symbol,mt="object"==typeof r&&r&&r.Object===Object&&r,vt="object"==typeof self&&self&&self.Object===Object&&self,gt=mt||vt||Function("return this")(),yt=gt.Symbol,_t=Object.prototype,St=_t.hasOwnProperty,bt=_t.toString,Ct=yt?yt.toStringTag:void 0,wt=Object.prototype,Et=wt.toString,Rt="[object Null]",Pt="[object Undefined]",xt=yt?yt.toStringTag:void 0,Tt="[object AsyncFunction]",Lt="[object Function]",Ot="[object GeneratorFunction]",It="[object Proxy]",Mt=9007199254740991,At={},Dt="function"==typeof Symbol&&Symbol.iterator,kt=function(e){return Dt&&e[Dt]&&e[Dt]()},jt="[object Arguments]",Nt=Object.prototype,Vt=Nt.hasOwnProperty,Ut=Nt.propertyIsEnumerable,Bt=R(function(){return arguments}())?R:function(e){return E(e)&&Vt.call(e,"callee")&&!Ut.call(e,"callee")},Ft=Array.isArray,Gt="object"==typeof n&&n&&!n.nodeType&&n,qt=Gt&&"object"==typeof t&&t&&!t.nodeType&&t,Jt=qt&&qt.exports===Gt,Wt=Jt?gt.Buffer:void 0,zt=Wt?Wt.isBuffer:void 0,Ht=zt||P,Xt=9007199254740991,Yt=/^(?:0|[1-9]\d*)$/,$t="[object Arguments]",Qt="[object Array]",Kt="[object Boolean]",Zt="[object Date]",en="[object Error]",tn="[object Function]",nn="[object Map]",rn="[object Number]",on="[object Object]",an="[object RegExp]",sn="[object Set]",cn="[object String]",un="[object WeakMap]",ln="[object ArrayBuffer]",dn="[object DataView]",pn="[object Float32Array]",fn="[object Float64Array]",hn="[object Int8Array]",mn="[object Int16Array]",vn="[object Int32Array]",gn="[object Uint8Array]",yn="[object Uint8ClampedArray]",_n="[object Uint16Array]",Sn="[object Uint32Array]",bn={};bn[pn]=bn[fn]=bn[hn]=bn[mn]=bn[vn]=bn[gn]=bn[yn]=bn[_n]=bn[Sn]=!0,bn[$t]=bn[Qt]=bn[ln]=bn[Kt]=bn[dn]=bn[Zt]=bn[en]=bn[tn]=bn[nn]=bn[rn]=bn[on]=bn[an]=bn[sn]=bn[cn]=bn[un]=!1;var Cn="object"==typeof n&&n&&!n.nodeType&&n,wn=Cn&&"object"==typeof t&&t&&!t.nodeType&&t,En=wn&&wn.exports===Cn,Rn=En&&mt.process,Pn=function(){try{var e=wn&&wn.require&&wn.require("util").types;return e?e:Rn&&Rn.binding&&Rn.binding("util")}catch(t){}}(),xn=Pn&&Pn.isTypedArray,Tn=xn?L(xn):T,Ln=Object.prototype,On=Ln.hasOwnProperty,In=Object.prototype,Mn=M(Object.keys,Object),An=Object.prototype,Dn=An.hasOwnProperty,kn=G(F,1/0),jn=function(e,t,n){var r=S(e)?q:kn;r(e,f(t),n)},Nn=J(W),Vn=h(Nn),Un=z(W),Bn=G(Un,1),Fn=h(Bn),Gn=X(),qn=function(e,t,n){function r(e,t){y.push(function(){c(e,t)})}function i(){if(0===y.length&&0===m)return n(null,h);for(;y.length&&t>m;){var e=y.shift();e()}}function a(e,t){var n=g[e];n||(n=g[e]=[]),n.push(t)}function s(e){var t=g[e]||[];H(t,function(e){e()}),i()}function c(e,t){if(!v){var r=U(function(t,r){if(m--,arguments.length>2&&(r=o(arguments,1)),t){var i={};Y(h,function(e,t){i[t]=e}),i[e]=r,v=!0,g=Object.create(null),n(t,i)}else h[e]=r,s(e)});m++;var i=f(t[t.length-1]);t.length>1?i(h,r):i(r)}}function u(){for(var e,t=0;_.length;)e=_.pop(),t++,H(l(e),function(e){0===--S[e]&&_.push(e)});if(t!==p)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function l(t){var n=[];return Y(e,function(e,r){Ft(e)&&Z(e,t,0)>=0&&n.push(r)}),n}"function"==typeof t&&(n=t,t=null),n=C(n||b);var d=D(e),p=d.length;if(!p)return n(null);t||(t=p);var h={},m=0,v=!1,g=Object.create(null),y=[],_=[],S={};Y(e,function(t,n){if(!Ft(t))return r(n,[t]),void _.push(n);var i=t.slice(0,t.length-1),o=i.length;return 0===o?(r(n,t),void _.push(n)):(S[n]=o,void H(i,function(s){if(!e[s])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+s+"` in "+i.join(", "));a(s,function(){o--,0===o&&r(n,t)})}))}),u(),i()},Jn="[object Symbol]",Wn=1/0,zn=yt?yt.prototype:void 0,Hn=zn?zn.toString:void 0,Xn="\\ud800-\\udfff",Yn="\\u0300-\\u036f",$n="\\ufe20-\\ufe2f",Qn="\\u20d0-\\u20ff",Kn=Yn+$n+Qn,Zn="\\ufe0e\\ufe0f",er="\\u200d",tr=RegExp("["+er+Xn+Kn+Zn+"]"),nr="\\ud800-\\udfff",rr="\\u0300-\\u036f",ir="\\ufe20-\\ufe2f",or="\\u20d0-\\u20ff",ar=rr+ir+or,sr="\\ufe0e\\ufe0f",cr="["+nr+"]",ur="["+ar+"]",lr="\\ud83c[\\udffb-\\udfff]",dr="(?:"+ur+"|"+lr+")",pr="[^"+nr+"]",fr="(?:\\ud83c[\\udde6-\\uddff]){2}",hr="[\\ud800-\\udbff][\\udc00-\\udfff]",mr="\\u200d",vr=dr+"?",gr="["+sr+"]?",yr="(?:"+mr+"(?:"+[pr,fr,hr].join("|")+")"+gr+vr+")*",_r=gr+vr+yr,Sr="(?:"+[pr+ur+"?",ur,fr,hr,cr].join("|")+")",br=RegExp(lr+"(?="+lr+")|"+Sr+_r,"g"),Cr=/^\s+|\s+$/g,wr=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Er=/,/,Rr=/(=.+)?(\s*)$/,Pr=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;me.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},me.prototype.empty=function(){for(;this.head;)this.shift();return this},me.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},me.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},me.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):ve(this,e)},me.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):ve(this,e)},me.prototype.shift=function(){return this.head&&this.removeLink(this.head)},me.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},me.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,n=0;n<this.length;n++)e[n]=t.data,t=t.next;return e},me.prototype.remove=function(e){for(var t=this.head;t;){var n=t.next;e(t)&&this.removeLink(t),t=n}return this};var xr,Tr=G(F,1),Lr=function(){return Se.apply(null,o(arguments).reverse())},Or=Array.prototype.concat,Ir=function(e,t,n,r){r=r||b;var i=f(n);Un(e,t,function(e,t){i(e,function(e){return e?t(e):t(null,o(arguments,1))})},function(e,t){for(var n=[],i=0;i<t.length;i++)t[i]&&(n=Or.apply(n,t[i]));return r(e,n)})},Mr=G(Ir,1/0),Ar=G(Ir,1),Dr=function(){var e=o(arguments),t=[null].concat(e);return function(){var e=arguments[arguments.length-1];return e.apply(this,t)}},kr=J(Ce(be,we)),jr=z(Ce(be,we)),Nr=G(jr,1),Vr=Ee("dir"),Ur=G(Ie,1),Br=J(Ce(Ae,Ae)),Fr=z(Ce(Ae,Ae)),Gr=G(Fr,1),qr=J(Ne),Jr=z(Ne),Wr=G(Jr,1),zr=function(e,t,n,r){r=r||b;var i=f(n);Un(e,t,function(e,t){i(e,function(n,r){return n?t(n):t(null,{key:r,val:e})})},function(e,t){for(var n={},i=Object.prototype.hasOwnProperty,o=0;o<t.length;o++)if(t[o]){var a=t[o].key,s=t[o].val;i.call(n,a)?n[a].push(s):n[a]=[s]}return r(e,n)})},Hr=G(zr,1/0),Xr=G(zr,1),Yr=Ee("log"),$r=G(Ue,1/0),Qr=G(Ue,1);xr=pt?e.nextTick:dt?i:s;var Kr=c(xr),Zr=function(e,t){var n=f(e);return ge(function(e,t){n(e[0],t)},t,1)},ei=function(e,t){var n=Zr(e,t);return n.push=function(e,t,r){if(null==r&&(r=b),"function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,Ft(e)||(e=[e]),0===e.length)return ft(function(){n.drain()});t=t||0;for(var i=n._tasks.head;i&&t>=i.priority;)i=i.next;for(var o=0,a=e.length;a>o;o++){var s={data:e[o],priority:t,callback:r};i?n._tasks.insertBefore(i,s):n._tasks.push(s)}ft(n.process)},delete n.unshift,n},ti=J(Ye),ni=z(Ye),ri=G(ni,1),ii=function(e,t){t||(t=e,e=null);var n=f(t);return lt(function(t,r){function i(e){n.apply(null,t.concat(e))}e?Qe(e,i,r):Qe(i,r)})},oi=J(Ce(Boolean,be)),ai=z(Ce(Boolean,be)),si=G(ai,1),ci=Math.ceil,ui=Math.max,li=G(nt,1/0),di=G(nt,1),pi=function(e,t){function n(t){var n=f(e[i++]);t.push(U(r)),n.apply(null,t)}function r(r){return r||i===e.length?t.apply(null,arguments):void n(o(arguments,1))}if(t=C(t||b),!Ft(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var i=0;n([])},fi={apply:ut,applyEach:Vn,applyEachSeries:Fn,asyncify:u,auto:qn,autoInject:he,cargo:ye,compose:Lr,concat:Mr,concatLimit:Ir,concatSeries:Ar,constant:Dr,detect:kr,detectLimit:jr,detectSeries:Nr,dir:Vr,doDuring:Re,doUntil:xe,doWhilst:Pe,during:Te,each:Oe,eachLimit:Ie,eachOf:jn,eachOfLimit:F,eachOfSeries:Tr,eachSeries:Ur,ensureAsync:Me,every:Br,everyLimit:Fr,everySeries:Gr,filter:qr,filterLimit:Jr,filterSeries:Wr,forever:Ve,groupBy:Hr,groupByLimit:zr,groupBySeries:Xr,log:Yr,map:Nn,mapLimit:Un,mapSeries:Bn,mapValues:$r,mapValuesLimit:Ue,mapValuesSeries:Qr,memoize:Fe,nextTick:Kr,parallel:qe,parallelLimit:Je,priorityQueue:ei,queue:Zr,race:We,reduce:_e,reduceRight:ze,reflect:He,reflectAll:Xe,reject:ti,rejectLimit:ni,rejectSeries:ri,retry:Qe,retryable:ii,seq:Se,series:Ke,setImmediate:ft,some:oi,someLimit:ai,someSeries:si,sortBy:Ze,timeout:et,times:li,timesLimit:nt,timesSeries:di,transform:rt,tryEach:it,unmemoize:ot,until:st,waterfall:pi,whilst:at,all:Br,allLimit:Fr,allSeries:Gr,any:oi,anyLimit:ai,anySeries:si,find:kr,findLimit:jr,findSeries:Nr,forEach:Oe,forEachSeries:Ur,forEachLimit:Ie,forEachOf:jn,forEachOfSeries:Tr,forEachOfLimit:F,inject:_e,foldl:_e,foldr:ze,select:qr,selectLimit:Jr,selectSeries:Wr,wrapSync:u};n["default"]=fi,n.apply=ut,n.applyEach=Vn,n.applyEachSeries=Fn,n.asyncify=u,n.auto=qn,n.autoInject=he,n.cargo=ye,n.compose=Lr,n.concat=Mr,n.concatLimit=Ir,n.concatSeries=Ar,n.constant=Dr,n.detect=kr,n.detectLimit=jr,n.detectSeries=Nr,n.dir=Vr,n.doDuring=Re,n.doUntil=xe,n.doWhilst=Pe,n.during=Te,n.each=Oe,n.eachLimit=Ie,n.eachOf=jn,n.eachOfLimit=F,n.eachOfSeries=Tr,n.eachSeries=Ur,n.ensureAsync=Me,n.every=Br,n.everyLimit=Fr,n.everySeries=Gr,n.filter=qr,n.filterLimit=Jr,n.filterSeries=Wr,n.forever=Ve,n.groupBy=Hr,n.groupByLimit=zr,n.groupBySeries=Xr,n.log=Yr,n.map=Nn,n.mapLimit=Un,n.mapSeries=Bn,n.mapValues=$r,n.mapValuesLimit=Ue,n.mapValuesSeries=Qr,n.memoize=Fe,n.nextTick=Kr,n.parallel=qe,n.parallelLimit=Je,n.priorityQueue=ei,n.queue=Zr,n.race=We,n.reduce=_e,n.reduceRight=ze,n.reflect=He,n.reflectAll=Xe,n.reject=ti,n.rejectLimit=ni,n.rejectSeries=ri,n.retry=Qe,n.retryable=ii,n.seq=Se,n.series=Ke,n.setImmediate=ft,n.some=oi,n.someLimit=ai,n.someSeries=si,n.sortBy=Ze,n.timeout=et,n.times=li,n.timesLimit=nt,n.timesSeries=di,n.transform=rt,n.tryEach=it,n.unmemoize=ot,n.until=st,n.waterfall=pi,n.whilst=at,n.all=Br,n.allLimit=Fr,n.allSeries=Gr,n.any=oi,n.anyLimit=ai,n.anySeries=si,n.find=kr,n.findLimit=jr,n.findSeries=Nr,n.forEach=Oe,n.forEachSeries=Ur,n.forEachLimit=Ie,n.forEachOf=jn,n.forEachOfSeries=Tr,n.forEachOfLimit=F,n.inject=_e,n.foldl=_e,n.foldr=ze,n.select=qr,n.selectLimit=Jr,n.selectSeries=Wr,n.wrapSync=u,Object.defineProperty(n,"__esModule",{value:!0})})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:8,timers:303}],67:[function(e,t,n){arguments[4][52][0].apply(n,arguments)},{async:66,dup:52,"extend-object":33,util:309,uuid:310,wildemitter:70}],68:[function(e,t,n){(function(e){(function(){function r(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function i(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function o(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function a(e,t){for(var n=null==e?0:e.length;n--&&t(e[n],n,e)!==!1;);return e}function s(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function c(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function u(e,t){var n=null==e?0:e.length;return!!n&&S(e,t,0)>-1}function l(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function d(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function p(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function f(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function h(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function m(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function v(e){return e.split("")}function g(e){return e.match(Ut)||[]}function y(e,t,n){var r;return n(e,function(e,n,i){return t(e,n,i)?(r=n,!1):void 0}),r}function _(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function S(e,t,n){return t===t?X(e,t,n):_(e,C,n)}function b(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function C(e){return e!==e}function w(e,t){var n=null==e?0:e.length;return n?T(e,t)/n:De}function E(e){return function(t){return null==t?te:t[e]}}function R(e){return function(t){return null==e?te:e[t]}}function P(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function x(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function T(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);o!==te&&(n=n===te?o:n+o)}return n}function L(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function O(e,t){return d(t,function(t){return[t,e[t]]})}function I(e){return function(t){return e(t)}}function M(e,t){return d(t,function(t){return e[t]})}function A(e,t){return e.has(t)}function D(e,t){for(var n=-1,r=e.length;++n<r&&S(t,e[n],0)>-1;);return n}function k(e,t){for(var n=e.length;n--&&S(t,e[n],0)>-1;);return n}function j(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}function N(e){return"\\"+Kn[e]}function V(e,t){return null==e?te:e[t]}function U(e){return qn.test(e)}function B(e){return Jn.test(e)}function F(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function G(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function q(e,t){return function(n){return e(t(n))}}function J(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];(a===t||a===ce)&&(e[n]=ce,o[i++]=n)}return o}function W(e,t){return"__proto__"==t?te:e[t]}function z(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function H(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function X(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}function Y(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}function $(e){return U(e)?K(e):mr(e)}function Q(e){return U(e)?Z(e):v(e)}function K(e){for(var t=Fn.lastIndex=0;Fn.test(e);)++t;return t}function Z(e){return e.match(Fn)||[]}function ee(e){return e.match(Gn)||[]}var te,ne="4.17.10",re=200,ie="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",oe="Expected a function",ae="__lodash_hash_undefined__",se=500,ce="__lodash_placeholder__",ue=1,le=2,de=4,pe=1,fe=2,he=1,me=2,ve=4,ge=8,ye=16,_e=32,Se=64,be=128,Ce=256,we=512,Ee=30,Re="...",Pe=800,xe=16,Te=1,Le=2,Oe=3,Ie=1/0,Me=9007199254740991,Ae=1.7976931348623157e308,De=0/0,ke=4294967295,je=ke-1,Ne=ke>>>1,Ve=[["ary",be],["bind",he],["bindKey",me],["curry",ge],["curryRight",ye],["flip",we],["partial",_e],["partialRight",Se],["rearg",Ce]],Ue="[object Arguments]",Be="[object Array]",Fe="[object AsyncFunction]",Ge="[object Boolean]",qe="[object Date]",Je="[object DOMException]",We="[object Error]",ze="[object Function]",He="[object GeneratorFunction]",Xe="[object Map]",Ye="[object Number]",$e="[object Null]",Qe="[object Object]",Ke="[object Promise]",Ze="[object Proxy]",et="[object RegExp]",tt="[object Set]",nt="[object String]",rt="[object Symbol]",it="[object Undefined]",ot="[object WeakMap]",at="[object WeakSet]",st="[object ArrayBuffer]",ct="[object DataView]",ut="[object Float32Array]",lt="[object Float64Array]",dt="[object Int8Array]",pt="[object Int16Array]",ft="[object Int32Array]",ht="[object Uint8Array]",mt="[object Uint8ClampedArray]",vt="[object Uint16Array]",gt="[object Uint32Array]",yt=/\b__p \+= '';/g,_t=/\b(__p \+=) '' \+/g,St=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bt=/&(?:amp|lt|gt|quot|#39);/g,Ct=/[&<>"']/g,wt=RegExp(bt.source),Et=RegExp(Ct.source),Rt=/<%-([\s\S]+?)%>/g,Pt=/<%([\s\S]+?)%>/g,xt=/<%=([\s\S]+?)%>/g,Tt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Lt=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,Mt=RegExp(It.source),At=/^\s+|\s+$/g,Dt=/^\s+/,kt=/\s+$/,jt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Nt=/\{\n\/\* \[wrapped with (.+)\] \*/,Vt=/,? & /,Ut=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Bt=/\\(\\)?/g,Ft=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Gt=/\w*$/,qt=/^[-+]0x[0-9a-f]+$/i,Jt=/^0b[01]+$/i,Wt=/^\[object .+?Constructor\]$/,zt=/^0o[0-7]+$/i,Ht=/^(?:0|[1-9]\d*)$/,Xt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yt=/($^)/,$t=/['\n\r\u2028\u2029\\]/g,Qt="\\ud800-\\udfff",Kt="\\u0300-\\u036f",Zt="\\ufe20-\\ufe2f",en="\\u20d0-\\u20ff",tn=Kt+Zt+en,nn="\\u2700-\\u27bf",rn="a-z\\xdf-\\xf6\\xf8-\\xff",on="\\xac\\xb1\\xd7\\xf7",an="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",sn="\\u2000-\\u206f",cn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",un="A-Z\\xc0-\\xd6\\xd8-\\xde",ln="\\ufe0e\\ufe0f",dn=on+an+sn+cn,pn="[']",fn="["+Qt+"]",hn="["+dn+"]",mn="["+tn+"]",vn="\\d+",gn="["+nn+"]",yn="["+rn+"]",_n="[^"+Qt+dn+vn+nn+rn+un+"]",Sn="\\ud83c[\\udffb-\\udfff]",bn="(?:"+mn+"|"+Sn+")",Cn="[^"+Qt+"]",wn="(?:\\ud83c[\\udde6-\\uddff]){2}",En="[\\ud800-\\udbff][\\udc00-\\udfff]",Rn="["+un+"]",Pn="\\u200d",xn="(?:"+yn+"|"+_n+")",Tn="(?:"+Rn+"|"+_n+")",Ln="(?:"+pn+"(?:d|ll|m|re|s|t|ve))?",On="(?:"+pn+"(?:D|LL|M|RE|S|T|VE))?",In=bn+"?",Mn="["+ln+"]?",An="(?:"+Pn+"(?:"+[Cn,wn,En].join("|")+")"+Mn+In+")*",Dn="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",kn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",jn=Mn+In+An,Nn="(?:"+[gn,wn,En].join("|")+")"+jn,Vn="(?:"+[Cn+mn+"?",mn,wn,En,fn].join("|")+")",Un=RegExp(pn,"g"),Bn=RegExp(mn,"g"),Fn=RegExp(Sn+"(?="+Sn+")|"+Vn+jn,"g"),Gn=RegExp([Rn+"?"+yn+"+"+Ln+"(?="+[hn,Rn,"$"].join("|")+")",Tn+"+"+On+"(?="+[hn,Rn+xn,"$"].join("|")+")",Rn+"?"+xn+"+"+Ln,Rn+"+"+On,kn,Dn,vn,Nn].join("|"),"g"),qn=RegExp("["+Pn+Qt+tn+ln+"]"),Jn=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Wn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],zn=-1,Hn={};Hn[ut]=Hn[lt]=Hn[dt]=Hn[pt]=Hn[ft]=Hn[ht]=Hn[mt]=Hn[vt]=Hn[gt]=!0,Hn[Ue]=Hn[Be]=Hn[st]=Hn[Ge]=Hn[ct]=Hn[qe]=Hn[We]=Hn[ze]=Hn[Xe]=Hn[Ye]=Hn[Qe]=Hn[et]=Hn[tt]=Hn[nt]=Hn[ot]=!1;var Xn={};Xn[Ue]=Xn[Be]=Xn[st]=Xn[ct]=Xn[Ge]=Xn[qe]=Xn[ut]=Xn[lt]=Xn[dt]=Xn[pt]=Xn[ft]=Xn[Xe]=Xn[Ye]=Xn[Qe]=Xn[et]=Xn[tt]=Xn[nt]=Xn[rt]=Xn[ht]=Xn[mt]=Xn[vt]=Xn[gt]=!0,Xn[We]=Xn[ze]=Xn[ot]=!1;var Yn={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"},$n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Qn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Kn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Zn=parseFloat,er=parseInt,tr="object"==typeof e&&e&&e.Object===Object&&e,nr="object"==typeof self&&self&&self.Object===Object&&self,rr=tr||nr||Function("return this")(),ir="object"==typeof n&&n&&!n.nodeType&&n,or=ir&&"object"==typeof t&&t&&!t.nodeType&&t,ar=or&&or.exports===ir,sr=ar&&tr.process,cr=function(){try{var e=or&&or.require&&or.require("util").types;return e?e:sr&&sr.binding&&sr.binding("util")}catch(t){}}(),ur=cr&&cr.isArrayBuffer,lr=cr&&cr.isDate,dr=cr&&cr.isMap,pr=cr&&cr.isRegExp,fr=cr&&cr.isSet,hr=cr&&cr.isTypedArray,mr=E("length"),vr=R(Yn),gr=R($n),yr=R(Qn),_r=function br(e){function t(e){if(oc(e)&&!vp(e)&&!(e instanceof R)){if(e instanceof v)return e;if(vl.call(e,"__wrapped__"))return na(e)}return new v(e)}function n(){}function v(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=te}function R(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ke,this.__views__=[]}function X(){var e=new R(this.__wrapped__);return e.__actions__=ji(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ji(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ji(this.__views__),e}function K(){if(this.__filtered__){var e=new R(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Z(){var e=this.__wrapped__.value(),t=this.__dir__,n=vp(e),r=0>t,i=n?e.length:0,o=Po(0,i,this.__views__),a=o.start,s=o.end,c=s-a,u=r?s:a-1,l=this.__iteratees__,d=l.length,p=0,f=zl(c,this.__takeCount__);if(!n||!r&&i==c&&f==c)return _i(e,this.__actions__);var h=[];e:for(;c--&&f>p;){u+=t;for(var m=-1,v=e[u];++m<d;){var g=l[m],y=g.iteratee,_=g.type,S=y(v);if(_==Le)v=S;else if(!S){if(_==Te)continue e;break e}}h[p++]=v}return h}function Ut(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Qt(){this.__data__=nd?nd(null):{},this.size=0}function Kt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Zt(e){var t=this.__data__;if(nd){var n=t[e];return n===ae?te:n}return vl.call(t,e)?t[e]:te}function en(e){var t=this.__data__;return nd?t[e]!==te:vl.call(t,e)}function tn(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nd&&t===te?ae:t,this}function nn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function rn(){this.__data__=[],this.size=0}function on(e){var t=this.__data__,n=On(t,e);if(0>n)return!1;var r=t.length-1;return n==r?t.pop():Ol.call(t,n,1),--this.size,!0}function an(e){var t=this.__data__,n=On(t,e);return 0>n?te:t[n][1]}function sn(e){return On(this.__data__,e)>-1}function cn(e,t){var n=this.__data__,r=On(n,e);

return 0>r?(++this.size,n.push([e,t])):n[r][1]=t,this}function un(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ln(){this.size=0,this.__data__={hash:new Ut,map:new(Kl||nn),string:new Ut}}function dn(e){var t=Co(this,e)["delete"](e);return this.size-=t?1:0,t}function pn(e){return Co(this,e).get(e)}function fn(e){return Co(this,e).has(e)}function hn(e,t){var n=Co(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function mn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new un;++t<n;)this.add(e[t])}function vn(e){return this.__data__.set(e,ae),this}function gn(e){return this.__data__.has(e)}function yn(e){var t=this.__data__=new nn(e);this.size=t.size}function _n(){this.__data__=new nn,this.size=0}function Sn(e){var t=this.__data__,n=t["delete"](e);return this.size=t.size,n}function bn(e){return this.__data__.get(e)}function Cn(e){return this.__data__.has(e)}function wn(e,t){var n=this.__data__;if(n instanceof nn){var r=n.__data__;if(!Kl||r.length<re-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new un(r)}return n.set(e,t),this.size=n.size,this}function En(e,t){var n=vp(e),r=!n&&mp(e),i=!n&&!r&&yp(e),o=!n&&!r&&!i&&wp(e),a=n||r||i||o,s=a?L(e.length,ul):[],c=s.length;for(var u in e)!t&&!vl.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Do(u,c))||s.push(u);return s}function Rn(e){var t=e.length;return t?e[ei(0,t-1)]:te}function Pn(e,t){return Ko(ji(e),jn(t,0,e.length))}function xn(e){return Ko(ji(e))}function Tn(e,t,n){(n!==te&&!Ws(e[t],n)||n===te&&!(t in e))&&Dn(e,t,n)}function Ln(e,t,n){var r=e[t];vl.call(e,t)&&Ws(r,n)&&(n!==te||t in e)||Dn(e,t,n)}function On(e,t){for(var n=e.length;n--;)if(Ws(e[n][0],t))return n;return-1}function In(e,t,n,r){return hd(e,function(e,i,o){t(r,e,n(e),o)}),r}function Mn(e,t){return e&&Ni(t,Bc(t),e)}function An(e,t){return e&&Ni(t,Fc(t),e)}function Dn(e,t,n){"__proto__"==t&&Dl?Dl(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function kn(e,t){for(var n=-1,r=t.length,i=nl(r),o=null==e;++n<r;)i[n]=o?te:Nc(e,t[n]);return i}function jn(e,t,n){return e===e&&(n!==te&&(e=n>=e?e:n),t!==te&&(e=e>=t?e:t)),e}function Nn(e,t,n,r,i,a){var s,c=t&ue,u=t&le,l=t&de;if(n&&(s=i?n(e,r,i,a):n(e)),s!==te)return s;if(!ic(e))return e;var d=vp(e);if(d){if(s=Lo(e),!c)return ji(e,s)}else{var p=Pd(e),f=p==ze||p==He;if(yp(e))return Pi(e,c);if(p==Qe||p==Ue||f&&!i){if(s=u||f?{}:Oo(e),!c)return u?Ui(e,An(s,e)):Vi(e,Mn(s,e))}else{if(!Xn[p])return i?e:{};s=Io(e,p,c)}}a||(a=new yn);var h=a.get(e);if(h)return h;if(a.set(e,s),Cp(e))return e.forEach(function(r){s.add(Nn(r,t,n,r,e,a))}),s;if(Sp(e))return e.forEach(function(r,i){s.set(i,Nn(r,t,n,i,e,a))}),s;var m=l?u?yo:go:u?Fc:Bc,v=d?te:m(e);return o(v||e,function(r,i){v&&(i=r,r=e[i]),Ln(s,i,Nn(r,t,n,i,e,a))}),s}function Vn(e){var t=Bc(e);return function(n){return Fn(n,e,t)}}function Fn(e,t,n){var r=n.length;if(null==e)return!r;for(e=sl(e);r--;){var i=n[r],o=t[i],a=e[i];if(a===te&&!(i in e)||!o(a))return!1}return!0}function Gn(e,t,n){if("function"!=typeof e)throw new ll(oe);return Ld(function(){e.apply(te,n)},t)}function qn(e,t,n,r){var i=-1,o=u,a=!0,s=e.length,c=[],p=t.length;if(!s)return c;n&&(t=d(t,I(n))),r?(o=l,a=!1):t.length>=re&&(o=A,a=!1,t=new mn(t));e:for(;++i<s;){var f=e[i],h=null==n?f:n(f);if(f=r||0!==f?f:0,a&&h===h){for(var m=p;m--;)if(t[m]===h)continue e;c.push(f)}else o(t,h,r)||c.push(f)}return c}function Jn(e,t){var n=!0;return hd(e,function(e,r,i){return n=!!t(e,r,i)}),n}function Yn(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],a=t(o);if(null!=a&&(s===te?a===a&&!vc(a):n(a,s)))var s=a,c=o}return c}function $n(e,t,n,r){var i=e.length;for(n=Cc(n),0>n&&(n=-n>i?0:i+n),r=r===te||r>i?i:Cc(r),0>r&&(r+=i),r=n>r?0:wc(r);r>n;)e[n++]=t;return e}function Qn(e,t){var n=[];return hd(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function Kn(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=Ao),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?Kn(s,t-1,n,r,i):p(i,s):r||(i[i.length]=s)}return i}function tr(e,t){return e&&vd(e,t,Bc)}function nr(e,t){return e&&gd(e,t,Bc)}function ir(e,t){return c(t,function(t){return tc(e[t])})}function or(e,t){t=Ei(t,e);for(var n=0,r=t.length;null!=e&&r>n;)e=e[Zo(t[n++])];return n&&n==r?e:te}function sr(e,t,n){var r=t(e);return vp(e)?r:p(r,n(e))}function cr(e){return null==e?e===te?it:$e:Al&&Al in sl(e)?Ro(e):zo(e)}function mr(e,t){return e>t}function _r(e,t){return null!=e&&vl.call(e,t)}function Cr(e,t){return null!=e&&t in sl(e)}function wr(e,t,n){return e>=zl(t,n)&&e<Wl(t,n)}function Er(e,t,n){for(var r=n?l:u,i=e[0].length,o=e.length,a=o,s=nl(o),c=1/0,p=[];a--;){var f=e[a];a&&t&&(f=d(f,I(t))),c=zl(f.length,c),s[a]=!n&&(t||i>=120&&f.length>=120)?new mn(a&&f):te}f=e[0];var h=-1,m=s[0];e:for(;++h<i&&p.length<c;){var v=f[h],g=t?t(v):v;if(v=n||0!==v?v:0,!(m?A(m,g):r(p,g,n))){for(a=o;--a;){var y=s[a];if(!(y?A(y,g):r(e[a],g,n)))continue e}m&&m.push(g),p.push(v)}}return p}function Rr(e,t,n,r){return tr(e,function(e,i,o){t(r,n(e),i,o)}),r}function Pr(e,t,n){t=Ei(t,e),e=Xo(e,t);var i=null==e?e:e[Zo(ba(t))];return null==i?te:r(i,e,n)}function xr(e){return oc(e)&&cr(e)==Ue}function Tr(e){return oc(e)&&cr(e)==st}function Lr(e){return oc(e)&&cr(e)==qe}function Or(e,t,n,r,i){return e===t?!0:null==e||null==t||!oc(e)&&!oc(t)?e!==e&&t!==t:Ir(e,t,n,r,Or,i)}function Ir(e,t,n,r,i,o){var a=vp(e),s=vp(t),c=a?Be:Pd(e),u=s?Be:Pd(t);c=c==Ue?Qe:c,u=u==Ue?Qe:u;var l=c==Qe,d=u==Qe,p=c==u;if(p&&yp(e)){if(!yp(t))return!1;a=!0,l=!1}if(p&&!l)return o||(o=new yn),a||wp(e)?fo(e,t,n,r,i,o):ho(e,t,c,n,r,i,o);if(!(n&pe)){var f=l&&vl.call(e,"__wrapped__"),h=d&&vl.call(t,"__wrapped__");if(f||h){var m=f?e.value():e,v=h?t.value():t;return o||(o=new yn),i(m,v,n,r,o)}}return p?(o||(o=new yn),mo(e,t,n,r,i,o)):!1}function Mr(e){return oc(e)&&Pd(e)==Xe}function Ar(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=sl(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){s=n[i];var c=s[0],u=e[c],l=s[1];if(a&&s[2]){if(u===te&&!(c in e))return!1}else{var d=new yn;if(r)var p=r(u,l,c,e,t,d);if(!(p===te?Or(l,u,pe|fe,r,d):p))return!1}}return!0}function Dr(e){if(!ic(e)||Uo(e))return!1;var t=tc(e)?Cl:Wt;return t.test(ea(e))}function kr(e){return oc(e)&&cr(e)==et}function jr(e){return oc(e)&&Pd(e)==tt}function Nr(e){return oc(e)&&rc(e.length)&&!!Hn[cr(e)]}function Vr(e){return"function"==typeof e?e:null==e?Ou:"object"==typeof e?vp(e)?Jr(e[0],e[1]):qr(e):Vu(e)}function Ur(e){if(!Bo(e))return Jl(e);var t=[];for(var n in sl(e))vl.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Br(e){if(!ic(e))return Wo(e);var t=Bo(e),n=[];for(var r in e)("constructor"!=r||!t&&vl.call(e,r))&&n.push(r);return n}function Fr(e,t){return t>e}function Gr(e,t){var n=-1,r=zs(e)?nl(e.length):[];return hd(e,function(e,i,o){r[++n]=t(e,i,o)}),r}function qr(e){var t=wo(e);return 1==t.length&&t[0][2]?Go(t[0][0],t[0][1]):function(n){return n===e||Ar(n,e,t)}}function Jr(e,t){return jo(e)&&Fo(t)?Go(Zo(e),t):function(n){var r=Nc(n,e);return r===te&&r===t?Uc(n,e):Or(t,r,pe|fe)}}function Wr(e,t,n,r,i){e!==t&&vd(t,function(o,a){if(ic(o))i||(i=new yn),zr(e,t,a,n,Wr,r,i);else{var s=r?r(W(e,a),o,a+"",e,t,i):te;s===te&&(s=o),Tn(e,a,s)}},Fc)}function zr(e,t,n,r,i,o,a){var s=W(e,n),c=W(t,n),u=a.get(c);if(u)return void Tn(e,n,u);var l=o?o(s,c,n+"",e,t,a):te,d=l===te;if(d){var p=vp(c),f=!p&&yp(c),h=!p&&!f&&wp(c);l=c,p||f||h?vp(s)?l=s:Hs(s)?l=ji(s):f?(d=!1,l=Pi(c,!0)):h?(d=!1,l=Ii(c,!0)):l=[]:fc(c)||mp(c)?(l=s,mp(s)?l=Rc(s):(!ic(s)||r&&tc(s))&&(l=Oo(c))):d=!1}d&&(a.set(c,l),i(l,c,r,o,a),a["delete"](c)),Tn(e,n,l)}function Hr(e,t){var n=e.length;if(n)return t+=0>t?n:0,Do(t,n)?e[t]:te}function Xr(e,t,n){var r=-1;t=d(t.length?t:[Ou],I(bo()));var i=Gr(e,function(e,n,i){var o=d(t,function(t){return t(e)});return{criteria:o,index:++r,value:e}});return x(i,function(e,t){return Ai(e,t,n)})}function Yr(e,t){return $r(e,t,function(t,n){return Uc(e,n)})}function $r(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=or(e,a);n(s,a)&&ai(o,Ei(a,e),s)}return o}function Qr(e){return function(t){return or(t,e)}}function Kr(e,t,n,r){var i=r?b:S,o=-1,a=t.length,s=e;for(e===t&&(t=ji(t)),n&&(s=d(e,I(n)));++o<a;)for(var c=0,u=t[o],l=n?n(u):u;(c=i(s,l,c,r))>-1;)s!==e&&Ol.call(s,c,1),Ol.call(e,c,1);return e}function Zr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;Do(i)?Ol.call(e,i,1):vi(e,i)}}return e}function ei(e,t){return e+Ul(Yl()*(t-e+1))}function ti(e,t,n,r){for(var i=-1,o=Wl(Vl((t-e)/(n||1)),0),a=nl(o);o--;)a[r?o:++i]=e,e+=n;return a}function ni(e,t){var n="";if(!e||1>t||t>Me)return n;do t%2&&(n+=e),t=Ul(t/2),t&&(e+=e);while(t);return n}function ri(e,t){return Od(Ho(e,t,Ou),e+"")}function ii(e){return Rn(Zc(e))}function oi(e,t){var n=Zc(e);return Ko(n,jn(t,0,n.length))}function ai(e,t,n,r){if(!ic(e))return e;t=Ei(t,e);for(var i=-1,o=t.length,a=o-1,s=e;null!=s&&++i<o;){var c=Zo(t[i]),u=n;if(i!=a){var l=s[c];u=r?r(l,c,s):te,u===te&&(u=ic(l)?l:Do(t[i+1])?[]:{})}Ln(s,c,u),s=s[c]}return e}function si(e){return Ko(Zc(e))}function ci(e,t,n){var r=-1,i=e.length;0>t&&(t=-t>i?0:i+t),n=n>i?i:n,0>n&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=nl(i);++r<i;)o[r]=e[r+t];return o}function ui(e,t){var n;return hd(e,function(e,r,i){return n=t(e,r,i),!n}),!!n}function li(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t===t&&Ne>=i){for(;i>r;){var o=r+i>>>1,a=e[o];null!==a&&!vc(a)&&(n?t>=a:t>a)?r=o+1:i=o}return i}return di(e,t,Ou,n)}function di(e,t,n,r){t=n(t);for(var i=0,o=null==e?0:e.length,a=t!==t,s=null===t,c=vc(t),u=t===te;o>i;){var l=Ul((i+o)/2),d=n(e[l]),p=d!==te,f=null===d,h=d===d,m=vc(d);if(a)var v=r||h;else v=u?h&&(r||p):s?h&&p&&(r||!f):c?h&&p&&!f&&(r||!m):f||m?!1:r?t>=d:t>d;v?i=l+1:o=l}return zl(o,je)}function pi(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!Ws(s,c)){var c=s;o[i++]=0===a?0:a}}return o}function fi(e){return"number"==typeof e?e:vc(e)?De:+e}function hi(e){if("string"==typeof e)return e;if(vp(e))return d(e,hi)+"";if(vc(e))return pd?pd.call(e):"";var t=e+"";return"0"==t&&1/e==-Ie?"-0":t}function mi(e,t,n){var r=-1,i=u,o=e.length,a=!0,s=[],c=s;if(n)a=!1,i=l;else if(o>=re){var d=t?null:Cd(e);if(d)return z(d);a=!1,i=A,c=new mn}else c=t?[]:s;e:for(;++r<o;){var p=e[r],f=t?t(p):p;if(p=n||0!==p?p:0,a&&f===f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),s.push(p)}else i(c,f,n)||(c!==s&&c.push(f),s.push(p))}return s}function vi(e,t){return t=Ei(t,e),e=Xo(e,t),null==e||delete e[Zo(ba(t))]}function gi(e,t,n,r){return ai(e,t,n(or(e,t)),r)}function yi(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ci(e,r?0:o,r?o+1:i):ci(e,r?o+1:0,r?i:o)}function _i(e,t){var n=e;return n instanceof R&&(n=n.value()),f(t,function(e,t){return t.func.apply(t.thisArg,p([e],t.args))},n)}function Si(e,t,n){var r=e.length;if(2>r)return r?mi(e[0]):[];for(var i=-1,o=nl(r);++i<r;)for(var a=e[i],s=-1;++s<r;)s!=i&&(o[i]=qn(o[i]||a,e[s],t,n));return mi(Kn(o,1),t,n)}function bi(e,t,n){for(var r=-1,i=e.length,o=t.length,a={};++r<i;){var s=o>r?t[r]:te;n(a,e[r],s)}return a}function Ci(e){return Hs(e)?e:[]}function wi(e){return"function"==typeof e?e:Ou}function Ei(e,t){return vp(e)?e:jo(e,t)?[e]:Id(xc(e))}function Ri(e,t,n){var r=e.length;return n=n===te?r:n,!t&&n>=r?e:ci(e,t,n)}function Pi(e,t){if(t)return e.slice();var n=e.length,r=Pl?Pl(n):new e.constructor(n);return e.copy(r),r}function xi(e){var t=new e.constructor(e.byteLength);return new Rl(t).set(new Rl(e)),t}function Ti(e,t){var n=t?xi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Li(e){var t=new e.constructor(e.source,Gt.exec(e));return t.lastIndex=e.lastIndex,t}function Oi(e){return dd?sl(dd.call(e)):{}}function Ii(e,t){var n=t?xi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Mi(e,t){if(e!==t){var n=e!==te,r=null===e,i=e===e,o=vc(e),a=t!==te,s=null===t,c=t===t,u=vc(t);if(!s&&!u&&!o&&e>t||o&&a&&c&&!s&&!u||r&&a&&c||!n&&c||!i)return 1;if(!r&&!o&&!u&&t>e||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!c)return-1}return 0}function Ai(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var c=Mi(i[r],o[r]);if(c){if(r>=s)return c;var u=n[r];return c*("desc"==u?-1:1)}}return e.index-t.index}function Di(e,t,n,r){for(var i=-1,o=e.length,a=n.length,s=-1,c=t.length,u=Wl(o-a,0),l=nl(c+u),d=!r;++s<c;)l[s]=t[s];for(;++i<a;)(d||o>i)&&(l[n[i]]=e[i]);for(;u--;)l[s++]=e[i++];return l}function ki(e,t,n,r){for(var i=-1,o=e.length,a=-1,s=n.length,c=-1,u=t.length,l=Wl(o-s,0),d=nl(l+u),p=!r;++i<l;)d[i]=e[i];for(var f=i;++c<u;)d[f+c]=t[c];for(;++a<s;)(p||o>i)&&(d[f+n[a]]=e[i++]);return d}function ji(e,t){var n=-1,r=e.length;for(t||(t=nl(r));++n<r;)t[n]=e[n];return t}function Ni(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):te;c===te&&(c=e[s]),i?Dn(n,s,c):Ln(n,s,c)}return n}function Vi(e,t){return Ni(e,Ed(e),t)}function Ui(e,t){return Ni(e,Rd(e),t)}function Bi(e,t){return function(n,r){var o=vp(n)?i:In,a=t?t():{};return o(n,e,bo(r,2),a)}}function Fi(e){return ri(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:te,a=i>2?n[2]:te;for(o=e.length>3&&"function"==typeof o?(i--,o):te,a&&ko(n[0],n[1],a)&&(o=3>i?te:o,i=1),t=sl(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t})}function Gi(e,t){return function(n,r){if(null==n)return n;if(!zs(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=sl(n);(t?o--:++o<i)&&r(a[o],o,a)!==!1;);return n}}function qi(e){return function(t,n,r){for(var i=-1,o=sl(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(n(o[c],c,o)===!1)break}return t}}function Ji(e,t,n){function r(){var t=this&&this!==rr&&this instanceof r?o:e;return t.apply(i?n:this,arguments)}var i=t&he,o=Hi(e);return r}function Wi(e){return function(t){t=xc(t);var n=U(t)?Q(t):te,r=n?n[0]:t.charAt(0),i=n?Ri(n,1).join(""):t.slice(1);return r[e]()+i}}function zi(e){return function(t){return f(Ru(ou(t).replace(Un,"")),e,"")}}function Hi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=fd(e.prototype),r=e.apply(n,t);return ic(r)?r:n}}function Xi(e,t,n){function i(){for(var a=arguments.length,s=nl(a),c=a,u=So(i);c--;)s[c]=arguments[c];var l=3>a&&s[0]!==u&&s[a-1]!==u?[]:J(s,u);if(a-=l.length,n>a)return oo(e,t,Qi,i.placeholder,te,s,l,te,te,n-a);var d=this&&this!==rr&&this instanceof i?o:e;return r(d,this,s)}var o=Hi(e);return i}function Yi(e){return function(t,n,r){var i=sl(t);if(!zs(t)){var o=bo(n,3);t=Bc(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:te}}function $i(e){return vo(function(t){var n=t.length,r=n,i=v.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if("function"!=typeof o)throw new ll(oe);if(i&&!a&&"wrapper"==_o(o))var a=new v([],!0)}for(r=a?r:n;++r<n;){o=t[r];var s=_o(o),c="wrapper"==s?wd(o):te;a=c&&Vo(c[0])&&c[1]==(be|ge|_e|Ce)&&!c[4].length&&1==c[9]?a[_o(c[0])].apply(a,c[3]):1==o.length&&Vo(o)?a[s]():a.thru(o)}return function(){var e=arguments,r=e[0];if(a&&1==e.length&&vp(r))return a.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}})}function Qi(e,t,n,r,i,o,a,s,c,u){function l(){for(var g=arguments.length,y=nl(g),_=g;_--;)y[_]=arguments[_];if(h)var S=So(l),b=j(y,S);if(r&&(y=Di(y,r,i,h)),o&&(y=ki(y,o,a,h)),g-=b,h&&u>g){var C=J(y,S);return oo(e,t,Qi,l.placeholder,n,y,C,s,c,u-g)}var w=p?n:this,E=f?w[e]:e;return g=y.length,s?y=Yo(y,s):m&&g>1&&y.reverse(),d&&g>c&&(y.length=c),this&&this!==rr&&this instanceof l&&(E=v||Hi(E)),E.apply(w,y)}var d=t&be,p=t&he,f=t&me,h=t&(ge|ye),m=t&we,v=f?te:Hi(e);return l}function Ki(e,t){return function(n,r){return Rr(n,e,t(r),{})}}function Zi(e,t){return function(n,r){var i;if(n===te&&r===te)return t;if(n!==te&&(i=n),r!==te){if(i===te)return r;"string"==typeof n||"string"==typeof r?(n=hi(n),r=hi(r)):(n=fi(n),r=fi(r)),i=e(n,r)}return i}}function eo(e){return vo(function(t){return t=d(t,I(bo())),ri(function(n){var i=this;return e(t,function(e){return r(e,i,n)})})})}function to(e,t){t=t===te?" ":hi(t);var n=t.length;if(2>n)return n?ni(t,e):t;var r=ni(t,Vl(e/$(t)));return U(t)?Ri(Q(r),0,e).join(""):r.slice(0,e)}function no(e,t,n,i){function o(){for(var t=-1,c=arguments.length,u=-1,l=i.length,d=nl(l+c),p=this&&this!==rr&&this instanceof o?s:e;++u<l;)d[u]=i[u];for(;c--;)d[u++]=arguments[++t];return r(p,a?n:this,d)}var a=t&he,s=Hi(e);return o}function ro(e){return function(t,n,r){return r&&"number"!=typeof r&&ko(t,n,r)&&(n=r=te),t=bc(t),n===te?(n=t,t=0):n=bc(n),r=r===te?n>t?1:-1:bc(r),ti(t,n,r,e)}}function io(e){return function(t,n){return("string"!=typeof t||"string"!=typeof n)&&(t=Ec(t),n=Ec(n)),e(t,n)}}function oo(e,t,n,r,i,o,a,s,c,u){var l=t&ge,d=l?a:te,p=l?te:a,f=l?o:te,h=l?te:o;t|=l?_e:Se,t&=~(l?Se:_e),t&ve||(t&=~(he|me));var m=[e,t,i,f,d,h,p,s,c,u],v=n.apply(te,m);return Vo(e)&&Td(v,m),v.placeholder=r,$o(v,e,t)}function ao(e){var t=al[e];return function(e,n){if(e=Ec(e),n=null==n?0:zl(Cc(n),292)){var r=(xc(e)+"e").split("e"),i=t(r[0]+"e"+(+r[1]+n));return r=(xc(i)+"e").split("e"),+(r[0]+"e"+(+r[1]-n))}return t(e)}}function so(e){return function(t){var n=Pd(t);return n==Xe?G(t):n==tt?H(t):O(t,e(t))}}function co(e,t,n,r,i,o,a,s){var c=t&me;if(!c&&"function"!=typeof e)throw new ll(oe);var u=r?r.length:0;if(u||(t&=~(_e|Se),r=i=te),a=a===te?a:Wl(Cc(a),0),s=s===te?s:Cc(s),u-=i?i.length:0,t&Se){var l=r,d=i;r=i=te}var p=c?te:wd(e),f=[e,t,n,r,i,l,d,o,a,s];if(p&&Jo(f,p),e=f[0],t=f[1],n=f[2],r=f[3],i=f[4],s=f[9]=f[9]===te?c?0:e.length:Wl(f[9]-u,0),!s&&t&(ge|ye)&&(t&=~(ge|ye)),t&&t!=he)h=t==ge||t==ye?Xi(e,t,s):t!=_e&&t!=(he|_e)||i.length?Qi.apply(te,f):no(e,t,n,r);else var h=Ji(e,t,n);var m=p?yd:Td;return $o(m(h,f),e,t)}function uo(e,t,n,r){return e===te||Ws(e,fl[n])&&!vl.call(r,n)?t:e}function lo(e,t,n,r,i,o){return ic(e)&&ic(t)&&(o.set(t,e),Wr(e,t,te,lo,o),o["delete"](t)),e}function po(e){return fc(e)?te:e}function fo(e,t,n,r,i,o){var a=n&pe,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var l=-1,d=!0,p=n&fe?new mn:te;for(o.set(e,t),o.set(t,e);++l<s;){var f=e[l],h=t[l];if(r)var v=a?r(h,f,l,t,e,o):r(f,h,l,e,t,o);if(v!==te){if(v)continue;d=!1;break}if(p){if(!m(t,function(e,t){return A(p,t)||f!==e&&!i(f,e,n,r,o)?void 0:p.push(t)})){d=!1;break}}else if(f!==h&&!i(f,h,n,r,o)){d=!1;break}}return o["delete"](e),o["delete"](t),d}function ho(e,t,n,r,i,o,a){switch(n){case ct:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case st:return e.byteLength==t.byteLength&&o(new Rl(e),new Rl(t))?!0:!1;case Ge:case qe:case Ye:return Ws(+e,+t);case We:return e.name==t.name&&e.message==t.message;case et:case nt:return e==t+"";case Xe:var s=G;case tt:var c=r&pe;if(s||(s=z),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;r|=fe,a.set(e,t);var l=fo(s(e),s(t),r,i,o,a);return a["delete"](e),l;case rt:if(dd)return dd.call(e)==dd.call(t)}return!1}function mo(e,t,n,r,i,o){var a=n&pe,s=go(e),c=s.length,u=go(t),l=u.length;if(c!=l&&!a)return!1;for(var d=c;d--;){var p=s[d];if(!(a?p in t:vl.call(t,p)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var h=!0;o.set(e,t),o.set(t,e);for(var m=a;++d<c;){p=s[d];var v=e[p],g=t[p];if(r)var y=a?r(g,v,p,t,e,o):r(v,g,p,e,t,o);if(!(y===te?v===g||i(v,g,n,r,o):y)){h=!1;break}m||(m="constructor"==p)}if(h&&!m){var _=e.constructor,S=t.constructor;_!=S&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof S&&S instanceof S)&&(h=!1)}return o["delete"](e),o["delete"](t),h}function vo(e){return Od(Ho(e,te,fa),e+"")}function go(e){return sr(e,Bc,Ed)}function yo(e){return sr(e,Fc,Rd)}function _o(e){for(var t=e.name+"",n=id[t],r=vl.call(id,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function So(e){var n=vl.call(t,"placeholder")?t:e;return n.placeholder}function bo(){var e=t.iteratee||Iu;return e=e===Iu?Vr:e,arguments.length?e(arguments[0],arguments[1]):e}function Co(e,t){var n=e.__data__;return No(t)?n["string"==typeof t?"string":"hash"]:n.map}function wo(e){for(var t=Bc(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Fo(i)]}return t}function Eo(e,t){var n=V(e,t);return Dr(n)?n:te}function Ro(e){var t=vl.call(e,Al),n=e[Al];try{e[Al]=te;var r=!0}catch(i){}var o=_l.call(e);return r&&(t?e[Al]=n:delete e[Al]),o}function Po(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=zl(t,e+a);break;case"takeRight":e=Wl(e,t-a)}}return{start:e,end:t}}function xo(e){var t=e.match(Nt);return t?t[1].split(Vt):[]}function To(e,t,n){t=Ei(t,e);for(var r=-1,i=t.length,o=!1;++r<i;){var a=Zo(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:(i=null==e?0:e.length,!!i&&rc(i)&&Do(a,i)&&(vp(e)||mp(e)))}function Lo(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&vl.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Oo(e){return"function"!=typeof e.constructor||Bo(e)?{}:fd(xl(e))}function Io(e,t,n){var r=e.constructor;switch(t){case st:return xi(e);case Ge:case qe:return new r(+e);case ct:return Ti(e,n);case ut:case lt:case dt:case pt:case ft:case ht:case mt:case vt:case gt:return Ii(e,n);case Xe:return new r;case Ye:case nt:return new r(e);case et:return Li(e);case tt:return new r;case rt:return Oi(e)}}function Mo(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(jt,"{\n/* [wrapped with "+t+"] */\n")}function Ao(e){return vp(e)||mp(e)||!!(Il&&e&&e[Il])}function Do(e,t){var n=typeof e;return t=null==t?Me:t,!!t&&("number"==n||"symbol"!=n&&Ht.test(e))&&e>-1&&e%1==0&&t>e}function ko(e,t,n){if(!ic(n))return!1;var r=typeof t;return("number"==r?zs(n)&&Do(t,n.length):"string"==r&&t in n)?Ws(n[t],e):!1}function jo(e,t){if(vp(e))return!1;var n=typeof e;return"number"==n||"symbol"==n||"boolean"==n||null==e||vc(e)?!0:Lt.test(e)||!Tt.test(e)||null!=t&&e in sl(t)}function No(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function Vo(e){var n=_o(e),r=t[n];if("function"!=typeof r||!(n in R.prototype))return!1;if(e===r)return!0;var i=wd(r);return!!i&&e===i[0]}function Uo(e){return!!yl&&yl in e}function Bo(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||fl;return e===n}function Fo(e){return e===e&&!ic(e)}function Go(e,t){return function(n){return null==n?!1:n[e]===t&&(t!==te||e in sl(n))}}function qo(e){var t=Is(e,function(e){return n.size===se&&n.clear(),e}),n=t.cache;return t}function Jo(e,t){var n=e[1],r=t[1],i=n|r,o=(he|me|be)>i,a=r==be&&n==ge||r==be&&n==Ce&&e[7].length<=t[8]||r==(be|Ce)&&t[7].length<=t[8]&&n==ge;if(!o&&!a)return e;r&he&&(e[2]=t[2],i|=n&he?0:ve);var s=t[3];if(s){var c=e[3];e[3]=c?Di(c,s,t[4]):s,e[4]=c?J(e[3],ce):t[4]}return s=t[5],s&&(c=e[5],e[5]=c?ki(c,s,t[6]):s,e[6]=c?J(e[5],ce):t[6]),s=t[7],s&&(e[7]=s),r&be&&(e[8]=null==e[8]?t[8]:zl(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e}function Wo(e){var t=[];if(null!=e)for(var n in sl(e))t.push(n);return t}function zo(e){return _l.call(e)}function Ho(e,t,n){return t=Wl(t===te?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=Wl(i.length-t,0),s=nl(a);++o<a;)s[o]=i[t+o];o=-1;for(var c=nl(t+1);++o<t;)c[o]=i[o];return c[t]=n(s),r(e,this,c)}}function Xo(e,t){return t.length<2?e:or(e,ci(t,0,-1))}function Yo(e,t){for(var n=e.length,r=zl(t.length,n),i=ji(e);r--;){var o=t[r];e[r]=Do(o,n)?i[o]:te}return e}function $o(e,t,n){var r=t+"";return Od(e,Mo(r,ta(xo(r),n)))}function Qo(e){var t=0,n=0;return function(){var r=Hl(),i=xe-(r-n);if(n=r,i>0){if(++t>=Pe)return arguments[0]}else t=0;return e.apply(te,arguments)}}function Ko(e,t){var n=-1,r=e.length,i=r-1;for(t=t===te?r:t;++n<t;){var o=ei(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}function Zo(e){if("string"==typeof e||vc(e))return e;var t=e+"";return"0"==t&&1/e==-Ie?"-0":t}function ea(e){if(null!=e){try{return ml.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function ta(e,t){return o(Ve,function(n){var r="_."+n[0];t&n[1]&&!u(e,r)&&e.push(r)}),e.sort()}function na(e){if(e instanceof R)return e.clone();var t=new v(e.__wrapped__,e.__chain__);return t.__actions__=ji(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function ra(e,t,n){t=(n?ko(e,t,n):t===te)?1:Wl(Cc(t),0);var r=null==e?0:e.length;if(!r||1>t)return[];for(var i=0,o=0,a=nl(Vl(r/t));r>i;)a[o++]=ci(e,i,i+=t);return a}function ia(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i}function oa(){var e=arguments.length;if(!e)return[];for(var t=nl(e-1),n=arguments[0],r=e;r--;)t[r-1]=arguments[r];return p(vp(n)?ji(n):[n],Kn(t,1))}function aa(e,t,n){var r=null==e?0:e.length;return r?(t=n||t===te?1:Cc(t),ci(e,0>t?0:t,r)):[]}function sa(e,t,n){var r=null==e?0:e.length;return r?(t=n||t===te?1:Cc(t),t=r-t,ci(e,0,0>t?0:t)):[]}function ca(e,t){return e&&e.length?yi(e,bo(t,3),!0,!0):[]}function ua(e,t){return e&&e.length?yi(e,bo(t,3),!0):[]}function la(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&ko(e,t,n)&&(n=0,r=i),$n(e,t,n,r)):[]}function da(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Cc(n);return 0>i&&(i=Wl(r+i,0)),_(e,bo(t,3),i)}function pa(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return n!==te&&(i=Cc(n),i=0>n?Wl(r+i,0):zl(i,r-1)),_(e,bo(t,3),i,!0)}function fa(e){var t=null==e?0:e.length;return t?Kn(e,1):[]}function ha(e){var t=null==e?0:e.length;return t?Kn(e,Ie):[]}function ma(e,t){var n=null==e?0:e.length;return n?(t=t===te?1:Cc(t),Kn(e,t)):[]}function va(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r}function ga(e){return e&&e.length?e[0]:te}function ya(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Cc(n);return 0>i&&(i=Wl(r+i,0)),S(e,t,i)}function _a(e){var t=null==e?0:e.length;return t?ci(e,0,-1):[]}function Sa(e,t){return null==e?"":ql.call(e,t)}function ba(e){var t=null==e?0:e.length;return t?e[t-1]:te}function Ca(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return n!==te&&(i=Cc(n),i=0>i?Wl(r+i,0):zl(i,r-1)),t===t?Y(e,t,i):_(e,C,i,!0)}function wa(e,t){return e&&e.length?Hr(e,Cc(t)):te}function Ea(e,t){return e&&e.length&&t&&t.length?Kr(e,t):e}function Ra(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,bo(n,2)):e}function Pa(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,te,n):e}function xa(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=bo(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return Zr(e,i),n}function Ta(e){return null==e?e:$l.call(e)}function La(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&ko(e,t,n)?(t=0,n=r):(t=null==t?0:Cc(t),n=n===te?r:Cc(n)),ci(e,t,n)):[]}function Oa(e,t){return li(e,t)}function Ia(e,t,n){return di(e,t,bo(n,2))}function Ma(e,t){var n=null==e?0:e.length;if(n){var r=li(e,t);if(n>r&&Ws(e[r],t))return r}return-1}function Aa(e,t){return li(e,t,!0)}function Da(e,t,n){return di(e,t,bo(n,2),!0)}function ka(e,t){var n=null==e?0:e.length;if(n){var r=li(e,t,!0)-1;if(Ws(e[r],t))return r}return-1}function ja(e){return e&&e.length?pi(e):[]}function Na(e,t){return e&&e.length?pi(e,bo(t,2)):[]}function Va(e){var t=null==e?0:e.length;return t?ci(e,1,t):[]}function Ua(e,t,n){return e&&e.length?(t=n||t===te?1:Cc(t),ci(e,0,0>t?0:t)):[]}function Ba(e,t,n){var r=null==e?0:e.length;return r?(t=n||t===te?1:Cc(t),t=r-t,ci(e,0>t?0:t,r)):[]}function Fa(e,t){return e&&e.length?yi(e,bo(t,3),!1,!0):[]}function Ga(e,t){return e&&e.length?yi(e,bo(t,3)):[]}function qa(e){return e&&e.length?mi(e):[]}function Ja(e,t){return e&&e.length?mi(e,bo(t,2)):[]}function Wa(e,t){return t="function"==typeof t?t:te,e&&e.length?mi(e,te,t):[]}function za(e){if(!e||!e.length)return[];var t=0;return e=c(e,function(e){return Hs(e)?(t=Wl(e.length,t),!0):void 0}),L(t,function(t){return d(e,E(t))})}function Ha(e,t){if(!e||!e.length)return[];var n=za(e);return null==t?n:d(n,function(e){return r(t,te,e)})}function Xa(e,t){return bi(e||[],t||[],Ln)}function Ya(e,t){return bi(e||[],t||[],ai)}function $a(e){var n=t(e);return n.__chain__=!0,n}function Qa(e,t){return t(e),e}function Ka(e,t){return t(e)}function Za(){return $a(this)}function es(){return new v(this.value(),this.__chain__)}function ts(){this.__values__===te&&(this.__values__=Sc(this.value()));var e=this.__index__>=this.__values__.length,t=e?te:this.__values__[this.__index__++];return{done:e,value:t}}function ns(){return this}function rs(e){for(var t,r=this;r instanceof n;){var i=na(r);i.__index__=0,i.__values__=te,t?o.__wrapped__=i:t=i;var o=i;r=r.__wrapped__}return o.__wrapped__=e,t}function is(){var e=this.__wrapped__;if(e instanceof R){var t=e;return this.__actions__.length&&(t=new R(this)),t=t.reverse(),t.__actions__.push({func:Ka,args:[Ta],thisArg:te}),new v(t,this.__chain__)}return this.thru(Ta)}function os(){return _i(this.__wrapped__,this.__actions__)}function as(e,t,n){var r=vp(e)?s:Jn;return n&&ko(e,t,n)&&(t=te),r(e,bo(t,3))}function ss(e,t){var n=vp(e)?c:Qn;return n(e,bo(t,3))}function cs(e,t){return Kn(hs(e,t),1)}function us(e,t){return Kn(hs(e,t),Ie)}function ls(e,t,n){return n=n===te?1:Cc(n),Kn(hs(e,t),n)}function ds(e,t){var n=vp(e)?o:hd;return n(e,bo(t,3))}function ps(e,t){var n=vp(e)?a:md;return n(e,bo(t,3))}function fs(e,t,n,r){e=zs(e)?e:Zc(e),n=n&&!r?Cc(n):0;var i=e.length;return 0>n&&(n=Wl(i+n,0)),mc(e)?i>=n&&e.indexOf(t,n)>-1:!!i&&S(e,t,n)>-1}function hs(e,t){var n=vp(e)?d:Gr;return n(e,bo(t,3))}function ms(e,t,n,r){return null==e?[]:(vp(t)||(t=null==t?[]:[t]),n=r?te:n,vp(n)||(n=null==n?[]:[n]),Xr(e,t,n))}function vs(e,t,n){var r=vp(e)?f:P,i=arguments.length<3;return r(e,bo(t,4),n,i,hd)}function gs(e,t,n){var r=vp(e)?h:P,i=arguments.length<3;return r(e,bo(t,4),n,i,md)}function ys(e,t){var n=vp(e)?c:Qn;return n(e,Ms(bo(t,3)))}function _s(e){var t=vp(e)?Rn:ii;return t(e)}function Ss(e,t,n){t=(n?ko(e,t,n):t===te)?1:Cc(t);var r=vp(e)?Pn:oi;return r(e,t)}function bs(e){var t=vp(e)?xn:si;return t(e)}function Cs(e){if(null==e)return 0;if(zs(e))return mc(e)?$(e):e.length;var t=Pd(e);return t==Xe||t==tt?e.size:Ur(e).length}function ws(e,t,n){var r=vp(e)?m:ui;return n&&ko(e,t,n)&&(t=te),r(e,bo(t,3))}function Es(e,t){if("function"!=typeof t)throw new ll(oe);return e=Cc(e),function(){return--e<1?t.apply(this,arguments):void 0}}function Rs(e,t,n){return t=n?te:t,t=e&&null==t?e.length:t,co(e,be,te,te,te,te,t)}function Ps(e,t){var n;if("function"!=typeof t)throw new ll(oe);return e=Cc(e),function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=te),n}}function xs(e,t,n){t=n?te:t;var r=co(e,ge,te,te,te,te,te,t);return r.placeholder=xs.placeholder,r}function Ts(e,t,n){t=n?te:t;var r=co(e,ye,te,te,te,te,te,t);return r.placeholder=Ts.placeholder,r}function Ls(e,t,n){function r(t){var n=p,r=f;return p=f=te,y=t,m=e.apply(r,n)}function i(e){return y=e,v=Ld(s,t),_?r(e):m}function o(e){var n=e-g,r=e-y,i=t-n;return S?zl(i,h-r):i}function a(e){var n=e-g,r=e-y;return g===te||n>=t||0>n||S&&r>=h}function s(){var e=ip();return a(e)?c(e):void(v=Ld(s,o(e)))}function c(e){return v=te,b&&p?r(e):(p=f=te,m)}function u(){v!==te&&bd(v),y=0,p=g=f=v=te}function l(){return v===te?m:c(ip())}function d(){var e=ip(),n=a(e);if(p=arguments,f=this,g=e,n){if(v===te)return i(g);if(S)return v=Ld(s,t),r(g)}return v===te&&(v=Ld(s,t)),m}var p,f,h,m,v,g,y=0,_=!1,S=!1,b=!0;if("function"!=typeof e)throw new ll(oe);return t=Ec(t)||0,ic(n)&&(_=!!n.leading,S="maxWait"in n,h=S?Wl(Ec(n.maxWait)||0,t):h,b="trailing"in n?!!n.trailing:b),d.cancel=u,d.flush=l,d}function Os(e){return co(e,we)}function Is(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ll(oe);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Is.Cache||un),
n}function Ms(e){if("function"!=typeof e)throw new ll(oe);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function As(e){return Ps(2,e)}function Ds(e,t){if("function"!=typeof e)throw new ll(oe);return t=t===te?t:Cc(t),ri(e,t)}function ks(e,t){if("function"!=typeof e)throw new ll(oe);return t=null==t?0:Wl(Cc(t),0),ri(function(n){var i=n[t],o=Ri(n,0,t);return i&&p(o,i),r(e,this,o)})}function js(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new ll(oe);return ic(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ls(e,t,{leading:r,maxWait:t,trailing:i})}function Ns(e){return Rs(e,1)}function Vs(e,t){return lp(wi(t),e)}function Us(){if(!arguments.length)return[];var e=arguments[0];return vp(e)?e:[e]}function Bs(e){return Nn(e,de)}function Fs(e,t){return t="function"==typeof t?t:te,Nn(e,de,t)}function Gs(e){return Nn(e,ue|de)}function qs(e,t){return t="function"==typeof t?t:te,Nn(e,ue|de,t)}function Js(e,t){return null==t||Fn(e,t,Bc(t))}function Ws(e,t){return e===t||e!==e&&t!==t}function zs(e){return null!=e&&rc(e.length)&&!tc(e)}function Hs(e){return oc(e)&&zs(e)}function Xs(e){return e===!0||e===!1||oc(e)&&cr(e)==Ge}function Ys(e){return oc(e)&&1===e.nodeType&&!fc(e)}function $s(e){if(null==e)return!0;if(zs(e)&&(vp(e)||"string"==typeof e||"function"==typeof e.splice||yp(e)||wp(e)||mp(e)))return!e.length;var t=Pd(e);if(t==Xe||t==tt)return!e.size;if(Bo(e))return!Ur(e).length;for(var n in e)if(vl.call(e,n))return!1;return!0}function Qs(e,t){return Or(e,t)}function Ks(e,t,n){n="function"==typeof n?n:te;var r=n?n(e,t):te;return r===te?Or(e,t,te,n):!!r}function Zs(e){if(!oc(e))return!1;var t=cr(e);return t==We||t==Je||"string"==typeof e.message&&"string"==typeof e.name&&!fc(e)}function ec(e){return"number"==typeof e&&Gl(e)}function tc(e){if(!ic(e))return!1;var t=cr(e);return t==ze||t==He||t==Fe||t==Ze}function nc(e){return"number"==typeof e&&e==Cc(e)}function rc(e){return"number"==typeof e&&e>-1&&e%1==0&&Me>=e}function ic(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function oc(e){return null!=e&&"object"==typeof e}function ac(e,t){return e===t||Ar(e,t,wo(t))}function sc(e,t,n){return n="function"==typeof n?n:te,Ar(e,t,wo(t),n)}function cc(e){return pc(e)&&e!=+e}function uc(e){if(xd(e))throw new il(ie);return Dr(e)}function lc(e){return null===e}function dc(e){return null==e}function pc(e){return"number"==typeof e||oc(e)&&cr(e)==Ye}function fc(e){if(!oc(e)||cr(e)!=Qe)return!1;var t=xl(e);if(null===t)return!0;var n=vl.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&ml.call(n)==Sl}function hc(e){return nc(e)&&e>=-Me&&Me>=e}function mc(e){return"string"==typeof e||!vp(e)&&oc(e)&&cr(e)==nt}function vc(e){return"symbol"==typeof e||oc(e)&&cr(e)==rt}function gc(e){return e===te}function yc(e){return oc(e)&&Pd(e)==ot}function _c(e){return oc(e)&&cr(e)==at}function Sc(e){if(!e)return[];if(zs(e))return mc(e)?Q(e):ji(e);if(Ml&&e[Ml])return F(e[Ml]());var t=Pd(e),n=t==Xe?G:t==tt?z:Zc;return n(e)}function bc(e){if(!e)return 0===e?e:0;if(e=Ec(e),e===Ie||e===-Ie){var t=0>e?-1:1;return t*Ae}return e===e?e:0}function Cc(e){var t=bc(e),n=t%1;return t===t?n?t-n:t:0}function wc(e){return e?jn(Cc(e),0,ke):0}function Ec(e){if("number"==typeof e)return e;if(vc(e))return De;if(ic(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ic(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(At,"");var n=Jt.test(e);return n||zt.test(e)?er(e.slice(2),n?2:8):qt.test(e)?De:+e}function Rc(e){return Ni(e,Fc(e))}function Pc(e){return e?jn(Cc(e),-Me,Me):0===e?e:0}function xc(e){return null==e?"":hi(e)}function Tc(e,t){var n=fd(e);return null==t?n:Mn(n,t)}function Lc(e,t){return y(e,bo(t,3),tr)}function Oc(e,t){return y(e,bo(t,3),nr)}function Ic(e,t){return null==e?e:vd(e,bo(t,3),Fc)}function Mc(e,t){return null==e?e:gd(e,bo(t,3),Fc)}function Ac(e,t){return e&&tr(e,bo(t,3))}function Dc(e,t){return e&&nr(e,bo(t,3))}function kc(e){return null==e?[]:ir(e,Bc(e))}function jc(e){return null==e?[]:ir(e,Fc(e))}function Nc(e,t,n){var r=null==e?te:or(e,t);return r===te?n:r}function Vc(e,t){return null!=e&&To(e,t,_r)}function Uc(e,t){return null!=e&&To(e,t,Cr)}function Bc(e){return zs(e)?En(e):Ur(e)}function Fc(e){return zs(e)?En(e,!0):Br(e)}function Gc(e,t){var n={};return t=bo(t,3),tr(e,function(e,r,i){Dn(n,t(e,r,i),e)}),n}function qc(e,t){var n={};return t=bo(t,3),tr(e,function(e,r,i){Dn(n,r,t(e,r,i))}),n}function Jc(e,t){return Wc(e,Ms(bo(t)))}function Wc(e,t){if(null==e)return{};var n=d(yo(e),function(e){return[e]});return t=bo(t),$r(e,n,function(e,n){return t(e,n[0])})}function zc(e,t,n){t=Ei(t,e);var r=-1,i=t.length;for(i||(i=1,e=te);++r<i;){var o=null==e?te:e[Zo(t[r])];o===te&&(r=i,o=n),e=tc(o)?o.call(e):o}return e}function Hc(e,t,n){return null==e?e:ai(e,t,n)}function Xc(e,t,n,r){return r="function"==typeof r?r:te,null==e?e:ai(e,t,n,r)}function Yc(e,t,n){var r=vp(e),i=r||yp(e)||wp(e);if(t=bo(t,4),null==n){var a=e&&e.constructor;n=i?r?new a:[]:ic(e)&&tc(a)?fd(xl(e)):{}}return(i?o:tr)(e,function(e,r,i){return t(n,e,r,i)}),n}function $c(e,t){return null==e?!0:vi(e,t)}function Qc(e,t,n){return null==e?e:gi(e,t,wi(n))}function Kc(e,t,n,r){return r="function"==typeof r?r:te,null==e?e:gi(e,t,wi(n),r)}function Zc(e){return null==e?[]:M(e,Bc(e))}function eu(e){return null==e?[]:M(e,Fc(e))}function tu(e,t,n){return n===te&&(n=t,t=te),n!==te&&(n=Ec(n),n=n===n?n:0),t!==te&&(t=Ec(t),t=t===t?t:0),jn(Ec(e),t,n)}function nu(e,t,n){return t=bc(t),n===te?(n=t,t=0):n=bc(n),e=Ec(e),wr(e,t,n)}function ru(e,t,n){if(n&&"boolean"!=typeof n&&ko(e,t,n)&&(t=n=te),n===te&&("boolean"==typeof t?(n=t,t=te):"boolean"==typeof e&&(n=e,e=te)),e===te&&t===te?(e=0,t=1):(e=bc(e),t===te?(t=e,e=0):t=bc(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=Yl();return zl(e+i*(t-e+Zn("1e-"+((i+"").length-1))),t)}return ei(e,t)}function iu(e){return Yp(xc(e).toLowerCase())}function ou(e){return e=xc(e),e&&e.replace(Xt,vr).replace(Bn,"")}function au(e,t,n){e=xc(e),t=hi(t);var r=e.length;n=n===te?r:jn(Cc(n),0,r);var i=n;return n-=t.length,n>=0&&e.slice(n,i)==t}function su(e){return e=xc(e),e&&Et.test(e)?e.replace(Ct,gr):e}function cu(e){return e=xc(e),e&&Mt.test(e)?e.replace(It,"\\$&"):e}function uu(e,t,n){e=xc(e),t=Cc(t);var r=t?$(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return to(Ul(i),n)+e+to(Vl(i),n)}function lu(e,t,n){e=xc(e),t=Cc(t);var r=t?$(e):0;return t&&t>r?e+to(t-r,n):e}function du(e,t,n){e=xc(e),t=Cc(t);var r=t?$(e):0;return t&&t>r?to(t-r,n)+e:e}function pu(e,t,n){return n||null==t?t=0:t&&(t=+t),Xl(xc(e).replace(Dt,""),t||0)}function fu(e,t,n){return t=(n?ko(e,t,n):t===te)?1:Cc(t),ni(xc(e),t)}function hu(){var e=arguments,t=xc(e[0]);return e.length<3?t:t.replace(e[1],e[2])}function mu(e,t,n){return n&&"number"!=typeof n&&ko(e,t,n)&&(t=n=te),(n=n===te?ke:n>>>0)?(e=xc(e),e&&("string"==typeof t||null!=t&&!bp(t))&&(t=hi(t),!t&&U(e))?Ri(Q(e),0,n):e.split(t,n)):[]}function vu(e,t,n){return e=xc(e),n=null==n?0:jn(Cc(n),0,e.length),t=hi(t),e.slice(n,n+t.length)==t}function gu(e,n,r){var i=t.templateSettings;r&&ko(e,n,r)&&(n=te),e=xc(e),n=Tp({},n,i,uo);var o,a,s=Tp({},n.imports,i.imports,uo),c=Bc(s),u=M(s,c),l=0,d=n.interpolate||Yt,p="__p += '",f=cl((n.escape||Yt).source+"|"+d.source+"|"+(d===xt?Ft:Yt).source+"|"+(n.evaluate||Yt).source+"|$","g"),h="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++zn+"]")+"\n";e.replace(f,function(t,n,r,i,s,c){return r||(r=i),p+=e.slice(l,c).replace($t,N),n&&(o=!0,p+="' +\n__e("+n+") +\n'"),s&&(a=!0,p+="';\n"+s+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=c+t.length,t}),p+="';\n";var m=n.variable;m||(p="with (obj) {\n"+p+"\n}\n"),p=(a?p.replace(yt,""):p).replace(_t,"$1").replace(St,"$1;"),p="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var v=$p(function(){return ol(c,h+"return "+p).apply(te,u)});if(v.source=p,Zs(v))throw v;return v}function yu(e){return xc(e).toLowerCase()}function _u(e){return xc(e).toUpperCase()}function Su(e,t,n){if(e=xc(e),e&&(n||t===te))return e.replace(At,"");if(!e||!(t=hi(t)))return e;var r=Q(e),i=Q(t),o=D(r,i),a=k(r,i)+1;return Ri(r,o,a).join("")}function bu(e,t,n){if(e=xc(e),e&&(n||t===te))return e.replace(kt,"");if(!e||!(t=hi(t)))return e;var r=Q(e),i=k(r,Q(t))+1;return Ri(r,0,i).join("")}function Cu(e,t,n){if(e=xc(e),e&&(n||t===te))return e.replace(Dt,"");if(!e||!(t=hi(t)))return e;var r=Q(e),i=D(r,Q(t));return Ri(r,i).join("")}function wu(e,t){var n=Ee,r=Re;if(ic(t)){var i="separator"in t?t.separator:i;n="length"in t?Cc(t.length):n,r="omission"in t?hi(t.omission):r}e=xc(e);var o=e.length;if(U(e)){var a=Q(e);o=a.length}if(n>=o)return e;var s=n-$(r);if(1>s)return r;var c=a?Ri(a,0,s).join(""):e.slice(0,s);if(i===te)return c+r;if(a&&(s+=c.length-s),bp(i)){if(e.slice(s).search(i)){var u,l=c;for(i.global||(i=cl(i.source,xc(Gt.exec(i))+"g")),i.lastIndex=0;u=i.exec(l);)var d=u.index;c=c.slice(0,d===te?s:d)}}else if(e.indexOf(hi(i),s)!=s){var p=c.lastIndexOf(i);p>-1&&(c=c.slice(0,p))}return c+r}function Eu(e){return e=xc(e),e&&wt.test(e)?e.replace(bt,yr):e}function Ru(e,t,n){return e=xc(e),t=n?te:t,t===te?B(e)?ee(e):g(e):e.match(t)||[]}function Pu(e){var t=null==e?0:e.length,n=bo();return e=t?d(e,function(e){if("function"!=typeof e[1])throw new ll(oe);return[n(e[0]),e[1]]}):[],ri(function(n){for(var i=-1;++i<t;){var o=e[i];if(r(o[0],this,n))return r(o[1],this,n)}})}function xu(e){return Vn(Nn(e,ue))}function Tu(e){return function(){return e}}function Lu(e,t){return null==e||e!==e?t:e}function Ou(e){return e}function Iu(e){return Vr("function"==typeof e?e:Nn(e,ue))}function Mu(e){return qr(Nn(e,ue))}function Au(e,t){return Jr(e,Nn(t,ue))}function Du(e,t,n){var r=Bc(t),i=ir(t,r);null!=n||ic(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=ir(t,Bc(t)));var a=!(ic(n)&&"chain"in n&&!n.chain),s=tc(e);return o(i,function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__),i=n.__actions__=ji(this.__actions__);return i.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,p([this.value()],arguments))})}),e}function ku(){return rr._===this&&(rr._=bl),this}function ju(){}function Nu(e){return e=Cc(e),ri(function(t){return Hr(t,e)})}function Vu(e){return jo(e)?E(Zo(e)):Qr(e)}function Uu(e){return function(t){return null==e?te:or(e,t)}}function Bu(){return[]}function Fu(){return!1}function Gu(){return{}}function qu(){return""}function Ju(){return!0}function Wu(e,t){if(e=Cc(e),1>e||e>Me)return[];var n=ke,r=zl(e,ke);t=bo(t),e-=ke;for(var i=L(r,t);++n<e;)t(n);return i}function zu(e){return vp(e)?d(e,Zo):vc(e)?[e]:ji(Id(xc(e)))}function Hu(e){var t=++gl;return xc(e)+t}function Xu(e){return e&&e.length?Yn(e,Ou,mr):te}function Yu(e,t){return e&&e.length?Yn(e,bo(t,2),mr):te}function $u(e){return w(e,Ou)}function Qu(e,t){return w(e,bo(t,2))}function Ku(e){return e&&e.length?Yn(e,Ou,Fr):te}function Zu(e,t){return e&&e.length?Yn(e,bo(t,2),Fr):te}function el(e){return e&&e.length?T(e,Ou):0}function tl(e,t){return e&&e.length?T(e,bo(t,2)):0}e=null==e?rr:Sr.defaults(rr.Object(),e,Sr.pick(rr,Wn));var nl=e.Array,rl=e.Date,il=e.Error,ol=e.Function,al=e.Math,sl=e.Object,cl=e.RegExp,ul=e.String,ll=e.TypeError,dl=nl.prototype,pl=ol.prototype,fl=sl.prototype,hl=e["__core-js_shared__"],ml=pl.toString,vl=fl.hasOwnProperty,gl=0,yl=function(){var e=/[^.]+$/.exec(hl&&hl.keys&&hl.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),_l=fl.toString,Sl=ml.call(sl),bl=rr._,Cl=cl("^"+ml.call(vl).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wl=ar?e.Buffer:te,El=e.Symbol,Rl=e.Uint8Array,Pl=wl?wl.allocUnsafe:te,xl=q(sl.getPrototypeOf,sl),Tl=sl.create,Ll=fl.propertyIsEnumerable,Ol=dl.splice,Il=El?El.isConcatSpreadable:te,Ml=El?El.iterator:te,Al=El?El.toStringTag:te,Dl=function(){try{var e=Eo(sl,"defineProperty");return e({},"",{}),e}catch(t){}}(),kl=e.clearTimeout!==rr.clearTimeout&&e.clearTimeout,jl=rl&&rl.now!==rr.Date.now&&rl.now,Nl=e.setTimeout!==rr.setTimeout&&e.setTimeout,Vl=al.ceil,Ul=al.floor,Bl=sl.getOwnPropertySymbols,Fl=wl?wl.isBuffer:te,Gl=e.isFinite,ql=dl.join,Jl=q(sl.keys,sl),Wl=al.max,zl=al.min,Hl=rl.now,Xl=e.parseInt,Yl=al.random,$l=dl.reverse,Ql=Eo(e,"DataView"),Kl=Eo(e,"Map"),Zl=Eo(e,"Promise"),ed=Eo(e,"Set"),td=Eo(e,"WeakMap"),nd=Eo(sl,"create"),rd=td&&new td,id={},od=ea(Ql),ad=ea(Kl),sd=ea(Zl),cd=ea(ed),ud=ea(td),ld=El?El.prototype:te,dd=ld?ld.valueOf:te,pd=ld?ld.toString:te,fd=function(){function e(){}return function(t){if(!ic(t))return{};if(Tl)return Tl(t);e.prototype=t;var n=new e;return e.prototype=te,n}}();t.templateSettings={escape:Rt,evaluate:Pt,interpolate:xt,variable:"",imports:{_:t}},t.prototype=n.prototype,t.prototype.constructor=t,v.prototype=fd(n.prototype),v.prototype.constructor=v,R.prototype=fd(n.prototype),R.prototype.constructor=R,Ut.prototype.clear=Qt,Ut.prototype["delete"]=Kt,Ut.prototype.get=Zt,Ut.prototype.has=en,Ut.prototype.set=tn,nn.prototype.clear=rn,nn.prototype["delete"]=on,nn.prototype.get=an,nn.prototype.has=sn,nn.prototype.set=cn,un.prototype.clear=ln,un.prototype["delete"]=dn,un.prototype.get=pn,un.prototype.has=fn,un.prototype.set=hn,mn.prototype.add=mn.prototype.push=vn,mn.prototype.has=gn,yn.prototype.clear=_n,yn.prototype["delete"]=Sn,yn.prototype.get=bn,yn.prototype.has=Cn,yn.prototype.set=wn;var hd=Gi(tr),md=Gi(nr,!0),vd=qi(),gd=qi(!0),yd=rd?function(e,t){return rd.set(e,t),e}:Ou,_d=Dl?function(e,t){return Dl(e,"toString",{configurable:!0,enumerable:!1,value:Tu(t),writable:!0})}:Ou,Sd=ri,bd=kl||function(e){return rr.clearTimeout(e)},Cd=ed&&1/z(new ed([,-0]))[1]==Ie?function(e){return new ed(e)}:ju,wd=rd?function(e){return rd.get(e)}:ju,Ed=Bl?function(e){return null==e?[]:(e=sl(e),c(Bl(e),function(t){return Ll.call(e,t)}))}:Bu,Rd=Bl?function(e){for(var t=[];e;)p(t,Ed(e)),e=xl(e);return t}:Bu,Pd=cr;(Ql&&Pd(new Ql(new ArrayBuffer(1)))!=ct||Kl&&Pd(new Kl)!=Xe||Zl&&Pd(Zl.resolve())!=Ke||ed&&Pd(new ed)!=tt||td&&Pd(new td)!=ot)&&(Pd=function(e){var t=cr(e),n=t==Qe?e.constructor:te,r=n?ea(n):"";if(r)switch(r){case od:return ct;case ad:return Xe;case sd:return Ke;case cd:return tt;case ud:return ot}return t});var xd=hl?tc:Fu,Td=Qo(yd),Ld=Nl||function(e,t){return rr.setTimeout(e,t)},Od=Qo(_d),Id=qo(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ot,function(e,n,r,i){t.push(r?i.replace(Bt,"$1"):n||e)}),t}),Md=ri(function(e,t){return Hs(e)?qn(e,Kn(t,1,Hs,!0)):[]}),Ad=ri(function(e,t){var n=ba(t);return Hs(n)&&(n=te),Hs(e)?qn(e,Kn(t,1,Hs,!0),bo(n,2)):[]}),Dd=ri(function(e,t){var n=ba(t);return Hs(n)&&(n=te),Hs(e)?qn(e,Kn(t,1,Hs,!0),te,n):[]}),kd=ri(function(e){var t=d(e,Ci);return t.length&&t[0]===e[0]?Er(t):[]}),jd=ri(function(e){var t=ba(e),n=d(e,Ci);return t===ba(n)?t=te:n.pop(),n.length&&n[0]===e[0]?Er(n,bo(t,2)):[]}),Nd=ri(function(e){var t=ba(e),n=d(e,Ci);return t="function"==typeof t?t:te,t&&n.pop(),n.length&&n[0]===e[0]?Er(n,te,t):[]}),Vd=ri(Ea),Ud=vo(function(e,t){var n=null==e?0:e.length,r=kn(e,t);return Zr(e,d(t,function(e){return Do(e,n)?+e:e}).sort(Mi)),r}),Bd=ri(function(e){return mi(Kn(e,1,Hs,!0))}),Fd=ri(function(e){var t=ba(e);return Hs(t)&&(t=te),mi(Kn(e,1,Hs,!0),bo(t,2))}),Gd=ri(function(e){var t=ba(e);return t="function"==typeof t?t:te,mi(Kn(e,1,Hs,!0),te,t)}),qd=ri(function(e,t){return Hs(e)?qn(e,t):[]}),Jd=ri(function(e){return Si(c(e,Hs))}),Wd=ri(function(e){var t=ba(e);return Hs(t)&&(t=te),Si(c(e,Hs),bo(t,2))}),zd=ri(function(e){var t=ba(e);return t="function"==typeof t?t:te,Si(c(e,Hs),te,t)}),Hd=ri(za),Xd=ri(function(e){var t=e.length,n=t>1?e[t-1]:te;return n="function"==typeof n?(e.pop(),n):te,Ha(e,n)}),Yd=vo(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return kn(t,e)};return!(t>1||this.__actions__.length)&&r instanceof R&&Do(n)?(r=r.slice(n,+n+(t?1:0)),r.__actions__.push({func:Ka,args:[i],thisArg:te}),new v(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(te),e})):this.thru(i)}),$d=Bi(function(e,t,n){vl.call(e,n)?++e[n]:Dn(e,n,1)}),Qd=Yi(da),Kd=Yi(pa),Zd=Bi(function(e,t,n){vl.call(e,n)?e[n].push(t):Dn(e,n,[t])}),ep=ri(function(e,t,n){var i=-1,o="function"==typeof t,a=zs(e)?nl(e.length):[];return hd(e,function(e){a[++i]=o?r(t,e,n):Pr(e,t,n)}),a}),tp=Bi(function(e,t,n){Dn(e,n,t)}),np=Bi(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),rp=ri(function(e,t){if(null==e)return[];var n=t.length;return n>1&&ko(e,t[0],t[1])?t=[]:n>2&&ko(t[0],t[1],t[2])&&(t=[t[0]]),Xr(e,Kn(t,1),[])}),ip=jl||function(){return rr.Date.now()},op=ri(function(e,t,n){var r=he;if(n.length){var i=J(n,So(op));r|=_e}return co(e,r,t,n,i)}),ap=ri(function(e,t,n){var r=he|me;if(n.length){var i=J(n,So(ap));r|=_e}return co(t,r,e,n,i)}),sp=ri(function(e,t){return Gn(e,1,t)}),cp=ri(function(e,t,n){return Gn(e,Ec(t)||0,n)});Is.Cache=un;var up=Sd(function(e,t){t=1==t.length&&vp(t[0])?d(t[0],I(bo())):d(Kn(t,1),I(bo()));var n=t.length;return ri(function(i){for(var o=-1,a=zl(i.length,n);++o<a;)i[o]=t[o].call(this,i[o]);return r(e,this,i)})}),lp=ri(function(e,t){var n=J(t,So(lp));return co(e,_e,te,t,n)}),dp=ri(function(e,t){var n=J(t,So(dp));return co(e,Se,te,t,n)}),pp=vo(function(e,t){return co(e,Ce,te,te,te,t)}),fp=io(mr),hp=io(function(e,t){return e>=t}),mp=xr(function(){return arguments}())?xr:function(e){return oc(e)&&vl.call(e,"callee")&&!Ll.call(e,"callee")},vp=nl.isArray,gp=ur?I(ur):Tr,yp=Fl||Fu,_p=lr?I(lr):Lr,Sp=dr?I(dr):Mr,bp=pr?I(pr):kr,Cp=fr?I(fr):jr,wp=hr?I(hr):Nr,Ep=io(Fr),Rp=io(function(e,t){return t>=e}),Pp=Fi(function(e,t){if(Bo(t)||zs(t))return void Ni(t,Bc(t),e);for(var n in t)vl.call(t,n)&&Ln(e,n,t[n])}),xp=Fi(function(e,t){Ni(t,Fc(t),e)}),Tp=Fi(function(e,t,n,r){Ni(t,Fc(t),e,r)}),Lp=Fi(function(e,t,n,r){Ni(t,Bc(t),e,r)}),Op=vo(kn),Ip=ri(function(e,t){e=sl(e);var n=-1,r=t.length,i=r>2?t[2]:te;for(i&&ko(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],a=Fc(o),s=-1,c=a.length;++s<c;){var u=a[s],l=e[u];(l===te||Ws(l,fl[u])&&!vl.call(e,u))&&(e[u]=o[u])}return e}),Mp=ri(function(e){return e.push(te,lo),r(Np,te,e)}),Ap=Ki(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=_l.call(t)),e[t]=n},Tu(Ou)),Dp=Ki(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=_l.call(t)),vl.call(e,t)?e[t].push(n):e[t]=[n]},bo),kp=ri(Pr),jp=Fi(function(e,t,n){Wr(e,t,n)}),Np=Fi(function(e,t,n,r){Wr(e,t,n,r)}),Vp=vo(function(e,t){var n={};if(null==e)return n;var r=!1;t=d(t,function(t){return t=Ei(t,e),r||(r=t.length>1),t}),Ni(e,yo(e),n),r&&(n=Nn(n,ue|le|de,po));for(var i=t.length;i--;)vi(n,t[i]);return n}),Up=vo(function(e,t){return null==e?{}:Yr(e,t)}),Bp=so(Bc),Fp=so(Fc),Gp=zi(function(e,t,n){return t=t.toLowerCase(),e+(n?iu(t):t)}),qp=zi(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),Jp=zi(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),Wp=Wi("toLowerCase"),zp=zi(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Hp=zi(function(e,t,n){return e+(n?" ":"")+Yp(t)}),Xp=zi(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Yp=Wi("toUpperCase"),$p=ri(function(e,t){try{return r(e,te,t)}catch(n){return Zs(n)?n:new il(n)}}),Qp=vo(function(e,t){return o(t,function(t){t=Zo(t),Dn(e,t,op(e[t],e))}),e}),Kp=$i(),Zp=$i(!0),ef=ri(function(e,t){return function(n){return Pr(n,e,t)}}),tf=ri(function(e,t){return function(n){return Pr(e,n,t)}}),nf=eo(d),rf=eo(s),of=eo(m),af=ro(),sf=ro(!0),cf=Zi(function(e,t){return e+t},0),uf=ao("ceil"),lf=Zi(function(e,t){return e/t},1),df=ao("floor"),pf=Zi(function(e,t){return e*t},1),ff=ao("round"),hf=Zi(function(e,t){return e-t},0);return t.after=Es,t.ary=Rs,t.assign=Pp,t.assignIn=xp,t.assignInWith=Tp,t.assignWith=Lp,t.at=Op,t.before=Ps,t.bind=op,t.bindAll=Qp,t.bindKey=ap,t.castArray=Us,t.chain=$a,t.chunk=ra,t.compact=ia,t.concat=oa,t.cond=Pu,t.conforms=xu,t.constant=Tu,t.countBy=$d,t.create=Tc,t.curry=xs,t.curryRight=Ts,t.debounce=Ls,t.defaults=Ip,t.defaultsDeep=Mp,t.defer=sp,t.delay=cp,t.difference=Md,t.differenceBy=Ad,t.differenceWith=Dd,t.drop=aa,t.dropRight=sa,t.dropRightWhile=ca,t.dropWhile=ua,t.fill=la,t.filter=ss,t.flatMap=cs,t.flatMapDeep=us,t.flatMapDepth=ls,t.flatten=fa,t.flattenDeep=ha,t.flattenDepth=ma,t.flip=Os,t.flow=Kp,t.flowRight=Zp,t.fromPairs=va,t.functions=kc,t.functionsIn=jc,t.groupBy=Zd,t.initial=_a,t.intersection=kd,t.intersectionBy=jd,t.intersectionWith=Nd,t.invert=Ap,t.invertBy=Dp,t.invokeMap=ep,t.iteratee=Iu,t.keyBy=tp,t.keys=Bc,t.keysIn=Fc,t.map=hs,t.mapKeys=Gc,t.mapValues=qc,t.matches=Mu,t.matchesProperty=Au,t.memoize=Is,t.merge=jp,t.mergeWith=Np,t.method=ef,t.methodOf=tf,t.mixin=Du,t.negate=Ms,t.nthArg=Nu,t.omit=Vp,t.omitBy=Jc,t.once=As,t.orderBy=ms,t.over=nf,t.overArgs=up,t.overEvery=rf,t.overSome=of,t.partial=lp,t.partialRight=dp,t.partition=np,t.pick=Up,t.pickBy=Wc,t.property=Vu,t.propertyOf=Uu,t.pull=Vd,t.pullAll=Ea,t.pullAllBy=Ra,t.pullAllWith=Pa,t.pullAt=Ud,t.range=af,t.rangeRight=sf,t.rearg=pp,t.reject=ys,t.remove=xa,t.rest=Ds,t.reverse=Ta,t.sampleSize=Ss,t.set=Hc,t.setWith=Xc,t.shuffle=bs,t.slice=La,t.sortBy=rp,t.sortedUniq=ja,t.sortedUniqBy=Na,t.split=mu,t.spread=ks,t.tail=Va,t.take=Ua,t.takeRight=Ba,t.takeRightWhile=Fa,t.takeWhile=Ga,t.tap=Qa,t.throttle=js,t.thru=Ka,t.toArray=Sc,t.toPairs=Bp,t.toPairsIn=Fp,t.toPath=zu,t.toPlainObject=Rc,t.transform=Yc,t.unary=Ns,t.union=Bd,t.unionBy=Fd,t.unionWith=Gd,t.uniq=qa,t.uniqBy=Ja,t.uniqWith=Wa,t.unset=$c,t.unzip=za,t.unzipWith=Ha,t.update=Qc,t.updateWith=Kc,t.values=Zc,t.valuesIn=eu,t.without=qd,t.words=Ru,t.wrap=Vs,t.xor=Jd,t.xorBy=Wd,t.xorWith=zd,t.zip=Hd,t.zipObject=Xa,t.zipObjectDeep=Ya,t.zipWith=Xd,t.entries=Bp,t.entriesIn=Fp,t.extend=xp,t.extendWith=Tp,Du(t,t),t.add=cf,t.attempt=$p,t.camelCase=Gp,t.capitalize=iu,t.ceil=uf,t.clamp=tu,t.clone=Bs,t.cloneDeep=Gs,t.cloneDeepWith=qs,t.cloneWith=Fs,t.conformsTo=Js,t.deburr=ou,t.defaultTo=Lu,t.divide=lf,t.endsWith=au,t.eq=Ws,t.escape=su,t.escapeRegExp=cu,t.every=as,t.find=Qd,t.findIndex=da,t.findKey=Lc,t.findLast=Kd,t.findLastIndex=pa,t.findLastKey=Oc,t.floor=df,t.forEach=ds,t.forEachRight=ps,t.forIn=Ic,t.forInRight=Mc,t.forOwn=Ac,t.forOwnRight=Dc,t.get=Nc,t.gt=fp,t.gte=hp,t.has=Vc,t.hasIn=Uc,t.head=ga,t.identity=Ou,t.includes=fs,t.indexOf=ya,t.inRange=nu,t.invoke=kp,t.isArguments=mp,t.isArray=vp,t.isArrayBuffer=gp,t.isArrayLike=zs,t.isArrayLikeObject=Hs,t.isBoolean=Xs,t.isBuffer=yp,t.isDate=_p,t.isElement=Ys,t.isEmpty=$s,t.isEqual=Qs,t.isEqualWith=Ks,t.isError=Zs,t.isFinite=ec,t.isFunction=tc,t.isInteger=nc,t.isLength=rc,t.isMap=Sp,t.isMatch=ac,t.isMatchWith=sc,t.isNaN=cc,t.isNative=uc,t.isNil=dc,t.isNull=lc,t.isNumber=pc,t.isObject=ic,t.isObjectLike=oc,t.isPlainObject=fc,t.isRegExp=bp,t.isSafeInteger=hc,t.isSet=Cp,t.isString=mc,t.isSymbol=vc,t.isTypedArray=wp,t.isUndefined=gc,t.isWeakMap=yc,t.isWeakSet=_c,t.join=Sa,t.kebabCase=qp,t.last=ba,t.lastIndexOf=Ca,t.lowerCase=Jp,t.lowerFirst=Wp,t.lt=Ep,t.lte=Rp,t.max=Xu,t.maxBy=Yu,t.mean=$u,t.meanBy=Qu,t.min=Ku,t.minBy=Zu,t.stubArray=Bu,t.stubFalse=Fu,t.stubObject=Gu,t.stubString=qu,t.stubTrue=Ju,t.multiply=pf,t.nth=wa,t.noConflict=ku,t.noop=ju,t.now=ip,t.pad=uu,t.padEnd=lu,t.padStart=du,t.parseInt=pu,t.random=ru,t.reduce=vs,t.reduceRight=gs,t.repeat=fu,t.replace=hu,t.result=zc,t.round=ff,t.runInContext=br,t.sample=_s,t.size=Cs,t.snakeCase=zp,t.some=ws,t.sortedIndex=Oa,t.sortedIndexBy=Ia,t.sortedIndexOf=Ma,t.sortedLastIndex=Aa,t.sortedLastIndexBy=Da,t.sortedLastIndexOf=ka,t.startCase=Hp,t.startsWith=vu,t.subtract=hf,t.sum=el,t.sumBy=tl,t.template=gu,t.times=Wu,t.toFinite=bc,t.toInteger=Cc,t.toLength=wc,t.toLower=yu,t.toNumber=Ec,t.toSafeInteger=Pc,t.toString=xc,t.toUpper=_u,t.trim=Su,t.trimEnd=bu,t.trimStart=Cu,t.truncate=wu,t.unescape=Eu,t.uniqueId=Hu,t.upperCase=Xp,t.upperFirst=Yp,t.each=ds,t.eachRight=ps,t.first=ga,Du(t,function(){var e={};return tr(t,function(n,r){vl.call(t.prototype,r)||(e[r]=n)}),e}(),{chain:!1}),t.VERSION=ne,o(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){t[e].placeholder=t}),o(["drop","take"],function(e,t){R.prototype[e]=function(n){n=n===te?1:Wl(Cc(n),0);var r=this.__filtered__&&!t?new R(this):this.clone();return r.__filtered__?r.__takeCount__=zl(n,r.__takeCount__):r.__views__.push({size:zl(n,ke),type:e+(r.__dir__<0?"Right":"")}),r},R.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),o(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==Te||n==Oe;R.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:bo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),o(["head","last"],function(e,t){var n="take"+(t?"Right":"");R.prototype[e]=function(){return this[n](1).value()[0]}}),o(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");R.prototype[e]=function(){return this.__filtered__?new R(this):this[n](1)}}),R.prototype.compact=function(){return this.filter(Ou)},R.prototype.find=function(e){return this.filter(e).head()},R.prototype.findLast=function(e){return this.reverse().find(e)},R.prototype.invokeMap=ri(function(e,t){return"function"==typeof e?new R(this):this.map(function(n){return Pr(n,e,t)})}),R.prototype.reject=function(e){return this.filter(Ms(bo(e)))},R.prototype.slice=function(e,t){e=Cc(e);var n=this;return n.__filtered__&&(e>0||0>t)?new R(n):(0>e?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==te&&(t=Cc(t),n=0>t?n.dropRight(-t):n.take(t-e)),n)},R.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},R.prototype.toArray=function(){return this.take(ke)},tr(R.prototype,function(e,n){var r=/^(?:filter|find|map|reject)|While$/.test(n),i=/^(?:head|last)$/.test(n),o=t[i?"take"+("last"==n?"Right":""):n],a=i||/^find/.test(n);o&&(t.prototype[n]=function(){var n=this.__wrapped__,s=i?[1]:arguments,c=n instanceof R,u=s[0],l=c||vp(n),d=function(e){var n=o.apply(t,p([e],s));return i&&f?n[0]:n};l&&r&&"function"==typeof u&&1!=u.length&&(c=l=!1);var f=this.__chain__,h=!!this.__actions__.length,m=a&&!f,g=c&&!h;if(!a&&l){n=g?n:new R(this);var y=e.apply(n,s);return y.__actions__.push({func:Ka,args:[d],thisArg:te}),new v(y,f)}return m&&g?e.apply(this,s):(y=this.thru(d),m?i?y.value()[0]:y.value():y)})}),o(["pop","push","shift","sort","splice","unshift"],function(e){var n=dl[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);t.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var t=this.value();return n.apply(vp(t)?t:[],e)}return this[r](function(t){return n.apply(vp(t)?t:[],e)})}}),tr(R.prototype,function(e,n){var r=t[n];if(r){var i=r.name+"",o=id[i]||(id[i]=[]);o.push({name:n,func:r})}}),id[Qi(te,me).name]=[{name:"wrapper",func:te}],R.prototype.clone=X,R.prototype.reverse=K,R.prototype.value=Z,t.prototype.at=Yd,t.prototype.chain=Za,t.prototype.commit=es,t.prototype.next=ts,t.prototype.plant=rs,t.prototype.reverse=is,t.prototype.toJSON=t.prototype.valueOf=t.prototype.value=os,t.prototype.first=t.prototype.head,Ml&&(t.prototype[Ml]=ns),t},Sr=_r();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(rr._=Sr,define(function(){return Sr})):or?((or.exports=Sr)._=Sr,ir._=Sr):rr._=Sr}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],69:[function(e,t,n){function r(e,t){var n,r=this;a.call(this),e=e||{},e.iceServers=e.iceServers||[],this.enableChromeNativeSimulcast=!1,t&&t.optional&&window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&t.optional.forEach(function(e){e.enableChromeNativeSimulcast&&(r.enableChromeNativeSimulcast=!0)}),this.enableMultiStreamHacks=!1,t&&t.optional&&window.chrome&&t.optional.forEach(function(e){e.enableMultiStreamHacks&&(r.enableMultiStreamHacks=!0)}),this.restrictBandwidth=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetRestrictBandwidth&&(r.restrictBandwidth=e.andyetRestrictBandwidth)}),this.batchIceCandidates=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetBatchIce&&(r.batchIceCandidates=e.andyetBatchIce)}),this.batchedIceCandidates=[],t&&t.optional&&window.chrome&&t.optional.forEach(function(e){e.andyetFasterICE&&(r.eliminateDuplicateCandidates=e.andyetFasterICE)}),t&&t.optional&&t.optional.forEach(function(e){e.andyetDontSignalCandidates&&(r.dontSignalCandidates=e.andyetDontSignalCandidates)}),this.assumeSetLocalSuccess=!1,t&&t.optional&&t.optional.forEach(function(e){e.andyetAssumeSetLocalSuccess&&(r.assumeSetLocalSuccess=e.andyetAssumeSetLocalSuccess)}),window.navigator.mozGetUserMedia&&t&&t.optional&&(this.wtFirefox=0,t.optional.forEach(function(e){e.andyetFirefoxMakesMeSad&&(r.wtFirefox=e.andyetFirefoxMakesMeSad,r.wtFirefox>0&&(r.firefoxcandidatebuffer=[]))})),this.pc=new RTCPeerConnection(e,t),this.getLocalStreams="function"==typeof this.pc.getLocalStreams?this.pc.getLocalStreams.bind(this.pc):function(){return[]},this.getSenders="function"==typeof this.pc.getSenders?this.pc.getSenders.bind(this.pc):function(){return[]},this.getRemoteStreams="function"==typeof this.pc.getRemoteStreams?this.pc.getRemoteStreams.bind(this.pc):function(){return[]},this.getReceivers="function"==typeof this.pc.getReceivers?this.pc.getReceivers.bind(this.pc):function(){return[]},this.addStream=this.pc.addStream.bind(this.pc),this.removeStream=function(e){"function"==typeof r.pc.removeStream?r.pc.removeStream.apply(r.pc,arguments):"function"==typeof r.pc.removeTrack&&e.getTracks().forEach(function(e){r.pc.removeTrack(e)})},"function"==typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc)),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onremovetrack=this.emit.bind(this,"removeTrack"),this.pc.onaddstream=this.emit.bind(this,"addStream"),this.pc.onaddtrack=this.emit.bind(this,"addTrack"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.localDescription={contents:[]},this.remoteDescription={contents:[]},this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1},this.iceCredentials={local:{},remote:{}};for(n in e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){var t=e.logger||console;t.log("PeerConnection event:",arguments)}),this.hadLocalStunCandidate=!1,this.hadRemoteStunCandidate=!1,this.hadLocalRelayCandidate=!1,this.hadRemoteRelayCandidate=!1,this.hadLocalIPv6Candidate=!1,this.hadRemoteIPv6Candidate=!1,this._remoteDataChannels=[],this._localDataChannels=[],this._candidateBuffer=[]}var i=e("util"),o=e("sdp-jingle-json"),a=e("wildemitter"),s=e("lodash.clonedeep");i.inherits(r,a),Object.defineProperty(r.prototype,"signalingState",{get:function(){return this.pc.signalingState}}),Object.defineProperty(r.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}}),r.prototype._role=function(){return this.isInitiator?"initiator":"responder"},r.prototype.addStream=function(e){this.localStream=e,this.pc.addStream(e)},r.prototype._checkLocalCandidate=function(e){var t=o.toCandidateJSON(e);"srflx"==t.type?this.hadLocalStunCandidate=!0:"relay"==t.type&&(this.hadLocalRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)},r.prototype._checkRemoteCandidate=function(e){var t=o.toCandidateJSON(e);"srflx"==t.type?this.hadRemoteStunCandidate=!0:"relay"==t.type&&(this.hadRemoteRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)},r.prototype.processIce=function(e,t){t=t||function(){};var n=this;if("closed"===this.pc.signalingState)return t();if(e.contents||e.jingle&&e.jingle.contents){var r=this.remoteDescription.contents.map(function(e){return e.name}),i=e.contents||e.jingle.contents;i.forEach(function(e){var i=e.transport||{},a=i.candidates||[],s=r.indexOf(e.name),c=e.name,u=n.remoteDescription.contents.find(function(t){
return t.name===e.name}),l=function(){a.forEach(function(e){var t=o.toCandidateSDP(e);n.pc.addIceCandidate(new RTCIceCandidate({candidate:t,sdpMLineIndex:s,sdpMid:c}),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(t)}),t()};if(n.iceCredentials.remote[e.name]&&i.ufrag&&n.iceCredentials.remote[e.name].ufrag!==i.ufrag)if(u){u.transport.ufrag=i.ufrag,u.transport.pwd=i.pwd;var d={type:"offer",jingle:n.remoteDescription};d.sdp=o.toSessionSDP(d.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.pc.setRemoteDescription(new RTCSessionDescription(d),function(){l()},function(e){n.emit("error",e)})}else n.emit("error","ice restart failed to find matching content");else l()})}else{if(e.candidate&&0!==e.candidate.candidate.indexOf("a=")&&(e.candidate.candidate="a="+e.candidate.candidate),this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(e.candidate),t();n.pc.addIceCandidate(new RTCIceCandidate(e.candidate),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate.candidate),t()}},r.prototype.offer=function(e,t){var n=this,r=2===arguments.length,i=r&&e?e:{offerToReceiveAudio:1,offerToReceiveVideo:1};return t=r?t:e,t=t||function(){},"closed"===this.pc.signalingState?t("Already closed"):void this.pc.createOffer(function(e){var r={type:"offer",sdp:e.sdp};n.assumeSetLocalSuccess&&(n.emit("offer",r),t(null,r)),n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){var i;n.config.useJingle&&(i=o.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),i.sid=n.config.sid,n.localDescription=i,i.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),r.jingle=i),r.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("offer",r),t(null,r))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},i)},r.prototype.handleOffer=function(e,t){t=t||function(){};var n=this;if(e.type="offer",e.jingle){if(this.enableChromeNativeSimulcast&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.application.googConferenceFlag=!0)}),this.enableMultiStreamHacks&&e.jingle.contents.forEach(function(e){if("video"===e.name){var t=e.application.sources||[];(0===t.length||"3735928559"!==t[0].ssrc)&&(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),e.application.sources=t)}}),n.restrictBandwidth>0&&e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name){var r=e.jingle.contents[1],i=r.application&&r.application.bandwidth&&r.application.bandwidth.bandwidth;i||(e.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:n.restrictBandwidth.toString()},e.sdp=o.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}))}e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),e.sdp=o.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle}e.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){t()},t)},r.prototype.answerAudioOnly=function(e){var t={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}};this._answer(t,e)},r.prototype.answerBroadcastOnly=function(e){var t={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};this._answer(t,e)},r.prototype.answer=function(e,t){var n=2===arguments.length,r=n?t:e,i=n&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};this._answer(i,r)},r.prototype.handleAnswer=function(e,t){t=t||function(){};var n=this;e.jingle&&(e.sdp=o.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle,e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})})),e.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){n.wtFirefox&&window.setTimeout(function(){n.firefoxcandidatebuffer.forEach(function(e){n.pc.addIceCandidate(new RTCIceCandidate(e),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate)}),n.firefoxcandidatebuffer=null},n.wtFirefox),t(null)},t)},r.prototype.close=function(){this.pc.close(),this._localDataChannels=[],this._remoteDataChannels=[],this.emit("close")},r.prototype._answer=function(e,t){t=t||function(){};var n=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");return"closed"===this.pc.signalingState?t("Already closed"):void n.pc.createAnswer(function(e){var r=[];if(n.enableChromeNativeSimulcast&&(e.jingle=o.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name)){var i=e.jingle.contents[1].application.sourceGroups||[],a=!1;if(i.forEach(function(e){"SIM"==e.semantics&&(a=!0)}),!a&&e.jingle.contents[1].application.sources.length){var c=JSON.parse(JSON.stringify(e.jingle.contents[1].application.sources[0]));c.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(c),r.push(e.jingle.contents[1].application.sources[0].ssrc),r.push(c.ssrc),i.push({semantics:"SIM",sources:r});var u=JSON.parse(JSON.stringify(c));u.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(u),i.push({semantics:"FID",sources:[c.ssrc,u.ssrc]}),e.jingle.contents[1].application.sourceGroups=i,e.sdp=o.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"})}}var l={type:"answer",sdp:e.sdp};if(n.assumeSetLocalSuccess){var d=s(l);n.emit("answer",d),t(null,d)}n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){if(n.config.useJingle){var r=o.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});r.sid=n.config.sid,n.localDescription=r,l.jingle=r}if(n.enableChromeNativeSimulcast&&(l.jingle||(l.jingle=o.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})),l.jingle.contents[1].application.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),l.sdp=o.toSessionSDP(l.jingle,{sid:n.sdpSessionID,role:n._role(),direction:"outgoing"})),l.sdp.split(/\r?\n/).forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),!n.assumeSetLocalSuccess){var i=s(l);n.emit("answer",i),t(null,i)}},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},e)},r.prototype._onIce=function(e){var t=this;if(e.candidate){if(this.dontSignalCandidates)return;var n=e.candidate,r={candidate:{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex}};this._checkLocalCandidate(n.candidate);var i,a,s=o.toCandidateJSON(n.candidate);if(this.eliminateDuplicateCandidates&&"relay"===s.type&&(i=this._candidateBuffer.filter(function(e){return"relay"===e.type}).map(function(e){return e.foundation+":"+e.component}),a=i.indexOf(s.foundation+":"+s.component),a>-1&&s.priority>>24>=i[a].priority>>24))return;if("max-bundle"===this.config.bundlePolicy&&(i=this._candidateBuffer.filter(function(e){return s.type===e.type}).map(function(e){return e.address+":"+e.port}),a=i.indexOf(s.address+":"+s.port),a>-1))return;if("require"===this.config.rtcpMuxPolicy&&"2"===s.component)return;if(this._candidateBuffer.push(s),t.config.useJingle){if(n.sdpMid||(n.sdpMid=t.pc.remoteDescription&&"offer"===t.pc.remoteDescription.type?t.remoteDescription.contents[n.sdpMLineIndex].name:t.localDescription.contents[n.sdpMLineIndex].name),!t.iceCredentials.local[n.sdpMid]){var c=o.toSessionJSON(t.pc.localDescription.sdp,{role:t._role(),direction:"outgoing"});c.contents.forEach(function(e){var n=e.transport||{};n.ufrag&&(t.iceCredentials.local[e.name]={ufrag:n.ufrag,pwd:n.pwd})})}if(r.jingle={contents:[{name:n.sdpMid,creator:t._role(),transport:{transportType:"iceUdp",ufrag:t.iceCredentials.local[n.sdpMid].ufrag,pwd:t.iceCredentials.local[n.sdpMid].pwd,candidates:[s]}}]},t.batchIceCandidates>0)return 0===t.batchedIceCandidates.length&&window.setTimeout(function(){var e={};t.batchedIceCandidates.forEach(function(t){t=t.contents[0],e[t.name]||(e[t.name]=t),e[t.name].transport.candidates.push(t.transport.candidates[0])});var n={jingle:{contents:[]}};Object.keys(e).forEach(function(t){n.jingle.contents.push(e[t])}),t.batchedIceCandidates=[],t.emit("ice",n)},t.batchIceCandidates),void t.batchedIceCandidates.push(r.jingle)}this.emit("ice",r)}else this.emit("endOfCandidates")},r.prototype._onDataChannel=function(e){var t=e.channel;this._remoteDataChannels.push(t),this.emit("addChannel",t)},r.prototype.createDataChannel=function(e,t){var n=this.pc.createDataChannel(e,t);return this._localDataChannels.push(n),n},r.prototype.getStats=function(){if("function"!=typeof arguments[0])return this.pc.getStats.apply(this.pc,arguments);var e=arguments[0];this.pc.getStats().then(function(t){e(null,t)},function(t){e(t)})},t.exports=r},{"lodash.clonedeep":164,"sdp-jingle-json":225,util:309,wildemitter:70}],70:[function(e,t,n){arguments[4][36][0].apply(n,arguments)},{dup:36}],71:[function(e,t,n){arguments[4][52][0].apply(n,arguments)},{async:72,dup:52,"extend-object":33,util:309,uuid:74,wildemitter:328}],72:[function(e,t,n){(function(e,n,r){!function(){function i(){}function o(e){return e}function a(e){return!!e}function s(e){return!e}function c(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function u(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}function l(e){return B(e)||"number"==typeof e.length&&e.length>=0&&e.length%1===0}function d(e,t){for(var n=-1,r=e.length;++n<r;)t(e[n],n,e)}function p(e,t){for(var n=-1,r=e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function f(e){return p(Array(e),function(e,t){return t})}function h(e,t,n){return d(e,function(e,r,i){n=t(n,e,r,i)}),n}function m(e,t){d(G(e),function(n){t(e[n],n)})}function v(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}function g(e){var t,n,r=-1;return l(e)?(t=e.length,function(){return r++,t>r?r:null}):(n=G(e),t=n.length,function(){return r++,t>r?n[r]:null})}function y(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;n>i;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r)}}}function _(e){return function(t,n,r){return e(t,r)}}function S(e){return function(t,n,r){r=u(r||i),t=t||[];var o=g(t);if(0>=e)return r(null);var a=!1,s=0,l=!1;!function d(){if(a&&0>=s)return r(null);for(;e>s&&!l;){var i=o();if(null===i)return a=!0,void(0>=s&&r(null));s+=1,n(t[i],i,c(function(e){s-=1,e?(r(e),l=!0):d()}))}}()}}function b(e){return function(t,n,r){return e(N.eachOf,t,n,r)}}function C(e){return function(t,n,r,i){return e(S(n),t,r,i)}}function w(e){return function(t,n,r){return e(N.eachOfSeries,t,n,r)}}function E(e,t,n,r){r=u(r||i),t=t||[];var o=l(t)?[]:{};e(t,function(e,t,r){n(e,function(e,n){o[t]=n,r(e)})},function(e){r(e,o)})}function R(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n){n&&i.push({index:t,value:e}),r()})},function(){r(p(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})}function P(e,t,n,r){R(e,t,function(e,t){n(e,function(e){t(!e)})},r)}function x(e,t,n){return function(r,i,o,a){function s(){a&&a(n(!1,void 0))}function c(e,r,i){return a?void o(e,function(r){a&&t(r)&&(a(n(!0,e)),a=o=!1),i()}):i()}arguments.length>3?e(r,i,c,s):(a=o,o=i,e(r,c,s))}}function T(e,t){return t}function L(e,t,n){n=n||i;var r=l(t)?[]:{};e(t,function(e,t,n){e(y(function(e,i){i.length<=1&&(i=i[0]),r[t]=i,n(e)}))},function(e){n(e,r)})}function O(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(e,t){i=i.concat(t||[]),r(e)})},function(e){r(e,i)})}function I(e,t,n){function r(e,t,n,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");return e.started=!0,B(t)||(t=[t]),0===t.length&&e.idle()?N.setImmediate(function(){e.drain()}):(d(t,function(t){var o={data:t,callback:r||i};n?e.tasks.unshift(o):e.tasks.push(o),e.tasks.length===e.concurrency&&e.saturated()}),void N.setImmediate(e.process))}function o(e,t){return function(){a-=1;var n=!1,r=arguments;d(t,function(e){d(s,function(t,r){t!==e||n||(s.splice(r,1),n=!0)}),e.callback.apply(e,r)}),e.tasks.length+a===0&&e.drain(),e.process()}}if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var a=0,s=[],u={tasks:[],concurrency:t,payload:n,saturated:i,empty:i,drain:i,started:!1,paused:!1,push:function(e,t){r(u,e,!1,t)},kill:function(){u.drain=i,u.tasks=[]},unshift:function(e,t){r(u,e,!0,t)},process:function(){for(;!u.paused&&a<u.concurrency&&u.tasks.length;){var t=u.payload?u.tasks.splice(0,u.payload):u.tasks.splice(0,u.tasks.length),n=p(t,function(e){return e.data});0===u.tasks.length&&u.empty(),a+=1,s.push(t[0]);var r=c(o(u,t));e(n,r)}},length:function(){return u.tasks.length},running:function(){return a},workersList:function(){return s},idle:function(){return u.tasks.length+a===0},pause:function(){u.paused=!0},resume:function(){if(u.paused!==!1){u.paused=!1;for(var e=Math.min(u.concurrency,u.tasks.length),t=1;e>=t;t++)N.setImmediate(u.process)}}};return u}function M(e){return y(function(t,n){t.apply(null,n.concat([y(function(t,n){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&d(n,function(t){console[e](t)}))})]))})}function A(e){return function(t,n,r){e(f(t),n,r)}}function D(e){return y(function(t,n){var r=y(function(n){var r=this,i=n.pop();return e(t,function(e,t,i){e.apply(r,n.concat([i]))},i)});return n.length?r.apply(this,n):r})}function k(e){return y(function(t){var n=t.pop();t.push(function(){var e=arguments;r?N.setImmediate(function(){n.apply(null,e)}):n.apply(null,e)});var r=!0;e.apply(this,t),r=!1})}var j,N={},V="object"==typeof self&&self.self===self&&self||"object"==typeof n&&n.global===n&&n||this;null!=V&&(j=V.async),N.noConflict=function(){return V.async=j,N};var U=Object.prototype.toString,B=Array.isArray||function(e){return"[object Array]"===U.call(e)},F=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},G=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},q="function"==typeof r&&r,J=q?function(e){q(e)}:function(e){setTimeout(e,0)};N.nextTick="object"==typeof e&&"function"==typeof e.nextTick?e.nextTick:J,N.setImmediate=q?J:N.nextTick,N.forEach=N.each=function(e,t,n){return N.eachOf(e,_(t),n)},N.forEachSeries=N.eachSeries=function(e,t,n){return N.eachOfSeries(e,_(t),n)},N.forEachLimit=N.eachLimit=function(e,t,n,r){return S(t)(e,_(n),r)},N.forEachOf=N.eachOf=function(e,t,n){function r(e){s--,e?n(e):null===o&&0>=s&&n(null)}n=u(n||i),e=e||[];for(var o,a=g(e),s=0;null!=(o=a());)s+=1,t(e[o],o,c(r));0===s&&n(null)},N.forEachOfSeries=N.eachOfSeries=function(e,t,n){function r(){var i=!0;return null===a?n(null):(t(e[a],a,c(function(e){if(e)n(e);else{if(a=o(),null===a)return n(null);i?N.setImmediate(r):r()}})),void(i=!1))}n=u(n||i),e=e||[];var o=g(e),a=o();r()},N.forEachOfLimit=N.eachOfLimit=function(e,t,n,r){S(t)(e,n,r)},N.map=b(E),N.mapSeries=w(E),N.mapLimit=C(E),N.inject=N.foldl=N.reduce=function(e,t,n,r){N.eachOfSeries(e,function(e,r,i){n(t,e,function(e,n){t=n,i(e)})},function(e){r(e,t)})},N.foldr=N.reduceRight=function(e,t,n,r){var i=p(e,o).reverse();N.reduce(i,t,n,r)},N.transform=function(e,t,n,r){3===arguments.length&&(r=n,n=t,t=B(e)?[]:{}),N.eachOf(e,function(e,r,i){n(t,e,r,i)},function(e){r(e,t)})},N.select=N.filter=b(R),N.selectLimit=N.filterLimit=C(R),N.selectSeries=N.filterSeries=w(R),N.reject=b(P),N.rejectLimit=C(P),N.rejectSeries=w(P),N.any=N.some=x(N.eachOf,a,o),N.someLimit=x(N.eachOfLimit,a,o),N.all=N.every=x(N.eachOf,s,s),N.everyLimit=x(N.eachOfLimit,s,s),N.detect=x(N.eachOf,o,T),N.detectSeries=x(N.eachOfSeries,o,T),N.detectLimit=x(N.eachOfLimit,o,T),N.sortBy=function(e,t,n){function r(e,t){var n=e.criteria,r=t.criteria;return r>n?-1:n>r?1:0}N.map(e,function(e,n){t(e,function(t,r){t?n(t):n(null,{value:e,criteria:r})})},function(e,t){return e?n(e):void n(null,p(t.sort(r),function(e){return e.value}))})},N.auto=function(e,t,n){function r(e){g.unshift(e)}function o(e){var t=v(g,e);t>=0&&g.splice(t,1)}function a(){c--,d(g.slice(0),function(e){e()})}"function"==typeof arguments[1]&&(n=t,t=null),n=u(n||i);var s=G(e),c=s.length;if(!c)return n(null);t||(t=c);var l={},p=0,f=!1,g=[];r(function(){c||n(null,l)}),d(s,function(i){function s(){return t>p&&h(_,function(e,t){return e&&l.hasOwnProperty(t)},!0)&&!l.hasOwnProperty(i)}function c(){s()&&(p++,o(c),d[d.length-1](g,l))}if(!f){for(var u,d=B(e[i])?e[i]:[e[i]],g=y(function(e,t){if(p--,t.length<=1&&(t=t[0]),e){var r={};m(l,function(e,t){r[t]=e}),r[i]=t,f=!0,n(e,r)}else l[i]=t,N.setImmediate(a)}),_=d.slice(0,d.length-1),S=_.length;S--;){if(!(u=e[_[S]]))throw new Error("Has nonexistent dependency in "+_.join(", "));if(B(u)&&v(u,i)>=0)throw new Error("Has cyclic dependencies")}s()?(p++,d[d.length-1](g,l)):r(c)}})},N.retry=function(e,t,n){function r(e,t){if("number"==typeof t)e.times=parseInt(t,10)||o;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||o,e.interval=parseInt(t.interval,10)||a}}function i(e,t){function n(e,n){return function(r){e(function(e,t){r(!e||n,{err:e,result:t})},t)}}function r(e){return function(t){setTimeout(function(){t(null)},e)}}for(;c.times;){var i=!(c.times-=1);s.push(n(c.task,i)),!i&&c.interval>0&&s.push(r(c.interval))}N.series(s,function(t,n){n=n[n.length-1],(e||c.callback)(n.err,n.result)})}var o=5,a=0,s=[],c={times:o,interval:a},u=arguments.length;if(1>u||u>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=u&&"function"==typeof e&&(n=t,t=e),"function"!=typeof e&&r(c,e),c.callback=n,c.task=t,c.callback?i():i},N.waterfall=function(e,t){function n(e){return y(function(r,i){if(r)t.apply(null,[r].concat(i));else{var o=e.next();i.push(o?n(o):t),k(e).apply(null,i)}})}if(t=u(t||i),!B(e)){var r=new Error("First argument to waterfall must be an array of functions");return t(r)}return e.length?void n(N.iterator(e))():t()},N.parallel=function(e,t){L(N.eachOf,e,t)},N.parallelLimit=function(e,t,n){L(S(t),e,n)},N.series=function(e,t){L(N.eachOfSeries,e,t)},N.iterator=function(e){function t(n){function r(){return e.length&&e[n].apply(null,arguments),r.next()}return r.next=function(){return n<e.length-1?t(n+1):null},r}return t(0)},N.apply=y(function(e,t){return y(function(n){return e.apply(null,t.concat(n))})}),N.concat=b(O),N.concatSeries=w(O),N.whilst=function(e,t,n){if(n=n||i,e()){var r=y(function(i,o){i?n(i):e.apply(this,o)?t(r):n.apply(null,[null].concat(o))});t(r)}else n(null)},N.doWhilst=function(e,t,n){var r=0;return N.whilst(function(){return++r<=1||t.apply(this,arguments)},e,n)},N.until=function(e,t,n){return N.whilst(function(){return!e.apply(this,arguments)},t,n)},N.doUntil=function(e,t,n){return N.doWhilst(e,function(){return!t.apply(this,arguments)},n)},N.during=function(e,t,n){n=n||i;var r=y(function(t,r){t?n(t):(r.push(o),e.apply(this,r))}),o=function(e,i){e?n(e):i?t(r):n(null)};e(o)},N.doDuring=function(e,t,n){var r=0;N.during(function(e){r++<1?e(null,!0):t.apply(this,arguments)},e,n)},N.queue=function(e,t){var n=I(function(t,n){e(t[0],n)},t,1);return n},N.priorityQueue=function(e,t){function n(e,t){return e.priority-t.priority}function r(e,t,n){for(var r=-1,i=e.length-1;i>r;){var o=r+(i-r+1>>>1);n(t,e[o])>=0?r=o:i=o-1}return r}function o(e,t,o,a){if(null!=a&&"function"!=typeof a)throw new Error("task callback must be a function");return e.started=!0,B(t)||(t=[t]),0===t.length?N.setImmediate(function(){e.drain()}):void d(t,function(t){var s={data:t,priority:o,callback:"function"==typeof a?a:i};e.tasks.splice(r(e.tasks,s,n)+1,0,s),e.tasks.length===e.concurrency&&e.saturated(),N.setImmediate(e.process)})}var a=N.queue(e,t);return a.push=function(e,t,n){o(a,e,t,n)},delete a.unshift,a},N.cargo=function(e,t){return I(e,1,t)},N.log=M("log"),N.dir=M("dir"),N.memoize=function(e,t){var n={},r={},i=Object.prototype.hasOwnProperty;t=t||o;var a=y(function(o){var a=o.pop(),s=t.apply(null,o);i.call(n,s)?N.setImmediate(function(){a.apply(null,n[s])}):i.call(r,s)?r[s].push(a):(r[s]=[a],e.apply(null,o.concat([y(function(e){n[s]=e;var t=r[s];delete r[s];for(var i=0,o=t.length;o>i;i++)t[i].apply(null,e)})])))});return a.memo=n,a.unmemoized=e,a},N.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},N.times=A(N.map),N.timesSeries=A(N.mapSeries),N.timesLimit=function(e,t,n,r){return N.mapLimit(f(e),t,n,r)},N.seq=function(){var e=arguments;return y(function(t){var n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=i,N.reduce(e,t,function(e,t,r){t.apply(n,e.concat([y(function(e,t){r(e,t)})]))},function(e,t){r.apply(n,[e].concat(t))})})},N.compose=function(){return N.seq.apply(null,Array.prototype.reverse.call(arguments))},N.applyEach=D(N.eachOf),N.applyEachSeries=D(N.eachOfSeries),N.forever=function(e,t){function n(e){return e?r(e):void o(n)}var r=c(t||i),o=k(e);n()},N.ensureAsync=k,N.constant=y(function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}}),N.wrapSync=N.asyncify=function(e){return y(function(t){var n,r=t.pop();try{n=e.apply(this,t)}catch(i){return r(i)}F(n)&&"function"==typeof n.then?n.then(function(e){r(null,e)})["catch"](function(e){r(e.message?e:new Error(e))}):r(null,n)})},"object"==typeof t&&t.exports?t.exports=N:"function"==typeof define&&define.amd?define([],function(){return N}):V.async=N}()}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:8,timers:303}],73:[function(e,t,n){(function(e){var n,r=e.crypto||e.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],74:[function(e,t,n){function r(e,t,n){var r=t&&n||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>i&&(t[r+i++]=u[e])});16>i;)t[r+i++]=0;return t}function i(e,t){var n=t||0,r=c;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function o(e,t,n){var r=t&&n||0,o=t||[];e=e||{};var a=void 0!==e.clockseq?e.clockseq:f,s=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:m+1,u=s-h+(c-m)/1e4;if(0>u&&void 0===e.clockseq&&(a=a+1&16383),(0>u||s>h)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=s,m=c,f=a,s+=122192928e5;var l=(1e4*(268435455&s)+c)%4294967296;o[r++]=l>>>24&255,o[r++]=l>>>16&255,o[r++]=l>>>8&255,o[r++]=255&l;var d=s/4294967296*1e4&268435455;o[r++]=d>>>8&255,o[r++]=255&d,o[r++]=d>>>24&15|16,o[r++]=d>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var v=e.node||p,g=0;6>g;g++)o[r+g]=v[g];return t?t:i(o)}function a(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var o=e.random||(e.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;16>a;a++)t[r+a]=o[a];return t||i(o)}for(var s=e("./rng"),c=[],u={},l=0;256>l;l++)c[l]=(l+256).toString(16).substr(1),u[c[l]]=l;var d=s(),p=[1|d[0],d[1],d[2],d[3],d[4],d[5]],f=16383&(d[6]<<8|d[7]),h=0,m=0,v=a;v.v1=o,v.v4=a,v.parse=r,v.unparse=i,t.exports=v},{"./rng":73}],75:[function(e,t,n){function r(e){a.call(this),e=e||{},this.jid=e.jid,this.selfID=e.selfID||this.jid&&this.jid.full||this.jid||"",this.sessions={},this.peers={},this.prepareSession=e.prepareSession||function(e){return e.applicationTypes.indexOf("rtp")>=0?new u(e):e.applicationTypes.indexOf("filetransfer")>=0?new l(e):void 0},this.performTieBreak=e.performTieBreak||function(e,t){var n=t.jingle.contents.map(function(e){return e.application?e.application.applicationType:void 0}),r=o(e.pendingApplicationTypes,n);return r.length>0},this.screenSharingSupport=s.screenSharing,this.capabilities=["urn:xmpp:jingle:1"],s.support&&(this.capabilities=["urn:xmpp:jingle:1","urn:xmpp:jingle:apps:rtp:1","urn:xmpp:jingle:apps:rtp:audio","urn:xmpp:jingle:apps:rtp:video","urn:xmpp:jingle:apps:rtp:rtcb-fb:0","urn:xmpp:jingle:apps:rtp:rtp-hdrext:0","urn:xmpp:jingle:apps:rtp:ssma:0","urn:xmpp:jingle:apps:dtls:0","urn:xmpp:jingle:apps:grouping:0","urn:xmpp:jingle:apps:file-transfer:3","urn:xmpp:jingle:transports:ice-udp:1","urn:xmpp:jingle:transports.dtls-sctp:1","urn:ietf:rfc:3264","urn:ietf:rfc:5576","urn:ietf:rfc:5888"]),this.config={debug:!1,peerConnectionConfig:{iceServers:e.iceServers||[{url:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[{DtlsSrtpKeyAgreement:!0},{RtpDataChannels:!1}]},media:{audio:!0,video:!0}};for(var t in e)this.config[t]=e[t];this.iceServers=this.config.peerConnectionConfig.iceServers}var i=e("util"),o=e("intersect"),a=e("wildemitter"),s=e("webrtcsupport"),c=e("jingle-session"),u=e("jingle-media-session"),l=e("jingle-filetransfer-session");i.inherits(r,a),r.prototype.addICEServer=function(e){"string"==typeof e&&(e={url:e}),this.iceServers.push(e)},r.prototype.addSession=function(e){var t=this,n=e.sid,r=e.peerID;return this.sessions[n]=e,this.peers[r]||(this.peers[r]=[]),this.peers[r].push(e),e.on("terminated",function(){var i=t.peers[r]||[];i.length&&i.splice(i.indexOf(e),1),delete t.sessions[n]}),e.on("*",function(n,r,i,o){if("send"===n){var a=r.jingle&&r.jingle.action;e.isInitiator&&"session-initiate"===a&&t.emit("outgoing",e)}!t.config.debug||"log:debug"!==n&&"log:error"!==n||console.log("Jingle:",r,i,o),0!==n.indexOf("change")&&t.emit(n,r,i,o)}),this.emit("createdSession",e),e},r.prototype.createMediaSession=function(e,t,n){var r=new u({sid:t,peer:e,initiator:!0,stream:n,parent:this,iceServers:this.iceServers,constraints:this.config.peerConnectionConstraints});return this.addSession(r),r},r.prototype.createFileTransferSession=function(e,t){var n=new l({sid:t,peer:e,initiator:!0,parent:this});return this.addSession(n),n},r.prototype.endPeerSessions=function(e,t,n){e=e.full||e;var r=this.peers[e]||[];delete this.peers[e],r.forEach(function(e){e.end(t||"gone",n)})},r.prototype.endAllSessions=function(e,t){var n=this;Object.keys(this.peers).forEach(function(r){n.endPeerSessions(r,e,t)})},r.prototype._createIncomingSession=function(e,t){var n;return this.prepareSession&&(n=this.prepareSession(e,t)),n||(n=new c(e)),this.addSession(n),n},r.prototype._sendError=function(e,t,n){n.type||(n.type="cancel"),this.emit("send",{to:e,id:t,type:"error",error:n})},r.prototype._log=function(e,t){this.emit("log:"+e,t)},r.prototype.process=function(e){var t=this,n=e.jingle?e.jingle.sid:null,r=this.sessions[n]||null,i=e.id,o=e.from.full||e.from;if("error"===e.type){var a=e.error&&"tie-break"===e.error.jingleCondition;return r&&r.pending&&a?r.end("alternative-session",!0):(r&&(r.pendingAction=!1),this.emit("error",e))}if("result"===e.type)return void(r&&(r.pendingAction=!1));var s=e.jingle.action,c=e.jingle.contents||[],u=c.map(function(e){return e.application?e.application.applicationType:void 0}),l=c.map(function(e){return e.transport?e.transport.transportType:void 0});if("session-initiate"!==s){if(!r)return this._log("error","Unknown session",n),this._sendError(o,i,{condition:"item-not-found",jingleCondition:"unknown-session"});if(r.peerID!==o||r.ended)return this._log("error","Session has ended, or action has wrong sender"),this._sendError(o,i,{condition:"item-not-found",jingleCondition:"unknown-session"});if("session-accept"===s&&!r.pending)return this._log("error","Tried to accept session twice",n),this._sendError(o,i,{condition:"unexpected-request",jingleCondition:"out-of-order"});if("session-terminate"!==s&&s===r.pendingAction&&(this._log("error","Tie break during pending request"),r.isInitiator))return this._sendError(o,i,{condition:"conflict",jingleCondition:"tie-break"})}else if(r){if(r.peerID!==o)return this._log("error","Duplicate sid from new sender"),this._sendError(o,i,{condition:"service-unavailable"});if(!r.pending)return this._log("error","Someone is doing this wrong"),this._sendError(o,i,{condition:"unexpected-request",jingleCondition:"out-of-order"});if(this.selfID>r.peerID&&this.performTieBreak(r,e))return this._log("error","Tie break new session because of duplicate sids"),this._sendError(o,i,{condition:"conflict",jingleCondition:"tie-break"})}else if(this.peers[o]&&this.peers[o].length)for(var d=0,p=this.peers[o].length;p>d;d++){var f=this.peers[o][d];if(f&&f.pending&&f.sid>n&&this.performTieBreak(f,e))return this._log("info","Tie break session-initiate"),this._sendError(o,i,{condition:"conflict",jingleCondition:"tie-break"})}if("session-initiate"===s){if(!c.length)return t._sendError(o,i,{condition:"bad-request"});r=this._createIncomingSession({sid:n,peer:e.from,peerID:o,initiator:!1,parent:this,applicationTypes:u,transportTypes:l,iceServers:this.iceServers,constraints:this.config.peerConnectionConstraints},e)}r.process(s,e.jingle,function(n){n?(t._log("error","Could not process request",e,n),t._sendError(o,i,n)):(t.emit("send",{to:o,id:i,type:"result"}),"session-initiate"===s&&t.emit("incoming",r))})},t.exports=r},{intersect:47,"jingle-filetransfer-session":50,"jingle-media-session":65,"jingle-session":71,util:309,webrtcsupport:327,wildemitter:328}],76:[function(e,t,n){function r(e){return!("object"!=typeof e||null==e||e instanceof Boolean||e instanceof Date||e instanceof Number||e instanceof RegExp||e instanceof String)}function i(e){function t(e){return"#"+e.map(function(e){return e.toString().replace(/~/g,"~0").replace(/\//g,"~1")}).join("/")}var i=new n.WeakSet,o=new n.WeakMap;return function(e,n){if("$ref"!==e&&r(n)){if(i.has(n))return{$ref:t(o.get(n))};o.set(n,(o.get(this)||[]).concat([e])),i.add(n)}return n}}function o(){function e(e){for(var n,r,i=e.$ref.slice(1).split("/"),o=this,a=0;a<i.length;a++)n=i[a].replace(/~1/g,"/").replace(/~0/g,"~"),o=o[n];r=t.get(e),r[n]=o}var t=new n.WeakMap,i=new n.Set;return function(n,o){if("$ref"===n)i.add(this);else if(r(o)){var a=""===n&&1===Object.keys(this).length;a?i.forEach(e,this):t.set(o,this)}return o}}function a(e){return Object.defineProperties(e,{decycle:{value:i},retrocycle:{value:o}})}n.WeakMap=WeakMap,n.WeakSet=WeakSet,n.Set=Set,n.decycle=i,n.retrocycle=o,n.extend=a},{}],77:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./shortcuts"),o=r(i),a=e("./types"),s=r(a);n["default"]=function(e){e.use(s["default"]),e.use(o["default"])},t.exports=n["default"]},{"./shortcuts":78,"./types":79}],78:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i={client:r.Namespace.CLIENT,server:r.Namespace.SERVER,component:r.Namespace.COMPONENT};n["default"]=function(e){e.extendMessage=function(e,t){var n=this;this.withMessage(function(r){n.extend(r,e,t)})},e.extendPresence=function(e,t){var n=this;this.withPresence(function(r){n.extend(r,e,t)})},e.extendIQ=function(e,t){var n=this;this.withIQ(function(r){n.extend(r,e,t)})},e.extendStreamFeatures=function(e){var t=this;this.withStreamFeatures(function(n){t.extend(n,e)})},e.extendPubsubItem=function(e){var t=this;this.withPubsubItem(function(n){t.extend(n,e)})},e.withIQ=function(e){this.withDefinition("iq",r.Namespace.CLIENT,e),this.withDefinition("iq",r.Namespace.COMPONENT,e);

},e.withMessage=function(e){this.withDefinition("message",r.Namespace.CLIENT,e),this.withDefinition("message",r.Namespace.COMPONENT,e)},e.withPresence=function(e){this.withDefinition("presence",r.Namespace.CLIENT,e),this.withDefinition("presence",r.Namespace.COMPONENT,e)},e.withStreamFeatures=function(e){this.withDefinition("features",r.Namespace.STREAM,e)},e.withStanzaError=function(e){this.withDefinition("error",r.Namespace.CLIENT,e),this.withDefinition("error",r.Namespace.COMPONENT,e)},e.withDataForm=function(e){this.withDefinition("x",r.Namespace.DATAFORM,e)},e.withPubsubItem=function(e){this.withDefinition("item",r.Namespace.PUBSUB,e),this.withDefinition("item",r.Namespace.PUBSUB_EVENT,e)},e.getMessage=function(){var e=void 0===arguments[0]?"client":arguments[0];return this.getDefinition("message",i[e])},e.getPresence=function(){var e=void 0===arguments[0]?"client":arguments[0];return this.getDefinition("presence",i[e])},e.getIQ=function(){var e=void 0===arguments[0]?"client":arguments[0];return this.getDefinition("iq",i[e])},e.getStreamError=function(){return this.getDefinition("error",r.Namespace.STREAM)},e.getIq=e.getIQ,e.withIq=e.withIQ},t.exports=n["default"]},{"xmpp-constants":330}],79:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-jid");n["default"]=function(e){var t=e.utils;t.jidAttribute=function(e,n){return{get:function(){var i=new r.JID(t.getAttribute(this.xml,e));return n&&(i.prepped=!0),i},set:function(n){t.setAttribute(this.xml,e,(n||"").toString())}}},t.jidSub=function(e,n,i){return{get:function(){var o=new r.JID(t.getSubText(this.xml,e,n));return i&&(o.prepped=!0),o},set:function(r){t.setSubText(this.xml,e,n,(r||"").toString())}}},t.tzoSub=t.field(function(e,n,r,i){var o=void 0,a=void 0,s=void 0,c=-1,u=t.getSubText(e,n,r);return u?("-"===u.charAt(0)&&(c=1,u=u.slice(1)),s=u.split(":"),o=parseInt(s[0],10),a=parseInt(s[1],10),(60*o+a)*c):i},function(e,n,r,i){var o=void 0,a=void 0,s="-";"number"==typeof i?(0>i&&(i=-i,s="+"),o=i/60,a=i%60,s+=(10>o?"0":"")+o+":"+(10>a?"0":"")+a):s=i,t.setSubText(e,n,r,s)})},t.exports=n["default"]},{"xmpp-jid":336}],80:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"_address",namespace:r.Namespace.ADDRESS,element:"address",fields:{jid:t.jidAttribute("jid"),uri:t.attribute("uri"),node:t.attribute("node"),description:t.attribute("desc"),delivered:t.boolAttribute("delivered"),type:t.attribute("type")}}),i=t.subMultiExtension(r.Namespace.ADDRESS,"addresses",n);e.withMessage(function(t){e.add(t,"addresses",i)}),e.withPresence(function(t){e.add(t,"addresses",i)})},t.exports=n["default"]},{"xmpp-constants":330}],81:[function(e,t,n){"use strict";var r=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var i=e("xmpp-constants"),o=e("lodash.foreach"),a=r(o);n["default"]=function(e){var t=e.utils,n=e.define({name:"avatar",namespace:i.Namespace.AVATAR_METADATA,element:"info",fields:{id:t.attribute("id"),bytes:t.attribute("bytes"),height:t.attribute("height"),width:t.attribute("width"),type:t.attribute("type","image/png"),url:t.attribute("url")}}),r={get:function(){var e=t.find(this.xml,i.Namespace.AVATAR_METADATA,"metadata"),r=[];if(e.length){var o=t.find(e[0],i.Namespace.AVATAR_METADATA,"info");a["default"](o,function(e){r.push(new n({},e))})}return r},set:function(e){var r=t.findOrCreate(this.xml,i.Namespace.AVATAR_METADATA,"metadata");t.setAttribute(r,"xmlns",i.Namespace.AVATAR_METADATA),a["default"](e,function(e){var t=new n(e);r.appendChild(t.xml)})}};e.withPubsubItem(function(n){e.add(n,"avatars",r),e.add(n,"avatarData",t.textSub(i.Namespace.AVATAR_DATA,"data"))})},t.exports=n["default"]},{"babel-runtime/helpers/interop-require-default":4,"lodash.foreach":166,"xmpp-constants":330}],82:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"bind",namespace:r.Namespace.BIND,element:"bind",fields:{resource:t.textSub(r.Namespace.BIND,"resource"),jid:t.jidSub(r.Namespace.BIND,"jid")}});e.extendIQ(n),e.extendStreamFeatures(n)},t.exports=n["default"]},{"xmpp-constants":330}],83:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=e("xmpp-jid");n["default"]=function(e){var t=e.utils,n={get:function(){var e=[],n=t.find(this.xml,r.Namespace.BLOCKING,"item");return n.length?(n.forEach(function(n){e.push(new i.JID(t.getAttribute(n,"jid","")))}),e):e},set:function(e){var n=this;e.forEach(function(e){var i=t.createElement(r.Namespace.BLOCKING,"item",r.Namespace.BLOCKING);t.setAttribute(i,"jid",e.toString()),n.xml.appendChild(i)})}},o=e.define({name:"block",namespace:r.Namespace.BLOCKING,element:"block",fields:{jids:n}}),a=e.define({name:"unblock",namespace:r.Namespace.BLOCKING,element:"unblock",fields:{jids:n}}),s=e.define({name:"blockList",namespace:r.Namespace.BLOCKING,element:"blocklist",fields:{jids:n}});e.extendIQ(o),e.extendIQ(a),e.extendIQ(s)},t.exports=n["default"]},{"xmpp-constants":330,"xmpp-jid":336}],84:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"bob",namespace:r.Namespace.BOB,element:"data",fields:{cid:t.attribute("cid"),maxAge:t.numberAttribute("max-age"),type:t.attribute("type"),data:t.text()}});e.extendIQ(n),e.extendMessage(n),e.extendPresence(n)},t.exports=n["default"]},{"xmpp-constants":330}],85:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"_conference",namespace:r.Namespace.BOOKMARKS,element:"conference",fields:{name:t.attribute("name"),autoJoin:t.boolAttribute("autojoin"),jid:t.jidAttribute("jid"),nick:t.textSub(r.Namespace.BOOKMARKS,"nick")}}),i=e.define({name:"bookmarks",namespace:r.Namespace.BOOKMARKS,element:"storage"});e.extend(i,n,"conferences"),e.withDefinition("query",r.Namespace.PRIVATE,function(t){e.extend(t,i)})},t.exports=n["default"]},{"xmpp-constants":330}],86:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils;e.define({name:"bosh",namespace:r.Namespace.BOSH,element:"body",prefixes:{xmpp:r.Namespace.BOSH_XMPP},fields:{accept:t.attribute("accept"),ack:t.numberAttribute("ack"),authid:t.attribute("authid"),charsets:t.attribute("charsets"),condition:t.attribute("condition"),content:t.attribute("content"),from:t.jidAttribute("from",!0),hold:t.numberAttribute("hold"),inactivity:t.numberAttribute("inactivity"),key:t.attribute("key"),maxpause:t.numberAttribute("maxpause"),newKey:t.attribute("newkey"),pause:t.numberAttribute("pause"),polling:t.numberAttribute("polling"),resport:t.numberAttribute("report"),requests:t.numberAttribute("requests"),rid:t.numberAttribute("rid"),sid:t.attribute("sid"),stream:t.attribute("stream"),time:t.attribute("time"),to:t.jidAttribute("to",!0),type:t.attribute("type"),ver:t.attribute("ver"),wait:t.numberAttribute("wait"),uri:t.textSub(r.Namespace.BOSH,"uri"),lang:t.langAttribute(),version:t.attribute("xmpp:version","1.0"),restart:t.attribute("xmpp:restart"),restartLogic:t.boolAttribute("xmpp:restartLogic"),payload:{get:function(){for(var t=[],n=0,r=this.xml.childNodes.length;r>n;n++){var i=e.build(this.xml.childNodes[n]);void 0!==i&&t.push(i)}return t},set:function(e){var t=this;e.forEach(function(e){t.xml.appendChild(e.xml)})}}}})},t.exports=n["default"]},{"xmpp-constants":330}],87:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.define({name:"carbonSent",eventName:"carbon:sent",namespace:r.Namespace.CARBONS_2,element:"sent"}),n=e.define({name:"carbonReceived",eventName:"carbon:received",namespace:r.Namespace.CARBONS_2,element:"received"}),i=e.define({name:"carbonPrivate",eventName:"carbon:private",namespace:r.Namespace.CARBONS_2,element:"private"}),o=e.define({name:"enableCarbons",namespace:r.Namespace.CARBONS_2,element:"enable"}),a=e.define({name:"disableCarbons",namespace:r.Namespace.CARBONS_2,element:"disable"});e.withDefinition("forwarded",r.Namespace.FORWARD_0,function(r){e.extend(t,r),e.extend(n,r)}),e.extendMessage(t),e.extendMessage(n),e.extendMessage(i),e.extendIQ(o),e.extendIQ(a)},t.exports=n["default"]},{"xmpp-constants":330}],88:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["next","prev","complete","cancel"],o=["bad-action","bad-locale","bad-payload","bad-sessionid","malformed-action","session-expired"];n["default"]=function(e){var t=e.utils,n=e.define({name:"command",namespace:r.Namespace.ADHOC_COMMANDS,element:"command",fields:{action:t.attribute("action"),node:t.attribute("node"),sessionid:t.attribute("sessionid"),status:t.attribute("status"),execute:t.subAttribute(r.Namespace.ADHOC_COMMANDS,"actions","execute"),actions:{get:function(){var e=[],n=t.find(this.xml,r.Namespace.ADHOC_COMMANDS,"actions");return n.length?(i.forEach(function(i){var o=t.find(n[0],r.Namespace.ADHOC_COMMANDS,i);o.length&&e.push(i)}),e):[]},set:function(e){for(var n=t.findOrCreate(this.xml,r.Namespace.ADHOC_COMMANDS,"actions"),i=0,o=n.childNodes.length;o>i;i++)n.removeChild(n.childNodes[i]);e.forEach(function(e){n.appendChild(t.createElement(r.Namespace.ADHOC_COMMANDS,e.toLowerCase(),r.Namespace.ADHOC_COMMANDS))})}}}}),a=e.define({name:"_commandNote",namespace:r.Namespace.ADHOC_COMMANDS,element:"note",fields:{type:t.attribute("type"),value:t.text()}});e.extend(n,a,"notes"),e.extendIQ(n),e.withStanzaError(function(n){e.add(n,"adhocCommandCondition",t.enumSub(r.Namespace.ADHOC_COMMANDS,o))}),e.withDataForm(function(t){e.extend(n,t)})},t.exports=n["default"]},{"xmpp-constants":330}],89:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.define({name:"clientStateIndication",namespace:r.Namespace.CSI,element:"csi"});e.define({name:"csiActive",eventName:"csi:active",namespace:r.Namespace.CSI,element:"active",topLevel:!0}),e.define({name:"csiInactive",eventName:"csi:inactive",namespace:r.Namespace.CSI,element:"inactive",topLevel:!0}),e.extendStreamFeatures(t)},t.exports=n["default"]},{"xmpp-constants":330}],90:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=e("xmpp-jid"),o=["text-single","text-private","list-single","jid-single"];n["default"]=function(e){var t=e.utils,n=e.define({name:"_field",namespace:r.Namespace.DATAFORM,element:"field",init:function(e){this._type=(e||{}).type||this.type},fields:{type:{get:function(){return t.getAttribute(this.xml,"type","text-single")},set:function(e){this._type=e,t.setAttribute(this.xml,"type",e)}},name:t.attribute("var"),desc:t.textSub(r.Namespace.DATAFORM,"desc"),required:t.boolSub(r.Namespace.DATAFORM,"required"),label:t.attribute("label"),value:{get:function(){var e=t.getMultiSubText(this.xml,r.Namespace.DATAFORM,"value");return"boolean"===this._type?"1"===e[0]||"true"===e[0]:e.length>1?"text-multi"===this._type?e.join("\n"):"jid-multi"===this._type?e.map(function(e){return new i.JID(e)}):e:o.indexOf(this._type)>=0?"jid-single"===this._type?new i.JID(e[0]):e[0]:e},set:function(e){if("boolean"===this._type||e===!0||e===!1){var n=e===!0||"true"===e||"1"===e,i=t.createElement(r.Namespace.DATAFORM,"value",r.Namespace.DATAFORM);i.textContent=n?"1":"0",this.xml.appendChild(i)}else"text-multi"===this._type&&"string"==typeof e&&(e=e.split("\n")),t.setMultiSubText(this.xml,r.Namespace.DATAFORM,"value",e,function(e){var n=t.createElement(r.Namespace.DATAFORM,"value",r.Namespace.DATAFORM);n.textContent=e,this.xml.appendChild(n)}.bind(this))}}}}),a=e.define({name:"_formoption",namespace:r.Namespace.DATAFORM,element:"option",fields:{label:t.attribute("label"),value:t.textSub(r.Namespace.DATAFORM,"value")}}),s=e.define({name:"_formitem",namespace:r.Namespace.DATAFORM,element:"item"}),c=e.define({name:"media",element:"media",namespace:r.Namespace.DATAFORM_MEDIA,fields:{height:t.numberAttribute("height"),width:t.numberAttribute("width")}}),u=e.define({name:"_mediaURI",element:"uri",namespace:r.Namespace.DATAFORM_MEDIA,fields:{uri:t.text(),type:t.attribute("type")}}),l=e.define({name:"validation",element:"validate",namespace:r.Namespace.DATAFORM_VALIDATION,fields:{dataType:t.attribute("datatype"),basic:t.boolSub(r.Namespace.DATAFORM_VALIDATION,"basic"),open:t.boolSub(r.Namespace.DATAFORM_VALIDATION,"open"),regex:t.textSub(r.Namespace.DATAFORM_VALIDATION,"regex")}}),d=e.define({name:"range",element:"range",namespace:r.Namespace.DATAFORM_VALIDATION,fields:{min:t.attribute("min"),max:t.attribute("max")}}),p=e.define({name:"select",element:"list-range",namespace:r.Namespace.DATAFORM_VALIDATION,fields:{min:t.numberAttribute("min"),max:t.numberAttribute("max")}}),f={get:function(){for(var e=[],t=0,n=this.xml.childNodes.length;n>t;t++){var i=this.xml.childNodes[t];if(i.namespaceURI===r.Namespace.DATAFORM_LAYOUT)switch(i.localName){case"text":e.push({text:i.textContent});break;case"fieldref":e.push({field:i.getAttribute("var")});break;case"reportedref":e.push({reported:!0});break;case"section":e.push({section:new h(null,i,this).toJSON()})}}return e},set:function(e){for(var n=0,i=e.length;i>n;n++){var o=e[n];if(o.text){var a=t.createElement(r.Namespace.DATAFORM_LAYOUT,"text",r.Namespace.DATAFORM_LAYOUT);a.textContent=o.text,this.xml.appendChild(a)}if(o.field){var s=t.createElement(r.Namespace.DATAFORM_LAYOUT,"fieldref",r.Namespace.DATAFORM_LAYOUT);s.setAttribute("var",o.field),this.xml.appendChild(s)}if(o.reported&&this.xml.appendChild(t.createElement(r.Namespace.DATAFORM_LAYOUT,"reportedref",r.Namespace.DATAFORM_LAYOUT)),o.section){var c=t.createElement(r.Namespace.DATAFORM_LAYOUT,"section",r.Namespace.DATAFORM_LAYOUT);this.xml.appendChild(c);var u=new h(null,c);u.label=o.section.label,u.contents=o.section.contents}}}},h=e.define({name:"_section",element:"section",namespace:r.Namespace.DATAFORM_LAYOUT,fields:{label:t.attribute("label"),contents:f}}),m=e.define({name:"_page",element:"page",namespace:r.Namespace.DATAFORM_LAYOUT,fields:{label:t.attribute("label"),contents:f}}),v=e.define({name:"form",namespace:r.Namespace.DATAFORM,element:"x",init:function(){if(this.reportedFields.length){var e={};this.reportedFields.forEach(function(t){e[t.name]=t.type}),this.items.forEach(function(t){t.fields.forEach(function(t){t.type=t._type=e[t.name]})})}},fields:{title:t.textSub(r.Namespace.DATAFORM,"title"),instructions:t.multiTextSub(r.Namespace.DATAFORM,"instructions"),type:t.attribute("type","form"),reportedFields:t.subMultiExtension(r.Namespace.DATAFORM,"reported",n)}});e.extend(v,n,"fields"),e.extend(v,s,"items"),e.extend(v,m,"layout"),e.extend(n,c),e.extend(n,l),e.extend(n,a,"options"),e.extend(s,n,"fields"),e.extend(c,u,"uris"),e.extend(l,d),e.extend(l,p),e.extendMessage(v)},t.exports=n["default"]},{"xmpp-constants":330,"xmpp-jid":336}],91:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"delay",namespace:r.Namespace.DELAY,element:"delay",fields:{from:t.jidAttribute("from"),stamp:t.dateAttribute("stamp"),reason:t.text()}});e.extendMessage(n),e.extendPresence(n)},t.exports=n["default"]},{"xmpp-constants":330}],92:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"caps",namespace:r.Namespace.CAPS,element:"c",fields:{ver:t.attribute("ver"),node:t.attribute("node"),hash:t.attribute("hash"),ext:t.attribute("ext")}}),i=e.define({name:"discoInfo",namespace:r.Namespace.DISCO_INFO,element:"query",fields:{node:t.attribute("node"),features:t.multiSubAttribute(r.Namespace.DISCO_INFO,"feature","var")}}),o=e.define({name:"_discoIdentity",namespace:r.Namespace.DISCO_INFO,element:"identity",fields:{category:t.attribute("category"),type:t.attribute("type"),name:t.attribute("name"),lang:t.langAttribute()}}),a=e.define({name:"discoItems",namespace:r.Namespace.DISCO_ITEMS,element:"query",fields:{node:t.attribute("node")}}),s=e.define({name:"_discoItem",namespace:r.Namespace.DISCO_ITEMS,element:"item",fields:{jid:t.jidAttribute("jid"),node:t.attribute("node"),name:t.attribute("name")}});e.extend(a,s,"items"),e.extend(i,o,"identities"),e.extendIQ(i),e.extendIQ(a),e.extendPresence(n),e.extendStreamFeatures(n),e.withDataForm(function(t){e.extend(i,t,"extensions")}),e.withDefinition("set",r.Namespace.RSM,function(t){e.extend(a,t)})},t.exports=n["default"]},{"xmpp-constants":330}],93:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["bad-request","conflict","feature-not-implemented","forbidden","gone","internal-server-error","item-not-found","jid-malformed","not-acceptable","not-allowed","not-authorized","payment-required","recipient-unavailable","redirect","registration-required","remote-server-not-found","remote-server-timeout","resource-constraint","service-unavailable","subscription-required","undefined-condition","unexpected-request"];n["default"]=function(e){var t=e.utils,n=e.define({name:"error",namespace:r.Namespace.CLIENT,element:"error",fields:{lang:{get:function(){return(this.parent||{}).lang||""}},condition:t.enumSub(r.Namespace.STANZA_ERROR,i),gone:{get:function(){return t.getSubText(this.xml,r.Namespace.STANZA_ERROR,"gone")},set:function(e){this.condition="gone",t.setSubText(this.xml,r.Namespace.STANZA_ERROR,"gone",e)}},redirect:{get:function(){return t.getSubText(this.xml,r.Namespace.STANZA_ERROR,"redirect")},set:function(e){this.condition="redirect",t.setSubText(this.xml,r.Namespace.STANZA_ERROR,"redirect",e)}},code:t.attribute("code"),type:t.attribute("type"),by:t.jidAttribute("by"),$text:{get:function(){return t.getSubLangText(this.xml,r.Namespace.STANZA_ERROR,"text",this.lang)}},text:{get:function(){var e=this.$text;return e[this.lang]||""},set:function(e){t.setSubLangText(this.xml,r.Namespace.STANZA_ERROR,"text",e,this.lang)}}}});e.extendMessage(n),e.extendPresence(n),e.extendIQ(n)},t.exports=n["default"]},{"xmpp-constants":330}],94:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,i=n.Services=e.define({name:"services",namespace:r.Namespace.DISCO_EXTERNAL_1,element:"services",fields:{type:t.attribute("type")}}),o=n.Credentials=e.define({name:"credentials",namespace:r.Namespace.DISCO_EXTERNAL_1,element:"credentials"}),a=e.define({name:"service",namespace:r.Namespace.DISCO_EXTERNAL_1,element:"service",fields:{host:t.attribute("host"),port:t.attribute("port"),transport:t.attribute("transport"),type:t.attribute("type"),username:t.attribute("username"),password:t.attribute("password")}});e.extend(i,a,"services"),e.extend(o,a),e.extendIQ(i),e.extendIQ(o),e.withDataForm(function(t){e.extend(a,t)})},t.exports=n["default"]},{"xmpp-constants":330}],95:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=r.Namespace.FILE_TRANSFER_4;n["default"]=function(e){var t=e.utils,n=e.define({name:"file",namespace:i,element:"file",fields:{name:t.textSub(i,"name"),description:t.textSub(i,"desc"),mediaType:t.textSub(i,"media-type"),size:t.numberSub(i,"size"),date:t.dateSub(i,"date")}}),o=e.define({name:"range",namespace:i,element:"range",fields:{offset:t.numberAttribute("offset"),length:t.numberAttribute("length")}}),a=e.define({name:"_"+i,namespace:i,element:"description",tags:["jingle-application"],fields:{applicationType:{value:i}}}),s=e.define({name:"_{"+i+"}received",namespace:i,element:"received",tags:["jingle-info"],fields:{infoType:{value:"{"+i+"}received"},creator:t.attribute("creator"),name:t.attribute("name")}}),c=e.define({name:"_{"+i+"}checksum",namespace:i,element:"checksum",tags:["jingle-info"],fields:{infoType:{value:"{"+i+"}checksum"},creator:t.attribute("creator"),name:t.attribute("name")}});e.extend(n,o),e.extend(c,n),e.extend(a,n),e.withDefinition("hash",r.Namespace.HASHES_1,function(t){e.extend(n,t,"hashes"),e.extend(o,t,"hashes")}),e.withDefinition("content",r.Namespace.JINGLE_1,function(t){e.extend(t,a)}),e.withDefinition("jingle",r.Namespace.JINGLE_1,function(t){e.extend(t,s),e.extend(t,c)})},t.exports=n["default"]},{"xmpp-constants":330}],96:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=r.Namespace.FILE_TRANSFER_3;n["default"]=function(e){var t=e.utils,n=e.define({name:"_file",namespace:i,element:"file",fields:{name:t.textSub(i,"name"),desc:t.textSub(i,"desc"),size:t.numberSub(i,"size"),date:t.dateSub(i,"date")}}),o=e.define({name:"range",namespace:i,element:"range",fields:{offset:t.numberAttribute("offset")}}),a=e.define({name:"thumbnail",namespace:r.Namespace.THUMBS_0,element:"thumbnail",fields:{cid:t.attribute("cid"),mimeType:t.attribute("mime-type"),width:t.numberAttribute("width"),height:t.numberAttribute("height")}}),s=e.define({name:"_filetransfer",namespace:i,element:"description",tags:["jingle-application"],fields:{applicationType:{value:"filetransfer"},offer:t.subExtension("offer",i,"offer",n),request:t.subExtension("request",i,"request",n)}});e.extend(n,o),e.extend(n,a),e.withDefinition("hash",r.Namespace.HASHES_1,function(t){e.extend(n,t,"hashes")}),e.withDefinition("content",r.Namespace.JINGLE_1,function(t){e.extend(t,s)})},t.exports=n["default"]},{"xmpp-constants":330}],97:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.define({name:"forwarded",namespace:r.Namespace.FORWARD_0,element:"forwarded"});e.withMessage(function(n){e.extend(n,t),e.extend(t,n)}),e.withPresence(function(n){e.extend(n,t),e.extend(t,n)}),e.withIQ(function(n){e.extend(n,t),e.extend(t,n)}),e.withDefinition("delay",r.Namespace.DELAY,function(n){e.extend(t,n)})},t.exports=n["default"]},{"xmpp-constants":330}],98:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils;e.define({name:"openStream",namespace:r.Namespace.FRAMING,element:"open",topLevel:!0,fields:{lang:t.langAttribute(),id:t.attribute("id"),version:t.attribute("version","1.0"),to:t.jidAttribute("to",!0),from:t.jidAttribute("from",!0)}}),e.define({name:"closeStream",namespace:r.Namespace.FRAMING,element:"close",topLevel:!0,fields:{seeOtherURI:t.attribute("see-other-uri")}})},t.exports=n["default"]},{"xmpp-constants":330}],99:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"geoloc",namespace:r.Namespace.GEOLOC,element:"geoloc",fields:{accuracy:t.numberSub(r.Namespace.GEOLOC,"accuracy",!0),altitude:t.numberSub(r.Namespace.GEOLOC,"alt",!0),area:t.textSub(r.Namespace.GEOLOC,"area"),heading:t.numberSub(r.Namespace.GEOLOC,"bearing",!0),bearing:t.numberSub(r.Namespace.GEOLOC,"bearing",!0),building:t.textSub(r.Namespace.GEOLOC,"building"),country:t.textSub(r.Namespace.GEOLOC,"country"),countrycode:t.textSub(r.Namespace.GEOLOC,"countrycode"),datum:t.textSub(r.Namespace.GEOLOC,"datum"),description:t.textSub(r.Namespace.GEOLOC,"description"),error:t.numberSub(r.Namespace.GEOLOC,"error",!0),floor:t.textSub(r.Namespace.GEOLOC,"floor"),latitude:t.numberSub(r.Namespace.GEOLOC,"lat",!0),locality:t.textSub(r.Namespace.GEOLOC,"locality"),longitude:t.numberSub(r.Namespace.GEOLOC,"lon",!0),postalcode:t.textSub(r.Namespace.GEOLOC,"postalcode"),region:t.textSub(r.Namespace.GEOLOC,"region"),room:t.textSub(r.Namespace.GEOLOC,"room"),speed:t.numberSub(r.Namespace.GEOLOC,"speed",!0),street:t.textSub(r.Namespace.GEOLOC,"street"),text:t.textSub(r.Namespace.GEOLOC,"text"),timestamp:t.dateSub(r.Namespace.GEOLOC,"timestamp"),tzo:t.tzoSub(r.Namespace.GEOLOC,"tzo"),uri:t.textSub(r.Namespace.GEOLOC,"uri")}});e.extendPubsubItem(n)},t.exports=n["default"]},{"xmpp-constants":330}],100:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){e.define({name:"hash",namespace:r.Namespace.HASHES_1,element:"hash",fields:{algo:e.utils.attribute("algo"),value:e.utils.text()}})},t.exports=n["default"]},{"xmpp-constants":330}],101:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.define({name:"_hat",namespace:r.Namespace.HATS_0,element:"hat",fields:{lang:e.utils.langAttribute(),name:e.utils.attribute("name"),displayName:e.utils.attribute("displayName")}});e.withPresence(function(n){e.add(n,"hats",e.utils.subMultiExtension(r.Namespace.HATS_0,"hats",t))})},t.exports=n["default"]},{"xmpp-constants":330}],102:[function(e,t,n){(function(r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("xmpp-constants"),o="http://jabber.org/protocol/ibb",a="urn:xmpp:jingle:transports:ibb:1";n["default"]=function(e){var t=e.utils,n={get:function(){var e=t.find(this.xml,o,"data");if(e.length)return e=e[0],{action:"data",sid:t.getAttribute(e,"sid"),seq:parseInt(t.getAttribute(e,"seq")||"0",10),data:new r(t.getText(e),"base64")};var n=t.find(this.xml,o,"open");if(n.length){n=n[0];var i=t.getAttribute(n,"stanza");return i="message"===i?!1:!0,{action:"open",sid:t.getAttribute(n,"sid"),blockSize:t.getAttribute(n,"block-size"),ack:i}}var a=t.find(this.xml,o,"close");return a.length?{action:"close",sid:t.getAttribute(a[0],"sid")}:void 0},set:function(e){if("data"===e.action){var n=t.createElement(o,"data");t.setAttribute(n,"sid",e.sid),t.setAttribute(n,"seq",e.seq.toString()),t.setText(n,e.data.toString("base64")),this.xml.appendChild(n)}if("open"===e.action){var r=t.createElement(o,"open");t.setAttribute(r,"sid",e.sid),t.setAttribute(r,"block-size",(e.blockSize||"4096").toString()),e.ack===!1?t.setAttribute(r,"stanza","message"):t.setAttribute(r,"stanza","iq"),this.xml.appendChild(r)}if("close"===e.action){var i=t.createElement(o,"close");t.setAttribute(i,"sid",e.sid),this.xml.appendChild(i)}}},s=e.define({name:"_"+a,namespace:a,element:"transport",tags:["jingle-transport"],fields:{transportType:{value:a},sid:t.attribute("sid"),blockSize:t.numberAttribute("block-size"),ack:{get:function(){var e=t.getAttribute(this.xml,"stanza");return"message"===e?!1:!0},set:function(e){e.ack===!1?t.setAttribute(this.xml,"stanza","message"):t.setAttribute(this.xml,"stanza","iq")}}}});e.withDefinition("content",i.Namespace.JINGLE_1,function(t){e.extend(t,s)}),e.withIQ(function(t){e.add(t,"ibb",n)}),e.withMessage(function(t){e.add(t,"ibb",n)})},t.exports=n["default"]}).call(this,e("buffer").Buffer)},{buffer:9,"xmpp-constants":330}],103:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"_iceUdp",namespace:r.Namespace.JINGLE_ICE_UDP_1,element:"transport",tags:["jingle-transport"],fields:{transportType:{value:"iceUdp"},pwd:t.attribute("pwd"),ufrag:t.attribute("ufrag")}}),i=e.define({name:"remoteCandidate",namespace:r.Namespace.JINGLE_ICE_UDP_1,element:"remote-candidate",fields:{component:t.attribute("component"),ip:t.attribute("ip"),port:t.attribute("port")}}),o=e.define({name:"_iceUdpCandidate",namespace:r.Namespace.JINGLE_ICE_UDP_1,element:"candidate",fields:{component:t.attribute("component"),foundation:t.attribute("foundation"),generation:t.attribute("generation"),id:t.attribute("id"),ip:t.attribute("ip"),network:t.attribute("network"),port:t.attribute("port"),priority:t.attribute("priority"),protocol:t.attribute("protocol"),relAddr:t.attribute("rel-addr"),relPort:t.attribute("rel-port"),tcpType:t.attribute("tcptype"),type:t.attribute("type")}}),a=e.define({name:"_iceFingerprint",namespace:r.Namespace.JINGLE_DTLS_0,element:"fingerprint",fields:{hash:t.attribute("hash"),setup:t.attribute("setup"),value:t.text(),required:t.boolAttribute("required")}}),s=e.define({name:"_sctpMap",namespace:r.Namespace.DTLS_SCTP_1,element:"sctpmap",fields:{number:t.attribute("number"),protocol:t.attribute("protocol"),streams:t.attribute("streams")}});e.extend(n,o,"candidates"),e.extend(n,i),e.extend(n,a,"fingerprints"),e.extend(n,s,"sctp"),e.withDefinition("content",r.Namespace.JINGLE_1,function(t){e.extend(t,n)})},t.exports=n["default"]},{"xmpp-constants":330}],104:[function(e,t,n){"use strict";var r=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var i=e("./addresses"),o=r(i),a=e("./avatar"),s=r(a),c=e("./bind"),u=r(c),l=e("./blocking"),d=r(l),p=e("./bob"),f=r(p),h=e("./bookmarks"),m=r(h),v=e("./bosh"),g=r(v),y=e("./carbons"),_=r(y),S=e("./command"),b=r(S),C=e("./csi"),w=r(C),E=e("./dataforms"),R=r(E),P=e("./delayed"),x=r(P),T=e("./disco"),L=r(T),O=e("./error"),I=r(O),M=e("./extdisco"),A=r(M),D=e("./file"),k=r(D),j=e("./file3"),N=r(j),V=e("./forwarded"),U=r(V),B=e("./framing"),F=r(B),G=e("./geoloc"),q=r(G),J=e("./hash"),W=r(J),z=e("./hats"),H=r(z),X=e("./iceUdp"),Y=r(X),$=e("./ibb"),Q=r($),K=e("./iq"),Z=r(K),ee=e("./jidprep"),te=r(ee),ne=e("./jingle"),re=r(ne),ie=e("./json"),oe=r(ie),ae=e("./logging"),se=r(ae),ce=e("./mam"),ue=r(ce),le=e("./message"),de=r(le),pe=e("./mood"),fe=r(pe),he=e("./muc"),me=r(he),ve=e("./nick"),ge=r(ve),ye=e("./oob"),_e=r(ye),Se=e("./ping"),be=r(Se),Ce=e("./presence"),we=r(Ce),Ee=e("./private"),Re=r(Ee),Pe=e("./psa"),xe=r(Pe),Te=e("./pubsub"),Le=r(Te),Oe=e("./pubsubError"),Ie=r(Oe),Me=e("./pubsubEvents"),Ae=r(Me),De=e("./pubsubOwner"),ke=r(De),je=e("./push"),Ne=r(je),Ve=e("./reach"),Ue=r(Ve),Be=e("./register"),Fe=r(Be),Ge=e("./roster"),qe=r(Ge),Je=e("./rsm"),We=r(Je),ze=e("./rtp"),He=r(ze),Xe=e("./rtt"),Ye=r(Xe),$e=e("./sasl"),Qe=r($e),Ke=e("./session"),Ze=r(Ke),et=e("./shim"),tt=r(et),nt=e("./sm"),rt=r(nt),it=e("./stream"),ot=r(it),at=e("./streamError"),st=r(at),ct=e("./streamFeatures"),ut=r(ct),lt=e("./time"),dt=r(lt),pt=e("./tune"),ft=r(pt),ht=e("./vcard"),mt=r(ht),vt=e("./version"),gt=r(vt),yt=e("./visibility"),_t=r(yt);n["default"]=function(e){e.use(o["default"]),e.use(s["default"]),e.use(u["default"]),e.use(d["default"]),e.use(f["default"]),e.use(m["default"]),e.use(g["default"]),e.use(_["default"]),e.use(b["default"]),e.use(w["default"]),e.use(R["default"]),e.use(x["default"]),e.use(L["default"]),e.use(I["default"]),e.use(A["default"]),e.use(k["default"]),e.use(N["default"]),e.use(U["default"]),e.use(F["default"]),e.use(q["default"]),e.use(W["default"]),e.use(H["default"]),e.use(Y["default"]),e.use(Q["default"]),e.use(Z["default"]),e.use(te["default"]),e.use(re["default"]),e.use(oe["default"]),e.use(se["default"]),e.use(ue["default"]),e.use(de["default"]),e.use(fe["default"]),e.use(me["default"]),e.use(ge["default"]),e.use(_e["default"]),e.use(be["default"]),e.use(we["default"]),e.use(Re["default"]),e.use(xe["default"]),e.use(Le["default"]),e.use(Ie["default"]),e.use(Ae["default"]),e.use(ke["default"]),e.use(Ne["default"]),e.use(Ue["default"]),e.use(Fe["default"]),e.use(qe["default"]),e.use(We["default"]),e.use(He["default"]),e.use(Ye["default"]),e.use(Qe["default"]),e.use(Ze["default"]),e.use(tt["default"]),e.use(rt["default"]),e.use(ot["default"]),e.use(st["default"]),e.use(ut["default"]),e.use(dt["default"]),e.use(ft["default"]),e.use(mt["default"]),e.use(gt["default"]),e.use(_t["default"])},t.exports=n["default"]},{"./addresses":80,"./avatar":81,"./bind":82,"./blocking":83,"./bob":84,"./bookmarks":85,"./bosh":86,"./carbons":87,"./command":88,"./csi":89,"./dataforms":90,"./delayed":91,"./disco":92,"./error":93,"./extdisco":94,"./file":95,"./file3":96,"./forwarded":97,"./framing":98,"./geoloc":99,"./hash":100,"./hats":101,"./ibb":102,"./iceUdp":103,
"./iq":105,"./jidprep":106,"./jingle":107,"./json":108,"./logging":109,"./mam":110,"./message":111,"./mood":112,"./muc":113,"./nick":114,"./oob":115,"./ping":116,"./presence":117,"./private":118,"./psa":119,"./pubsub":120,"./pubsubError":121,"./pubsubEvents":122,"./pubsubOwner":123,"./push":124,"./reach":125,"./register":126,"./roster":127,"./rsm":128,"./rtp":129,"./rtt":130,"./sasl":131,"./session":132,"./shim":133,"./sm":134,"./stream":135,"./streamError":136,"./streamFeatures":137,"./time":138,"./tune":139,"./vcard":140,"./version":141,"./visibility":142,"babel-runtime/helpers/interop-require-default":4}],105:[function(e,t,n){"use strict";var r=e("babel-runtime/core-js/object/assign")["default"];Object.defineProperty(n,"__esModule",{value:!0});var i=e("xmpp-constants"),o={};o.defineIQ=function(e,t,n){var i=e.utils,o=e.define({name:t,namespace:n,element:"iq",topLevel:!0,fields:{lang:i.langAttribute(),id:i.attribute("id"),to:i.jidAttribute("to",!0),from:i.jidAttribute("from",!0),type:i.attribute("type")}}),a=o.prototype.toJSON;r(o.prototype,{toJSON:function(){var e=a.call(this);return e.resultReply=this.resultReply,e.errorReply=this.errorReply,e},resultReply:function(e){return e=e||{},e.to=this.from,e.id=this.id,e.type="result",new o(e)},errorReply:function(e){return e=e||{},e.to=this.from,e.id=this.id,e.type="error",new o(e)}})},n["default"]=function(e){o.defineIQ(e,"iq",i.Namespace.CLIENT),o.defineIQ(e,"serverIQ",i.Namespace.SERVER),o.defineIQ(e,"componentIQ",i.Namespace.COMPONENT)},t.exports=n["default"]},{"babel-runtime/core-js/object/assign":3,"xmpp-constants":330}],106:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=e("xmpp-jid");n["default"]=function(e){e.withIQ(function(t){e.add(t,"jidPrep",{get:function(){var t=e.utils.getSubText(this.xml,r.Namespace.JID_PREP_0,"jid");if(t){var n=new i.JID(t);return n.prepped=!0,n}},set:function(t){e.utils.setSubText(this.xml,r.Namespace.JID_PREP_0,"jid",(t||"").toString())}})})},t.exports=n["default"]},{"xmpp-constants":330,"xmpp-jid":336}],107:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["out-of-order","tie-break","unknown-session","unsupported-info"],o=["alternative-session","busy","cancel","connectivity-error","decline","expired","failed-application","failed-transport","general-error","gone","incompatible-parameters","media-error","security-error","success","timeout","unsupported-applications","unsupported-transports"];n["default"]=function(e){var t=e.utils,n=e.define({name:"jingle",namespace:r.Namespace.JINGLE_1,element:"jingle",fields:{action:t.attribute("action"),initiator:t.attribute("initiator"),responder:t.attribute("responder"),sid:t.attribute("sid"),info:{get:function(){for(var n=e.tagged("jingle-info").map(function(e){return e.prototype._name}),r=0,i=n.length;i>r;r++)if(this._extensions[n[r]])return this._extensions[n[r]];return"session-info"===t.getAttribute(this.xml,"action")?0===this.xml.children.length?{infoType:"ping"}:{infoType:"unknown"}:void 0},set:function(e){if("ping"!==e.infoType){var t="_"+e.infoType;this[t]=e}}}}}),a=e.define({name:"_jingleContent",namespace:r.Namespace.JINGLE_1,element:"content",fields:{creator:t.attribute("creator"),disposition:t.attribute("disposition","session"),name:t.attribute("name"),senders:t.attribute("senders","both"),application:{get:function(){for(var t=e.tagged("jingle-application").map(function(e){return e.prototype._name}),n=0,r=t.length;r>n;n++)if(this._extensions[t[n]])return this._extensions[t[n]]},set:function(e){var t="_"+e.applicationType;this[t]=e}},transport:{get:function(){for(var t=e.tagged("jingle-transport").map(function(e){return e.prototype._name}),n=0,r=t.length;r>n;n++)if(this._extensions[t[n]])return this._extensions[t[n]]},set:function(e){var t="_"+e.transportType;this[t]=e}},security:{get:function(){for(var t=e.tagged("jingle-security").map(function(e){return Security.prototype._name}),n=0,r=t.length;r>n;n++)if(this._extensions[t[n]])return this._extensions[t[n]]},set:function(e){var t="_"+e.securityType;this[t]=e}}}}),s=e.define({name:"reason",namespace:r.Namespace.JINGLE_1,element:"reason",fields:{condition:t.enumSub(r.Namespace.JINGLE_1,o),alternativeSession:{get:function(){return t.getSubText(this.xml,r.Namespace.JINGLE_1,"alternative-session")},set:function(e){this.condition="alternative-session",t.setSubText(this.xml,r.Namespace.JINGLE_1,"alternative-session",e)}},text:t.textSub(r.Namespace.JINGLE_1,"text")}});e.extend(n,a,"contents"),e.extend(n,s),e.extendIQ(n),e.withStanzaError(function(n){e.add(n,"jingleCondition",t.enumSub(r.Namespace.JINGLE_ERRORS_1,i))})},t.exports=n["default"]},{"xmpp-constants":330}],108:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t={get:function(){var t=e.utils.getSubText(this.xml,r.Namespace.JSON_0,"json");return t?JSON.parse(t):void 0},set:function(t){t=JSON.stringify(t),t&&e.utils.setSubText(this.xml,r.Namespace.JSON_0,"json",t)}};e.withMessage(function(n){e.add(n,"json",t)}),e.withPubsubItem(function(n){e.add(n,"json",t)})},t.exports=n["default"]},{"xmpp-constants":330}],109:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"log",namespace:r.Namespace.EVENTLOG,element:"log",fields:{id:t.attribute("id"),timestamp:t.dateAttribute("timestamp"),type:t.attribute("type"),level:t.attribute("level"),object:t.attribute("object"),subject:t.attribute("subject"),facility:t.attribute("facility"),module:t.attribute("module"),message:t.textSub(r.Namespace.EVENTLOG,"message"),stackTrace:t.textSub(r.Namespace.EVENTLOG,"stackTrace")}}),i=e.define({name:"_logtag",namespace:r.Namespace.EVENTLOG,element:"tag",fields:{name:t.attribute("name"),value:t.attribute("value"),type:t.attribute("type")}});e.extend(n,i,"tags"),e.extendMessage(n),e.extendPubsubItem(n)},t.exports=n["default"]},{"xmpp-constants":330}],110:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=e("xmpp-jid");n["default"]=function(e){var t=e.utils,n=e.define({name:"mam",namespace:r.Namespace.MAM_0,element:"query",fields:{queryid:t.attribute("queryid")}}),o=e.define({name:"mamItem",namespace:r.Namespace.MAM_0,element:"result",fields:{queryid:t.attribute("queryid"),id:t.attribute("id")}}),a=e.define({name:"mamResult",namespace:r.Namespace.MAM_0,element:"fin",fields:{queryid:t.attribute("queryid"),complete:t.boolAttribute("complete"),stable:t.boolAttribute("stable")}}),s=e.define({name:"mamPrefs",namespace:r.Namespace.MAM_0,element:"prefs",fields:{defaultCondition:t.attribute("default"),always:{get:function(){var e=[],n=t.find(this.xml,r.Namespace.MAM_0,"always");if(0===n.length)return e;n=n[0];var o=t.getMultiSubText(n,r.Namespace.MAM_0,"jid");return o.forEach(function(t){e.push(new i.JID(t.textContent))}),e},set:function(e){if(e.length>0){var n=t.findOrCreate(this.xml,r.Namespace.MAM_0,"always");t.setMultiSubText(n,r.Namespace.MAM_0,"jid",e)}}},never:{get:function(){var e=[],n=t.find(this.xml,r.Namespace.MAM_0,"always");if(0===n.length)return e;n=n[0];var o=t.getMultiSubText(n,r.Namespace.MAM_0,"jid");return o.forEach(function(t){e.push(new i.JID(t.textContent))}),e},set:function(e){if(e.length>0){var n=t.findOrCreate(this.xml,r.Namespace.MAM_0,"never");t.setMultiSubText(n,r.Namespace.MAM_0,"jid",e)}}}}});e.extendMessage(o),e.extendMessage(a),e.extendIQ(n),e.extendIQ(s),e.withDataForm(function(t){e.extend(n,t)}),e.withDefinition("forwarded",r.Namespace.FORWARD_0,function(t){e.extend(o,t)}),e.withDefinition("set",r.Namespace.RSM,function(t){e.extend(n,t),e.extend(a,t)})},t.exports=n["default"]},{"xmpp-constants":330,"xmpp-jid":336}],111:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i={};i.defineMessage=function(e,t,n){var i=e.utils;e.define({name:t,namespace:n,element:"message",topLevel:!0,fields:{lang:i.langAttribute(),id:i.attribute("id"),to:i.jidAttribute("to",!0),from:i.jidAttribute("from",!0),type:i.attribute("type","normal"),thread:i.textSub(n,"thread"),parentThread:i.subAttribute(n,"thread","parent"),subject:i.textSub(n,"subject"),$body:{get:function(){return i.getSubLangText(this.xml,n,"body",this.lang)}},body:{get:function(){var e=this.$body;return e[this.lang]||""},set:function(e){i.setSubLangText(this.xml,n,"body",e,this.lang)}},attention:i.boolSub(r.Namespace.ATTENTION_0,"attention"),chatState:i.enumSub(r.Namespace.CHAT_STATES,["active","composing","paused","inactive","gone"]),replace:i.subAttribute(r.Namespace.CORRECTION_0,"replace","id"),requestReceipt:i.boolSub(r.Namespace.RECEIPTS,"request"),receipt:i.subAttribute(r.Namespace.RECEIPTS,"received","id")}})},n["default"]=function(e){i.defineMessage(e,"message",r.Namespace.CLIENT),i.defineMessage(e,"serverMessage",r.Namespace.SERVER),i.defineMessage(e,"componentMessage",r.Namespace.COMPONENT)},t.exports=n["default"]},{"xmpp-constants":330}],112:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["afraid","amazed","amorous","angry","annoyed","anxious","aroused","ashamed","bored","brave","calm","cautious","cold","confident","confused","contemplative","contented","cranky","crazy","creative","curious","dejected","depressed","disappointed","disgusted","dismayed","distracted","embarrassed","envious","excited","flirtatious","frustrated","grateful","grieving","grumpy","guilty","happy","hopeful","hot","humbled","humiliated","hungry","hurt","impressed","in_awe","in_love","indignant","interested","intoxicated","invincible","jealous","lonely","lucky","mean","moody","nervous","neutral","offended","outraged","playful","proud","relaxed","relieved","remorseful","restless","sad","sarcastic","serious","shocked","shy","sick","sleepy","spontaneous","stressed","strong","surprised","thankful","thirsty","tired","undefined","weak","worried"];n["default"]=function(e){var t=e.define({name:"mood",namespace:r.Namespace.MOOD,element:"mood",fields:{text:e.utils.textSub(r.Namespace.MOOD,"text"),value:e.utils.enumSub(r.Namespace.MOOD,i)}});e.extendMessage(t),e.extendPubsubItem(t)},t.exports=n["default"]},{"xmpp-constants":330}],113:[function(e,t,n){"use strict";function r(e,t){return{get:function(){return this._extensions[e]?this[e][t]:void 0},set:function(n){this[e][t]=n}}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"_mucUserItem",namespace:i.Namespace.MUC_USER,element:"item",fields:{affiliation:t.attribute("affiliation"),nick:t.attribute("nick"),jid:t.jidAttribute("jid"),role:t.attribute("role"),reason:t.textSub(i.Namespace.MUC_USER,"reason")}}),o=e.define({name:"_mucUserActor",namespace:i.Namespace.MUC_USER,element:"actor",fields:{nick:t.attribute("nick"),jid:t.jidAttribute("jid")}}),a=e.define({name:"destroyed",namespace:i.Namespace.MUC_USER,element:"destroy",fields:{jid:t.jidAttribute("jid"),reason:t.textSub(i.Namespace.MUC_USER,"reason")}}),s=e.define({name:"invite",namespace:i.Namespace.MUC_USER,element:"invite",fields:{to:t.jidAttribute("to"),from:t.jidAttribute("from"),reason:t.textSub(i.Namespace.MUC_USER,"reason"),thread:t.subAttribute(i.Namespace.MUC_USER,"continue","thread"),"continue":t.boolSub(i.Namespace.MUC_USER,"continue")}}),c=e.define({name:"decline",namespace:i.Namespace.MUC_USER,element:"decline",fields:{to:t.jidAttribute("to"),from:t.jidAttribute("from"),reason:t.textSub(i.Namespace.MUC_USER,"reason")}}),u=e.define({name:"_mucAdminItem",namespace:i.Namespace.MUC_ADMIN,element:"item",fields:{affiliation:t.attribute("affiliation"),nick:t.attribute("nick"),jid:t.jidAttribute("jid"),role:t.attribute("role"),reason:t.textSub(i.Namespace.MUC_ADMIN,"reason")}}),l=e.define({name:"actor",namespace:i.Namespace.MUC_USER,element:"actor",fields:{nick:t.attribute("nick"),jid:t.jidAttribute("jid")}}),d=e.define({name:"destroy",namespace:i.Namespace.MUC_OWNER,element:"destroy",fields:{jid:t.jidAttribute("jid"),password:t.textSub(i.Namespace.MUC_OWNER,"password"),reason:t.textSub(i.Namespace.MUC_OWNER,"reason")}}),p=e.define({name:"muc",namespace:i.Namespace.MUC_USER,element:"x",fields:{affiliation:r("_mucUserItem","affiliation"),nick:r("_mucUserItem","nick"),jid:r("_mucUserItem","jid"),role:r("_mucUserItem","role"),actor:r("_mucUserItem","_mucUserActor"),reason:r("_mucUserItem","reason"),password:t.textSub(i.Namespace.MUC_USER,"password"),codes:{get:function(){return t.getMultiSubText(this.xml,i.Namespace.MUC_USER,"status",function(e){return t.getAttribute(e,"code")})},set:function(e){var n=this;t.setMultiSubText(this.xml,i.Namespace.MUC_USER,"status",e,function(e){var r=t.createElement(i.Namespace.MUC_USER,"status",i.Namespace.MUC_USER);t.setAttribute(r,"code",e),n.xml.appendChild(r)})}}}}),f=e.define({name:"mucAdmin",namespace:i.Namespace.MUC_ADMIN,element:"query",fields:{affiliation:r("_mucAdminItem","affiliation"),nick:r("_mucAdminItem","nick"),jid:r("_mucAdminItem","jid"),role:r("_mucAdminItem","role"),actor:r("_mucAdminItem","_mucAdminActor"),reason:r("_mucAdminItem","reason")}}),h=e.define({name:"mucOwner",namespace:i.Namespace.MUC_OWNER,element:"query"}),m=e.define({name:"joinMuc",namespace:i.Namespace.MUC,element:"x",fields:{password:t.textSub(i.Namespace.MUC,"password"),history:{get:function(){var e={},n=t.find(this.xml,i.Namespace.MUC,"history");if(!n.length)return{};n=n[0];var r=n.getAttribute("maxchars")||"",o=n.getAttribute("maxstanzas")||"",a=n.getAttribute("seconds")||"",s=n.getAttribute("since")||"";r&&(e.maxchars=parseInt(r,10)),o&&(e.maxstanzas=parseInt(o,10)),a&&(e.seconds=parseInt(a,10)),s&&(e.since=new Date(s))},set:function(e){var n=t.find(this.xml,i.Namespace.MUC,"history");if(n.length)for(var r=0;r<n.length;r++)this.xml.removeChild(n[r]);var o=t.createElement(i.Namespace.MUC,"history",i.Namespace.MUC);this.xml.appendChild(o),e.maxchars&&o.setAttribute("maxchars",""+e.maxchars),e.maxstanzas&&o.setAttribute("maxstanzas",""+e.maxstanzas),e.seconds&&o.setAttribute("seconds",""+e.seconds),e.since&&o.setAttribute("since",e.since.toISOString())}}}}),v=e.define({name:"mucInvite",namespace:i.Namespace.MUC_DIRECT_INVITE,element:"x",fields:{jid:t.jidAttribute("jid"),password:t.attribute("password"),reason:t.attribute("reason"),thread:t.attribute("thread"),"continue":t.boolAttribute("continue")}});e.extend(n,o),e.extend(p,n),e.extend(p,s,"invites"),e.extend(p,c),e.extend(p,a),e.extend(u,l),e.extend(f,u,"items"),e.extend(h,d),e.extendPresence(p),e.extendPresence(m),e.extendMessage(p),e.extendMessage(v),e.withIQ(function(n){e.add(n,"mucUnique",t.textSub(i.Namespace.MUC_UNIQUE,"unique")),e.extend(n,f),e.extend(n,h)}),e.withDataForm(function(t){e.extend(h,t)})},t.exports=n["default"]},{"xmpp-constants":330}],114:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils.textSub(r.Namespace.NICK,"nick");e.withPubsubItem(function(n){e.add(n,"nick",t)}),e.withPresence(function(n){e.add(n,"nick",t)}),e.withMessage(function(n){e.add(n,"nick",t)})},t.exports=n["default"]},{"xmpp-constants":330}],115:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.define({name:"oob",element:"x",namespace:r.Namespace.OOB,fields:{url:e.utils.textSub(r.Namespace.OOB,"url"),desc:e.utils.textSub(r.Namespace.OOB,"desc")}});e.extendMessage(t,"oobURIs")},t.exports=n["default"]},{"xmpp-constants":330}],116:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.define({name:"ping",namespace:r.Namespace.PING,element:"ping"});e.extendIQ(t)},t.exports=n["default"]},{"xmpp-constants":330}],117:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i={};i.definePresence=function(e,t,n){var i=e.utils;e.define({name:t,namespace:n,element:"presence",topLevel:!0,fields:{lang:i.langAttribute(),id:i.attribute("id"),to:i.jidAttribute("to",!0),from:i.jidAttribute("from",!0),priority:i.numberSub(n,"priority",!1,0),show:i.textSub(n,"show"),type:{get:function(){return i.getAttribute(this.xml,"type","available")},set:function(e){"available"===e&&(e=!1),i.setAttribute(this.xml,"type",e)}},$status:{get:function(){return i.getSubLangText(this.xml,n,"status",this.lang)}},status:{get:function(){var e=this.$status;return e[this.lang]||""},set:function(e){i.setSubLangText(this.xml,n,"status",e,this.lang)}},idleSince:i.dateSubAttribute(r.Namespace.IDLE_1,"idle","since"),decloak:i.subAttribute(r.Namespace.DECLOAK_0,"decloak","reason"),avatarId:{get:function(){var e=i.find(this.xml,r.Namespace.VCARD_TEMP_UPDATE,"x");return e.length?i.getSubText(e[0],r.Namespace.VCARD_TEMP_UPDATE,"photo"):""},set:function(e){var t=i.findOrCreate(this.xml,r.Namespace.VCARD_TEMP_UPDATE,"x");if(""===e)i.setBoolSub(t,r.Namespace.VCARD_TEMP_UPDATE,"photo",!0);else{if(e===!0)return;e?i.setSubText(t,r.Namespace.VCARD_TEMP_UPDATE,"photo",e):this.xml.removeChild(t)}}}}})},n["default"]=function(e){i.definePresence(e,"presence",r.Namespace.CLIENT),i.definePresence(e,"serverPresence",r.Namespace.SERVER),i.definePresence(e,"componentPresence",r.Namespace.COMPONENT)},t.exports=n["default"]},{"xmpp-constants":330}],118:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.define({name:"privateStorage",namespace:r.Namespace.PRIVATE,element:"query"});e.extendIQ(t)},t.exports=n["default"]},{"xmpp-constants":330}],119:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["server-unavailable","connection-paused"];n["default"]=function(e){var t=e.define({name:"state",namespace:r.Namespace.PSA,element:"state-annotation",fields:{from:e.utils.jidAttribute("from"),condition:e.utils.enumSub(r.Namespace.PSA,i),description:e.utils.textSub(r.Namespace.PSA,"description")}});e.extendPresence(t)},t.exports=n["default"]},{"xmpp-constants":330}],120:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"pubsub",namespace:r.Namespace.PUBSUB,element:"pubsub",fields:{create:{get:function(){var e=t.getSubAttribute(this.xml,r.Namespace.PUBSUB,"create","node");return e?e:t.getBoolSub(this.xml,r.Namespace.PUBSUB,"create")},set:function(e){e!==!0&&e?t.setSubAttribute(this.xml,r.Namespace.PUBSUB,"create","node",e):t.setBoolSub(this.xml,r.Namespace.PUBSUB,"create",e)}},publishOptions:{get:function(){var n=e.getDefinition("x",r.Namespace.DATAFORM),i=t.find(this.xml,r.Namespace.PUBSUB,"publish-options");return i.length&&i[0].childNodes.length?new n({},i[0].childNodes[0]):void 0},set:function(n){var i=e.getDefinition("x",r.Namespace.DATAFORM),o=t.findOrCreate(this.xml,r.Namespace.PUBSUB,"publish-options");if(n){var a=new i(n);o.appendChild(a.xml)}}}}}),i=e.define({name:"config",namespace:r.Namespace.PUBSUB,element:"configure"}),o=e.define({name:"subscribe",namespace:r.Namespace.PUBSUB,element:"subscribe",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid")}}),a=e.define({name:"subscription",namespace:r.Namespace.PUBSUB,element:"subscription",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid"),subid:t.attribute("subid"),type:t.attribute("subscription"),configurable:t.boolSub("subscribe-options"),configurationRequired:{get:function(){var e=t.find(this.xml,r.Namespace.PUBSUB,"subscribe-options");return e.length?t.getBoolSub(e[0],r.Namespace.PUBSUB,"required"):!1}}}}),s=e.define({name:"subscriptions",namespace:r.Namespace.PUBSUB,element:"subscriptions",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid")}}),c=e.define({name:"affiliation",namespace:r.Namespace.PUBSUB,element:"affiliation",fields:{node:t.attribute("node"),type:t.attribute("affiliation")}}),u=e.define({name:"affiliations",namespace:r.Namespace.PUBSUB,element:"affiliations",fields:{node:t.attribute("node")}}),l=e.define({name:"subscriptionOptions",namespace:r.Namespace.PUBSUB,element:"options",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid"),subid:t.attribute("subid")}}),d=e.define({name:"unsubscribe",namespace:r.Namespace.PUBSUB,element:"unsubscribe",fields:{node:t.attribute("node"),subid:t.attribute("subid"),jid:t.jidAttribute("jid")}}),p=e.define({name:"publish",namespace:r.Namespace.PUBSUB,element:"publish",fields:{node:t.attribute("node")}}),f=e.define({name:"retract",namespace:r.Namespace.PUBSUB,element:"retract",fields:{node:t.attribute("node"),notify:t.boolAttribute("notify"),id:t.subAttribute(r.Namespace.PUBSUB,"item","id")}}),h=e.define({name:"retrieve",namespace:r.Namespace.PUBSUB,element:"items",fields:{node:t.attribute("node"),max:t.attribute("max_items")}}),m=e.define({name:"item",namespace:r.Namespace.PUBSUB,element:"item",fields:{id:t.attribute("id"),publisher:t.jidAttribute("publisher")}});e.extend(n,i),e.extend(n,o),e.extend(n,d),e.extend(n,p),e.extend(n,f),e.extend(n,h),e.extend(n,a),e.extend(n,l),e.extend(n,s),e.extend(n,u),e.extend(p,m,"items"),e.extend(h,m,"items"),e.extend(s,a,"list"),e.extend(u,c,"list"),e.extendIQ(n),e.withDataForm(function(t){e.extend(l,t),e.extend(m,t),e.extend(i,t)}),e.withDefinition("set",r.Namespace.RSM,function(t){e.extend(n,t)})},t.exports=n["default"]},{"xmpp-constants":330}],121:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["closed-node","configuration-required","invalid-jid","invalid-options","invalid-payload","invalid-subid","item-forbidden","item-required","jid-required","max-items-exceeded","max-nodes-exceeded","nodeid-required","not-in-roster-group","not-subscribed","payload-too-big","payload-required","pending-subscription","presence-subscription-required","subid-required","too-many-subscriptions","unsupported","unsupported-access-model"];n["default"]=function(e){e.withStanzaError(function(t){e.add(t,"pubsubCondition",e.utils.enumSub(r.Namespace.PUBSUB_ERRORS,i)),e.add(t,"pubsubUnsupportedFeature",{get:function(){return e.utils.getSubAttribute(this.xml,r.Namespace.PUBSUB_ERRORS,"unsupported","feature")},set:function(t){t&&(this.pubsubCondition="unsupported"),e.utils.setSubAttribute(this.xml,r.Namespace.PUBSUB_ERRORS,"unsupported","feature",t)}})})},t.exports=n["default"]},{"xmpp-constants":330}],122:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"event",namespace:r.Namespace.PUBSUB_EVENT,element:"event"}),i=e.define({name:"purged",namespace:r.Namespace.PUBSUB_EVENT,element:"purge",fields:{node:t.attribute("node")}}),o=e.define({name:"deleted",namespace:r.Namespace.PUBSUB_EVENT,element:"delete",fields:{node:t.attribute("node"),redirect:t.subAttribute(r.Namespace.PUBSUB_EVENT,"redirect","uri")}}),a=e.define({name:"subscriptionChanged",namespace:r.Namespace.PUBSUB_EVENT,element:"subscription",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid"),type:t.attribute("subscription"),subid:t.attribute("subid"),expiry:{get:function(){var e=t.getAttribute(this.xml,"expiry");return"presence"===e?e:e?new Date(e):void 0},set:function(e){e&&("string"!=typeof e&&(e=e.toISOString()),t.setAttribute(this.xml,"expiry",e))}}}}),s=e.define({name:"configurationChanged",namespace:r.Namespace.PUBSUB_EVENT,element:"configuration",fields:{node:t.attribute("node")}}),c=e.define({name:"updated",namespace:r.Namespace.PUBSUB_EVENT,element:"items",fields:{node:t.attribute("node"),retracted:{get:function(){var e=[],n=t.find(this.xml,r.Namespace.PUBSUB_EVENT,"retract");return n.forEach(function(t){e.push(t.getAttribute("id"))}),e},set:function(e){e.forEach(function(e){var n=t.createElement(r.Namespace.PUBSUB_EVENT,"retract",r.Namespace.PUBSUB_EVENT);n.setAttribute("id",e),this.xml.appendChild(n)})}}}}),u=e.define({name:"_eventItem",namespace:r.Namespace.PUBSUB_EVENT,element:"item",fields:{id:t.attribute("id"),node:t.attribute("node"),publisher:t.jidAttribute("publisher")}});e.extend(c,u,"published"),e.extend(n,c),e.extend(n,a),e.extend(n,s),e.extend(n,o),e.extend(n,i),e.extendMessage(n),e.withDataForm(function(t){e.extend(s,t)})},t.exports=n["default"]},{"xmpp-constants":330}],123:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"pubsubOwner",namespace:r.Namespace.PUBSUB_OWNER,element:"pubsub",fields:{purge:t.subAttribute(r.Namespace.PUBSUB_OWNER,"purge","node"),del:t.subAttribute(r.Namespace.PUBSUB_OWNER,"delete","node"),redirect:{get:function(){var e=t.find(this.xml,r.Namespace.PUBSUB_OWNER,"delete");return e.length?t.getSubAttribute(e[0],r.Namespace.PUBSUB_OWNER,"redirect","uri"):""},set:function(e){var n=t.findOrCreate(this.xml,r.Namespace.PUBSUB_OWNER,"delete");t.setSubAttribute(n,r.Namespace.PUBSUB_OWNER,"redirect","uri",e)}}}}),i=e.define({name:"subscription",namespace:r.Namespace.PUBSUB_OWNER,element:"subscription",fields:{node:t.attribute("node"),jid:t.jidAttribute("jid"),subid:t.attribute("subid"),type:t.attribute("subscription"),configurable:t.boolSub("subscribe-options"),configurationRequired:{get:function(){var e=t.find(this.xml,r.Namespace.PUBSUB_OWNER,"subscribe-options");return e.length?t.getBoolSub(e[0],r.Namespace.PUBSUB_OWNER,"required"):!1}}}}),o=e.define({name:"subscriptions",namespace:r.Namespace.PUBSUB_OWNER,element:"subscriptions",fields:{node:t.attribute("node")}}),a=e.define({name:"affiliation",namespace:r.Namespace.PUBSUB_OWNER,element:"affiliation",fields:{jid:t.jidAttribute("jid"),type:t.attribute("affiliation")}}),s=e.define({name:"affiliations",namespace:r.Namespace.PUBSUB_OWNER,element:"affiliations",fields:{node:t.attribute("node")}}),c=e.define({name:"config",namespace:r.Namespace.PUBSUB_OWNER,element:"configure",fields:{node:t.attribute("node")}});e.extend(n,c),e.extend(n,o),e.extend(n,s),e.extend(o,i,"list"),e.extend(s,a,"list"),e.extendIQ(n),e.withDataForm(function(t){e.extend(c,t)})},t.exports=n["default"]},{"xmpp-constants":330}],124:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"enablePush",element:"enable",namespace:r.Namespace.PUSH_0,fields:{jid:t.jidAttribute("jid"),node:t.attribute("node")}}),i=e.define({name:"disablePush",element:"disable",namespace:r.Namespace.PUSH_0,fields:{jid:t.jidAttribute("jid"),node:t.attribute("node")}}),o=e.define({name:"pushNotification",element:"notification",namespace:r.Namespace.PUSH_0});e.withDataForm(function(t){e.extend(o,t),e.extend(n,t)}),e.extendIQ(n),e.extendIQ(i)},t.exports=n["default"]},{"xmpp-constants":330}],125:[function(e,t,n){"use strict";var r=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(n,"__esModule",{value:!0});var i=e("xmpp-constants"),o=e("lodash.foreach"),a=r(o);n["default"]=function(e){var t=e.utils,n=e.define({name:"_reachAddr",namespace:i.Namespace.REACH_0,element:"addr",fields:{uri:t.attribute("uri"),$desc:{get:function(){return t.getSubLangText(this.xml,i.Namespace.REACH_0,"desc",this.lang)}},desc:{get:function(){var e=this.$desc;return e[this.lang]||""},set:function(e){t.setSubLangText(this.xml,i.Namespace.REACH_0,"desc",e,this.lang)}}}}),r={get:function(){var e=t.find(this.xml,i.Namespace.REACH_0,"reach"),r=[];if(e.length){var o=t.find(e[0],i.Namespace.REACH_0,"addr");a["default"](o,function(e){r.push(new n({},e))})}return r},set:function(e){var r=t.findOrCreate(this.xml,i.Namespace.REACH_0,"reach");t.setAttribute(r,"xmlns",i.Namespace.REACH_0),a["default"](e,function(e){var t=new n(e);r.appendChild(t.xml)})}};e.withPubsubItem(function(t){e.add(t,"reach",r)}),e.withPresence(function(t){e.add(t,"reach",r)})},t.exports=n["default"]},{"babel-runtime/helpers/interop-require-default":4,"lodash.foreach":166,"xmpp-constants":330}],126:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"register",namespace:r.Namespace.REGISTER,element:"query",fields:{instructions:t.textSub(r.Namespace.REGISTER,"instructions"),registered:t.boolSub(r.Namespace.REGISTER,"registered"),remove:t.boolSub(r.Namespace.REGISTER,"remove"),username:t.textSub(r.Namespace.REGISTER,"username"),nick:t.textSub(r.Namespace.REGISTER,"nick"),password:t.textSub(r.Namespace.REGISTER,"password"),name:t.textSub(r.Namespace.REGISTER,"name"),first:t.textSub(r.Namespace.REGISTER,"first"),last:t.textSub(r.Namespace.REGISTER,"last"),email:t.textSub(r.Namespace.REGISTER,"email"),address:t.textSub(r.Namespace.REGISTER,"address"),city:t.textSub(r.Namespace.REGISTER,"city"),state:t.textSub(r.Namespace.REGISTER,"state"),zip:t.textSub(r.Namespace.REGISTER,"zip"),phone:t.textSub(r.Namespace.REGISTER,"phone"),url:t.textSub(r.Namespace.REGISTER,"url"),date:t.textSub(r.Namespace.REGISTER,"date"),misc:t.textSub(r.Namespace.REGISTER,"misc"),text:t.textSub(r.Namespace.REGISTER,"text"),key:t.textSub(r.Namespace.REGISTER,"key")}});e.extendIQ(n),e.withDefinition("x",r.Namespace.OOB,function(t){e.extend(n,t)}),e.withDataForm(function(t){e.extend(n,t)})},t.exports=n["default"]},{"xmpp-constants":330}],127:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"roster",namespace:r.Namespace.ROSTER,element:"query",fields:{ver:{get:function(){return t.getAttribute(this.xml,"ver")},set:function(e){var n=""===e;t.setAttribute(this.xml,"ver",e,n)}}}}),i=e.define({name:"_rosterItem",namespace:r.Namespace.ROSTER,element:"item",fields:{jid:t.jidAttribute("jid",!0),name:t.attribute("name"),subscription:t.attribute("subscription","none"),subscriptionRequested:{get:function(){var e=t.getAttribute(this.xml,"ask");return"subscribe"===e}},preApproved:t.boolAttribute(r.Namespace.ROSTER,"approved"),groups:t.multiTextSub(r.Namespace.ROSTER,"group")}});e.extend(n,i,"items"),e.extendIQ(n)},t.exports=n["default"]},{"xmpp-constants":330}],128:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils;e.define({name:"rsm",namespace:r.Namespace.RSM,element:"set",fields:{after:t.textSub(r.Namespace.RSM,"after"),before:{get:function(){return t.getSubText(this.xml,r.Namespace.RSM,"before")},set:function(e){e===!0?t.findOrCreate(this.xml,r.Namespace.RSM,"before"):t.setSubText(this.xml,r.Namespace.RSM,"before",e)}},count:t.numberSub(r.Namespace.RSM,"count",!1,0),first:t.textSub(r.Namespace.RSM,"first"),firstIndex:t.subAttribute(r.Namespace.RSM,"first","index"),index:t.textSub(r.Namespace.RSM,"index"),last:t.textSub(r.Namespace.RSM,"last"),max:t.textSub(r.Namespace.RSM,"max")}})},t.exports=n["default"]},{"xmpp-constants":330}],129:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n={get:function(){var e=t.find(this.xml,r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb"),n=[];return e.forEach(function(e){n.push({type:t.getAttribute(e,"type"),subtype:t.getAttribute(e,"subtype")})}),e=t.find(this.xml,r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb-trr-int"),e.forEach(function(e){n.push({type:t.getAttribute(e,"type"),value:t.getAttribute(e,"value")})}),n},set:function(e){var n=this,i=t.find(this.xml,r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb");i.forEach(function(e){n.xml.removeChild(e)}),i=t.find(this.xml,r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb-trr-int"),i.forEach(function(e){n.xml.removeChild(e)}),e.forEach(function(e){var i=void 0;"trr-int"===e.type?(i=t.createElement(r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb-trr-int",r.Namespace.JINGLE_RTP_1),
t.setAttribute(i,"type",e.type),t.setAttribute(i,"value",e.value)):(i=t.createElement(r.Namespace.JINGLE_RTP_RTCP_FB_0,"rtcp-fb",r.Namespace.JINGLE_RTP_1),t.setAttribute(i,"type",e.type),t.setAttribute(i,"subtype",e.subtype)),n.xml.appendChild(i)})}},i=e.define({name:"bandwidth",namespace:r.Namespace.JINGLE_RTP_1,element:"bandwidth",fields:{type:t.attribute("type"),bandwidth:t.text()}}),o=e.define({name:"_rtp",namespace:r.Namespace.JINGLE_RTP_1,element:"description",tags:["jingle-application"],fields:{applicationType:{value:"rtp"},media:t.attribute("media"),ssrc:t.attribute("ssrc"),mux:t.boolSub(r.Namespace.JINGLE_RTP_1,"rtcp-mux"),encryption:{get:function(){var e=t.find(this.xml,r.Namespace.JINGLE_RTP_1,"encryption");if(!e.length)return[];e=e[0];var n=this,i=t.find(e,r.Namespace.JINGLE_RTP_1,"crypto"),o=[];return i.forEach(function(e){o.push(new s({},e,n).toJSON())}),o},set:function(e){var n=t.find(this.xml,r.Namespace.JINGLE_RTP_1,"encryption");if(n.length&&this.xml.removeChild(n),e.length){t.setBoolSubAttribute(this.xml,r.Namespace.JINGLE_RTP_1,"encryption","required",!0),n=t.find(this.xml,r.Namespace.JINGLE_RTP_1,"encryption")[0];var i=this;e.forEach(function(e){var t=new s(e,null,i);n.appendChild(t.xml)})}}},feedback:n,headerExtensions:{get:function(){var e=t.find(this.xml,r.Namespace.JINGLE_RTP_HDREXT_0,"rtp-hdrext"),n=[];return e.forEach(function(e){n.push({id:t.getAttribute(e,"id"),uri:t.getAttribute(e,"uri"),senders:t.getAttribute(e,"senders")})}),n},set:function(e){var n=this,i=t.find(this.xml,r.Namespace.JINGLE_RTP_HDREXT_0,"rtp-hdrext");i.forEach(function(e){n.xml.removeChild(e)}),e.forEach(function(e){var i=t.createElement(r.Namespace.JINGLE_RTP_HDREXT_0,"rtp-hdrext",r.Namespace.JINGLE_RTP_1);t.setAttribute(i,"id",e.id),t.setAttribute(i,"uri",e.uri),t.setAttribute(i,"senders",e.senders),n.xml.appendChild(i)})}}}}),a=e.define({name:"_payloadType",namespace:r.Namespace.JINGLE_RTP_1,element:"payload-type",fields:{channels:t.attribute("channels"),clockrate:t.attribute("clockrate"),id:t.attribute("id"),maxptime:t.attribute("maxptime"),name:t.attribute("name"),ptime:t.attribute("ptime"),feedback:n,parameters:{get:function(){var e=[],n=t.find(this.xml,r.Namespace.JINGLE_RTP_1,"parameter");return n.forEach(function(n){e.push({key:t.getAttribute(n,"name"),value:t.getAttribute(n,"value")})}),e},set:function(e){var n=this;e.forEach(function(e){var i=t.createElement(r.Namespace.JINGLE_RTP_1,"parameter");t.setAttribute(i,"name",e.key),t.setAttribute(i,"value",e.value),n.xml.appendChild(i)})}}}}),s=e.define({name:"crypto",namespace:r.Namespace.JINGLE_RTP_1,element:"crypto",fields:{cipherSuite:t.attribute("crypto-suite"),keyParams:t.attribute("key-params"),sessionParams:t.attribute("session-params"),tag:t.attribute("tag")}}),c=e.define({name:"_group",namespace:r.Namespace.JINGLE_GROUPING_0,element:"group",fields:{semantics:t.attribute("semantics"),contents:t.multiSubAttribute(r.Namespace.JINGLE_GROUPING_0,"content","name")}}),u=e.define({name:"mute",namespace:r.Namespace.JINGLE_RTP_INFO_1,element:"mute",fields:{creator:t.attribute("creator"),name:t.attribute("name")}}),l=e.define({name:"unmute",namespace:r.Namespace.JINGLE_RTP_INFO_1,element:"unmute",fields:{creator:t.attribute("creator"),name:t.attribute("name")}});e.extend(o,i),e.extend(o,a,"payloads"),e.withDefinition("content",r.Namespace.JINGLE_1,function(t){e.extend(t,o)}),e.withDefinition("jingle",r.Namespace.JINGLE_1,function(n){e.extend(n,u),e.extend(n,l),e.extend(n,c,"groups"),e.add(n,"ringing",t.boolSub(r.Namespace.JINGLE_RTP_INFO_1,"ringing")),e.add(n,"hold",t.boolSub(r.Namespace.JINGLE_RTP_INFO_1,"hold")),e.add(n,"active",t.boolSub(r.Namespace.JINGLE_RTP_INFO_1,"active"))})},t.exports=n["default"]},{"xmpp-constants":330}],130:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i={insert:"t",erase:"e",wait:"w"},o={t:"insert",e:"erase",w:"wait"};n["default"]=function(e){var t=e.utils,n=e.define({name:"rtt",namespace:r.Namespace.RTT_0,element:"rtt",fields:{id:t.attribute("id"),event:t.attribute("event","edit"),seq:t.numberAttribute("seq"),actions:{get:function(){for(var e=[],n=0,i=this.xml.childNodes.length;i>n;n++){var a=this.xml.childNodes[n],s=a.localName,c={};if(a.namespaceURI===r.Namespace.RTT_0&&o[s]){c.type=o[s];var u=t.getAttribute(a,"p");u&&(c.pos=parseInt(u,10));var l=t.getAttribute(a,"n");l&&(c.num=parseInt(l,10));var d=t.getText(a);d&&"t"===s&&(c.text=d),e.push(c)}}return e},set:function(e){for(var n=this,o=0,a=this.xml.childNodes.length;a>o;o++)this.xml.removeChild(this.xml.childNodes[o]);e.forEach(function(e){if(i[e.type]){var o=t.createElement(r.Namespace.RTT_0,i[e.type],r.Namespace.RTT_0);void 0!==e.pos&&t.setAttribute(o,"p",e.pos.toString()),e.num&&t.setAttribute(o,"n",e.num.toString()),e.text&&t.setText(o,e.text),n.xml.appendChild(o)}})}}}});e.extendMessage(n)},t.exports=n["default"]},{"xmpp-constants":330}],131:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["aborted","account-disabled","credentials-expired","encryption-required","incorrect-encoding","invalid-authzid","invalid-mechanism","malformed-request","mechanism-too-weak","not-authorized","temporary-auth-failure"];n["default"]=function(e){var t=e.utils,n=e.define({name:"sasl",namespace:r.Namespace.SASL,element:"mechanisms",fields:{mechanisms:t.multiTextSub(r.Namespace.SASL,"mechanism")}});e.define({name:"saslAuth",eventName:"sasl:auth",namespace:r.Namespace.SASL,element:"auth",topLevel:!0,fields:{value:t.text(),mechanism:t.attribute("mechanism")}}),e.define({name:"saslChallenge",eventName:"sasl:challenge",namespace:r.Namespace.SASL,element:"challenge",topLevel:!0,fields:{value:t.text()}}),e.define({name:"saslResponse",eventName:"sasl:response",namespace:r.Namespace.SASL,element:"response",topLevel:!0,fields:{value:t.text()}}),e.define({name:"saslAbort",eventName:"sasl:abort",namespace:r.Namespace.SASL,element:"abort",topLevel:!0}),e.define({name:"saslSuccess",eventName:"sasl:success",namespace:r.Namespace.SASL,element:"success",topLevel:!0,fields:{value:t.text()}}),e.define({name:"saslFailure",eventName:"sasl:failure",namespace:r.Namespace.SASL,element:"failure",topLevel:!0,fields:{lang:{get:function(){return this._lang||""},set:function(e){this._lang=e}},condition:t.enumSub(r.Namespace.SASL,i),$text:{get:function(){return t.getSubLangText(this.xml,r.Namespace.SASL,"text",this.lang)}},text:{get:function(){var e=this.$text;return e[this.lang]||""},set:function(e){t.setSubLangText(this.xml,r.Namespace.SASL,"text",e,this.lang)}}}}),e.extendStreamFeatures(n)},t.exports=n["default"]},{"xmpp-constants":330}],132:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.define({name:"session",namespace:r.Namespace.SESSION,element:"session",fields:{required:e.utils.boolSub(r.Namespace.SESSION,"required"),optional:e.utils.boolSub(r.Namespace.SESSION,"optional")}});e.extendIQ(t),e.extendStreamFeatures(t)},t.exports=n["default"]},{"xmpp-constants":330}],133:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n={get:function(){var e=t.find(this.xml,r.Namespace.SHIM,"headers");return e.length?t.getMultiSubText(e[0],r.Namespace.SHIM,"header",function(e){var n=t.getAttribute(e,"name");return n?{name:n,value:t.getText(e)}:void 0}):[]},set:function(n){var i=t.findOrCreate(this.xml,r.Namespace.SHIM,"headers");e.setMultiSubText(i,r.Namespace.SHIM,"header",n,function(e){var n=t.createElement(r.Namespace.SHIM,"header",r.Namespace.SHIM);t.setAttribute(n,"name",e.name),t.setText(n,e.value),i.appendChild(n)})}};e.withMessage(function(t){e.add(t,"headers",n)}),e.withPresence(function(t){e.add(t,"headers",n)})},t.exports=n["default"]},{"xmpp-constants":330}],134:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"streamManagement",namespace:r.Namespace.SMACKS_3,element:"sm"});e.define({name:"smEnable",eventName:"stream:management:enable",namespace:r.Namespace.SMACKS_3,element:"enable",topLevel:!0,fields:{resume:t.boolAttribute("resume")}}),e.define({name:"smEnabled",eventName:"stream:management:enabled",namespace:r.Namespace.SMACKS_3,element:"enabled",topLevel:!0,fields:{id:t.attribute("id"),resume:t.boolAttribute("resume")}}),e.define({name:"smResume",eventName:"stream:management:resume",namespace:r.Namespace.SMACKS_3,element:"resume",topLevel:!0,fields:{h:t.numberAttribute("h",!1,0),previd:t.attribute("previd")}}),e.define({name:"smResumed",eventName:"stream:management:resumed",namespace:r.Namespace.SMACKS_3,element:"resumed",topLevel:!0,fields:{h:t.numberAttribute("h",!1,0),previd:t.attribute("previd")}}),e.define({name:"smFailed",eventName:"stream:management:failed",namespace:r.Namespace.SMACKS_3,element:"failed",topLevel:!0}),e.define({name:"smAck",eventName:"stream:management:ack",namespace:r.Namespace.SMACKS_3,element:"a",topLevel:!0,fields:{h:t.numberAttribute("h",!1,0)}}),e.define({name:"smRequest",eventName:"stream:management:request",namespace:r.Namespace.SMACKS_3,element:"r",topLevel:!0}),e.extendStreamFeatures(n)},t.exports=n["default"]},{"xmpp-constants":330}],135:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils;e.define({name:"stream",namespace:r.Namespace.STREAM,element:"stream",fields:{lang:t.langAttribute(),id:t.attribute("id"),version:t.attribute("version","1.0"),to:t.jidAttribute("to",!0),from:t.jidAttribute("from",!0)}})},t.exports=n["default"]},{"xmpp-constants":330}],136:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants"),i=["bad-format","bad-namespace-prefix","conflict","connection-timeout","host-gone","host-unknown","improper-addressing","internal-server-error","invalid-from","invalid-namespace","invalid-xml","not-authorized","not-well-formed","policy-violation","remote-connection-failed","reset","resource-constraint","restricted-xml","see-other-host","system-shutdown","undefined-condition","unsupported-encoding","unsupported-feature","unsupported-stanza-type","unsupported-version"];n["default"]=function(e){var t=e.utils;e.define({name:"streamError",namespace:r.Namespace.STREAM,element:"error",topLevel:!0,fields:{lang:{get:function(){return this._lang||""},set:function(e){this._lang=e}},condition:t.enumSub(r.Namespace.STREAM_ERROR,i),seeOtherHost:{get:function(){return t.getSubText(this.xml,r.Namespace.STREAM_ERROR,"see-other-host")},set:function(e){this.condition="see-other-host",t.setSubText(this.xml,r.Namespace.STREAM_ERROR,"see-other-host",e)}},$text:{get:function(){return t.getSubLangText(this.xml,r.Namespace.STREAM_ERROR,"text",this.lang)}},text:{get:function(){var e=this.$text;return e[this.lang]||""},set:function(e){t.setSubLangText(this.xml,r.Namespace.STREAM_ERROR,"text",e,this.lang)}}}})},t.exports=n["default"]},{"xmpp-constants":330}],137:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=(e.define({name:"streamFeatures",namespace:r.Namespace.STREAM,element:"features",topLevel:!0}),e.define({name:"rosterVersioning",namespace:r.Namespace.ROSTER_VERSIONING,element:"ver"})),n=e.define({name:"subscriptionPreApproval",namespace:r.Namespace.SUBSCRIPTION_PREAPPROVAL,element:"sub"});e.extendStreamFeatures(t),e.extendStreamFeatures(n)},t.exports=n["default"]},{"xmpp-constants":330}],138:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.define({name:"time",namespace:r.Namespace.TIME,element:"time",fields:{utc:e.utils.dateSub(r.Namespace.TIME,"utc"),tzo:e.utils.tzoSub(r.Namespace.TIME,"tzo",0)}});e.extendIQ(t)},t.exports=n["default"]},{"xmpp-constants":330}],139:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"tune",namespace:r.Namespace.TUNE,element:"tune",fields:{artist:t.textSub(r.Namespace.TUNE,"artist"),length:t.numberSub(r.Namespace.TUNE,"length"),rating:t.numberSub(r.Namespace.TUNE,"rating"),source:t.textSub(r.Namespace.TUNE,"source"),title:t.textSub(r.Namespace.TUNE,"title"),track:t.textSub(r.Namespace.TUNE,"track"),uri:t.textSub(r.Namespace.TUNE,"uri")}});e.extendPubsubItem(n),e.extendMessage(n)},t.exports=n["default"]},{"xmpp-constants":330}],140:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.utils,n=e.define({name:"vCardTemp",namespace:r.Namespace.VCARD_TEMP,element:"vCard",fields:{role:t.textSub(r.Namespace.VCARD_TEMP,"ROLE"),website:t.textSub(r.Namespace.VCARD_TEMP,"URL"),title:t.textSub(r.Namespace.VCARD_TEMP,"TITLE"),description:t.textSub(r.Namespace.VCARD_TEMP,"DESC"),fullName:t.textSub(r.Namespace.VCARD_TEMP,"FN"),birthday:t.dateSub(r.Namespace.VCARD_TEMP,"BDAY"),nicknames:t.multiTextSub(r.Namespace.VCARD_TEMP,"NICKNAME"),jids:t.multiTextSub(r.Namespace.VCARD_TEMP,"JABBERID")}}),i=e.define({name:"_email",namespace:r.Namespace.VCARD_TEMP,element:"EMAIL",fields:{email:t.textSub(r.Namespace.VCARD_TEMP,"USERID"),home:t.boolSub(r.Namespace.VCARD_TEMP,"HOME"),work:t.boolSub(r.Namespace.VCARD_TEMP,"WORK"),preferred:t.boolSub(r.Namespace.VCARD_TEMP,"PREF")}}),o=e.define({name:"_tel",namespace:r.Namespace.VCARD_TEMP,element:"TEL",fields:{number:t.textSub(r.Namespace.VCARD_TEMP,"NUMBER"),home:t.boolSub(r.Namespace.VCARD_TEMP,"HOME"),work:t.boolSub(r.Namespace.VCARD_TEMP,"WORK"),mobile:t.boolSub(r.Namespace.VCARD_TEMP,"CELL"),preferred:t.boolSub(r.Namespace.VCARD_TEMP,"PREF")}}),a=e.define({name:"_address",namespace:r.Namespace.VCARD_TEMP,element:"ADR",fields:{street:t.textSub(r.Namespace.VCARD_TEMP,"STREET"),street2:t.textSub(r.Namespace.VCARD_TEMP,"EXTADD"),country:t.textSub(r.Namespace.VCARD_TEMP,"CTRY"),city:t.textSub(r.Namespace.VCARD_TEMP,"LOCALITY"),region:t.textSub(r.Namespace.VCARD_TEMP,"REGION"),postalCode:t.textSub(r.Namespace.VCARD_TEMP,"PCODE"),pobox:t.textSub(r.Namespace.VCARD_TEMP,"POBOX"),home:t.boolSub(r.Namespace.VCARD_TEMP,"HOME"),work:t.boolSub(r.Namespace.VCARD_TEMP,"WORK"),preferred:t.boolSub(r.Namespace.VCARD_TEMP,"PREF")}}),s=e.define({name:"organization",namespace:r.Namespace.VCARD_TEMP,element:"ORG",fields:{name:t.textSub(r.Namespace.VCARD_TEMP,"ORGNAME"),unit:t.textSub(r.Namespace.VCARD_TEMP,"ORGUNIT")}}),c=e.define({name:"name",namespace:r.Namespace.VCARD_TEMP,element:"N",fields:{family:t.textSub(r.Namespace.VCARD_TEMP,"FAMILY"),given:t.textSub(r.Namespace.VCARD_TEMP,"GIVEN"),middle:t.textSub(r.Namespace.VCARD_TEMP,"MIDDLE"),prefix:t.textSub(r.Namespace.VCARD_TEMP,"PREFIX"),suffix:t.textSub(r.Namespace.VCARD_TEMP,"SUFFIX")}}),u=e.define({name:"photo",namespace:r.Namespace.VCARD_TEMP,element:"PHOTO",fields:{type:t.textSub(r.Namespace.VCARD_TEMP,"TYPE"),data:t.textSub(r.Namespace.VCARD_TEMP,"BINVAL"),url:t.textSub(r.Namespace.VCARD_TEMP,"EXTVAL")}});e.extend(n,i,"emails"),e.extend(n,a,"addresses"),e.extend(n,o,"phoneNumbers"),e.extend(n,s),e.extend(n,c),e.extend(n,u),e.extendIQ(n)},t.exports=n["default"]},{"xmpp-constants":330}],141:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){var t=e.define({name:"version",namespace:r.Namespace.VERSION,element:"query",fields:{name:e.utils.textSub(r.Namespace.VERSION,"name"),version:e.utils.textSub(r.Namespace.VERSION,"version"),os:e.utils.textSub(r.Namespace.VERSION,"os")}});e.extendIQ(t)},t.exports=n["default"]},{"xmpp-constants":330}],142:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("xmpp-constants");n["default"]=function(e){e.withIQ(function(t){e.add(t,"visible",e.utils.boolSub(r.Namespace.INVISIBLE_0,"visible")),e.add(t,"invisible",e.utils.boolSub(r.Namespace.INVISIBLE_0,"invisible"))})},t.exports=n["default"]},{"xmpp-constants":330}],143:[function(e,t,n){"use strict";function r(){this._LOOKUP={},this._LOOKUP_EXT={},this._TAGS={},this._CB_DEFINITION={},this._CB_TAG={},this._ID=o.v4(),this.utils=i({},a,s)}var i=e("lodash.assign"),o=e("uuid"),a=e("./lib/types"),s=e("./lib/helpers"),c=e("./lib/stanza");r.prototype.use=function(e){return e&&"function"==typeof e?(e["__JXT_LOADED_"+this._ID]||(e(this),e["__JXT_LOADED_"+this._ID]=!0),this):this},r.prototype.getDefinition=function(e,t,n){var r=this._LOOKUP[t+"|"+e];if(n&&!r)throw new Error("Could not find definition for <"+e+' xmlns="'+t+'" />');return r},r.prototype.getExtensions=function(e,t){return this._LOOKUP_EXT[t+"|"+e]||{}},r.prototype.withDefinition=function(e,t,n){var r=t+"|"+e;this._CB_DEFINITION[r]||(this._CB_DEFINITION[r]=[]),this._CB_DEFINITION[r].push(n),this._LOOKUP[r]&&n(this._LOOKUP[r])},r.prototype.withTag=function(e,t){this._CB_TAG[e]||(this._CB_TAG[e]=[]),this._CB_TAG[e].push(t),this.tagged(e).forEach(function(e){t(e)})},r.prototype.tagged=function(e){return this._TAGS[e]||[]},r.prototype.build=function(e){var t=this.getDefinition(e.localName,e.namespaceURI);return t?new t(null,e):void 0},r.prototype.parse=function(e){var t=s.parse(e);if(t)return this.build(t)},r.prototype.extend=function(e,t,n,r){var i=e.prototype._NS+"|"+e.prototype._EL,o=t.prototype._name,s=t.prototype._NS+"|"+t.prototype._EL;this._LOOKUP[s]=t,this._LOOKUP_EXT[s]||(this._LOOKUP_EXT[s]={}),this._LOOKUP_EXT[i]||(this._LOOKUP_EXT[i]={}),this._LOOKUP_EXT[i][o]=t,(!n||n&&!r)&&this.add(e,o,a.extension(t)),n&&this.add(e,n,a.multiExtension(t))},r.prototype.add=function(e,t,n){n.enumerable=!0,Object.defineProperty(e.prototype,t,n)},r.prototype.define=function(e){var t=this,n=c(this,e),r=n.prototype._NS,i=n.prototype._EL,o=n.prototype._TAGS,a=r+"|"+i;this._LOOKUP[a]=n,o.forEach(function(e){t._TAGS[e]||(t._TAGS[e]=[]),t._TAGS[e].push(n)});var s=Object.keys(e.fields||{});return s.forEach(function(r){t.add(n,r,e.fields[r])}),this._CB_DEFINITION[a]&&this._CB_DEFINITION[a].forEach(function(e){e(n)}),o.forEach(function(e){t._CB_TAG[e]&&t._CB_TAG[e].forEach(function(e){e(n)})}),n},r.createRegistry=function(){return new r},i(r,s),i(r,a);var u=new r;r.define=u.define.bind(u),r.extend=u.extend.bind(u),r.add=u.add.bind(u),r.parse=u.parse.bind(u),r.build=u.build.bind(u),r.getExtensions=u.getExtensions.bind(u),r.getDefinition=u.getDefinition.bind(u),r.withDefinition=u.withDefinition.bind(u),r.withTag=u.withTag.bind(u),r.tagged=u.tagged.bind(u),r.getGlobalJXT=function(){return u},t.exports=r},{"./lib/helpers":144,"./lib/stanza":145,"./lib/types":146,"lodash.assign":163,uuid:310}],144:[function(e,t,n){"use strict";var r=e("ltx"),i=e("ltx/lib/DOMElement"),o=n.XML_NS="http://www.w3.org/XML/1998/namespace";n.parse=function(e){var t=r.parse(e,{Element:i});if(1===t.nodeType)return t},n.createElement=function(e,t,r){var o=new i(t);return r&&r===e||n.setAttribute(o,"xmlns",e),o};var a=n.find=function(e,t,n){for(var r=[],i=e.getElementsByTagName(n),o=0,a=i.length;a>o;o++){var s=i[o];s.namespaceURI===t&&s.parentNode===e&&r.push(s)}return r};n.findOrCreate=function(e,t,r){var i=n.find(e,t,r);if(i.length)return i[0];var o=n.createElement(t,r,e.namespaceURI);return e.appendChild(o),o},n.getAttribute=function(e,t,n){return e.getAttribute(t)||n||""},n.getAttributeNS=function(e,t,n,r){return e.getAttributeNS(t,n)||r||""},n.setAttribute=function(e,t,n,r){n||r?e.setAttribute(t,n):e.removeAttribute(t)},n.setAttributeNS=function(e,t,n,r,i){r||i?e.setAttributeNS(t,n,r):e.removeAttributeNS(t,n)},n.getBoolAttribute=function(e,t,n){var r=e.getAttribute(t)||n||"";return"true"===r||"1"===r},n.setBoolAttribute=function(e,t,n){n?e.setAttribute(t,"1"):e.removeAttribute(t)},n.getSubAttribute=function(e,t,n,r,i){var o=a(e,t,n);if(!o)return"";for(var s=0;s<o.length;s++)return o[s].getAttribute(r)||i||"";return""},n.setSubAttribute=function(e,t,r,i,o){var s=a(e,t,r);if(s.length)for(var c=0;c<s.length;c++){if(o)return void s[c].setAttribute(i,o);s[c].removeAttribute(i)}else o&&(r=n.createElement(t,r,e.namespaceURI),r.setAttribute(i,o),e.appendChild(r))},n.getBoolSubAttribute=function(e,t,n,r,i){var o=e.getSubAttribute(t,n,r)||i||"";return"true"===o||"1"===o},n.setBoolSubAttribute=function(e,t,r,i,o){o=o?"1":"",n.setSubAttribute(e,t,r,i,o)},n.getText=function(e){return e.textContent},n.setText=function(e,t){e.textContent=t},n.getSubText=n.getTextSub=function(e,t,n,r){var i=a(e,t,n);return r=r||"",i.length?i[0].textContent||r:r},n.setSubText=n.setTextSub=function(e,t,r,i){var o=a(e,t,r);if(o.length)for(var s=0;s<o.length;s++)e.removeChild(o[s]);if(i){var c=n.createElement(t,r,e.namespaceURI);i!==!0&&(c.textContent=i),e.appendChild(c)}},n.getMultiSubText=function(e,t,n,r){var i=a(e,t,n),o=[];r=r||function(e){return e.textContent||""};for(var s=0;s<i.length;s++)o.push(r(i[s]));return o},n.setMultiSubText=function(e,t,r,i,o){var s=a(e,t,r),c=[];o=o||function(i){if(i){var o=n.createElement(t,r,e.namespaceURI);o.textContent=i,e.appendChild(o)}},c="string"==typeof i?(i||"").split("\n"):i;var u,l;for(u=0,l=s.length;l>u;u++)e.removeChild(s[u]);for(u=0,l=c.length;l>u;u++)o(c[u])},n.getMultiSubAttribute=function(e,t,r,i){return n.getMultiSubText(e,t,r,function(e){return n.getAttribute(e,i)})},n.setMultiSubAttribute=function(e,t,r,i,o){n.setMultiSubText(e,t,r,o,function(o){var a=n.createElement(t,r,e.namespaceURI);n.setAttribute(a,i,o),e.appendChild(a)})},n.getSubLangText=function(e,t,n,r){var i=a(e,t,n);if(!i.length)return{};for(var s,c,u={},l=[],d=0;d<i.length;d++)c=i[d],s=c.getAttributeNS(o,"lang")||r,l.push(s),u[s]=c.textContent||"";return u},n.setSubLangText=function(e,t,r,i,s){var c,u,l=a(e,t,r);if(l.length)for(var d=0;d<l.length;d++)e.removeChild(l[d]);if("string"==typeof i)c=n.createElement(t,r,e.namespaceURI),c.textContent=i,e.appendChild(c);else if("object"==typeof i)for(u in i)i.hasOwnProperty(u)&&(c=n.createElement(t,r,e.namespaceURI),u!==s&&c.setAttributeNS(o,"lang",u),c.textContent=i[u],e.appendChild(c))},n.getBoolSub=function(e,t,n){var r=a(e,t,n);return!!r.length},n.setBoolSub=function(e,t,r,i){var o=a(e,t,r);if(o.length)for(var s=0;s<o.length;s++){if(i)return;e.removeChild(o[s])}else if(i){var c=n.createElement(t,r,e.namespaceURI);e.appendChild(c)}}},{ltx:174,"ltx/lib/DOMElement":175}],145:[function(e,t,n){"use strict";var r=e("./helpers"),i=e("lodash.assign"),o={constructor:!0,parent:!0,prototype:!0,toJSON:!0,toString:!0,xml:!0};t.exports=function(e,t){function n(n,o,a){var s=this,c=(o||{}).parentNode||(a||{}).xml,u=(c||{}).namespaceURI;s.xml=o||r.createElement(s._NS,s._EL,u),Object.keys(s._PREFIXES).forEach(function(e){var t=s._PREFIXES[e];s.xml.setAttribute("xmlns:"+e,t)}),s._extensions={};for(var l=0,d=s.xml.childNodes.length;d>l;l++){var p=s.xml.childNodes[l],f=e.getDefinition(p.localName,p.namespaceURI);if(void 0!==f){var h=f.prototype._name;s._extensions[h]=new f(null,p),s._extensions[h].parent=s}}return i(s,n),t.init&&t.init.apply(s,[n]),s}return n.prototype._isJXT=!0,n.prototype._name=t.name,n.prototype._eventname=t.eventName,n.prototype._NS=t.namespace,n.prototype._EL=t.element||t.name,n.prototype._PREFIXES=t.prefixes||{},n.prototype._TAGS=t.tags||[],n.prototype.toString=function(){return this.xml.toString()},n.prototype.toJSON=function(){var t,n={};for(t in this._extensions)this._extensions[t].toJSON&&"_"!==t[0]&&(n[t]=this._extensions[t].toJSON());for(t in this){var r=!o[t]&&"_"!==t[0],i=e.getExtensions(this._EL,this._NS)[t];if(r&&!i){var a=this[t];if("function"==typeof a)continue;var s=Object.prototype.toString.call(a);if(s.indexOf("Object")>=0)Object.keys(a).length>0&&(n[t]=a._isJXT?a.toJSON():a);else if(s.indexOf("Array")>=0){if(a.length>0){for(var c=[],u=a.length,l=0;u>l;l++){var d=a[l];"undefined"!=typeof d&&c.push(d._isJXT?d.toJSON():d)}n[t]=c}}else void 0!==a&&a!==!1&&""!==a&&(n[t]=a)}}return n},n}},{"./helpers":144,"lodash.assign":163}],146:[function(e,t,n){(function(t){"use strict";var r=e("./helpers"),i=e("lodash.assign"),o=r.find,a=r.createElement,s=n.field=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return{get:function(){return e.apply(null,[this.xml].concat(n))},set:function(e){t.apply(null,[this.xml].concat(n).concat([e]))}}}};n.boolAttribute=s(r.getBoolAttribute,r.setBoolAttribute),n.subAttribute=s(r.getSubAttribute,r.setSubAttribute),n.boolSubAttribute=s(r.getSubBoolAttribute,r.setSubBoolAttribute),n.text=s(r.getText,r.setText),n.textSub=n.subText=s(r.getSubText,r.setSubText),n.multiTextSub=n.multiSubText=s(r.getMultiSubText,r.setMultiSubText),n.multiSubAttribute=s(r.getMultiSubAttribute,r.setMultiSubAttribute),n.langTextSub=n.subLangText=s(r.getSubLangText,r.setSubLangText),n.boolSub=s(r.getBoolSub,r.setBoolSub),n.langAttribute=s(function(e){return e.getAttributeNS(r.XML_NS,"lang")||""},function(e,t){e.setAttributeNS(r.XML_NS,"lang",t)}),n.b64Text=s(function(e){return e.textContent&&"="!==e.textContent?new t(e.textContent,"base64"):""},function(e,n){if("string"==typeof n){var r=new t(n).toString("base64");e.textContent=r||"="}else e.textContent=""}),n.dateAttribute=function(e,t){return{get:function(){var n=r.getAttribute(this.xml,e);return n?new Date(n):t?new Date(Date.now()):void 0},set:function(t){t&&("string"!=typeof t&&(t=t.toISOString()),r.setAttribute(this.xml,e,t))}}},n.dateSub=function(e,t,n){return{get:function(){var i=r.getSubText(this.xml,e,t);return i?new Date(i):n?new Date(Date.now()):void 0},set:function(n){n&&("string"!=typeof n&&(n=n.toISOString()),r.setSubText(this.xml,e,t,n))}}},n.dateSubAttribute=function(e,t,n,i){return{get:function(){var o=r.getSubAttribute(this.xml,e,t,n);return o?new Date(o):i?new Date(Date.now()):void 0},set:function(i){i&&("string"!=typeof i&&(i=i.toISOString()),r.setSubAttribute(this.xml,e,t,n,i))}}},n.numberAttribute=function(e,t,n){return{get:function(){var i=t?parseFloat:parseInt,o=r.getAttribute(this.xml,e,"");if(!o)return n;var a=i(o,10);return isNaN(a)?n:a},set:function(t){r.setAttribute(this.xml,e,t.toString())}}},n.numberSub=function(e,t,n,i){return{get:function(){var o=n?parseFloat:parseInt,a=r.getSubText(this.xml,e,t,"");if(!a)return i;var s=o(a,10);return isNaN(s)?i:s},set:function(n){r.setSubText(this.xml,e,t,n.toString())}}},n.numberSubAttribute=function(e,t,n,i,o){return{get:function(){var a=i?parseFloat:parseInt,s=r.getSubAttribute(this.xml,e,t,n,"");if(!s)return o;var c=a(s,10);return isNaN(c)?o:c},set:function(i){r.setSubAttribute(this.xml,e,t,n,i.toString())}}},n.attribute=function(e,t){return{get:function(){return r.getAttribute(this.xml,e,t)},set:function(t){r.setAttribute(this.xml,e,t)}}},n.attributeNS=function(e,t,n){return{get:function(){return r.getAttributeNS(this.xml,e,t,n)},set:function(n){r.setAttributeNS(this.xml,e,t,n)}}},n.extension=function(e){return{get:function(){var t=this,n=e.prototype._name;if(!this._extensions[n]){var r=o(this.xml,e.prototype._NS,e.prototype._EL);r.length?this._extensions[n]=new e(null,r[0],t):(this._extensions[n]=new e({},null,t),this.xml.appendChild(this._extensions[n].xml)),this._extensions[n].parent=this}return this._extensions[n]},set:function(t){if(t){var n=this[e.prototype._name];t===!0&&(t={}),i(n,t)}}}},n.multiExtension=function(e){return{get:function(){for(var t=this,n=o(this.xml,e.prototype._NS,e.prototype._EL),r=[],i=0,a=n.length;a>i;i++)r.push(new e({},n[i],t));return r},set:function(t){t=t||[];var n,r,i=this,a=o(this.xml,e.prototype._NS,e.prototype._EL);for(n=0,r=a.length;r>n;n++)i.xml.removeChild(a[n]);for(n=0,r=t.length;r>n;n++){var s=new e(t[n],null,i);i.xml.appendChild(s.xml)}}}},n.enumSub=function(e,t){return{get:function(){var n=this,r=[];return t.forEach(function(t){var i=o(n.xml,e,t);i.length&&r.push(i[0].nodeName)}),r[0]||""},set:function(n){var r=this,i=!1;if(t.forEach(function(t){var a=o(r.xml,e,t);a.length&&(t===n?i=!0:r.xml.removeChild(a[0]))}),n&&!i){var s=a(e,n);this.xml.appendChild(s)}}}},n.subExtension=function(e,t,n,r){return{get:function(){if(!this._extensions[e]){var i=o(this.xml,t,n);i.length?i=i[0]:(i=a(t,n,this._NS),this.xml.appendChild(i));var s=o(i,r.prototype._NS,r.prototype._EL);s.length?this._extensions[e]=new r(null,s[0],{xml:i}):(this._extensions[e]=new r({},null,{xml:i}),i.appendChild(this._extensions[e].xml)),this._extensions[e].parent=this}return this._extensions[e]},set:function(r){var a=o(this.xml,t,n);if(a.length&&!r&&this.xml.removeChild(a[0]),r){var s=this[e];r===!0&&(r={}),i(s,r)}}}},n.subMultiExtension=function(e,t,n){return{get:function(){var r=this,i=[],a=o(this.xml,e,t);if(!a.length)return i;a=a[0];var s=o(a,n.prototype._NS,n.prototype._EL);return s.forEach(function(e){i.push(new n({},e,r))}),i},set:function(r){var i=this,s=o(this.xml,e,t);s.length&&i.xml.removeChild(s[0]),r.length&&(s=a(e,t,this._NS),r.forEach(function(t){var r=new n(t,null,{xml:{namespaceURI:e}});s.appendChild(r.xml)}),i.xml.appendChild(s))}}}}).call(this,e("buffer").Buffer)},{"./helpers":144,buffer:9,"lodash.assign":163}],147:[function(e,t,n){function r(e,t){for(var n=-1,r=e.length;++n<r&&t(e[n],n,e)!==!1;);return e}t.exports=r},{}],148:[function(e,t,n){function r(e,t){for(var n=-1,r=e.length,i=-1,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[++i]=a)}return o}t.exports=r},{}],149:[function(e,t,n){function r(e,t){return null==t?e:i(t,o(t),e)}var i=e("lodash._basecopy"),o=e("lodash.keys");t.exports=r},{"lodash._basecopy":151,"lodash.keys":170}],150:[function(e,t,n){function r(e){return null==e?"":e+""}function i(e,t,n){var r=typeof e;return"function"==r?void 0===t?e:C(e,t,n):null==e?_:"object"==r?s(e):void 0===t?S(e):c(e,t)}function o(e,t,n){if(null!=e){void 0!==n&&n in m(e)&&(t=[n]);for(var r=0,i=t.length;null!=e&&i>r;)e=e[t[r++]];return r&&r==i?e:void 0}}function a(e,t,n){var r=t.length,i=r,o=!n;if(null==e)return!i;for(e=m(e);r--;){var a=t[r];if(o&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++r<i;){a=t[r];var s=a[0],c=e[s],u=a[1];if(o&&a[2]){if(void 0===c&&!(s in e))return!1}else{var l=n?n(c,u,s):void 0;if(!(void 0===l?b(u,c,n,!0):l))return!1}}return!0}function s(e){var t=p(e);if(1==t.length&&t[0][2]){var n=t[0][0],r=t[0][1];return function(e){return null==e?!1:e[n]===r&&(void 0!==r||n in m(e))}}return function(e){return a(e,t)}}function c(e,t){var n=w(e),r=f(e)&&h(t),i=e+"";return e=v(e),function(a){if(null==a)return!1;var s=i;if(a=m(a),!(!n&&r||s in a)){if(a=1==e.length?a:o(a,d(e,0,-1)),null==a)return!1;s=g(e),a=m(a)}return a[s]===t?void 0!==t||s in a:b(t,a[s],void 0,!0)}}function u(e){return function(t){return null==t?void 0:t[e]}}function l(e){var t=e+"";return e=v(e),function(n){return o(n,e,t)}}function d(e,t,n){var r=-1,i=e.length;t=null==t?0:+t||0,0>t&&(t=-t>i?0:i+t),n=void 0===n||n>i?i:+n||0,0>n&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}function p(e){for(var t=E(e),n=t.length;n--;)t[n][2]=h(t[n][1]);return t}function f(e,t){var n=typeof e;if("string"==n&&P.test(e)||"number"==n)return!0;if(w(e))return!1;var r=!R.test(e);return r||null!=t&&e in m(t)}function h(e){return e===e&&!y(e)}function m(e){return y(e)?e:Object(e)}function v(e){if(w(e))return e;var t=[];return r(e).replace(x,function(e,n,r,i){t.push(r?i.replace(T,"$1"):n||e)}),t}function g(e){var t=e?e.length:0;return t?e[t-1]:void 0}function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function _(e){return e}function S(e){return f(e)?u(e):l(e)}var b=e("lodash._baseisequal"),C=e("lodash._bindcallback"),w=e("lodash.isarray"),E=e("lodash.pairs"),R=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,P=/^\w*$/,x=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,T=/\\(\\)?/g;t.exports=i},{"lodash._baseisequal":155,"lodash._bindcallback":157,"lodash.isarray":168,"lodash.pairs":171}],151:[function(e,t,n){function r(e,t,n){n||(n={});for(var r=-1,i=t.length;++r<i;){var o=t[r];n[o]=e[o]}return n}t.exports=r},{}],152:[function(e,t,n){function r(e,t){return f(e,t,l)}function i(e){
return function(t){return null==t?void 0:t[e]}}function o(e,t){return function(n,r){var i=n?h(n):0;if(!s(i))return e(n,r);for(var o=t?i:-1,a=c(n);(t?o--:++o<i)&&r(a[o],o,a)!==!1;);return n}}function a(e){return function(t,n,r){for(var i=c(t),o=r(t),a=o.length,s=e?a:-1;e?s--:++s<a;){var u=o[s];if(n(i[u],u,i)===!1)break}return t}}function s(e){return"number"==typeof e&&e>-1&&e%1==0&&d>=e}function c(e){return u(e)?e:Object(e)}function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var l=e("lodash.keys"),d=9007199254740991,p=o(r),f=a(),h=i("length");t.exports=p},{"lodash.keys":170}],153:[function(e,t,n){function r(e,t){var n=[];return i(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}var i=e("lodash._baseeach");t.exports=r},{"lodash._baseeach":152}],154:[function(e,t,n){function r(e,t,n){if(t!==t)return i(e,n);for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}function i(e,t,n){for(var r=e.length,i=t+(n?0:-1);n?i--:++i<r;){var o=e[i];if(o!==o)return i}return-1}t.exports=r},{}],155:[function(e,t,n){function r(e){return!!e&&"object"==typeof e}function i(e,t){for(var n=-1,r=e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function o(e,t,n,i,s,c){return e===t?!0:null==e||null==t||!l(e)&&!r(t)?e!==e&&t!==t:a(e,t,o,n,i,s,c)}function a(e,t,n,r,i,o,a){var l=d(e),f=d(t),v=m,g=m;l||(v=R.call(e),v==h?v=S:v!=S&&(l=p(e))),f||(g=R.call(t),g==h?g=S:g!=S&&(f=p(t)));var y=v==S,_=g==S,b=v==g;if(b&&!l&&!y)return c(e,t,v);if(!i){var C=y&&E.call(e,"__wrapped__"),w=_&&E.call(t,"__wrapped__");if(C||w)return n(C?e.value():e,w?t.value():t,r,i,o,a)}if(!b)return!1;o||(o=[]),a||(a=[]);for(var P=o.length;P--;)if(o[P]==e)return a[P]==t;o.push(e),a.push(t);var x=(l?s:u)(e,t,n,r,i,o,a);return o.pop(),a.pop(),x}function s(e,t,n,r,o,a,s){var c=-1,u=e.length,l=t.length;if(u!=l&&!(o&&l>u))return!1;for(;++c<u;){var d=e[c],p=t[c],f=r?r(o?p:d,o?d:p,c):void 0;if(void 0!==f){if(f)continue;return!1}if(o){if(!i(t,function(e){return d===e||n(d,e,r,o,a,s)}))return!1}else if(d!==p&&!n(d,p,r,o,a,s))return!1}return!0}function c(e,t,n){switch(n){case v:case g:return+e==+t;case y:return e.name==t.name&&e.message==t.message;case _:return e!=+e?t!=+t:e==+t;case b:case C:return e==t+""}return!1}function u(e,t,n,r,i,o,a){var s=f(e),c=s.length,u=f(t),l=u.length;if(c!=l&&!i)return!1;for(var d=c;d--;){var p=s[d];if(!(i?p in t:E.call(t,p)))return!1}for(var h=i;++d<c;){p=s[d];var m=e[p],v=t[p],g=r?r(i?v:m,i?m:v,p):void 0;if(!(void 0===g?n(m,v,r,i,o,a):g))return!1;h||(h="constructor"==p)}if(!h){var y=e.constructor,_=t.constructor;if(y!=_&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _))return!1}return!0}function l(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var d=e("lodash.isarray"),p=e("lodash.istypedarray"),f=e("lodash.keys"),h="[object Arguments]",m="[object Array]",v="[object Boolean]",g="[object Date]",y="[object Error]",_="[object Number]",S="[object Object]",b="[object RegExp]",C="[object String]",w=Object.prototype,E=w.hasOwnProperty,R=w.toString;t.exports=o},{"lodash.isarray":168,"lodash.istypedarray":169,"lodash.keys":170}],156:[function(e,t,n){function r(e,t){var n=-1,r=i,c=e.length,u=!0,l=u&&c>=s,d=l?a():null,p=[];d?(r=o,u=!1):(l=!1,d=t?[]:p);e:for(;++n<c;){var f=e[n],h=t?t(f,n,e):f;if(u&&f===f){for(var m=d.length;m--;)if(d[m]===h)continue e;t&&d.push(h),p.push(f)}else r(d,h,0)<0&&((t||l)&&d.push(h),p.push(f))}return p}var i=e("lodash._baseindexof"),o=e("lodash._cacheindexof"),a=e("lodash._createcache"),s=200;t.exports=r},{"lodash._baseindexof":154,"lodash._cacheindexof":158,"lodash._createcache":160}],157:[function(e,t,n){function r(e,t,n){if("function"!=typeof e)return i;if(void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,o){return e.call(t,n,r,i,o)};case 5:return function(n,r,i,o,a){return e.call(t,n,r,i,o,a)}}return function(){return e.apply(t,arguments)}}function i(e){return e}t.exports=r},{}],158:[function(e,t,n){function r(e,t){var n=e.data,r="string"==typeof t||i(t)?n.set.has(t):n.hash[t];return r?0:-1}function i(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}t.exports=r},{}],159:[function(e,t,n){function r(e){return a(function(t,n){var r=-1,a=null==t?0:n.length,s=a>2?n[a-2]:void 0,c=a>2?n[2]:void 0,u=a>1?n[a-1]:void 0;for("function"==typeof s?(s=i(s,u,5),a-=2):(s="function"==typeof u?u:void 0,a-=s?1:0),c&&o(n[0],n[1],c)&&(s=3>a?void 0:s,a=1);++r<a;){var l=n[r];l&&e(t,l,s)}return t})}var i=e("lodash._bindcallback"),o=e("lodash._isiterateecall"),a=e("lodash.restparam");t.exports=r},{"lodash._bindcallback":157,"lodash._isiterateecall":162,"lodash.restparam":172}],160:[function(e,t,n){(function(n){function r(e){var t=e?e.length:0;for(this.data={hash:u(null),set:new c};t--;)this.push(e[t])}function i(e){var t=this.data;"string"==typeof e||a(e)?t.set.add(e):t.hash[e]=!0}function o(e){return u&&c?new r(e):null}function a(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var s=e("lodash._getnative"),c=s(n,"Set"),u=s(Object,"create");r.prototype.push=i,t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._getnative":161}],161:[function(e,t,n){function r(e){return!!e&&"object"==typeof e}function i(e,t){var n=null==e?void 0:e[t];return s(n)?n:void 0}function o(e){return a(e)&&f.call(e)==c}function a(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function s(e){return null==e?!1:o(e)?h.test(d.call(e)):r(e)&&u.test(e)}var c="[object Function]",u=/^\[object .+?Constructor\]$/,l=Object.prototype,d=Function.prototype.toString,p=l.hasOwnProperty,f=l.toString,h=RegExp("^"+d.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=i},{}],162:[function(e,t,n){function r(e){return function(t){return null==t?void 0:t[e]}}function i(e){return null!=e&&s(d(e))}function o(e,t){return e="number"==typeof e||u.test(e)?+e:-1,t=null==t?l:t,e>-1&&e%1==0&&t>e}function a(e,t,n){if(!c(n))return!1;var r=typeof t;if("number"==r?i(n)&&o(t,n.length):"string"==r&&t in n){var a=n[t];return e===e?e===a:a!==a}return!1}function s(e){return"number"==typeof e&&e>-1&&e%1==0&&l>=e}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var u=/^\d+$/,l=9007199254740991,d=r("length");t.exports=a},{}],163:[function(e,t,n){function r(e,t,n){for(var r=-1,i=a(t),o=i.length;++r<o;){var s=i[r],c=e[s],u=n(c,t[s],s,e,t);(u===u?u===c:c!==c)&&(void 0!==c||s in e)||(e[s]=u)}return e}var i=e("lodash._baseassign"),o=e("lodash._createassigner"),a=e("lodash.keys"),s=o(function(e,t,n){return n?r(e,t,n):i(e,t)});t.exports=s},{"lodash._baseassign":149,"lodash._createassigner":159,"lodash.keys":170}],164:[function(e,t,n){(function(e){function r(e,t){return e.set(t[0],t[1]),e}function i(e,t){return e.add(t),e}function o(e,t){for(var n=-1,r=e?e.length:0;++n<r&&t(e[n],n,e)!==!1;);return e}function a(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function s(e,t,n,r){var i=-1,o=e?e.length:0;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function c(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function u(e,t){return null==e?void 0:e[t]}function l(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}function d(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function p(e,t){return function(n){return e(t(n))}}function f(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function h(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function m(){this.__data__=Ut?Ut(null):{}}function v(e){return this.has(e)&&delete this.__data__[e]}function g(e){var t=this.__data__;if(Ut){var n=t[e];return n===Le?void 0:n}return bt.call(t,e)?t[e]:void 0}function y(e){var t=this.__data__;return Ut?void 0!==t[e]:bt.call(t,e)}function _(e,t){var n=this.__data__;return n[e]=Ut&&void 0===t?Le:t,this}function S(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function b(){this.__data__=[]}function C(e){var t=this.__data__,n=B(t,e);if(0>n)return!1;var r=t.length-1;return n==r?t.pop():Ot.call(t,n,1),!0}function w(e){var t=this.__data__,n=B(t,e);return 0>n?void 0:t[n][1]}function E(e){return B(this.__data__,e)>-1}function R(e,t){var n=this.__data__,r=B(n,e);return 0>r?n.push([e,t]):n[r][1]=t,this}function P(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function x(){this.__data__={hash:new h,map:new(kt||S),string:new h}}function T(e){return ae(this,e)["delete"](e)}function L(e){return ae(this,e).get(e)}function O(e){return ae(this,e).has(e)}function I(e,t){return ae(this,e).set(e,t),this}function M(e){this.__data__=new S(e)}function A(){this.__data__=new S}function D(e){return this.__data__["delete"](e)}function k(e){return this.__data__.get(e)}function j(e){return this.__data__.has(e)}function N(e,t){var n=this.__data__;if(n instanceof S){var r=n.__data__;if(!kt||r.length<Te-1)return r.push([e,t]),this;n=this.__data__=new P(r)}return n.set(e,t),this}function V(e,t){var n=Yt(e)||ye(e)?c(e.length,String):[],r=n.length,i=!!r;for(var o in e)!t&&!bt.call(e,o)||i&&("length"==o||de(o,r))||n.push(o);return n}function U(e,t,n){var r=e[t];bt.call(e,t)&&ge(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function B(e,t){for(var n=e.length;n--;)if(ge(e[n][0],t))return n;return-1}function F(e,t){return e&&re(t,Re(t),e)}function G(e,t,n,r,i,a,s){var c;if(r&&(c=a?r(e,i,a,s):r(e)),void 0!==c)return c;if(!we(e))return e;var u=Yt(e);if(u){if(c=ce(e),!t)return ne(e,c)}else{var d=Xt(e),p=d==je||d==Ne;if($t(e))return X(e,t);if(d==Be||d==Ie||p&&!a){if(l(e))return a?e:{};if(c=ue(p?{}:e),!t)return ie(e,F(c,e))}else{if(!ct[d])return a?e:{};c=le(e,d,G,t)}}s||(s=new M);var f=s.get(e);if(f)return f;if(s.set(e,c),!u)var h=n?oe(e):Re(e);return o(h||e,function(i,o){h&&(o=i,i=e[o]),U(c,o,G(i,t,n,r,o,e,s))}),c}function q(e){return we(e)?Tt(e):{}}function J(e,t,n){var r=t(e);return Yt(e)?r:a(r,n(e))}function W(e){return Ct.call(e)}function z(e){if(!we(e)||fe(e))return!1;var t=be(e)||l(e)?wt:at;return t.test(me(e))}function H(e){if(!he(e))return At(e);var t=[];for(var n in Object(e))bt.call(e,n)&&"constructor"!=n&&t.push(n);return t}function X(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}function Y(e){var t=new e.constructor(e.byteLength);return new Pt(t).set(new Pt(e)),t}function $(e,t){var n=t?Y(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Q(e,t,n){var i=t?n(d(e),!0):d(e);return s(i,r,new e.constructor)}function K(e){var t=new e.constructor(e.source,ot.exec(e));return t.lastIndex=e.lastIndex,t}function Z(e,t,n){var r=t?n(f(e),!0):f(e);return s(r,i,new e.constructor)}function ee(e){return zt?Object(zt.call(e)):{}}function te(e,t){var n=t?Y(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ne(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function re(e,t,n,r){n||(n={});for(var i=-1,o=t.length;++i<o;){var a=t[i],s=r?r(n[a],e[a],a,n,e):void 0;U(n,a,void 0===s?e[a]:s)}return n}function ie(e,t){return re(e,Ht(e),t)}function oe(e){return J(e,Re,Ht)}function ae(e,t){var n=e.__data__;return pe(t)?n["string"==typeof t?"string":"hash"]:n.map}function se(e,t){var n=u(e,t);return z(n)?n:void 0}function ce(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&bt.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function ue(e){return"function"!=typeof e.constructor||he(e)?{}:q(xt(e))}function le(e,t,n,r){var i=e.constructor;switch(t){case He:return Y(e);case Ae:case De:return new i(+e);case Xe:return $(e,r);case Ye:case $e:case Qe:case Ke:case Ze:case et:case tt:case nt:case rt:return te(e,r);case Ve:return Q(e,r,n);case Ue:case Je:return new i(e);case Ge:return K(e);case qe:return Z(e,r,n);case We:return ee(e)}}function de(e,t){return t=null==t?Oe:t,!!t&&("number"==typeof e||st.test(e))&&e>-1&&e%1==0&&t>e}function pe(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function fe(e){return!!_t&&_t in e}function he(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||gt;return e===n}function me(e){if(null!=e){try{return St.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function ve(e){return G(e,!0,!0)}function ge(e,t){return e===t||e!==e&&t!==t}function ye(e){return Se(e)&&bt.call(e,"callee")&&(!Lt.call(e,"callee")||Ct.call(e)==Ie)}function _e(e){return null!=e&&Ce(e.length)&&!be(e)}function Se(e){return Ee(e)&&_e(e)}function be(e){var t=we(e)?Ct.call(e):"";return t==je||t==Ne}function Ce(e){return"number"==typeof e&&e>-1&&e%1==0&&Oe>=e}function we(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Ee(e){return!!e&&"object"==typeof e}function Re(e){return _e(e)?V(e):H(e)}function Pe(){return[]}function xe(){return!1}var Te=200,Le="__lodash_hash_undefined__",Oe=9007199254740991,Ie="[object Arguments]",Me="[object Array]",Ae="[object Boolean]",De="[object Date]",ke="[object Error]",je="[object Function]",Ne="[object GeneratorFunction]",Ve="[object Map]",Ue="[object Number]",Be="[object Object]",Fe="[object Promise]",Ge="[object RegExp]",qe="[object Set]",Je="[object String]",We="[object Symbol]",ze="[object WeakMap]",He="[object ArrayBuffer]",Xe="[object DataView]",Ye="[object Float32Array]",$e="[object Float64Array]",Qe="[object Int8Array]",Ke="[object Int16Array]",Ze="[object Int32Array]",et="[object Uint8Array]",tt="[object Uint8ClampedArray]",nt="[object Uint16Array]",rt="[object Uint32Array]",it=/[\\^$.*+?()[\]{}|]/g,ot=/\w*$/,at=/^\[object .+?Constructor\]$/,st=/^(?:0|[1-9]\d*)$/,ct={};ct[Ie]=ct[Me]=ct[He]=ct[Xe]=ct[Ae]=ct[De]=ct[Ye]=ct[$e]=ct[Qe]=ct[Ke]=ct[Ze]=ct[Ve]=ct[Ue]=ct[Be]=ct[Ge]=ct[qe]=ct[Je]=ct[We]=ct[et]=ct[tt]=ct[nt]=ct[rt]=!0,ct[ke]=ct[je]=ct[ze]=!1;var ut="object"==typeof e&&e&&e.Object===Object&&e,lt="object"==typeof self&&self&&self.Object===Object&&self,dt=ut||lt||Function("return this")(),pt="object"==typeof n&&n&&!n.nodeType&&n,ft=pt&&"object"==typeof t&&t&&!t.nodeType&&t,ht=ft&&ft.exports===pt,mt=Array.prototype,vt=Function.prototype,gt=Object.prototype,yt=dt["__core-js_shared__"],_t=function(){var e=/[^.]+$/.exec(yt&&yt.keys&&yt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),St=vt.toString,bt=gt.hasOwnProperty,Ct=gt.toString,wt=RegExp("^"+St.call(bt).replace(it,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Et=ht?dt.Buffer:void 0,Rt=dt.Symbol,Pt=dt.Uint8Array,xt=p(Object.getPrototypeOf,Object),Tt=Object.create,Lt=gt.propertyIsEnumerable,Ot=mt.splice,It=Object.getOwnPropertySymbols,Mt=Et?Et.isBuffer:void 0,At=p(Object.keys,Object),Dt=se(dt,"DataView"),kt=se(dt,"Map"),jt=se(dt,"Promise"),Nt=se(dt,"Set"),Vt=se(dt,"WeakMap"),Ut=se(Object,"create"),Bt=me(Dt),Ft=me(kt),Gt=me(jt),qt=me(Nt),Jt=me(Vt),Wt=Rt?Rt.prototype:void 0,zt=Wt?Wt.valueOf:void 0;h.prototype.clear=m,h.prototype["delete"]=v,h.prototype.get=g,h.prototype.has=y,h.prototype.set=_,S.prototype.clear=b,S.prototype["delete"]=C,S.prototype.get=w,S.prototype.has=E,S.prototype.set=R,P.prototype.clear=x,P.prototype["delete"]=T,P.prototype.get=L,P.prototype.has=O,P.prototype.set=I,M.prototype.clear=A,M.prototype["delete"]=D,M.prototype.get=k,M.prototype.has=j,M.prototype.set=N;var Ht=It?p(It,Object):Pe,Xt=W;(Dt&&Xt(new Dt(new ArrayBuffer(1)))!=Xe||kt&&Xt(new kt)!=Ve||jt&&Xt(jt.resolve())!=Fe||Nt&&Xt(new Nt)!=qe||Vt&&Xt(new Vt)!=ze)&&(Xt=function(e){var t=Ct.call(e),n=t==Be?e.constructor:void 0,r=n?me(n):void 0;if(r)switch(r){case Bt:return Xe;case Ft:return Ve;case Gt:return Fe;case qt:return qe;case Jt:return ze}return t});var Yt=Array.isArray,$t=Mt||xe;t.exports=ve}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],165:[function(e,t,n){function r(e,t,n){var r=s(e)?i:a;return t=o(t,n,3),r(e,t)}var i=e("lodash._arrayfilter"),o=e("lodash._basecallback"),a=e("lodash._basefilter"),s=e("lodash.isarray");t.exports=r},{"lodash._arrayfilter":148,"lodash._basecallback":150,"lodash._basefilter":153,"lodash.isarray":168}],166:[function(e,t,n){function r(e,t){return function(n,r,i){return"function"==typeof r&&void 0===i&&s(n)?e(n,r):t(n,a(r,i,3))}}var i=e("lodash._arrayeach"),o=e("lodash._baseeach"),a=e("lodash._bindcallback"),s=e("lodash.isarray"),c=r(i,o);t.exports=c},{"lodash._arrayeach":147,"lodash._baseeach":152,"lodash._bindcallback":157,"lodash.isarray":168}],167:[function(e,t,n){function r(e){return o(e)&&m.call(e,"callee")&&(!g.call(e,"callee")||v.call(e)==d)}function i(e){return null!=e&&s(e.length)&&!a(e)}function o(e){return u(e)&&i(e)}function a(e){var t=c(e)?v.call(e):"";return t==p||t==f}function s(e){return"number"==typeof e&&e>-1&&e%1==0&&l>=e}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function u(e){return!!e&&"object"==typeof e}var l=9007199254740991,d="[object Arguments]",p="[object Function]",f="[object GeneratorFunction]",h=Object.prototype,m=h.hasOwnProperty,v=h.toString,g=h.propertyIsEnumerable;t.exports=r},{}],168:[function(e,t,n){function r(e){return!!e&&"object"==typeof e}function i(e,t){var n=null==e?void 0:e[t];return c(n)?n:void 0}function o(e){return"number"==typeof e&&e>-1&&e%1==0&&y>=e}function a(e){return s(e)&&m.call(e)==l}function s(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function c(e){return null==e?!1:a(e)?v.test(f.call(e)):r(e)&&d.test(e)}var u="[object Array]",l="[object Function]",d=/^\[object .+?Constructor\]$/,p=Object.prototype,f=Function.prototype.toString,h=p.hasOwnProperty,m=p.toString,v=RegExp("^"+f.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),g=i(Array,"isArray"),y=9007199254740991,_=g||function(e){return r(e)&&o(e.length)&&m.call(e)==u};t.exports=_},{}],169:[function(e,t,n){function r(e){return"number"==typeof e&&e>-1&&e%1==0&&a>=e}function i(e){return!!e&&"object"==typeof e}function o(e){return i(e)&&r(e.length)&&!!I[A.call(e)]}var a=9007199254740991,s="[object Arguments]",c="[object Array]",u="[object Boolean]",l="[object Date]",d="[object Error]",p="[object Function]",f="[object Map]",h="[object Number]",m="[object Object]",v="[object RegExp]",g="[object Set]",y="[object String]",_="[object WeakMap]",S="[object ArrayBuffer]",b="[object DataView]",C="[object Float32Array]",w="[object Float64Array]",E="[object Int8Array]",R="[object Int16Array]",P="[object Int32Array]",x="[object Uint8Array]",T="[object Uint8ClampedArray]",L="[object Uint16Array]",O="[object Uint32Array]",I={};I[C]=I[w]=I[E]=I[R]=I[P]=I[x]=I[T]=I[L]=I[O]=!0,I[s]=I[c]=I[S]=I[u]=I[b]=I[l]=I[d]=I[p]=I[f]=I[h]=I[m]=I[v]=I[g]=I[y]=I[_]=!1;var M=Object.prototype,A=M.toString;t.exports=o},{}],170:[function(e,t,n){function r(e){return function(t){return null==t?void 0:t[e]}}function i(e){return null!=e&&a(y(e))}function o(e,t){return e="number"==typeof e||f.test(e)?+e:-1,t=null==t?g:t,e>-1&&e%1==0&&t>e}function a(e){return"number"==typeof e&&e>-1&&e%1==0&&g>=e}function s(e){for(var t=u(e),n=t.length,r=n&&e.length,i=!!r&&a(r)&&(p(e)||d(e)),s=-1,c=[];++s<n;){var l=t[s];(i&&o(l,r)||m.call(e,l))&&c.push(l)}return c}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function u(e){if(null==e)return[];c(e)||(e=Object(e));var t=e.length;t=t&&a(t)&&(p(e)||d(e))&&t||0;for(var n=e.constructor,r=-1,i="function"==typeof n&&n.prototype===e,s=Array(t),u=t>0;++r<t;)s[r]=r+"";for(var l in e)u&&o(l,t)||"constructor"==l&&(i||!m.call(e,l))||s.push(l);return s}var l=e("lodash._getnative"),d=e("lodash.isarguments"),p=e("lodash.isarray"),f=/^\d+$/,h=Object.prototype,m=h.hasOwnProperty,v=l(Object,"keys"),g=9007199254740991,y=r("length"),_=v?function(e){var t=null==e?void 0:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&i(e)?s(e):c(e)?v(e):[]}:s;t.exports=_},{"lodash._getnative":161,"lodash.isarguments":167,"lodash.isarray":168}],171:[function(e,t,n){function r(e){return i(e)?e:Object(e)}function i(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function o(e){e=r(e);for(var t=-1,n=a(e),i=n.length,o=Array(i);++t<i;){var s=n[t];o[t]=[s,e[s]]}return o}var a=e("lodash.keys");t.exports=o},{"lodash.keys":170}],172:[function(e,t,n){function r(e,t){if("function"!=typeof e)throw new TypeError(i);return t=o(void 0===t?e.length-1:+t||0,0),function(){for(var n=arguments,r=-1,i=o(n.length-t,0),a=Array(i);++r<i;)a[r]=n[t+r];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,n[0],a);case 2:return e.call(this,n[0],n[1],a)}var s=Array(t+1);for(r=-1;++r<t;)s[r]=n[r];return s[t]=a,e.apply(this,s)}}var i="Expected a function",o=Math.max;t.exports=r},{}],173:[function(e,t,n){function r(e,t){for(var n,r=-1,i=e.length,o=-1,a=[];++r<i;){var s=e[r],c=t?t(s,r,e):s;r&&n===c||(n=c,a[++o]=s)}return a}function i(e,t,n,i){var c=e?e.length:0;return c?(null!=t&&"boolean"!=typeof t&&(i=n,n=s(e,t,i)?void 0:t,t=!1),n=null==n?n:o(n,i,3),t?r(e,n):a(e,n)):[]}var o=e("lodash._basecallback"),a=e("lodash._baseuniq"),s=e("lodash._isiterateecall");t.exports=i},{"lodash._basecallback":150,"lodash._baseuniq":156,"lodash._isiterateecall":162}],174:[function(e,t,n){"use strict";var r=e("./lib/parse"),i=e("./lib/Parser"),o=e("./lib/escape"),a=e("./lib/Element"),s=e("./lib/equal"),c=e("./lib/createElement"),u=e("./lib/tag"),l=e("./lib/tagString"),d=e("./lib/is"),p=e("./lib/clone"),f=e("./lib/stringify");n=t.exports=function(){return u.apply(null,arguments)},n.Element=a,n.equal=s.equal,n.nameEqual=s.name,n.attrsEqual=s.attrs,n.childrenEqual=s.children,n.isNode=d.isNode,n.isElement=d.isElement,n.isText=d.isText,n.clone=p,n.createElement=c,n.escapeXML=o.escapeXML,n.unescapeXML=o.unescapeXML,n.escapeXMLText=o.escapeXMLText,n.unescapeXMLText=o.unescapeXMLText,n.Parser=i,n.parse=r,n.tag=u,n.tagString=l,n.stringify=f},{"./lib/Element":176,"./lib/Parser":177,"./lib/clone":178,"./lib/createElement":179,"./lib/equal":180,"./lib/escape":181,"./lib/is":182,"./lib/parse":183,"./lib/stringify":185,"./lib/tag":186,"./lib/tagString":187}],175:[function(e,t,n){"use strict";function r(e,t){o.call(this,e,t),this.nodeType=1,this.nodeName=this.localName}var i=e("inherits"),o=e("./Element");i(r,o),r.prototype._getElement=function(e,t){var n=new r(e,t);return n},Object.defineProperty(r.prototype,"localName",{get:function(){return this.getName()}}),Object.defineProperty(r.prototype,"namespaceURI",{get:function(){return this.getNS()}}),Object.defineProperty(r.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(r.prototype,"childNodes",{get:function(){return this.children}}),Object.defineProperty(r.prototype,"textContent",{get:function(){return this.getText()},set:function(e){this.children.push(e)}}),r.prototype.getElementsByTagName=function(e){return this.getChildren(e)},r.prototype.getAttribute=function(e){return this.getAttr(e)},r.prototype.setAttribute=function(e,t){this.attr(e,t)},r.prototype.getAttributeNS=function(e,t){return"http://www.w3.org/XML/1998/namespace"===e?this.getAttr(["xml",t].join(":")):this.getAttr(t,e)},r.prototype.setAttributeNS=function(e,t,n){var r;if("http://www.w3.org/XML/1998/namespace"===e)r="xml";else{var i=this.getXmlns();r=i[e]||""}r&&this.attr([r,t].join(":"),n)},r.prototype.removeAttribute=function(e){this.attr(e,null)},r.prototype.removeAttributeNS=function(e,t){var n;if("http://www.w3.org/XML/1998/namespace"===e)n="xml";else{var r=this.getXmlns();n=r[e]||""}n&&this.attr([n,t].join(":"),null)},r.prototype.appendChild=function(e){this.cnode(e)},r.prototype.removeChild=function(e){this.remove(e)},r.createElement=function(e,t){var n=new r(e,t),i=Array.prototype.slice.call(arguments,2);return i.forEach(function(e){n.appendChild(e)}),n},t.exports=r},{"./Element":176,inherits:46}],176:[function(e,t,n){"use strict";function r(e,t){this.name=e,this.parent=null,this.children=[],this.attrs={},this.setAttrs(t)}var i=e("./escape"),o=i.escapeXML,a=i.escapeXMLText,s=e("./equal"),c=s.equal,u=s.name,l=s.attrs,d=s.children,p=e("./clone");r.prototype.is=function(e,t){return this.getName()===e&&(!t||this.getNS()===t)},r.prototype.getName=function(){return this.name.indexOf(":")>=0?this.name.substr(this.name.indexOf(":")+1):this.name},r.prototype.getNS=function(){if(this.name.indexOf(":")>=0){var e=this.name.substr(0,this.name.indexOf(":"));return this.findNS(e)}return this.findNS()},r.prototype.findNS=function(e){if(e){var t="xmlns:"+e;if(this.attrs[t])return this.attrs[t];if(this.parent)return this.parent.findNS(e)}else{if(this.attrs.xmlns)return this.attrs.xmlns;if(this.parent)return this.parent.findNS()}},r.prototype.getXmlns=function(){var e={};this.parent&&(e=this.parent.getXmlns());for(var t in this.attrs){var n=t.match("xmlns:?(.*)");this.attrs.hasOwnProperty(t)&&n&&(e[this.attrs[t]]=n[1])}return e},r.prototype.setAttrs=function(e){"string"==typeof e?this.attrs.xmlns=e:e&&Object.keys(e).forEach(function(t){this.attrs[t]=e[t]},this)},r.prototype.getAttr=function(e,t){if(!t)return this.attrs[e];var n=this.getXmlns();return n[t]?this.attrs[[n[t],e].join(":")]:null},r.prototype.getChild=function(e,t){return this.getChildren(e,t)[0]},r.prototype.getChildren=function(e,t){for(var n=[],r=0;r<this.children.length;r++){var i=this.children[r];!i.getName||i.getName()!==e||t&&i.getNS()!==t||n.push(i)}return n},r.prototype.getChildByAttr=function(e,t,n,r){return this.getChildrenByAttr(e,t,n,r)[0]},r.prototype.getChildrenByAttr=function(e,t,n,r){for(var i=[],o=0;o<this.children.length;o++){var a=this.children[o];!a.attrs||a.attrs[e]!==t||n&&a.getNS()!==n||i.push(a),r&&a.getChildrenByAttr&&i.push(a.getChildrenByAttr(e,t,n,!0))}return r&&(i=[].concat.apply([],i)),i},r.prototype.getChildrenByFilter=function(e,t){for(var n=[],r=0;r<this.children.length;r++){var i=this.children[r];e(i)&&n.push(i),t&&i.getChildrenByFilter&&n.push(i.getChildrenByFilter(e,!0))}return t&&(n=[].concat.apply([],n)),n},r.prototype.getText=function(){for(var e="",t=0;t<this.children.length;t++){var n=this.children[t];("string"==typeof n||"number"==typeof n)&&(e+=n)}return e},r.prototype.getChildText=function(e,t){var n=this.getChild(e,t);return n?n.getText():null},r.prototype.getChildElements=function(){return this.getChildrenByFilter(function(e){return e instanceof r})},r.prototype.root=function(){return this.parent?this.parent.root():this},r.prototype.tree=r.prototype.root,r.prototype.up=function(){return this.parent?this.parent:this},r.prototype.c=function(e,t){return this.cnode(new r(e,t))},r.prototype.cnode=function(e){return this.children.push(e),"object"==typeof e&&(e.parent=this),e},r.prototype.t=function(e){return this.children.push(e),this},r.prototype.remove=function(e,t){var n;return n="string"==typeof e?function(n){return!(n.is&&n.is(e,t))}:function(t){return t!==e},this.children=this.children.filter(n),this},r.prototype.clone=function(){return p(this)},r.prototype.text=function(e){return e&&1===this.children.length?(this.children[0]=e,this):this.getText()},r.prototype.attr=function(e,t){return"undefined"!=typeof t||null===t?(this.attrs||(this.attrs={}),this.attrs[e]=t,this):this.attrs[e]},r.prototype.toString=function(){var e="";return this.write(function(t){e+=t}),e},r.prototype.toJSON=function(){return{name:this.name,attrs:this.attrs,children:this.children.map(function(e){return e&&e.toJSON?e.toJSON():e})}},r.prototype._addChildren=function(e){e(">");for(var t=0;t<this.children.length;t++){var n=this.children[t];(n||0===n)&&(n.write?n.write(e):"string"==typeof n?e(a(n)):n.toString&&e(a(n.toString(10))))}e("</"),e(this.name),e(">")},r.prototype.write=function(e){e("<"),e(this.name);for(var t in this.attrs){var n=this.attrs[t];null!=n&&(e(" "),e(t),e('="'),"string"!=typeof n&&(n=n.toString()),e(o(n)),e('"'))}0===this.children.length?e("/>"):this._addChildren(e)},r.prototype.nameEquals=function(e){return u(this,e)},r.prototype.attrsEquals=function(e){return l(this,e)},r.prototype.childrenEquals=function(e){return d(this,e)},r.prototype.equals=function(e){return c(this,e)},t.exports=r},{"./clone":178,"./equal":180,"./escape":181}],177:[function(e,t,n){"use strict";var r=e("events").EventEmitter,i=e("inherits"),o=e("./Element"),a=e("./parsers/ltx"),s=function(e){r.call(this);var t=this.Parser=e&&e.Parser||this.DefaultParser,n=this.Element=e&&e.Element||this.DefaultElement;this.parser=new t;var i,o=this;this.parser.on("startElement",function(e,t){var r=new n(e,t);i=i?i.cnode(r):r}),this.parser.on("endElement",function(e){i&&e===i.name&&(i.parent?i=i.parent:o.tree||(o.tree=i,i=void 0))}),this.parser.on("text",function(e){i&&i.t(e)}),this.parser.on("error",function(e){o.error=e,o.emit("error",e)})};i(s,r),s.prototype.DefaultParser=a,s.prototype.DefaultElement=o,s.prototype.write=function(e){this.parser.write(e)},s.prototype.end=function(e){this.parser.end(e),this.error||(this.tree?this.emit("tree",this.tree):this.emit("error",new Error("Incomplete document")))},t.exports=s},{"./Element":176,"./parsers/ltx":184,events:32,inherits:46}],178:[function(e,t,n){"use strict";t.exports=function r(e){for(var r=new e.constructor(e.name,e.attrs),t=0;t<e.children.length;t++){var n=e.children[t];r.cnode(n.clone?n.clone():n)}return r}},{}],179:[function(e,t,n){"use strict";var r=e("./Element");t.exports=function(e,t){for(var n=new r(e,t),i=2;i<arguments.length;i++){var o=arguments[i];o&&n.cnode(o)}return n}},{"./Element":176}],180:[function(e,t,n){"use strict";function r(e,t){return e.name===t.name}function i(e,t){var n=e.attrs,r=Object.keys(n),i=r.length;if(i!==Object.keys(t.attrs).length)return!1;for(var o=0,a=i;a>o;o++){var s=r[o],c=n[s];if(null==c||null==t.attrs[s]){if(c!==t.attrs[s])return!1}else if(c.toString()!==t.attrs[s].toString())return!1}return!0}function o(e,t){var n=e.children,r=n.length;if(r!==t.children.length)return!1;for(var i=0,o=r;o>i;i++){var a=n[i];if("string"==typeof a){if(a!==t.children[i])return!1}else if(!a.equals(t.children[i]))return!1}return!0}function a(e,t){return r(e,t)&&i(e,t)&&o(e,t)?!0:!1}t.exports.name=r,t.exports.attrs=i,t.exports.children=o,t.exports.equal=a},{}],181:[function(e,t,n){"use strict";function r(e){return o[e]}function i(e){return a[e]}var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},a={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&quot;":'"',"&#34;":'"',"&apos;":"'","&#39;":"'"};n.escapeXML=function(e){return e.replace(/&|<|>|"|'/g,r)},n.unescapeXML=function(e){return e.replace(/&(amp|#38|lt|#60|gt|#62|quot|#34|apos|#39);/g,i)},n.escapeXMLText=function(e){return e.replace(/&|<|>/g,r)},n.unescapeXMLText=function(e){return e.replace(/&(amp|#38|lt|#60|gt|#62);/g,i)}},{}],182:[function(e,t,n){"use strict";var r=e("./Element");t.exports.isNode=function(e){return e instanceof r||"string"==typeof e},t.exports.isElement=function(e){return e instanceof r},t.exports.isText=function(e){return"string"==typeof e}},{"./Element":176}],183:[function(e,t,n){"use strict";var r=e("./Parser");t.exports=function(e,t){var n;n="function"==typeof t?new t:new r(t);var i=null,o=null;if(n.on("tree",function(e){i=e}),n.on("error",function(e){o=e}),n.write(e),n.end(),o)throw o;return i}},{"./Parser":177}],184:[function(e,t,n){"use strict";var r=e("inherits"),i=e("events").EventEmitter,o=e("../escape").unescapeXML,a=0,s=1,c=2,u=3,l=4,d=5,p=6,f=7,h=8,m=9,v=t.exports=function(){i.call(this);var e,t,n,r,v,g,y,_=a,S=0;this._handleTagOpening=function(e,t,n){e?this.emit("endElement",t):(this.emit("startElement",t,n),v&&this.emit("endElement",t))},this.write=function(i){function b(){if("number"==typeof S){var e=i.slice(S,C);return S=void 0,e}}"string"!=typeof i&&(i=i.toString());var C=0;for(e&&(i=e+i,C+=e.length,e=null);C<i.length;C++){var w=i.charCodeAt(C);switch(_){case a:if(60===w){var E=b();E&&this.emit("text",o(E)),_=u,S=C+1,n={}}break;case m:if(93===w&&"]>"===i.substr(C+1,2)){var R=b();R&&this.emit("text",R),
_=s}break;case u:47===w&&S===C?(S=C+1,r=!0):33===w?"[CDATA["===i.substr(C+1,7)?(S=C+8,_=m):(S=void 0,_=s):63===w?(S=void 0,_=c):(32>=w||47===w||62===w)&&(t=b(),C--,_=l);break;case s:if(62===w){var P=i.charCodeAt(C-1),x=i.charCodeAt(C-2);(45===P&&45===x||93===P&&93===x)&&(_=a)}break;case c:if(62===w){var T=i.charCodeAt(C-1);63===T&&(_=a)}break;case l:62===w?(this._handleTagOpening(r,t,n),t=void 0,n=void 0,r=void 0,v=void 0,_=a,S=C+1):47===w?v=!0:w>32&&(S=C,_=d);break;case d:(32>=w||61===w)&&(y=b(),C--,_=p);break;case p:61===w&&(_=f);break;case f:(34===w||39===w)&&(g=w,_=h,S=C+1);break;case h:if(w===g){var L=o(b());n[y]=L,y=void 0,_=l}}}"number"==typeof S&&S<=i.length&&(e=i.slice(S),S=0)}};r(v,i),v.prototype.end=function(e){e&&this.write(e),this.write=function(){}}},{"../escape":181,events:32,inherits:46}],185:[function(e,t,n){"use strict";function r(e,t,n){"number"==typeof t&&(t=" ".repeat(t)),n||(n=1);var i="";return i+="<"+e.name,Object.keys(e.attrs).forEach(function(t){i+=" "+t+'="'+e.attrs[t]+'"'}),e.children.length?(i+=">",e.children.forEach(function(e,o){t&&(i+="\n"+t.repeat(n)),i+="string"==typeof e?e:r(e,t,n+1)}),t&&(i+="\n"+t.repeat(n-1)),i+="</"+e.name+">"):i+="/>",i}t.exports=r},{}],186:[function(e,t,n){"use strict";var r=e("./tagString"),i=e("./parse");t.exports=function(){return i(r.apply(null,arguments))}},{"./parse":183,"./tagString":187}],187:[function(e,t,n){"use strict";var r=e("./escape").escapeXML;t.exports=function(){for(var e=arguments[0],t="",n=1;n<arguments.length;n++)t+=e[n-1],t+=r(arguments[n]);return t+=e[e.length-1]}},{"./escape":181}],188:[function(e,t,n){(function(n){"use strict";function r(){l.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function i(e,t){return e<<t|e>>>32-t}function o(e,t,n,r,o,a,s){return i(e+(t&n|~t&r)+o+a|0,s)+t|0}function a(e,t,n,r,o,a,s){return i(e+(t&r|n&~r)+o+a|0,s)+t|0}function s(e,t,n,r,o,a,s){return i(e+(t^n^r)+o+a|0,s)+t|0}function c(e,t,n,r,o,a,s){return i(e+(n^(t|~r))+o+a|0,s)+t|0}var u=e("inherits"),l=e("hash-base"),d=new Array(16);u(r,l),r.prototype._update=function(){for(var e=d,t=0;16>t;++t)e[t]=this._block.readInt32LE(4*t);var n=this._a,r=this._b,i=this._c,u=this._d;n=o(n,r,i,u,e[0],3614090360,7),u=o(u,n,r,i,e[1],3905402710,12),i=o(i,u,n,r,e[2],606105819,17),r=o(r,i,u,n,e[3],3250441966,22),n=o(n,r,i,u,e[4],4118548399,7),u=o(u,n,r,i,e[5],1200080426,12),i=o(i,u,n,r,e[6],2821735955,17),r=o(r,i,u,n,e[7],4249261313,22),n=o(n,r,i,u,e[8],1770035416,7),u=o(u,n,r,i,e[9],2336552879,12),i=o(i,u,n,r,e[10],4294925233,17),r=o(r,i,u,n,e[11],2304563134,22),n=o(n,r,i,u,e[12],1804603682,7),u=o(u,n,r,i,e[13],4254626195,12),i=o(i,u,n,r,e[14],2792965006,17),r=o(r,i,u,n,e[15],1236535329,22),n=a(n,r,i,u,e[1],4129170786,5),u=a(u,n,r,i,e[6],3225465664,9),i=a(i,u,n,r,e[11],643717713,14),r=a(r,i,u,n,e[0],3921069994,20),n=a(n,r,i,u,e[5],3593408605,5),u=a(u,n,r,i,e[10],38016083,9),i=a(i,u,n,r,e[15],3634488961,14),r=a(r,i,u,n,e[4],3889429448,20),n=a(n,r,i,u,e[9],568446438,5),u=a(u,n,r,i,e[14],3275163606,9),i=a(i,u,n,r,e[3],4107603335,14),r=a(r,i,u,n,e[8],1163531501,20),n=a(n,r,i,u,e[13],2850285829,5),u=a(u,n,r,i,e[2],4243563512,9),i=a(i,u,n,r,e[7],1735328473,14),r=a(r,i,u,n,e[12],2368359562,20),n=s(n,r,i,u,e[5],4294588738,4),u=s(u,n,r,i,e[8],2272392833,11),i=s(i,u,n,r,e[11],1839030562,16),r=s(r,i,u,n,e[14],4259657740,23),n=s(n,r,i,u,e[1],2763975236,4),u=s(u,n,r,i,e[4],1272893353,11),i=s(i,u,n,r,e[7],4139469664,16),r=s(r,i,u,n,e[10],3200236656,23),n=s(n,r,i,u,e[13],681279174,4),u=s(u,n,r,i,e[0],3936430074,11),i=s(i,u,n,r,e[3],3572445317,16),r=s(r,i,u,n,e[6],76029189,23),n=s(n,r,i,u,e[9],3654602809,4),u=s(u,n,r,i,e[12],3873151461,11),i=s(i,u,n,r,e[15],530742520,16),r=s(r,i,u,n,e[2],3299628645,23),n=c(n,r,i,u,e[0],4096336452,6),u=c(u,n,r,i,e[7],1126891415,10),i=c(i,u,n,r,e[14],2878612391,15),r=c(r,i,u,n,e[5],4237533241,21),n=c(n,r,i,u,e[12],1700485571,6),u=c(u,n,r,i,e[3],2399980690,10),i=c(i,u,n,r,e[10],4293915773,15),r=c(r,i,u,n,e[1],2240044497,21),n=c(n,r,i,u,e[8],1873313359,6),u=c(u,n,r,i,e[15],4264355552,10),i=c(i,u,n,r,e[6],2734768916,15),r=c(r,i,u,n,e[13],1309151649,21),n=c(n,r,i,u,e[4],4149444226,6),u=c(u,n,r,i,e[11],3174756917,10),i=c(i,u,n,r,e[2],718787259,15),r=c(r,i,u,n,e[9],3951481745,21),this._a=this._a+n|0,this._b=this._b+r|0,this._c=this._c+i|0,this._d=this._d+u|0},r.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=new n(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},t.exports=r}).call(this,e("buffer").Buffer)},{buffer:9,"hash-base":39,inherits:46}],189:[function(e,t,n){var r=e("trim"),i=e("for-each"),o=function(e){return"[object Array]"===Object.prototype.toString.call(e)};t.exports=function(e){if(!e)return{};var t={};return i(r(e).split("\n"),function(e){var n=e.indexOf(":"),i=r(e.slice(0,n)).toLowerCase(),a=r(e.slice(n+1));"undefined"==typeof t[i]?t[i]=a:o(t[i])?t[i].push(a):t[i]=[t[i],a]}),t}},{"for-each":37,trim:305}],190:[function(e,t,n){(function(e){"use strict";function n(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick(function(){t.apply(null,o)})}}t.exports=!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?{nextTick:n}:e}).call(this,e("_process"))},{_process:8}],191:[function(e,t,n){(function(e){!function(r){function i(e){throw new RangeError(A[e])}function o(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function a(e,t){var n=e.split("@"),r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(M,".");var i=e.split("."),a=o(i,t).join(".");return r+a}function s(e){for(var t,n,r=[],i=0,o=e.length;o>i;)t=e.charCodeAt(i++),t>=55296&&56319>=t&&o>i?(n=e.charCodeAt(i++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--)):r.push(t);return r}function c(e){return o(e,function(e){var t="";return e>65535&&(e-=65536,t+=j(e>>>10&1023|55296),e=56320|1023&e),t+=j(e)}).join("")}function u(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:C}function l(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function d(e,t,n){var r=0;for(e=n?k(e/P):e>>1,e+=k(e/t);e>D*E>>1;r+=C)e=k(e/D);return k(r+(D+1)*e/(e+R))}function p(e){var t,n,r,o,a,s,l,p,f,h,m=[],v=e.length,g=0,y=T,_=x;for(n=e.lastIndexOf(L),0>n&&(n=0),r=0;n>r;++r)e.charCodeAt(r)>=128&&i("not-basic"),m.push(e.charCodeAt(r));for(o=n>0?n+1:0;v>o;){for(a=g,s=1,l=C;o>=v&&i("invalid-input"),p=u(e.charCodeAt(o++)),(p>=C||p>k((b-g)/s))&&i("overflow"),g+=p*s,f=_>=l?w:l>=_+E?E:l-_,!(f>p);l+=C)h=C-f,s>k(b/h)&&i("overflow"),s*=h;t=m.length+1,_=d(g-a,t,0==a),k(g/t)>b-y&&i("overflow"),y+=k(g/t),g%=t,m.splice(g++,0,y)}return c(m)}function f(e){var t,n,r,o,a,c,u,p,f,h,m,v,g,y,_,S=[];for(e=s(e),v=e.length,t=T,n=0,a=x,c=0;v>c;++c)m=e[c],128>m&&S.push(j(m));for(r=o=S.length,o&&S.push(L);v>r;){for(u=b,c=0;v>c;++c)m=e[c],m>=t&&u>m&&(u=m);for(g=r+1,u-t>k((b-n)/g)&&i("overflow"),n+=(u-t)*g,t=u,c=0;v>c;++c)if(m=e[c],t>m&&++n>b&&i("overflow"),m==t){for(p=n,f=C;h=a>=f?w:f>=a+E?E:f-a,!(h>p);f+=C)_=p-h,y=C-h,S.push(j(l(h+_%y,0))),p=k(_/y);S.push(j(l(p,0))),a=d(n,g,r==o),n=0,++r}++n,++t}return S.join("")}function h(e){return a(e,function(e){return O.test(e)?p(e.slice(4).toLowerCase()):e})}function m(e){return a(e,function(e){return I.test(e)?"xn--"+f(e):e})}var v="object"==typeof n&&n&&!n.nodeType&&n,g="object"==typeof t&&t&&!t.nodeType&&t,y="object"==typeof e&&e;(y.global===y||y.window===y||y.self===y)&&(r=y);var _,S,b=2147483647,C=36,w=1,E=26,R=38,P=700,x=72,T=128,L="-",O=/^xn--/,I=/[^\x20-\x7E]/,M=/[\x2E\u3002\uFF0E\uFF61]/g,A={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},D=C-w,k=Math.floor,j=String.fromCharCode;if(_={version:"1.4.1",ucs2:{decode:s,encode:c},decode:p,encode:f,toASCII:m,toUnicode:h},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return _});else if(v&&g)if(t.exports==v)g.exports=_;else for(S in _)_.hasOwnProperty(S)&&(v[S]=_[S]);else r.punycode=_}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],192:[function(e,t,n){(function(n,r){"use strict";function i(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}function o(e,t){if(e>65536)throw new Error("requested too many random bytes");var i=new r.Uint8Array(e);e>0&&s.getRandomValues(i);var o=a.from(i.buffer);return"function"==typeof t?n.nextTick(function(){t(null,o)}):o}var a=e("safe-buffer").Buffer,s=r.crypto||r.msCrypto;t.exports=s&&s.getRandomValues?o:i}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:8,"safe-buffer":211}],193:[function(e,t,n){t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":194}],194:[function(e,t,n){"use strict";function r(e){return this instanceof r?(u.call(this,e),l.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(e)}function i(){this.allowHalfOpen||this._writableState.ended||a.nextTick(o,this)}function o(e){e.end()}var a=e("process-nextick-args"),s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=r;var c=e("core-util-is");c.inherits=e("inherits");var u=e("./_stream_readable"),l=e("./_stream_writable");c.inherits(r,u);for(var d=s(l.prototype),p=0;p<d.length;p++){var f=d[p];r.prototype[f]||(r.prototype[f]=l.prototype[f])}Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(r.prototype,"destroyed",{get:function(){return void 0===this._readableState||void 0===this._writableState?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),r.prototype._destroy=function(e,t){this.push(null),this.end(),a.nextTick(t,e)}},{"./_stream_readable":196,"./_stream_writable":198,"core-util-is":26,inherits:46,"process-nextick-args":190}],195:[function(e,t,n){"use strict";function r(e){return this instanceof r?void i.call(this,e):new r(e)}t.exports=r;var i=e("./_stream_transform"),o=e("core-util-is");o.inherits=e("inherits"),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":197,"core-util-is":26,inherits:46}],196:[function(e,t,n){(function(n,r){"use strict";function i(e){return N.from(e)}function o(e){return N.isBuffer(e)||e instanceof V}function a(e,t,n){return"function"==typeof e.prependListener?e.prependListener(t,n):void(e._events&&e._events[t]?D(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n))}function s(t,n){A=A||e("./_stream_duplex"),t=t||{};var r=n instanceof A;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,o=t.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(o||0===o)?o:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new q,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(G||(G=e("string_decoder/").StringDecoder),this.decoder=new G(t.encoding),this.encoding=t.encoding)}function c(t){return A=A||e("./_stream_duplex"),this instanceof c?(this._readableState=new s(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),void j.call(this)):new c(t)}function u(e,t,n,r,o){var a=e._readableState;if(null===t)a.reading=!1,m(e,a);else{var s;o||(s=d(a,t)),s?e.emit("error",s):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===N.prototype||(t=i(t)),r?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):l(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?l(e,a,t,!1):y(e,a)):l(e,a,t,!1))):r||(a.reading=!1)}return p(a)}function l(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&v(e)),y(e,t)}function d(e,t){var n;return o(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function p(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function f(e){return e>=z?e=z:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function h(e,t){return 0>=e||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=f(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function m(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,v(e)}}function v(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(F("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?M.nextTick(g,e):g(e))}function g(e){F("emit readable"),e.emit("readable"),E(e)}function y(e,t){t.readingMore||(t.readingMore=!0,M.nextTick(_,e,t))}function _(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(F("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function S(e){return function(){var t=e._readableState;F("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&k(e,"data")&&(t.flowing=!0,E(e))}}function b(e){F("readable nexttick read 0"),e.read(0)}function C(e,t){t.resumeScheduled||(t.resumeScheduled=!0,M.nextTick(w,e,t))}function w(e,t){t.reading||(F("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),E(e),t.flowing&&!t.reading&&e.read(0)}function E(e){var t=e._readableState;for(F("flow",t.flowing);t.flowing&&null!==e.read(););}function R(e,t){if(0===t.length)return null;var n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=P(e,t.buffer,t.decoder),n}function P(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?x(e,t):T(e,t),r}function x(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(i+=a===o.length?o:o.slice(0,e),e-=a,0===e){a===o.length?(++r,t.head=n.next?n.next:t.tail=null):(t.head=n,n.data=o.slice(a));break}++r}return t.length-=r,i}function T(e,t){var n=N.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,a),e-=a,0===e){a===o.length?(++i,t.head=r.next?r.next:t.tail=null):(t.head=r,r.data=o.slice(a));break}++i}return t.length-=i,n}function L(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,M.nextTick(O,t,e))}function O(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function I(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1}var M=e("process-nextick-args");t.exports=c;var A,D=e("isarray");c.ReadableState=s;var k=(e("events").EventEmitter,function(e,t){return e.listeners(t).length}),j=e("./internal/streams/stream"),N=e("safe-buffer").Buffer,V=r.Uint8Array||function(){},U=e("core-util-is");U.inherits=e("inherits");var B=e("util"),F=void 0;F=B&&B.debuglog?B.debuglog("stream"):function(){};var G,q=e("./internal/streams/BufferList"),J=e("./internal/streams/destroy");U.inherits(c,j);var W=["error","close","destroy","pause","resume"];Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0===this._readableState?!1:this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),c.prototype.destroy=J.destroy,c.prototype._undestroy=J.undestroy,c.prototype._destroy=function(e,t){this.push(null),t(e)},c.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&(t=t||r.defaultEncoding,t!==r.encoding&&(e=N.from(e,t),t=""),n=!0),u(this,e,t,!1,n)},c.prototype.unshift=function(e){return u(this,e,null,!0,!1)},c.prototype.isPaused=function(){return this._readableState.flowing===!1},c.prototype.setEncoding=function(t){return G||(G=e("string_decoder/").StringDecoder),this._readableState.decoder=new G(t),this._readableState.encoding=t,this};var z=8388608;c.prototype.read=function(e){F("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return F("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?L(this):v(this),null;if(e=h(e,t),0===e&&t.ended)return 0===t.length&&L(this),null;var r=t.needReadable;F("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,F("length less than watermark",r)),t.ended||t.reading?(r=!1,F("reading or ended",r)):r&&(F("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=h(n,t)));var i;return i=e>0?R(e,t):null,null===i?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&L(this)),null!==i&&this.emit("data",i),i},c.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},c.prototype.pipe=function(e,t){function r(e,t){F("onunpipe"),e===p&&t&&t.hasUnpiped===!1&&(t.hasUnpiped=!0,o())}function i(){F("onend"),e.end()}function o(){F("cleanup"),e.removeListener("close",u),e.removeListener("finish",l),e.removeListener("drain",v),e.removeListener("error",c),e.removeListener("unpipe",r),p.removeListener("end",i),p.removeListener("end",d),p.removeListener("data",s),g=!0,!f.awaitDrain||e._writableState&&!e._writableState.needDrain||v()}function s(t){F("ondata"),y=!1;var n=e.write(t);!1!==n||y||((1===f.pipesCount&&f.pipes===e||f.pipesCount>1&&-1!==I(f.pipes,e))&&!g&&(F("false write response, pause",p._readableState.awaitDrain),p._readableState.awaitDrain++,y=!0),p.pause())}function c(t){F("onerror",t),d(),e.removeListener("error",c),0===k(e,"error")&&e.emit("error",t)}function u(){e.removeListener("finish",l),d()}function l(){F("onfinish"),e.removeListener("close",u),d()}function d(){F("unpipe"),p.unpipe(e)}var p=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=e;break;case 1:f.pipes=[f.pipes,e];break;default:f.pipes.push(e)}f.pipesCount+=1,F("pipe count=%d opts=%j",f.pipesCount,t);var h=(!t||t.end!==!1)&&e!==n.stdout&&e!==n.stderr,m=h?i:d;f.endEmitted?M.nextTick(m):p.once("end",m),e.on("unpipe",r);var v=S(p);e.on("drain",v);var g=!1,y=!1;return p.on("data",s),a(e,"error",c),e.once("close",u),e.once("finish",l),e.emit("pipe",p),f.flowing||(F("pipe resume"),p.resume()),e},c.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;i>o;o++)r[o].emit("unpipe",this,n);return this}var a=I(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},c.prototype.on=function(e,t){var n=j.prototype.on.call(this,e,t);if("data"===e)this._readableState.flowing!==!1&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&v(this):M.nextTick(b,this))}return n},c.prototype.addListener=c.prototype.on,c.prototype.resume=function(){var e=this._readableState;return e.flowing||(F("resume"),e.flowing=!0,C(this,e)),this},c.prototype.pause=function(){return F("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(F("pause"),this._readableState.flowing=!1,this.emit("pause")),this},c.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;e.on("end",function(){if(F("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){if(F("wrapped data"),n.decoder&&(i=n.decoder.write(i)),(!n.objectMode||null!==i&&void 0!==i)&&(n.objectMode||i&&i.length)){var o=t.push(i);o||(r=!0,e.pause())}});for(var i in e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<W.length;o++)e.on(W[o],this.emit.bind(this,W[o]));return this._read=function(t){F("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(c.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),c._fromList=R}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":194,"./internal/streams/BufferList":199,"./internal/streams/destroy":200,"./internal/streams/stream":201,_process:8,"core-util-is":26,events:32,inherits:46,isarray:202,"process-nextick-args":190,"safe-buffer":211,"string_decoder/":203,util:7}],197:[function(e,t,n){"use strict";function r(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function i(e){return this instanceof i?(s.call(this,e),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),void this.on("prefinish",o)):new i(e)}function o(){var e=this;"function"==typeof this._flush?this._flush(function(t,n){a(e,t,n)}):a(this,null,null)}function a(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}t.exports=i;var s=e("./_stream_duplex"),c=e("core-util-is");c.inherits=e("inherits"),c.inherits(i,s),i.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},i.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},i.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},i.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},i.prototype._destroy=function(e,t){var n=this;s.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},{"./_stream_duplex":194,"core-util-is":26,inherits:46}],198:[function(e,t,n){(function(n,r,i){"use strict";function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){x(t,e)}}function a(e){return D.from(e)}function s(e){return D.isBuffer(e)||e instanceof k}function c(){}function u(t,n){L=L||e("./_stream_duplex"),t=t||{};var r=n instanceof L;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,a=t.writableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=t.decodeStrings===!1;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){y(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function l(t){return L=L||e("./_stream_duplex"),N.call(l,this)||this instanceof L?(this._writableState=new u(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t["final"]&&(this._final=t["final"])),void A.call(this)):new l(t)}function d(e,t){var n=new Error("write after end");e.emit("error",n),T.nextTick(t,n)}function p(e,t,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),T.nextTick(r,o),i=!1),i}function f(e,t,n){return e.objectMode||e.decodeStrings===!1||"string"!=typeof t||(t=D.from(t,n)),t}function h(e,t,n,r,i,o){if(!n){var a=f(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else m(e,t,!1,s,r,i,o);return c}function m(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function v(e,t,n,r,i){--t.pendingcb,n?(T.nextTick(i,r),T.nextTick(R,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),R(e,t))}function g(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function y(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(g(n),t)v(e,n,r,t,i);else{var o=C(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||b(e,n),r?O(_,e,n,o,i):_(e,n,o,i)}}function _(e,t,n,r){n||S(e,t),t.pendingcb--,r(),R(e,t)}function S(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function b(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var s=0,c=!0;n;)i[s]=n,n.isBuf||(c=!1),n=n.next,s+=1;i.allBuffers=c,m(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,l=n.encoding,d=n.callback,p=t.objectMode?1:u.length;if(m(e,t,!1,p,u,l,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function C(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),R(e,t)})}function E(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,T.nextTick(w,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function R(e,t){var n=C(t);return n&&(E(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}function P(e,t,n){t.ending=!0,R(e,t),n&&(t.finished?T.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function x(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}var T=e("process-nextick-args");t.exports=l;var L,O=!n.browser&&["v0.10","v0.9."].indexOf(n.version.slice(0,5))>-1?i:T.nextTick;l.WritableState=u;var I=e("core-util-is");I.inherits=e("inherits");var M={deprecate:e("util-deprecate")},A=e("./internal/streams/stream"),D=e("safe-buffer").Buffer,k=r.Uint8Array||function(){},j=e("./internal/streams/destroy");I.inherits(l,A),u.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(u.prototype,"buffer",{get:M.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}();var N;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(N=Function.prototype[Symbol.hasInstance],Object.defineProperty(l,Symbol.hasInstance,{value:function(e){return N.call(this,e)?!0:this!==l?!1:e&&e._writableState instanceof u}})):N=function(e){return e instanceof this},l.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},l.prototype.write=function(e,t,n){var r=this._writableState,i=!1,o=!r.objectMode&&s(e);return o&&!D.isBuffer(e)&&(e=a(e)),"function"==typeof t&&(n=t,t=null),o?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=c),r.ended?d(this,n):(o||p(this,r,e,n))&&(r.pendingcb++,i=h(this,r,o,e,t,n)),i},l.prototype.cork=function(){var e=this._writableState;e.corked++},l.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||b(this,e))},l.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),l.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},l.prototype._writev=null,l.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||P(this,r,n)},Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0===this._writableState?!1:this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),l.prototype.destroy=j.destroy,l.prototype._undestroy=j.undestroy,l.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{"./_stream_duplex":194,"./internal/streams/destroy":200,"./internal/streams/stream":201,_process:8,"core-util-is":26,inherits:46,"process-nextick-args":190,"safe-buffer":211,timers:303,"util-deprecate":306
}],199:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){e.copy(t,n)}var o=e("safe-buffer").Buffer,a=e("util");t.exports=function(){function e(){r(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return o.alloc(0);if(1===this.length)return this.head.data;for(var t=o.allocUnsafe(e>>>0),n=this.head,r=0;n;)i(n.data,t,r),r+=n.data.length,n=n.next;return t},e}(),a&&a.inspect&&a.inspect.custom&&(t.exports.prototype[a.inspect.custom]=function(){var e=a.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":211,util:7}],200:[function(e,t,n){"use strict";function r(e,t){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||a.nextTick(o,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(a.nextTick(o,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}),this)}function i(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function o(e,t){e.emit("error",t)}var a=e("process-nextick-args");t.exports={destroy:r,undestroy:i}},{"process-nextick-args":190}],201:[function(e,t,n){t.exports=e("events").EventEmitter},{events:32}],202:[function(e,t,n){arguments[4][10][0].apply(n,arguments)},{dup:10}],203:[function(e,t,n){"use strict";function r(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function i(e){var t=r(e);if("string"!=typeof t&&(y.isEncoding===_||!_(e)))throw new Error("Unknown encoding: "+e);return t||e}function o(e){this.encoding=i(e);var t;switch(this.encoding){case"utf16le":this.text=p,this.end=f,t=4;break;case"utf8":this.fillLast=u,t=4;break;case"base64":this.text=h,this.end=m,t=3;break;default:return this.write=v,void(this.end=g)}this.lastNeed=0,this.lastTotal=0,this.lastChar=y.allocUnsafe(t)}function a(e){return 127>=e?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function s(e,t,n){var r=t.length-1;if(n>r)return 0;var i=a(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n||-2===i?0:(i=a(t[r]),i>=0?(i>0&&(e.lastNeed=i-2),i):--r<n||-2===i?0:(i=a(t[r]),i>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0))}function c(e,t,n){if(128!==(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!==(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!==(192&t[2]))return e.lastNeed=2,""}}function u(e){var t=this.lastTotal-this.lastNeed,n=c(this,e,t);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){var n=s(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t}function p(e,t){if((e.length-t)%2===0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&56319>=r)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function f(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function h(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function m(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function v(e){return e.toString(this.encoding)}function g(e){return e&&e.length?this.write(e):""}var y=e("safe-buffer").Buffer,_=y.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};n.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(t=this.fillLast(e),void 0===t)return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=d,o.prototype.text=l,o.prototype.fillLast=function(e){return this.lastNeed<=e.length?(e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),void(this.lastNeed-=e.length))}},{"safe-buffer":211}],204:[function(e,t,n){t.exports=e("./readable").PassThrough},{"./readable":205}],205:[function(e,t,n){n=t.exports=e("./lib/_stream_readable.js"),n.Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":194,"./lib/_stream_passthrough.js":195,"./lib/_stream_readable.js":196,"./lib/_stream_transform.js":197,"./lib/_stream_writable.js":198}],206:[function(e,t,n){t.exports=e("./readable").Transform},{"./readable":205}],207:[function(e,t,n){t.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":198}],208:[function(e,t,n){"use strict";function r(){p.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function i(e,t){return e<<t|e>>>32-t}function o(e,t,n,r,o,a,s,c){return i(e+(t^n^r)+a+s|0,c)+o|0}function a(e,t,n,r,o,a,s,c){return i(e+(t&n|~t&r)+a+s|0,c)+o|0}function s(e,t,n,r,o,a,s,c){return i(e+((t|~n)^r)+a+s|0,c)+o|0}function c(e,t,n,r,o,a,s,c){return i(e+(t&r|n&~r)+a+s|0,c)+o|0}function u(e,t,n,r,o,a,s,c){return i(e+(t^(n|~r))+a+s|0,c)+o|0}var l=e("buffer").Buffer,d=e("inherits"),p=e("hash-base"),f=new Array(16),h=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],m=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],v=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],y=[0,1518500249,1859775393,2400959708,2840853838],_=[1352829926,1548603684,1836072691,2053994217,0];d(r,p),r.prototype._update=function(){for(var e=f,t=0;16>t;++t)e[t]=this._block.readInt32LE(4*t);for(var n=0|this._a,r=0|this._b,l=0|this._c,d=0|this._d,p=0|this._e,S=0|this._a,b=0|this._b,C=0|this._c,w=0|this._d,E=0|this._e,R=0;80>R;R+=1){var P,x;16>R?(P=o(n,r,l,d,p,e[h[R]],y[0],v[R]),x=u(S,b,C,w,E,e[m[R]],_[0],g[R])):32>R?(P=a(n,r,l,d,p,e[h[R]],y[1],v[R]),x=c(S,b,C,w,E,e[m[R]],_[1],g[R])):48>R?(P=s(n,r,l,d,p,e[h[R]],y[2],v[R]),x=s(S,b,C,w,E,e[m[R]],_[2],g[R])):64>R?(P=c(n,r,l,d,p,e[h[R]],y[3],v[R]),x=a(S,b,C,w,E,e[m[R]],_[3],g[R])):(P=u(n,r,l,d,p,e[h[R]],y[4],v[R]),x=o(S,b,C,w,E,e[m[R]],_[4],g[R])),n=p,p=d,d=i(l,10),l=r,r=P,S=E,E=w,w=i(C,10),C=b,b=x}var T=this._b+l+w|0;this._b=this._c+d+E|0,this._c=this._d+p+S|0,this._d=this._e+n+b|0,this._e=this._a+r+C|0,this._a=T},r.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=l.alloc?l.alloc(20):new l(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},t.exports=r},{buffer:9,"hash-base":39,inherits:46}],209:[function(e,t,n){"use strict";var r={};r.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)t=r[i].trim().split("="),n[t[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){r.push(e.parameters[t]?t+"="+e.parameters[t]:t)}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];return t?t.substr(6):void 0},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){var n=r.matchPrefix(e+t,"a=fingerprint:");return{role:"auto",fingerprints:n.map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);n=n.concat(r.splitLines(t));var i={usernameFragment:n.filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)};return i},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e),i=n[0].split(" "),o=3;o<i.length;o++){var a=i[o],s=r.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(s){var c=r.parseRtpMap(s),u=r.matchPrefix(e,"a=fmtp:"+a+" ");switch(c.parameters=u.length?r.parseFmtp(u[0]):{},c.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(r.parseRtcpFb),t.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(c.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.substr(17).split(" ");return t.map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),o&&(r=JSON.parse(JSON.stringify(r)),r.fec={ssrc:t,mechanism:a?"red+ulpfec":"red"},n.push(r))}}),0===n.length&&c&&n.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=l})),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return t=n[0].substr(7).split(" "),{stream:t[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?(t=i[0].value.split(" "),{stream:t[0],track:t[1]}):void 0},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t){var n,i=void 0!==t?t:2;return n=e?e:r.generateSessionId(),"v=0\r\no=thisisadapterortc "+n+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",o+=e.direction?"a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){var t=r.splitLines(e),n=t[0].split(" ");return n[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e),n=t[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0],n=t.substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},"object"==typeof t&&(t.exports=r)},{}],210:[function(e,t,n){"use strict";function r(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function i(e,t,n,r,i){var o=l.writeRtpDescription(e.kind,t);if(o+=l.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=l.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":i||"active"),o+="a=mid:"+e.mid+"\r\n",o+=e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var s="msid:"+(r?r.id:"-")+" "+a+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+l.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+l.localCName+"\r\n"),o}function o(e,t){var n=!1;return e=JSON.parse(JSON.stringify(e)),e.filter(function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter(function(e){var r=0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!n;return r?(n=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")}),delete e.url,e.urls=i?r[0]:r,!!r.length}})}function a(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach(function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;a=JSON.parse(JSON.stringify(a)),a.numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n}function s(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function c(e,t){var n=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return n||e.addRemoteCandidate(t),!n}function u(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}var l=e("sdp");t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}function p(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout(function(){t._dispatchEvent("track",o)})}var f=function(n){var r=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){r[e]=i[e].bind(i)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this.localDescription=null,this.remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw u("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=o(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=l.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};f.prototype.onicecandidate=null,f.prototype.onaddstream=null,f.prototype.ontrack=null,f.prototype.onremovestream=null,f.prototype.onsignalingstatechange=null,f.prototype.oniceconnectionstatechange=null,f.prototype.onconnectionstatechange=null,f.prototype.onicegatheringstatechange=null,f.prototype.onnegotiationneeded=null,f.prototype.ondatachannel=null,f.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},f.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},f.prototype.getConfiguration=function(){return this._config},f.prototype.getLocalStreams=function(){return this.localStreams},f.prototype.getRemoteStreams=function(){return this.remoteStreams},f.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},f.prototype.addTrack=function(t,n){if(this._isClosed)throw u("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r=this.transceivers.find(function(e){return e.track===t});if(r)throw u("InvalidAccessError","Track already exists.");for(var i,o=0;o<this.transceivers.length;o++)this.transceivers[o].track||this.transceivers[o].kind!==t.kind||(i=this.transceivers[o]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=t,i.stream=n,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},f.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach(function(t){n.addTrack(t,e)});else{var r=e.clone();e.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),r.getTracks().forEach(function(e){n.addTrack(e,r)})}},f.prototype.removeTrack=function(t){if(this._isClosed)throw u("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find(function(e){return e.rtpSender===t});if(!n)throw u("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null;var i=this.transceivers.map(function(e){return e.stream});-1===i.indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},f.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var n=t.getSenders().find(function(t){return t.track===e});n&&t.removeTrack(n)})},f.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},f.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},f.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},f.prototype._gather=function(t,n){var r=this,i=this.transceivers[n].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),i.onlocalcandidate=function(e){if(!(r.usingBundle&&n>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:n};var a=e.candidate,s=!a||0===Object.keys(a).length;if(s)("new"===i.state||"gathering"===i.state)&&(i.state="completed");else{"new"===i.state&&(i.state="gathering"),a.component=1,a.ufrag=i.getLocalParameters().usernameFragment;var c=l.writeCandidate(a);o.candidate=Object.assign(o.candidate,l.parseCandidate(c)),o.candidate.candidate=c,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var u=l.getMediaSections(r.localDescription.sdp);u[o.candidate.sdpMLineIndex]+=s?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",r.localDescription.sdp=l.getDescription(r.localDescription.sdp)+u.join("");var d=r.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==r.iceGatheringState&&(r.iceGatheringState="gathering",r._emitGatheringStateChange()),s||r._dispatchEvent("icecandidate",o),d&&(r._dispatchEvent("icecandidate",new Event("icecandidate")),r.iceGatheringState="complete",r._emitGatheringStateChange())}},e.setTimeout(function(){o.forEach(function(e){i.onlocalcandidate(e)})},0)}},f.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},f.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},f.prototype._transceive=function(e,n,r){var i=a(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:l.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),r&&e.rtpReceiver&&i.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&15019>t&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),i.encodings=e.recvEncodingParameters.length?e.recvEncodingParameters:[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},f.prototype.setLocalDescription=function(e){var t=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(u("TypeError",'Unsupported type "'+e.type+'"'));if(!s("setLocalDescription",e.type,t.signalingState)||t._isClosed)return Promise.reject(u("InvalidStateError","Can not set local "+e.type+" in state "+t.signalingState));var n,r;if("offer"===e.type)n=l.splitSections(e.sdp),r=n.shift(),n.forEach(function(e,n){var r=l.parseRtpParameters(e);t.transceivers[n].localCapabilities=r}),t.transceivers.forEach(function(e,n){t._gather(e.mid,n)});else if("answer"===e.type){n=l.splitSections(t.remoteDescription.sdp),r=n.shift();var i=l.matchPrefix(r,"a=ice-lite").length>0;

n.forEach(function(e,n){var o=t.transceivers[n],s=o.iceGatherer,c=o.iceTransport,u=o.dtlsTransport,d=o.localCapabilities,p=o.remoteCapabilities,f=l.isRejected(e)&&0===l.matchPrefix(e,"a=bundle-only").length;if(!f&&!o.rejected){var h=l.getIceParameters(e,r),m=l.getDtlsParameters(e,r);i&&(m.role="server"),t.usingBundle&&0!==n||(t._gather(o.mid,n),"new"===c.state&&c.start(s,h,i?"controlling":"controlled"),"new"===u.state&&u.start(m));var v=a(d,p);t._transceive(o,v.codecs.length>0,!1)}})}return t.localDescription={type:e.type,sdp:e.sdp},t._updateSignalingState("offer"===e.type?"have-local-offer":"stable"),Promise.resolve()},f.prototype.setRemoteDescription=function(r){var i=this;if(-1===["offer","answer"].indexOf(r.type))return Promise.reject(u("TypeError",'Unsupported type "'+r.type+'"'));if(!s("setRemoteDescription",r.type,i.signalingState)||i._isClosed)return Promise.reject(u("InvalidStateError","Can not set remote "+r.type+" in state "+i.signalingState));var o={};i.remoteStreams.forEach(function(e){o[e.id]=e});var a=[],f=l.splitSections(r.sdp),h=f.shift(),m=l.matchPrefix(h,"a=ice-lite").length>0,v=l.matchPrefix(h,"a=group:BUNDLE ").length>0;i.usingBundle=v;var g=l.matchPrefix(h,"a=ice-options:")[0];return i.canTrickleIceCandidates=g?g.substr(14).split(" ").indexOf("trickle")>=0:!1,f.forEach(function(s,u){var p=l.splitLines(s),f=l.getKind(s),g=l.isRejected(s)&&0===l.matchPrefix(s,"a=bundle-only").length,y=p[0].substr(2).split(" ")[2],_=l.getDirection(s,h),S=l.parseMsid(s),b=l.getMid(s)||l.generateIdentifier();if("application"===f&&"DTLS/SCTP"===y||g)return void(i.transceivers[u]={mid:b,kind:f,rejected:!0});!g&&i.transceivers[u]&&i.transceivers[u].rejected&&(i.transceivers[u]=i._createTransceiver(f,!0));var C,w,E,R,P,x,T,L,O,I,M,A=l.parseRtpParameters(s);g||(I=l.getIceParameters(s,h),M=l.getDtlsParameters(s,h),M.role="client"),T=l.parseRtpEncodingParameters(s);var D=l.parseRtcpParameters(s),k=l.matchPrefix(s,"a=end-of-candidates",h).length>0,j=l.matchPrefix(s,"a=candidate:").map(function(e){return l.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===r.type||"answer"===r.type)&&!g&&v&&u>0&&i.transceivers[u]&&(i._disposeIceAndDtlsTransports(u),i.transceivers[u].iceGatherer=i.transceivers[0].iceGatherer,i.transceivers[u].iceTransport=i.transceivers[0].iceTransport,i.transceivers[u].dtlsTransport=i.transceivers[0].dtlsTransport,i.transceivers[u].rtpSender&&i.transceivers[u].rtpSender.setTransport(i.transceivers[0].dtlsTransport),i.transceivers[u].rtpReceiver&&i.transceivers[u].rtpReceiver.setTransport(i.transceivers[0].dtlsTransport)),"offer"!==r.type||g)"answer"!==r.type||g||(C=i.transceivers[u],w=C.iceGatherer,E=C.iceTransport,R=C.dtlsTransport,P=C.rtpReceiver,x=C.sendEncodingParameters,L=C.localCapabilities,i.transceivers[u].recvEncodingParameters=T,i.transceivers[u].remoteCapabilities=A,i.transceivers[u].rtcpParameters=D,j.length&&"new"===E.state&&(!m&&!k||v&&0!==u?j.forEach(function(e){c(C.iceTransport,e)}):E.setRemoteCandidates(j)),v&&0!==u||("new"===E.state&&E.start(w,I,"controlling"),"new"===R.state&&R.start(M)),i._transceive(C,"sendrecv"===_||"recvonly"===_,"sendrecv"===_||"sendonly"===_),!P||"sendrecv"!==_&&"sendonly"!==_?delete C.rtpReceiver:(O=P.track,S?(o[S.stream]||(o[S.stream]=new e.MediaStream),n(O,o[S.stream]),a.push([O,P,o[S.stream]])):(o["default"]||(o["default"]=new e.MediaStream),n(O,o["default"]),a.push([O,P,o["default"]]))));else{C=i.transceivers[u]||i._createTransceiver(f),C.mid=b,C.iceGatherer||(C.iceGatherer=i._createIceGatherer(u,v)),j.length&&"new"===C.iceTransport.state&&(!k||v&&0!==u?j.forEach(function(e){c(C.iceTransport,e)}):C.iceTransport.setRemoteCandidates(j)),L=e.RTCRtpReceiver.getCapabilities(f),15019>t&&(L.codecs=L.codecs.filter(function(e){return"rtx"!==e.name})),x=C.sendEncodingParameters||[{ssrc:1001*(2*u+2)}];var N=!1;if("sendrecv"===_||"sendonly"===_){if(N=!C.rtpReceiver,P=C.rtpReceiver||new e.RTCRtpReceiver(C.dtlsTransport,f),N){var V;O=P.track,S&&"-"===S.stream||(S?(o[S.stream]||(o[S.stream]=new e.MediaStream,Object.defineProperty(o[S.stream],"id",{get:function(){return S.stream}})),Object.defineProperty(O,"id",{get:function(){return S.track}}),V=o[S.stream]):(o["default"]||(o["default"]=new e.MediaStream),V=o["default"])),V&&(n(O,V),C.associatedRemoteMediaStreams.push(V)),a.push([O,P,V])}}else C.rtpReceiver&&C.rtpReceiver.track&&(C.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===C.rtpReceiver.track.id});t&&d(t,e)}),C.associatedRemoteMediaStreams=[]);C.localCapabilities=L,C.remoteCapabilities=A,C.rtpReceiver=P,C.rtcpParameters=D,C.sendEncodingParameters=x,C.recvEncodingParameters=T,i._transceive(i.transceivers[u],!1,N)}}),void 0===i._dtlsRole&&(i._dtlsRole="offer"===r.type?"active":"passive"),i.remoteDescription={type:r.type,sdp:r.sdp},i._updateSignalingState("offer"===r.type?"have-remote-offer":"stable"),Object.keys(o).forEach(function(t){var n=o[t];if(n.getTracks().length){if(-1===i.remoteStreams.indexOf(n)){i.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout(function(){i._dispatchEvent("addstream",r)})}a.forEach(function(e){var t=e[0],r=e[1];n.id===e[2].id&&p(i,t,r,[n])})}}),a.forEach(function(e){e[2]||p(i,e[0],e[1],[])}),e.setTimeout(function(){i&&i.transceivers&&i.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},f.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},f.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},f.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&this.needNegotiation!==!0&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},f.prototype._updateIceConnectionState=function(){var e,t={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t["new"]>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},f.prototype._updateConnectionState=function(){var e,t={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++,t[e.dtlsTransport.state]++}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t["new"]>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},f.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(u("InvalidStateError","Can not call createOffer after close"));var r=n.transceivers.filter(function(e){return"audio"===e.kind}).length,o=n.transceivers.filter(function(e){return"video"===e.kind}).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(r=a.offerToReceiveAudio===!0?1:a.offerToReceiveAudio===!1?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(o=a.offerToReceiveVideo===!0?1:a.offerToReceiveVideo===!1?0:a.offerToReceiveVideo)}for(n.transceivers.forEach(function(e){"audio"===e.kind?(r--,0>r&&(e.wantReceive=!1)):"video"===e.kind&&(o--,0>o&&(e.wantReceive=!1))});r>0||o>0;)r>0&&(n._createTransceiver("audio"),r--),o>0&&(n._createTransceiver("video"),o--);var s=l.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach(function(r,i){var o=r.track,a=r.kind,s=r.mid||l.generateIdentifier();r.mid=s,r.iceGatherer||(r.iceGatherer=n._createIceGatherer(i,n.usingBundle));var c=e.RTCRtpSender.getCapabilities(a);15019>t&&(c.codecs=c.codecs.filter(function(e){return"rtx"!==e.name})),c.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),c.headerExtensions.forEach(function(e){var t=r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[];t.forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var u=r.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];o&&t>=15019&&"video"===a&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new e.RTCRtpReceiver(r.dtlsTransport,a)),r.localCapabilities=c,r.sendEncodingParameters=u}),"max-compat"!==n._config.bundlePolicy&&(s+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n",n.transceivers.forEach(function(e,t){s+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),s+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,s+="a="+l.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(s+="a=end-of-candidates\r\n"))});var c=new e.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(c)},f.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(u("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(u("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var r=l.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(r+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n");var o=l.getMediaSections(n.remoteDescription.sdp).length;n.transceivers.forEach(function(e,s){if(!(s+1>o)){if(e.rejected)return"application"===e.kind?r+="m=application 0 DTLS/SCTP 5000\r\n":"audio"===e.kind?r+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(r+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(r+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");if(e.stream){var c;"audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1})}var u=a(e.localCapabilities,e.remoteCapabilities),l=u.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length;!l&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,r+=i(e,u,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(r+="a=rtcp-rsize\r\n")}});var s=new e.RTCSessionDescription({type:"answer",sdp:r});return Promise.resolve(s)},f.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(r,i){if(!n.remoteDescription)return i(u("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var a=0;a<n.transceivers.length;a++)if(n.transceivers[a].mid===e.sdpMid){o=a;break}var s=n.transceivers[o];if(!s)return i(u("OperationError","Can not add ICE candidate"));if(s.rejected)return r();var d=Object.keys(e.candidate).length>0?l.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return r();if(d.component&&1!==d.component)return r();if((0===o||o>0&&s.iceTransport!==n.transceivers[0].iceTransport)&&!c(s.iceTransport,d))return i(u("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),t=l.getMediaSections(n.remoteDescription.sdp),t[o]+="a="+(d.type?p:"end-of-candidates")+"\r\n",n.remoteDescription.sdp=l.getDescription(n.remoteDescription.sdp)+t.join("")}else for(var f=0;f<n.transceivers.length&&(n.transceivers[f].rejected||(n.transceivers[f].iceTransport.addRemoteCandidate({}),t=l.getMediaSections(n.remoteDescription.sdp),t[f]+="a=end-of-candidates\r\n",n.remoteDescription.sdp=l.getDescription(n.remoteDescription.sdp)+t.join(""),!n.usingBundle));f++);r()})},f.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)}),!n)throw u("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&r.push(e[t].getStats())})}),Promise.all(r).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};var h=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];h.forEach(function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(n){e[n].type=r(e[n]),t.set(n,e[n])}),t})}}});var m=["createOffer","createAnswer"];return m.forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),m=["setLocalDescription","setRemoteDescription","addIceCandidate"],m.forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=f.prototype[e];f.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),f}},{sdp:209}],211:[function(e,t,n){function r(e,t){for(var n in e)t[n]=e[n]}function i(e,t,n){return a(e,t,n)}var o=e("buffer"),a=o.Buffer;a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?t.exports=o:(r(o,n),n.Buffer=i),r(a,i),i.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return a(e,t,n)},i.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=a(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return a(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o.SlowBuffer(e)}},{buffer:9}],212:[function(e,t,n){!function(e,r){"object"==typeof n?r(n,t):"function"==typeof define&&define.amd&&define(["exports","module"],r)}(this,function(e,t){function n(){}n.prototype.name="ANONYMOUS",n.prototype.clientFirst=!0,n.prototype.response=function(e){return e.trace||""},n.prototype.challenge=function(e){},e=t.exports=n})},{}],213:[function(e,t,n){!function(r,i){"object"==typeof n?i(n,t,e("./lib/mechanism")):"function"==typeof define&&define.amd&&define(["exports","module","./lib/mechanism"],i)}(this,function(e,t,n){e=t.exports=n,e.Mechanism=n})},{"./lib/mechanism":212}],214:[function(e,t,n){!function(e,r){"object"==typeof n?r(n,t):"function"==typeof define&&define.amd&&define(["exports","module"],r)}(this,function(e,t){function n(){}n.prototype.name="EXTERNAL",n.prototype.clientFirst=!0,n.prototype.response=function(e){return e.authzid||""},n.prototype.challenge=function(e){},e=t.exports=n})},{}],215:[function(e,t,n){arguments[4][213][0].apply(n,arguments)},{"./lib/mechanism":214,dup:213}],216:[function(e,t,n){!function(e,r){"object"==typeof n?r(n,t):"function"==typeof define&&define.amd&&define(["exports","module"],r)}(this,function(e,t){function n(){}n.prototype.name="PLAIN",n.prototype.clientFirst=!0,n.prototype.response=function(e){var t="";return t+=e.authzid||"",t+="\x00",t+=e.username,t+="\x00",t+=e.password},n.prototype.challenge=function(e){return this},e=t.exports=n})},{}],217:[function(e,t,n){arguments[4][213][0].apply(n,arguments)},{"./lib/mechanism":216,dup:213}],218:[function(e,t,n){(function(n){function r(e){e=e||{},this._genNonce=e.genNonce||o.genNonce,this._stage="initial"}var i=e("./lib/bitops"),o=e("./lib/utils"),a={},s="Client Key",c="Server Key";r.Mechanism=r,r.prototype.name="SCRAM-SHA-1",r.prototype.clientFirst=!0,r.prototype.response=function(e){return a[this._stage](this,e)},r.prototype.challenge=function(e){var t=o.parse(e);return this._salt=new n(t.s||"","base64"),this._iterationCount=parseInt(t.i,10),this._nonce=t.r,this._verifier=t.v,this._error=t.e,this._challenge=e,this},a.initial=function(e,t){e._cnonce=e._genNonce();var n="";t.authzid&&(n="a="+o.saslname(t.authzid)),e._gs2Header="n,"+n+",";var r="r="+e._cnonce,i="n="+o.saslname(t.username||"");e._clientFirstMessageBare=i+","+r;var a=e._gs2Header+e._clientFirstMessageBare;return e._stage="challenge",a},a.challenge=function(e,t){var r=new n(e._gs2Header).toString("base64");e._clientFinalMessageWithoutProof="c="+r+",r="+e._nonce;var o,a,u;t.salt&&0===n.compare(t.salt,e._salt)?t.clientKey&&t.serverKey?(a=t.clientKey,u=t.serverKey):t.saltedPassword&&(o=t.saltedPassword,a=i.HMAC(o,s),u=i.HMAC(o,c)):(o=i.Hi(t.password||"",e._salt,e._iterationCount),a=i.HMAC(o,s),u=i.HMAC(o,c));var l=i.H(a),d=e._clientFirstMessageBare+","+e._challenge+","+e._clientFinalMessageWithoutProof,p=i.HMAC(l,d),f=i.XOR(a,p).toString("base64");e._serverSignature=i.HMAC(u,d);var h=e._clientFinalMessageWithoutProof+",p="+f;return e._stage="final",e.cache={salt:e._salt,saltedPassword:o,clientKey:a,serverKey:u},h},a["final"]=function(){return""},t.exports=r}).call(this,e("buffer").Buffer)},{"./lib/bitops":219,"./lib/utils":220,buffer:9}],219:[function(e,t,n){(function(t){var r=e("create-hash"),i=e("create-hmac"),o=e("bitwise-xor");n.XOR=o,n.H=function(e){return r("sha1").update(e).digest()},n.HMAC=function(e,t){return i("sha1",e).update(t).digest()},n.Hi=function(e,r,i){for(var o=n.HMAC(e,t.concat([r,new t([0,0,0,1],"binary")])),a=o,s=0;i-1>s;s++)o=n.HMAC(e,o),a=n.XOR(a,o);return a}}).call(this,e("buffer").Buffer)},{"bitwise-xor":6,buffer:9,"create-hash":27,"create-hmac":29}],220:[function(e,t,n){var r=e("randombytes").randomBytes||e("randombytes");n.parse=function(e){for(var t={},n=e.split(/,(?=(?:[^"]|"[^"]*")*$)/),r=0,i=n.length;i>r;r++){var o=/(\w+)=["]?([^"]+)["]?$/.exec(n[r]);o&&(t[o[1]]=o[2])}return t},n.saslname=function(e){for(var t=[],n="",r=0;r<e.length;r++)n=e[r],t.push(","===n?"=2C":"="===n?"=3D":n);return t.join("")},n.genNonce=function(e){return r((e||32)/2).toString("hex")}},{randombytes:192}],221:[function(e,t,n){!function(e,r){"object"==typeof n?r(n,t):"function"==typeof define&&define.amd&&define(["exports","module"],r)}(this,function(e,t){function n(){}n.prototype.name="X-OAUTH2",n.prototype.clientFirst=!0,n.prototype.response=function(e){var t="";return t+="\x00",t+=e.username,t+="\x00",t+=e.token},n.prototype.challenge=function(e){},e=t.exports=n})},{}],222:[function(e,t,n){arguments[4][213][0].apply(n,arguments)},{"./lib/mechanism":221,dup:213}],223:[function(e,t,n){!function(e,r){"object"==typeof n?r(n,t):"function"==typeof define&&define.amd&&define(["exports","module"],r)}(this,function(e,t){function n(){this._mechs=[]}n.prototype.use=function(e,t){return t||(t=e,e=t.prototype.name),this._mechs.push({name:e,mech:t}),this},n.prototype.create=function(e){for(var t=0,n=this._mechs.length;n>t;t++)for(var r=0,i=e.length;i>r;r++){var o=this._mechs[t];if(o.name==e[r])return new o.mech}return null},e=t.exports=n})},{}],224:[function(e,t,n){!function(r,i){"object"==typeof n?i(n,t,e("./lib/factory")):"function"==typeof define&&define.amd&&define(["exports","module","./lib/factory"],i)}(this,function(e,t,n){e=t.exports=n,e.Factory=n})},{"./lib/factory":223}],225:[function(e,t,n){var r=e("./lib/tosdp"),i=e("./lib/tojson");n.toIncomingSDPOffer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingSDPOffer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"outgoing"})},n.toIncomingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"outgoing"})},n.toCandidateSDP=r.toCandidateSDP,n.toMediaSDP=r.toMediaSDP,n.toSessionSDP=r.toSessionSDP,n.toIncomingJSONOffer=function(e,t){return i.toSessionJSON(e,{role:"responder",direction:"incoming",creators:t})},n.toOutgoingJSONOffer=function(e,t){return i.toSessionJSON(e,{role:"initiator",direction:"outgoing",creators:t})},n.toIncomingJSONAnswer=function(e,t){return i.toSessionJSON(e,{role:"initiator",direction:"incoming",creators:t})},n.toOutgoingJSONAnswer=function(e,t){return i.toSessionJSON(e,{role:"responder",direction:"outgoing",creators:t})},n.toIncomingMediaJSONOffer=function(e,t){return i.toMediaJSON(e,{role:"responder",direction:"incoming",creator:t})},n.toOutgoingMediaJSONOffer=function(e,t){return i.toMediaJSON(e,{role:"initiator",direction:"outgoing",creator:t})},n.toIncomingMediaJSONAnswer=function(e,t){return i.toMediaJSON(e,{role:"initiator",direction:"incoming",creator:t})},n.toOutgoingMediaJSONAnswer=function(e,t){return i.toMediaJSON(e,{role:"responder",direction:"outgoing",creator:t})},n.toCandidateJSON=i.toCandidateJSON,n.toMediaJSON=i.toMediaJSON,n.toSessionJSON=i.toSessionJSON},{"./lib/tojson":228,"./lib/tosdp":229}],226:[function(e,t,n){n.lines=function(e){return e.split("\r\n").filter(function(e){return e.length>0})},n.findLine=function(e,t,n){for(var r=e.length,i=0;i<t.length;i++)if(t[i].substr(0,r)===e)return t[i];if(!n)return!1;for(var o=0;o<n.length;o++)if(n[o].substr(0,r)===e)return n[o];return!1},n.findLines=function(e,t,n){for(var r=[],i=e.length,o=0;o<t.length;o++)t[o].substr(0,i)===e&&r.push(t[o]);if(r.length||!n)return r;for(var a=0;a<n.length;a++)n[a].substr(0,i)===e&&r.push(n[a]);return r},n.mline=function(e){for(var t=e.substr(2).split(" "),n={media:t[0],port:t[1],proto:t[2],formats:[]},r=3;r<t.length;r++)t[r]&&n.formats.push(t[r]);return n},n.rtpmap=function(e){var t=e.substr(9).split(" "),n={id:t.shift()};return t=t[0].split("/"),n.name=t[0],n.clockrate=t[1],n.channels=3==t.length?t[2]:"1",n},n.sctpmap=function(e){var t=e.substr(10).split(" "),n={number:t.shift(),protocol:t.shift(),streams:t.shift()};return n},n.fmtp=function(e){for(var t,n,r,i=e.substr(e.indexOf(" ")+1).split(";"),o=[],a=0;a<i.length;a++)t=i[a].split("="),n=t[0].trim(),r=t[1],n&&r?o.push({key:n,value:r}):n&&o.push({key:"",value:n});return o},n.crypto=function(e){var t=e.substr(9).split(" "),n={tag:t[0],cipherSuite:t[1],keyParams:t[2],sessionParams:t.slice(3).join(" ")};return n},n.fingerprint=function(e){var t=e.substr(14).split(" ");return{hash:t[0],value:t[1]}},n.extmap=function(e){var t=e.substr(9).split(" "),n={},r=t.shift(),i=r.indexOf("/");return i>=0?(n.id=r.substr(0,i),n.senders=r.substr(i+1)):(n.id=r,n.senders="sendrecv"),n.uri=t.shift()||"",n},n.rtcpfb=function(e){var t=e.substr(10).split(" "),n={};return n.id=t.shift(),n.type=t.shift(),"trr-int"===n.type?n.value=t.shift():n.subtype=t.shift()||"",n.parameters=t,n},n.candidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:t[3],ip:t[4],port:t[5],type:t[7],generation:"0"},r=8;r<t.length;r+=2)"raddr"===t[r]?n.relAddr=t[r+1]:"rport"===t[r]?n.relPort=t[r+1]:"generation"===t[r]?n.generation=t[r+1]:"tcptype"===t[r]&&(n.tcpType=t[r+1]);return n.network="1",n},n.sourceGroups=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].substr(13).split(" ");t.push({semantics:r.shift(),sources:r})}return t},n.sources=function(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r].substr(7).split(" "),o=i.shift();if(!n[o]){var a={ssrc:o,parameters:[]};t.push(a),n[o]=a}i=i.join(" ").split(":");var s=i.shift(),c=i.join(":")||null;n[o].parameters.push({key:s,value:c})}return t},n.groups=function(e){for(var t,n=[],r=0;r<e.length;r++)t=e[r].substr(8).split(" "),n.push({semantics:t.shift(),contents:t});return n},n.bandwidth=function(e){var t=e.substr(2).split(":"),n={};return n.type=t.shift(),n.bandwidth=t.shift(),n},n.msid=function(e){var t=e.substr(7),n=t.split(" ");return{msid:t,mslabel:n[0],label:n[1]}}},{}],227:[function(e,t,n){t.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],228:[function(e,t,n){var r=e("./senders"),i=e("./parsers"),o=Math.random();n._setIdCounter=function(e){o=e},n.toSessionJSON=function(e,t){var r,o=t.creators||[],a=t.role||"initiator",s=t.direction||"outgoing",c=e.split("\r\nm=");for(r=1;r<c.length;r++)c[r]="m="+c[r],r!==c.length-1&&(c[r]+="\r\n");var u=c.shift()+"\r\n",l=i.lines(u),d={},p=[];for(r=0;r<c.length;r++)p.push(n.toMediaJSON(c[r],u,{role:a,direction:s,creator:o[r]||"initiator"}));d.contents=p;var f=i.findLines("a=group:",l);return f.length&&(d.groups=i.groups(f)),d},n.toMediaJSON=function(e,t,o){var a=o.creator||"initiator",s=o.role||"initiator",c=o.direction||"outgoing",u=i.lines(e),l=i.lines(t),d=i.mline(u[0]),p={creator:a,name:d.media,application:{applicationType:"rtp",media:d.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==d.media&&(p.application={applicationType:"datachannel"},p.transport.sctp=[]);var f=p.application,h=p.transport,m=i.findLine("a=mid:",u);if(m&&(p.name=m.substr(6)),i.findLine("a=sendrecv",u,l)?p.senders="both":i.findLine("a=sendonly",u,l)?p.senders=r[s][c].sendonly:i.findLine("a=recvonly",u,l)?p.senders=r[s][c].recvonly:i.findLine("a=inactive",u,l)&&(p.senders="none"),"rtp"==f.applicationType){var v=i.findLine("b=",u);v&&(f.bandwidth=i.bandwidth(v));var g=i.findLine("a=ssrc:",u);g&&(f.ssrc=g.substr(7).split(" ")[0]);var y=i.findLines("a=rtpmap:",u);y.forEach(function(e){var t=i.rtpmap(e);t.parameters=[],t.feedback=[];var n=i.findLines("a=fmtp:"+t.id,u);n.forEach(function(e){t.parameters=i.fmtp(e)});var r=i.findLines("a=rtcp-fb:"+t.id,u);r.forEach(function(e){t.feedback.push(i.rtcpfb(e))}),f.payloads.push(t)});var _=i.findLines("a=crypto:",u,l);_.forEach(function(e){f.encryption.push(i.crypto(e))});var S=i.findLines("a=rtcp-fb:*",u);S.forEach(function(e){f.feedback.push(i.rtcpfb(e))});var b=i.findLines("a=extmap:",u);b.forEach(function(e){var t=i.extmap(e);t.senders=r[s][c][t.senders],f.headerExtensions.push(t)});var C=i.findLines("a=ssrc-group:",u);f.sourceGroups=i.sourceGroups(C||[]);var w=i.findLines("a=ssrc:",u),E=f.sources=i.sources(w||[]),R=i.findLine("a=msid:",u);if(R){var P=i.msid(R);["msid","mslabel","label"].forEach(function(e){for(var t=0;t<E.length;t++){for(var n=!1,r=0;r<E[t].parameters.length;r++)E[t].parameters[r].key===e&&(n=!0);n||E[t].parameters.push({key:e,value:P[e]})}})}i.findLine("a=x-google-flag:conference",u,l)&&(f.googConferenceFlag=!0)}i.findLine("a=rtcp-mux",u)&&(h.usertcpmux="true");var x=i.findLines("a=fingerprint:",u,l),T=i.findLine("a=setup:",u,l);x.forEach(function(e){var t=i.fingerprint(e);T&&(t.setup=T.substr(8)),h.fingerprints.push(t)});var L=i.findLine("a=ice-ufrag:",u,l),O=i.findLine("a=ice-pwd:",u,l);if(L&&O){h.ufrag=L.substr(12),h.pwd=O.substr(10),h.candidates=[];var I=i.findLines("a=candidate:",u,l);I.forEach(function(e){h.candidates.push(n.toCandidateJSON(e))})}if("datachannel"==f.applicationType){var M=i.findLines("a=sctpmap:",u);M.forEach(function(e){var t=i.sctpmap(e);h.sctp.push(t)})}return p},n.toCandidateJSON=function(e){var t=i.candidate(e.split("\r\n")[0]);return t.id=(o++).toString(36).substr(0,12),t}},{"./parsers":226,"./senders":227}],229:[function(e,t,n){var r=e("./senders");n.toSessionSDP=function(e,t){var r=(t.role||"initiator",t.direction||"outgoing",t.sid||e.sid||Date.now()),i=t.time||Date.now(),o=["v=0","o=- "+r+" "+i+" IN IP4 0.0.0.0","s=-","t=0 0"],a=e.contents||[],s=!1;a.forEach(function(e){e.application.sources&&e.application.sources.length&&(s=!0)}),s&&o.push("a=msid-semantic: WMS *");var c=e.groups||[];return c.forEach(function(e){o.push("a=group:"+e.semantics+" "+e.contents.join(" "))}),a.forEach(function(e){o.push(n.toMediaSDP(e,t))}),o.join("\r\n")+"\r\n"},n.toMediaSDP=function(e,t){var i=[],o=t.role||"initiator",a=t.direction||"outgoing",s=e.application,c=e.transport,u=s.payloads||[],l=c&&c.fingerprints||[],d=[];if("datachannel"==s.applicationType?(d.push("application"),d.push("1"),d.push("DTLS/SCTP"),c.sctp&&c.sctp.forEach(function(e){d.push(e.number)})):(d.push(s.media),d.push("1"),d.push(l.length>0?"UDP/TLS/RTP/SAVPF":s.encryption&&s.encryption.length>0?"RTP/SAVPF":"RTP/AVPF"),u.forEach(function(e){d.push(e.id)})),i.push("m="+d.join(" ")),i.push("c=IN IP4 0.0.0.0"),s.bandwidth&&s.bandwidth.type&&s.bandwidth.bandwidth&&i.push("b="+s.bandwidth.type+":"+s.bandwidth.bandwidth),"rtp"==s.applicationType&&i.push("a=rtcp:1 IN IP4 0.0.0.0"),c){c.ufrag&&i.push("a=ice-ufrag:"+c.ufrag),c.pwd&&i.push("a=ice-pwd:"+c.pwd);var p=!1;l.forEach(function(e){i.push("a=fingerprint:"+e.hash+" "+e.value),e.setup&&!p&&i.push("a=setup:"+e.setup)}),c.sctp&&c.sctp.forEach(function(e){i.push("a=sctpmap:"+e.number+" "+e.protocol+" "+e.streams)}),"true"===c.usertcpmux&&i.push("a=rtcp-mux")}"rtp"==s.applicationType&&i.push("a="+(r[o][a][e.senders]||"sendrecv")),i.push("a=mid:"+e.name),s.sources&&s.sources.length&&(s.sources[0].parameters||[]).forEach(function(e){"msid"===e.key&&i.push("a=msid:"+e.value)});var f=s.encryption||[];f.forEach(function(e){i.push("a=crypto:"+e.tag+" "+e.cipherSuite+" "+e.keyParams+(e.sessionParams?" "+e.sessionParams:""))}),s.googConferenceFlag&&i.push("a=x-google-flag:conference"),u.forEach(function(e){var t="a=rtpmap:"+e.id+" "+e.name+"/"+e.clockrate;if(e.channels&&"1"!=e.channels&&(t+="/"+e.channels),i.push(t),e.parameters&&e.parameters.length){var n=["a=fmtp:"+e.id],r=[];e.parameters.forEach(function(e){
r.push((e.key?e.key+"=":"")+e.value)}),n.push(r.join(";")),i.push(n.join(" "))}e.feedback&&e.feedback.forEach(function(t){i.push("trr-int"===t.type?"a=rtcp-fb:"+e.id+" trr-int "+(t.value?t.value:"0"):"a=rtcp-fb:"+e.id+" "+t.type+(t.subtype?" "+t.subtype:""))})}),s.feedback&&s.feedback.forEach(function(e){i.push("trr-int"===e.type?"a=rtcp-fb:* trr-int "+(e.value?e.value:"0"):"a=rtcp-fb:* "+e.type+(e.subtype?" "+e.subtype:""))});var h=s.headerExtensions||[];h.forEach(function(e){i.push("a=extmap:"+e.id+(e.senders?"/"+r[o][a][e.senders]:"")+" "+e.uri)});var m=s.sourceGroups||[];m.forEach(function(e){i.push("a=ssrc-group:"+e.semantics+" "+e.sources.join(" "))});var v=s.sources||[];v.forEach(function(e){for(var t=0;t<e.parameters.length;t++){var n=e.parameters[t];i.push("a=ssrc:"+(e.ssrc||s.ssrc)+" "+n.key+(n.value?":"+n.value:""))}});var g=c.candidates||[];return g.forEach(function(e){i.push(n.toCandidateSDP(e))}),i.join("\r\n")},n.toCandidateSDP=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),("srflx"===n||"prflx"===n||"relay"===n)&&e.relAddr&&e.relPort&&(t.push("raddr"),t.push(e.relAddr),t.push("rport"),t.push(e.relPort)),e.tcpType&&"TCP"==e.protocol.toUpperCase()&&(t.push("tcptype"),t.push(e.tcpType)),t.push("generation"),t.push(e.generation||"0"),"a=candidate:"+t.join(" ")}},{"./senders":227}],230:[function(e,t,n){"use strict";var r={};r.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.numChannels=3===t.length?parseInt(t[2],10):1,n},r.writeRtpMap=function(e){var t=e.payloadType;return void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==e.numChannels?"/"+e.numChannels:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)t=r[i].trim().split("="),n[t[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){r.push(t+"="+e.parameters[t])}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];return t?t.substr(6):void 0},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){var n=r.matchPrefix(e+t,"a=fingerprint:");return{role:"auto",fingerprints:n.map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);n=n.concat(r.splitLines(t));var i={usernameFragment:n.filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)};return i},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e),i=n[0].split(" "),o=3;o<i.length;o++){var a=i[o],s=r.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(s){var c=r.parseRtpMap(s),u=r.matchPrefix(e,"a=fmtp:"+a+" ");switch(c.parameters=u.length?r.parseFmtp(u[0]):{},c.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(r.parseRtcpFb),t.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(c.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.split(" ");return t.shift(),t.map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10),rtx:{ssrc:t}};n.push(r),o&&(r=JSON.parse(JSON.stringify(r)),r.fec={ssrc:t,mechanism:a?"red+ulpfec":"red"},n.push(r))}}),0===n.length&&c&&n.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(0===l[0].indexOf("b=TIAS:")?l=parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")&&(l=parseInt(l[0].substr(5),10)),n.forEach(function(e){e.maxBitrate=l})),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return t=n[0].substr(7).split(" "),{stream:t[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?(t=i[0].value.split(" "),{stream:t[0],track:t[1]}):void 0},r.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",o+=e.direction?"a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){var t=r.splitLines(e),n=t[0].split(" ");return n[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.exports=r},{}],231:[function(e,t,n){function r(e,t){this._block=i.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}var i=e("safe-buffer").Buffer;r.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=i.from(e,t));for(var n=this._block,r=this._blockSize,o=e.length,a=this._len,s=0;o>s;){for(var c=a%r,u=Math.min(o-s,r-c),l=0;u>l;l++)n[c+l]=e[s+l];a+=u,s+=u,a%r===0&&this._update(n)}return this._len+=o,this},r.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(4294967295>=n)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var o=this._hash();return e?o.toString(e):o},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=r},{"safe-buffer":211}],232:[function(e,t,n){var n=t.exports=function(e){e=e.toLowerCase();var t=n[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};n.sha=e("./sha"),n.sha1=e("./sha1"),n.sha224=e("./sha224"),n.sha256=e("./sha256"),n.sha384=e("./sha384"),n.sha512=e("./sha512")},{"./sha":233,"./sha1":234,"./sha224":235,"./sha256":236,"./sha384":237,"./sha512":238}],233:[function(e,t,n){function r(){this.init(),this._w=d,c.call(this,64,56)}function i(e){return e<<5|e>>>27}function o(e){return e<<30|e>>>2}function a(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}var s=e("inherits"),c=e("./hash"),u=e("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],d=new Array(80);s(r,c),r.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},r.prototype._update=function(e){for(var t=this._w,n=0|this._a,r=0|this._b,s=0|this._c,c=0|this._d,u=0|this._e,d=0;16>d;++d)t[d]=e.readInt32BE(4*d);for(;80>d;++d)t[d]=t[d-3]^t[d-8]^t[d-14]^t[d-16];for(var p=0;80>p;++p){var f=~~(p/20),h=i(n)+a(f,r,s,c)+u+t[p]+l[f]|0;u=c,c=s,s=o(r),r=n,n=h}this._a=n+this._a|0,this._b=r+this._b|0,this._c=s+this._c|0,this._d=c+this._d|0,this._e=u+this._e|0},r.prototype._hash=function(){var e=u.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=r},{"./hash":231,inherits:46,"safe-buffer":211}],234:[function(e,t,n){function r(){this.init(),this._w=p,u.call(this,64,56)}function i(e){return e<<1|e>>>31}function o(e){return e<<5|e>>>27}function a(e){return e<<30|e>>>2}function s(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}var c=e("inherits"),u=e("./hash"),l=e("safe-buffer").Buffer,d=[1518500249,1859775393,-1894007588,-899497514],p=new Array(80);c(r,u),r.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},r.prototype._update=function(e){for(var t=this._w,n=0|this._a,r=0|this._b,c=0|this._c,u=0|this._d,l=0|this._e,p=0;16>p;++p)t[p]=e.readInt32BE(4*p);for(;80>p;++p)t[p]=i(t[p-3]^t[p-8]^t[p-14]^t[p-16]);for(var f=0;80>f;++f){var h=~~(f/20),m=o(n)+s(h,r,c,u)+l+t[f]+d[h]|0;l=u,u=c,c=a(r),r=n,n=m}this._a=n+this._a|0,this._b=r+this._b|0,this._c=c+this._c|0,this._d=u+this._d|0,this._e=l+this._e|0},r.prototype._hash=function(){var e=l.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},t.exports=r},{"./hash":231,inherits:46,"safe-buffer":211}],235:[function(e,t,n){function r(){this.init(),this._w=c,a.call(this,64,56)}var i=e("inherits"),o=e("./sha256"),a=e("./hash"),s=e("safe-buffer").Buffer,c=new Array(64);i(r,o),r.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},r.prototype._hash=function(){var e=s.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},t.exports=r},{"./hash":231,"./sha256":236,inherits:46,"safe-buffer":211}],236:[function(e,t,n){function r(){this.init(),this._w=h,d.call(this,64,56)}function i(e,t,n){return n^e&(t^n)}function o(e,t,n){return e&t|n&(e|t)}function a(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function s(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function c(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}function u(e){return(e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10}var l=e("inherits"),d=e("./hash"),p=e("safe-buffer").Buffer,f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],h=new Array(64);l(r,d),r.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},r.prototype._update=function(e){for(var t=this._w,n=0|this._a,r=0|this._b,l=0|this._c,d=0|this._d,p=0|this._e,h=0|this._f,m=0|this._g,v=0|this._h,g=0;16>g;++g)t[g]=e.readInt32BE(4*g);for(;64>g;++g)t[g]=u(t[g-2])+t[g-7]+c(t[g-15])+t[g-16]|0;for(var y=0;64>y;++y){var _=v+s(p)+i(p,h,m)+f[y]+t[y]|0,S=a(n)+o(n,r,l)|0;v=m,m=h,h=p,p=d+_|0,d=l,l=r,r=n,n=_+S|0}this._a=n+this._a|0,this._b=r+this._b|0,this._c=l+this._c|0,this._d=d+this._d|0,this._e=p+this._e|0,this._f=h+this._f|0,this._g=m+this._g|0,this._h=v+this._h|0},r.prototype._hash=function(){var e=p.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},t.exports=r},{"./hash":231,inherits:46,"safe-buffer":211}],237:[function(e,t,n){function r(){this.init(),this._w=c,a.call(this,128,112)}var i=e("inherits"),o=e("./sha512"),a=e("./hash"),s=e("safe-buffer").Buffer,c=new Array(160);i(r,o),r.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},r.prototype._hash=function(){function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}var t=s.allocUnsafe(48);return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t},t.exports=r},{"./hash":231,"./sha512":238,inherits:46,"safe-buffer":211}],238:[function(e,t,n){function r(){this.init(),this._w=g,h.call(this,128,112)}function i(e,t,n){return n^e&(t^n)}function o(e,t,n){return e&t|n&(e|t)}function a(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function s(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function c(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function u(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function l(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function d(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function p(e,t){return t>>>0>e>>>0?1:0}var f=e("inherits"),h=e("./hash"),m=e("safe-buffer").Buffer,v=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],g=new Array(160);f(r,h),r.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},r.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,f=0|this._ch,h=0|this._dh,m=0|this._eh,g=0|this._fh,y=0|this._gh,_=0|this._hh,S=0|this._al,b=0|this._bl,C=0|this._cl,w=0|this._dl,E=0|this._el,R=0|this._fl,P=0|this._gl,x=0|this._hl,T=0;32>T;T+=2)t[T]=e.readInt32BE(4*T),t[T+1]=e.readInt32BE(4*T+4);for(;160>T;T+=2){var L=t[T-30],O=t[T-30+1],I=c(L,O),M=u(O,L);L=t[T-4],O=t[T-4+1];var A=l(L,O),D=d(O,L),k=t[T-14],j=t[T-14+1],N=t[T-32],V=t[T-32+1],U=M+j|0,B=I+k+p(U,M)|0;U=U+D|0,B=B+A+p(U,D)|0,U=U+V|0,B=B+N+p(U,V)|0,t[T]=B,t[T+1]=U}for(var F=0;160>F;F+=2){B=t[F],U=t[F+1];var G=o(n,r,f),q=o(S,b,C),J=a(n,S),W=a(S,n),z=s(m,E),H=s(E,m),X=v[F],Y=v[F+1],$=i(m,g,y),Q=i(E,R,P),K=x+H|0,Z=_+z+p(K,x)|0;K=K+Q|0,Z=Z+$+p(K,Q)|0,K=K+Y|0,Z=Z+X+p(K,Y)|0,K=K+U|0,Z=Z+B+p(K,U)|0;var ee=W+q|0,te=J+G+p(ee,W)|0;_=y,x=P,y=g,P=R,g=m,R=E,E=w+K|0,m=h+Z+p(E,w)|0,h=f,w=C,f=r,C=b,r=n,b=S,S=K+ee|0,n=Z+te+p(S,K)|0}this._al=this._al+S|0,this._bl=this._bl+b|0,this._cl=this._cl+C|0,this._dl=this._dl+w|0,this._el=this._el+E|0,this._fl=this._fl+R|0,this._gl=this._gl+P|0,this._hl=this._hl+x|0,this._ah=this._ah+n+p(this._al,S)|0,this._bh=this._bh+r+p(this._bl,b)|0,this._ch=this._ch+f+p(this._cl,C)|0,this._dh=this._dh+h+p(this._dl,w)|0,this._eh=this._eh+m+p(this._el,E)|0,this._fh=this._fh+g+p(this._fl,R)|0,this._gh=this._gh+y+p(this._gl,P)|0,this._hh=this._hh+_+p(this._hl,x)|0},r.prototype._hash=function(){function e(e,n,r){t.writeInt32BE(e,r),t.writeInt32BE(n,r+4)}var t=m.allocUnsafe(64);return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t},t.exports=r},{"./hash":231,inherits:46,"safe-buffer":211}],239:[function(e,t,n){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.shortNumber=r()}(this,function(e){"use strict";return function(e){if("number"!=typeof e)throw new TypeError("Expected a number");if(e>1e19)throw new RangeError("Input expected to be < 1e19");if(-1e19>e)throw new RangeError("Input expected to be > 1e19");if(Math.abs(e)<1e3)return e;var t,n,r,i=0>e?"-":"",o={K:6,M:9,B:12,T:16};e=Math.abs(e),r=e.toString().length,n=r%3===0?r-3:r-r%3,t=Math.round(10*(e/Math.pow(10,n)))/10;for(var a in o)if(n<o[a]){t+=a;break}return i+t}})},{}],240:[function(e,t,n){"use strict";n.VERSION="8.1.1",n.JID=e("xmpp-jid").JID,n.Client=e("./lib/client"),n.createClient=function(t){var r=new n.Client(t);return r.use(e("./lib/plugins")),r}},{"./lib/client":241,"./lib/plugins":264,"xmpp-jid":336}],241:[function(e,t,n){"use strict";function r(e,t,n){var r;return Promise.race([e,new Promise(function(e,i){r=setTimeout(function(){i({id:t,type:"error",error:{condition:"timeout"}})},n)})]).then(function(e){return clearTimeout(r),e})}function i(t){var n=this;u.call(this),t=t||{},this._initConfig(t),this.stanzas=c.getGlobalJXT(),this.jid=new p,this.stanzas=c.createRegistry(),this.stanzas.use(e("jxt-xmpp-types")),this.stanzas.use(e("jxt-xmpp")),this.use(e("./plugins/features")),this.use(e("./plugins/sasl")),this.use(e("./plugins/smacks")),this.use(e("./plugins/bind")),this.use(e("./plugins/session")),this.sm=new f(this),this.transports={},this.on("stream:data",function(e){var t=e.toJSON();if("iq"===e._name&&(t._xmlChildCount=0,o(e.xml.childNodes,function(e){1===e.nodeType&&(t._xmlChildCount+=1)})),n.emit(e._eventname||e._name,t),"message"===e._name||"presence"===e._name||"iq"===e._name)n.sm.handle(t),n.emit("stanza",t);else{if("smAck"===e._name)return n.sm.process(t);if("smRequest"===e._name)return n.sm.ack()}t.id&&(n.emit("id:"+t.id,t),n.emit(e._name+":id:"+t.id,t))}),this.on("disconnected",function(){n.transport&&(n.transport.off("*"),delete n.transport),n.releaseGroup("connection")}),this.on("iq",function(e){var t=e.type,r=e._xmlChildCount;delete e._xmlChildCount;var i=Object.keys(e).filter(function(e){return"id"!==e&&"to"!==e&&"from"!==e&&"lang"!==e&&"type"!==e&&"errorReply"!==e&&"resultReply"!==e});if("get"===e.type||"set"===e.type){if(1!==r)return n.sendIq(e.errorReply({error:{type:"modify",condition:"bad-request"}}));if(!i.length)return n.sendIq(e.errorReply({error:{type:"cancel",condition:"feature-not-implemented"}}));var o="iq:"+t+":"+i[0];n.callbacks[o]?n.emit(o,e):n.sendIq(e.errorReply({error:{type:"cancel",condition:"feature-not-implemented"}}))}}),this.on("message",function(e){Object.keys(e.$body||{}).length&&("chat"===e.type||"normal"===e.type?n.emit("chat",e):"groupchat"===e.type&&n.emit("groupchat",e)),"error"===e.type&&n.emit("message:error",e)}),this.on("presence",function(e){var t=e.type||"available";"error"===t&&(t="presence:error"),n.emit(t,e)})}var o=e("lodash.foreach"),a=e("lodash.assign"),s=e("lodash.isarray"),c=e("jxt"),u=e("wildemitter"),l=e("util"),d=e("uuid"),p=e("xmpp-jid").JID,f=e("./sm"),h=e("hostmeta"),m=e("saslmechanisms"),v={external:e("sasl-external"),"scram-sha-1":e("sasl-scram-sha-1"),"digest-md5":e("alt-sasl-digest-md5"),"x-oauth2":e("sasl-x-oauth2"),plain:e("sasl-plain"),anonymous:e("sasl-anonymous")};l.inherits(i,u),Object.defineProperty(i.prototype,"stream",{get:function(){return this.transport?this.transport.stream:void 0}}),i.prototype._initConfig=function(e){var t=this,n=this.config||{};this.config=a({useStreamManagement:!0,transports:["websocket","bosh"],sasl:["external","scram-sha-1","digest-md5","plain","anonymous"]},n,e),s(this.config.sasl)||(this.config.sasl=[this.config.sasl]),this.SASLFactory=new m,this.config.sasl.forEach(function(e){if("string"==typeof e){var n=v[e.toLowerCase()];n&&t.SASLFactory.use(n)}else t.SASLFactory.use(e)}),this.config.jid=new p(this.config.jid),this.config.server||(this.config.server=this.config.jid.domain),this.config.password&&(this.config.credentials=this.config.credentials||{},this.config.credentials.password=this.config.password,delete this.config.password),this.config.transport&&(this.config.transports=[this.config.transport]),s(this.config.transports)||(this.config.transports=[this.config.transports])},i.prototype.use=function(e){e(this,this.stanzas,this.config)},i.prototype.nextId=function(){return d.v4()},i.prototype.discoverBindings=function(e,t){h(e,function(e,n){if(e)return t(e,[]);var r={websocket:[],bosh:[]},i=n.links||[];i.forEach(function(e){e.href&&"urn:xmpp:alt-connections:websocket"===e.rel&&r.websocket.push(e.href),e.href&&"urn:xmpp:altconnect:websocket"===e.rel&&r.websocket.push(e.href),e.href&&"urn:xmpp:alt-connections:xbosh"===e.rel&&r.bosh.push(e.href),e.href&&"urn:xmpp:altconnect:bosh"===e.rel&&r.bosh.push(e.href)}),t(!1,r)})},i.prototype._getConfiguredCredentials=function(){var e=this.config.credentials||{},t=new p(this.config.jid),n=e.username||t.local,r=e.server||t.domain,i={username:n,password:this.config.password,server:r,host:r,realm:r,serviceType:"xmpp",serviceName:r},o=a(i,e);return o},i.prototype.getCredentials=function(e){return e(null,this._getConfiguredCredentials())},i.prototype.connect=function(t,n){var r=this;if(this._initConfig(t),n||1!==r.config.transports.length||(n={},n.name=r.config.transports[0]),n&&n.name){("websocket"===n.name||"old-websocket"===n.name)&&(this.use(e("./plugins/websocket")),this.use(e("./plugins/oldwebsocket"))),"bosh"===n.name&&this.use(e("./plugins/bosh"));var i=r.transport=new r.transports[n.name](r.sm,r.stanzas);return i.on("*",function(e,t){r.emit(e,t)}),i.connect(r.config)}return r.discoverBindings(r.config.server,function(e,t){if(e)return console.error("Could not find https://"+r.config.server+"/.well-known/host-meta file to discover connection endpoints for the requested transports."),r.disconnect();for(var n=0,i=r.config.transports.length;i>n;n++){var o=r.config.transports[n];console.log("Checking for %s endpoints",o);for(var a=0,s=(t[o]||[]).length;s>a;a++){var c=t[o][a];if(0===c.indexOf("wss://")||0===c.indexOf("https://"))return"websocket"===o?r.config.wsURL=c:r.config.boshURL=c,console.log("Using %s endpoint: %s",o,c),r.connect(null,{name:o,url:c});console.warn("Discovered unencrypted %s endpoint (%s). Ignoring",o,c)}}return console.error("No endpoints found for the requested transports."),r.disconnect()})},i.prototype.disconnect=function(){this.sessionStarted&&(this.releaseGroup("session"),this.sm.started||this.emit("session:end")),this.sessionStarted=!1,this.releaseGroup("connection"),this.transport?this.transport.disconnect():this.emit("disconnected")},i.prototype.send=function(e){this.sm.track(e),this.transport&&this.transport.send(e)},i.prototype.sendMessage=function(e){e=e||{},e.id||(e.id=this.nextId());var t=this.stanzas.getMessage(),n=new t(e);return this.emit("message:sent",n.toJSON()),this.send(n),e.id},i.prototype.sendPresence=function(e){e=e||{},e.id||(e.id=this.nextId());var t=this.stanzas.getPresence();return this.send(new t(e)),e.id},i.prototype.sendIq=function(e,t){var n,i,o,a,s=this;e=e||{},e.id||(e.id=this.nextId());var c=this.stanzas.getIq(),u=e.toJSON?e:new c(e);return"error"===e.type||"result"===e.type?void this.send(u):(a=new p(e.to),o={},o[""]=!0,o[a.full]=!0,o[a.bare]=!0,o[a.domain]=!0,o[s.jid.bare]=!0,o[s.jid.domain]=!0,i="iq:id:"+e.id,n=new Promise(function(e,t){var n=function(r){o[r.from.full]&&("result"===r.type||"error"===r.type)&&(s.off(i,n),r.error?t(r):e(r))};s.on(i,"session",n)}),this.send(u),r(n,e.id,1e3*(s.config.timeout||15)).then(function(e){return t&&t(null,e),e},function(e){if(t)return t(e);throw e}))},i.prototype.sendStreamError=function(e){e=e||{};var t=this.stanzas.getStreamError(),n=new t(e);this.emit("stream:error",n.toJSON()),this.send(n),this.disconnect()},t.exports=i},{"./plugins/bind":244,"./plugins/bosh":248,"./plugins/features":259,"./plugins/oldwebsocket":275,"./plugins/sasl":286,"./plugins/session":287,"./plugins/smacks":289,"./plugins/websocket":293,"./sm":294,"alt-sasl-digest-md5":1,hostmeta:40,jxt:143,"jxt-xmpp":104,"jxt-xmpp-types":77,"lodash.assign":163,"lodash.foreach":166,"lodash.isarray":168,"sasl-anonymous":213,"sasl-external":215,"sasl-plain":217,"sasl-scram-sha-1":218,"sasl-x-oauth2":222,saslmechanisms:224,util:309,uuid:300,wildemitter:328,"xmpp-jid":336}],242:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:attention:0"),e.getAttention=function(t,n){n=n||{},n.to=t,n.type="headline",n.attention=!0,e.sendMessage(n)},e.on("message",function(t){t.attention&&e.emit("attention",t)})}},{}],243:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:avatar:metadata+notify"),e.on("pubsub:event",function(t){t.event.updated&&"urn:xmpp:avatar:metadata"===t.event.updated.node&&e.emit("avatar",{jid:t.from,source:"pubsub",avatars:t.event.updated.published[0].avatars})}),e.on("presence",function(t){t.avatarId&&e.emit("avatar",{jid:t.from,source:"vcard",avatars:[{id:t.avatarId}]})}),e.publishAvatar=function(e,t,n){return this.publish("","urn:xmpp:avatar:data",{id:e,avatarData:t},n)},e.useAvatars=function(e,t){return this.publish("","urn:xmpp:avatar:metadata",{id:"current",avatars:e},t)},e.getAvatar=function(e,t,n){return this.getItem(e,"urn:xmpp:avatar:data",t,n)}}},{}],244:[function(e,t,n){"use strict";var r=e("xmpp-jid").JID;t.exports=function(e,t,n){e.registerFeature("bind",300,function(e,t){var r=this;r.sendIq({type:"set",bind:{resource:n.resource}},function(n,i){if(n)return r.emit("session:error",n),t("disconnect","JID binding failed");r.features.negotiated.bind=!0,r.emit("session:prebind",i.bind.jid);var o=!e.session||e.session&&e.session.optional;return!r.sessionStarted&&o&&r.emit("session:started",r.jid),t()})}),e.on("session:started",function(){e.sessionStarted=!0}),e.on("session:prebind",function(t){e.jid=new r(t),e.emit("session:bound",e.jid)}),e.on("disconnected",function(){e.sessionStarted=!1,e.features.negotiated.bind=!1})}},{"xmpp-jid":336}],245:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:blocking"),e.block=function(t,n){return e.sendIq({type:"set",block:{jids:[t]}},n)},e.unblock=function(t,n){return e.sendIq({
type:"set",unblock:{jids:[t]}},n)},e.getBlocked=function(t){return e.sendIq({type:"get",blockList:!0},t)},e.on("iq:set:block",function(t){e.emit("block",{jids:t.block.jids||[]}),e.sendIq(t.resultReply())}),e.on("iq:set:unblock",function(t){e.emit("unblock",{jids:t.unblock.jids||[]}),e.sendIq(t.resultReply())})}},{}],246:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:bob"),e.getBits=function(t,n,r){return e.sendIq({to:t,type:"get",bob:{cid:n}},r)}}},{}],247:[function(e,t,n){"use strict";var r=e("lodash.assign"),i=e("lodash.filter"),o=e("xmpp-jid").JID;t.exports=function(e){e.getBookmarks=function(e){return this.getPrivateData({bookmarks:!0},e)},e.setBookmarks=function(e,t){return this.setPrivateData({bookmarks:e},t)},e.addBookmark=function(t,n){return t.jid=new o(t.jid),this.getBookmarks().then(function(n){var o=n.privateStorage.bookmarks.conferences||[],a=i(o,function(e){return e.jid.bare===t.jid.bare});return a.length?r(a[0],t):o.push(t),e.setBookmarks({conferences:o})}).then(function(e){return n&&n(null,e),e},function(e){if(!n)throw e;n(e)})},e.removeBookmark=function(t,n){return t=new o(t),this.getBookmarks().then(function(n){var r=n.privateStorage.bookmarks.conferences||[];return r=i(r,function(e){return t.bare!==e.jid.bare}),e.setBookmarks({conferences:r})}).then(function(e){n&&n(null,e)},function(e){if(!n)throw e;n(e)})}}},{"lodash.assign":163,"lodash.filter":165,"xmpp-jid":336}],248:[function(e,t,n){"use strict";var r=e("../transports/bosh");t.exports=function(e){e.transports.bosh=r}},{"../transports/bosh":295}],249:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:carbons:2"),e.enableCarbons=function(e){return this.sendIq({type:"set",enableCarbons:!0},e)},e.disableCarbons=function(e){return this.sendIq({type:"set",disableCarbons:!0},e)},e.on("message",function(t){return t.carbonSent?e.emit("carbon:sent",t):t.carbonReceived?e.emit("carbon:received",t):void 0}),e.on("carbon:*",function(t,n){var r=t.split(":")[1];if(n.from.bare===e.jid.bare){var i,o;"received"===r?(i=n.carbonReceived.forwarded.message,o=n.carbonReceived.forwarded.delay):(i=n.carbonSent.forwarded.message,o=n.carbonSent.forwarded.delay),i.delay||(i.delay={stamp:o?o.stamp:new Date(Date.now())}),i.carbon=!0,i.from.bare===e.jid.bare?e.emit("message:sent",i):e.emit("message",i)}})}},{}],250:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("http://jabber.org/protocol/chatstates"),e.on("message",function(t){t.chatState&&(e.emit("chat:state",{to:t.to,from:t.from,chatState:t.chatState}),e.emit("chatState",{to:t.to,from:t.from,chatState:t.chatState}))})}},{}],251:[function(e,t,n){"use strict";var r="http://jabber.org/protocol/commands";t.exports=function(e){e.disco.addFeature(r),e.disco.addItem({name:"Ad-Hoc Commands",node:r}),e.getCommands=function(t,n){return e.getDiscoItems(t,r,n)}}},{}],252:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:message-correct:0"),e.on("message",function(t){t.replace&&(e.emit("replace",t),e.emit("replace:"+t.id,t))})}},{}],253:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t.getDefinition("active","urn:xmpp:csi"),r=t.getDefinition("inactive","urn:xmpp:csi");e.registerFeature("clientStateIndication",400,function(e,t){this.features.negotiated.clientStateIndication=!0,t()}),e.markActive=function(){this.features.negotiated.clientStateIndication&&this.send(new n)},e.markInactive=function(){this.features.negotiated.clientStateIndication&&this.send(new r)}}},{}],254:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("jabber:x:data"),e.disco.addFeature("urn:xmpp:media-element"),e.disco.addFeature("http://jabber.org/protocol/xdata-validate"),e.disco.addFeature("http://jabber.org/protocol/xdata-layout"),e.on("message",function(t){t.form&&e.emit("dataform",t)})}},{}],255:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:delay")}},{}],256:[function(e,t,n){(function(n){"use strict";function r(e,t){var r="",i=e.features.sort(),o=[],c={},l=[];a(e.identities,function(e){o.push([e.category||"",e.type||"",e.lang||"",e.name||""].join("/"))}),o.sort();var d=o.length,p=i.length;if(o=s(o,!0),i=s(i,!0),p!==i.length||d!==o.length)return!1;r+=o.join("<")+"<",r+=i.join("<")+"<";var f=!1;if(a(e.extensions,function(e){for(var t=e.fields,n=0,r=t.length;r>n;n++)if("FORM_TYPE"===t[n].name&&"hidden"===t[n].type){var i=t[n].value;return c[i]?void(f=!0):(c[i]=e,void l.push(i))}}),f)return!1;l.sort(),a(l,function(e){var t=c[e],n={},i=[];r+="<"+e,a(t.fields,function(e){var t=e.name;if("FORM_TYPE"!==t){var r=e.value||"";"object"!=typeof r&&(r=r.split("\n")),n[t]=r.sort(),i.push(t)}}),i.sort(),a(i,function(e){r+="<"+e,a(n[e],function(e){r+="<"+e})})});var h=u.createHash(t).update(new n(r,"utf8")).digest("base64"),m=4-h.length%4;4===m&&(m=0);for(var v=0;m>v;v++)h+="=";return h}function i(e,t,n){var i=r(e,t);return i&&i===n}function o(){this.features={},this.identities={},this.extensions={},this.items={},this.caps={}}var a=e("lodash.foreach"),s=e("lodash.uniq"),c=e("xmpp-jid").JID,u=e("iana-hashes");o.prototype={constructor:{value:o},addFeature:function(e,t){t=t||"",this.features[t]||(this.features[t]=[]),this.features[t].push(e)},addIdentity:function(e,t){t=t||"",this.identities[t]||(this.identities[t]=[]),this.identities[t].push(e)},addItem:function(e,t){t=t||"",this.items[t]||(this.items[t]=[]),this.items[t].push(e)},addExtension:function(e,t){t=t||"",this.extensions[t]||(this.extensions[t]=[]),this.extensions[t].push(e)}},t.exports=function(e){e.disco=new o(e),e.disco.addFeature("http://jabber.org/protocol/disco#info"),e.disco.addFeature("http://jabber.org/protocol/disco#items"),e.disco.addIdentity({category:"client",type:"web"}),e.registerFeature("caps",100,function(t,n){this.emit("disco:caps",{from:new c(e.jid.domain||e.config.server),caps:t.caps}),this.features.negotiated.caps=!0,n()}),e.getDiscoInfo=function(e,t,n){return this.sendIq({to:e,type:"get",discoInfo:{node:t}},n)},e.getDiscoItems=function(e,t,n){return this.sendIq({to:e,type:"get",discoItems:{node:t}},n)},e.updateCaps=function(){var t=this.config.capsNode||"https://stanza.io",n=JSON.parse(JSON.stringify({identities:this.disco.identities[""],features:this.disco.features[""],extensions:this.disco.extensions[""]})),i=r(n,"sha-1");return this.disco.caps={node:t,hash:"sha-1",ver:i},t=t+"#"+i,this.disco.features[t]=n.features,this.disco.identities[t]=n.identities,this.disco.extensions[t]=n.extensions,e.getCurrentCaps()},e.getCurrentCaps=function(){var t=e.disco.caps;if(!t.ver)return{ver:null,discoInfo:null};var n=t.node+"#"+t.ver;return{ver:t.ver,discoInfo:{identities:e.disco.identities[n],features:e.disco.features[n],extensions:e.disco.extensions[n]}}},e.on("presence",function(t){t.caps&&e.emit("disco:caps",t)}),e.on("iq:get:discoInfo",function(t){var n=t.discoInfo.node||"",r=t.discoInfo.node||"";n===e.disco.caps.node+"#"+e.disco.caps.ver&&(r=n,n=""),e.sendIq(t.resultReply({discoInfo:{node:r,identities:e.disco.identities[n]||[],features:e.disco.features[n]||[],extensions:e.disco.extensions[n]||[]}}))}),e.on("iq:get:discoItems",function(t){var n=t.discoItems.node;e.sendIq(t.resultReply({discoItems:{node:n,items:e.disco.items[n]||[]}}))}),e.verifyVerString=i,e.generateVerString=r,e.updateCaps()}}).call(this,e("buffer").Buffer)},{buffer:9,"iana-hashes":43,"lodash.foreach":166,"lodash.uniq":173,"xmpp-jid":336}],257:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("jid\\20escaping")}},{}],258:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:extdisco:1"),e.getServices=function(e,t,n){return this.sendIq({type:"get",to:e,services:{type:t}},n)},e.getServiceCredentials=function(e,t,n){return this.sendIq({type:"get",to:e,credentials:{service:{host:t}}},n)}}},{}],259:[function(e,t,n){"use strict";var r=e("async");t.exports=function(e){e.features={negotiated:{},order:[],handlers:{}},e.registerFeature=function(t,n,r){this.features.order.push({priority:n,name:t}),this.features.order.sort(function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}),this.features.handlers[t]=r.bind(e)},e.on("streamFeatures",function(t){var n=[],i=e.features.negotiated,o=e.features.handlers;e.features.order.forEach(function(e){var r=e.name;t[r]&&o[r]&&!i[r]&&n.push(function(e){i[r]?e():o[r](t,e)})}),r.series(n,function(t,n){"restart"===t?e.transport.restart():"disconnect"===t&&(e.emit("stream:error",{condition:"policy-violation",text:"Failed to negotiate stream features: "+n}),e.disconnect())})})}},{async:298}],260:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:forward:0")}},{}],261:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("http://jabber.org/protocol/geoloc"),e.disco.addFeature("http://jabber.org/protocol/geoloc+notify"),e.on("pubsub:event",function(t){t.event.updated&&"http://jabber.org/protocol/geoloc"===t.event.updated.node&&e.emit("geoloc",{jid:t.from,geoloc:t.event.updated.published[0].geoloc})}),e.publishGeoLoc=function(e,t){return this.publish("","http://jabber.org/protocol/geoloc",{geoloc:e},t)}}},{}],262:[function(e,t,n){"use strict";var r=e("iana-hashes");t.exports=function(e){e.disco.addFeature("urn:xmpp:hashes:1");var t=r.getHashes();t.forEach(function(t){e.disco.addFeature("urn:xmpp:hash-function-text-names:"+t)})}},{"iana-hashes":43}],263:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:idle:1")}},{}],264:[function(e,t,n){"use strict";t.exports=function(t){t.use(e("./disco")),t.use(e("./attention")),t.use(e("./avatar")),t.use(e("./blocking")),t.use(e("./bob")),t.use(e("./bookmarks")),t.use(e("./carbons")),t.use(e("./chatstates")),t.use(e("./command")),t.use(e("./correction")),t.use(e("./csi")),t.use(e("./dataforms")),t.use(e("./delayed")),t.use(e("./escaping")),t.use(e("./extdisco")),t.use(e("./forwarding")),t.use(e("./geoloc")),t.use(e("./hashes")),t.use(e("./idle")),t.use(e("./invisible")),t.use(e("./jidprep")),t.use(e("./jingle")),t.use(e("./json")),t.use(e("./keepalive")),t.use(e("./logging")),t.use(e("./mam")),t.use(e("./muc")),t.use(e("./mood")),t.use(e("./nick")),t.use(e("./oob")),t.use(e("./ping")),t.use(e("./private")),t.use(e("./psa")),t.use(e("./pubsub")),t.use(e("./reach")),t.use(e("./receipts")),t.use(e("./register")),t.use(e("./roster")),t.use(e("./rtt")),t.use(e("./shim")),t.use(e("./time")),t.use(e("./vcard")),t.use(e("./version"))}},{"./attention":242,"./avatar":243,"./blocking":245,"./bob":246,"./bookmarks":247,"./carbons":249,"./chatstates":250,"./command":251,"./correction":252,"./csi":253,"./dataforms":254,"./delayed":255,"./disco":256,"./escaping":257,"./extdisco":258,"./forwarding":260,"./geoloc":261,"./hashes":262,"./idle":263,"./invisible":265,"./jidprep":266,"./jingle":267,"./json":268,"./keepalive":269,"./logging":270,"./mam":271,"./mood":272,"./muc":273,"./nick":274,"./oob":276,"./ping":277,"./private":278,"./psa":279,"./pubsub":280,"./reach":281,"./receipts":282,"./register":283,"./roster":284,"./rtt":285,"./shim":288,"./time":290,"./vcard":291,"./version":292}],265:[function(e,t,n){"use strict";t.exports=function(e){e.goInvisible=function(e){return this.sendIq({type:"set",invisible:!0},e)},e.goVisible=function(e){return this.sendIq({type:"set",visible:!0},e)}}},{}],266:[function(e,t,n){"use strict";t.exports=function(e){e.prepJID=function(t,n){return e.sendIq({to:e.jid.domain,type:"get",jidPrep:t},n)}}},{}],267:[function(e,t,n){"use strict";var r=e("jingle");t.exports=function(e){var t=e.jingle=new r;t.capabilities.forEach(function(t){e.disco.addFeature(t)});var n=["outgoing","incoming","accepted","terminated","ringing","mute","unmute","hold","resumed"];n.forEach(function(n){t.on(n,function(t,r){e.emit("jingle:"+n,t,r)})}),t.on("createdSession",function(t){e.emit("jingle:created",t)}),t.on("peerStreamAdded",function(t,n){e.emit("jingle:remotestream:added",t,n)}),t.on("peerStreamRemoved",function(t,n){e.emit("jingle:remotestream:removed",t,n)}),t.on("send",function(t){e.sendIq(t,function(t){t&&e.emit("jingle:error",t)})}),e.on("session:bound",function(e){t.jid=e,t.selfID=e.full}),e.on("iq:set:jingle",function(e){t.process(e)}),e.on("unavailable",function(e){var n=e.from.full;t.endPeerSessions(n,!0)}),e.discoverICEServers=function(t){return this.getServices(e.config.server).then(function(t){for(var n=t.services.services,r=[],i=0;i<n.length;i++){var o=n[i],a={};"stun"===o.type||"stuns"===o.type?(a.url=o.type+":"+o.host,o.port&&(a.url+=":"+o.port),r.push(a),e.jingle.addICEServer(a)):("turn"===o.type||"turns"===o.type)&&(a.url=o.type+":"+o.host,o.port&&(a.url+=":"+o.port),o.transport&&"udp"!==o.transport&&(a.url+="?transport="+o.transport),o.username&&(a.username=o.username),o.password&&(a.credential=o.password),r.push(a),e.jingle.addICEServer(a))}return r}).then(function(e){return t&&t(null,e),e},function(e){if(!t)throw e;t(e)})}}},{jingle:75}],268:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:json:0")}},{}],269:[function(e,t,n){"use strict";function r(e,t){var n;return Promise.race([e,new Promise(function(e,r){n=setTimeout(function(){r()},t)})]).then(function(e){return clearTimeout(n),e})}function i(e,t){return r(new Promise(function(t,n){e.sm.started?(e.once("stream:management:ack",t),e.sm.request()):e.ping().then(t)["catch"](function(e){e.error&&"timeout"!==e.error.condition?t():n()})}),1e3*t||15e3)}t.exports=function(e){e.enableKeepAlive=function(t){function n(){e.sessionStarted&&i(e,t.timeout)["catch"](function(){e.emit("stream:error",{condition:"connection-timeout",text:"Server did not respond in "+t.timeout+" seconds"}),e.transport&&(e.transport.hasStream=!1,e.transport.disconnect())})}t=t||{},t.interval=t.interval||300,t.timeout=t.timeout||15,e._keepAliveInterval=setInterval(n,1e3*t.interval)},e.disableKeepAlive=function(){e._keepAliveInterval&&(clearInterval(e._keepAliveInterval),delete e._keepAliveInterval)},e.on("disconnected",function(){e.disableKeepAlive()})}},{}],270:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("","urn:xmpp:eventlog"),e.sendLog=function(t,n){e.sendMessage({to:t,type:"normal",log:n})}}},{}],271:[function(e,t,n){"use strict";function r(e,t,n){var r;return Promise.race([e,new Promise(function(e,i){r=setTimeout(function(){i({id:t,type:"error",error:{condition:"timeout"}})},n)})]).then(function(e){return clearTimeout(r),e})}var i=e("xmpp-jid").JID;t.exports=function(e){e.disco.addFeature("urn:xmpp:mam:0"),e.getHistorySearchForm=function(t,n){return e.sendIq({to:t,type:"get",mam:!0},n)},e.searchHistory=function(t,n){var o=this,a=this.nextId();t=t||{},t.queryid=a;var s=t.jid||t.to||"";delete t.jid,delete t.to,t.form||(t.form={}),t.form.type="submit";var c=t.form.fields=t.form.fields||[],u=["FORM_TYPE","with","start","end"];u.forEach(function(e){if(t[e]||"FORM_TYPE"===e){var n=t[e],r="start"===e||"end"===e;r&&"string"!=typeof n&&(n=n.toISOString()),"FORM_TYPE"===e&&(n="urn:xmpp:mam:0");for(var i=!1,o=0,a=c.length;a>o;o++)c[o].name!==e;i||c.push({name:e,value:n}),delete t[e]}});var l=new i(s||e.jid.bare),d={};d[""]=!0,d[l.full]=!0,d[l.bare]=!0,d[l.domain]=!0,d[e.jid.bare]=!0,d[e.jid.domain]=!0;var p=[];this.on("mam:item:"+a,"session",function(e){d[e.from.full]&&p.push(e.mamItem)});var f=new Promise(function(e){o.once("mam:result:"+a,"session",function(t){d[t.from.full]&&(t.mamResult.items=p,e(t))})}),h=this.sendIq({type:"set",to:s,id:a,mam:t});r(Promise.all([h,f]),a,1e3*o.config.timeout||15e3).then(function(e){var t=e[1];return o.off("mam:item:"+a),o.off("mam:result:"+a),n&&n(null,t),t},function(e){if(o.off("mam:item:"+a),o.off("mam:result:"+a),!n)throw e;n(e)})},e.getHistoryPreferences=function(e){return this.sendIq({type:"get",mamPrefs:!0},e)},e.setHistoryPreferences=function(e,t){return this.sendIq({type:"set",mamPrefs:e},t)},e.on("message",function(t){t.mamItem&&e.emit("mam:item:"+t.mamItem.queryid,t),t.mamResult&&e.emit("mam:result:"+t.mamResult.queryid,t)})}},{"xmpp-jid":336}],272:[function(e,t,n){"use strict";var r="http://jabber.org/protocol/mood";t.exports=function(e){e.disco.addFeature(r),e.disco.addFeature(r+"+notify"),e.on("pubsub:event",function(t){t.event.updated&&t.event.updated.node===r&&e.emit("mood",{jid:t.from,mood:t.event.updated.published[0].mood})}),e.publishMood=function(e,t,n){return this.publish("",r,{mood:{value:e,text:t}},n)}}},{}],273:[function(e,t,n){"use strict";var r=e("lodash.foreach"),i=e("xmpp-jid").JID;t.exports=function(e){function t(){r(e.joinedRooms,function(t,n){e.joinedRooms[n]=!1,e.joinRoom(n,t)})}e.disco.addFeature("http://jabber.org/protocol/muc"),e.disco.addFeature("jabber:x:conference"),e.disco.addFeature("urn:xmpp:hats:0"),e.joinedRooms={},e.on("session:started",t),e.on("stream:management:resumed",t),e.on("message",function(t){t.muc?(t.muc.invite&&e.emit("muc:invite",{from:t.muc.invite.from,room:t.from,reason:t.muc.invite.reason,password:t.muc.password,thread:t.muc.invite.thread,type:"mediated"}),t.muc.destroyed&&e.emit("muc:destroyed",{room:t.from,newRoom:t.muc.destroyed.jid,reason:t.muc.destroyed.reason,password:t.muc.destroyed.password}),t.muc.decline&&e.emit("muc:declined",{room:t.from,from:t.muc.decline.from,reason:t.muc.decline.reason})):t.mucInvite&&e.emit("muc:invite",{from:t.from,room:t.mucInvite.jid,reason:t.mucInvite.reason,password:t.mucInvite.password,thread:t.mucInvite.thread,type:"direct"}),"groupchat"===t.type&&t.subject&&e.emit("muc:subject",t)}),e.on("presence",function(t){if(t.joinMuc&&"error"===t.type)e.emit("muc:error",t);else if(t.muc){var n=t.muc.codes&&t.muc.codes.indexOf("110")>=0;"error"===t.type?e.emit("muc:error",t):"unavailable"===t.type?(e.emit("muc:unavailable",t),n&&(e.emit("muc:leave",t),delete e.joinedRooms[t.from.bare])):(e.emit("muc:available",t),n&&!e.joinedRooms[t.from.bare]&&(e.emit("muc:join",t),e.joinedRooms[t.from.bare]=t.from.resource))}}),e.joinRoom=function(e,t,n){n=n||{},n.to=e+"/"+t,n.caps=this.disco.caps,n.joinMuc=n.joinMuc||{},this.sendPresence(n)},e.leaveRoom=function(e,t,n){n=n||{},n.to=e+"/"+t,n.type="unavailable",this.sendPresence(n)},e.ban=function(t,n,r,i){e.setRoomAffiliation(t,n,"outcast",r,i)},e.kick=function(t,n,r,i){e.setRoomRole(t,n,"none",r,i)},e.invite=function(t,n){e.sendMessage({to:t,muc:{invites:n}})},e.directInvite=function(t,n){n.jid=t,e.sendMessage({to:n.to,mucInvite:n})},e.declineInvite=function(t,n,r){e.sendMessage({to:t,muc:{decline:{to:n,reason:r}}})},e.changeNick=function(t,n){e.sendPresence({to:new i(t).bare+"/"+n})},e.setSubject=function(t,n){e.sendMessage({to:t,type:"groupchat",subject:n})},e.discoverReservedNick=function(t,n){e.getDiscoInfo(t,"x-roomuser-item",function(e,t){if(e)return n(e);var r=t.discoInfo.identities[0]||{};n(null,r.name)})},e.requestRoomVoice=function(t){e.sendMessage({to:t,form:{fields:[{name:"FORM_TYPE",value:"http://jabber.org/protocol/muc#request"},{name:"muc#role",type:"text-single",value:"participant"}]}})},e.setRoomAffiliation=function(e,t,n,r,i){return this.sendIq({type:"set",to:e,mucAdmin:{jid:t,affiliation:n,reason:r}},i)},e.setRoomRole=function(e,t,n,r,i){return this.sendIq({type:"set",to:e,mucAdmin:{nick:t,role:n,reason:r}},i)},e.getRoomMembers=function(e,t,n){return this.sendIq({type:"get",to:e,mucAdmin:t},n)},e.getRoomConfig=function(e,t){return this.sendIq({to:e,type:"get",mucOwner:!0},t)},e.configureRoom=function(e,t,n){return t.type||(t.type="submit"),this.sendIq({to:e,type:"set",mucOwner:{form:t}},n)},e.destroyRoom=function(e,t,n){return this.sendIq({to:e,type:"set",mucOwner:{destroy:t}},n)},e.getUniqueRoomName=function(e,t){return this.sendIq({type:"get",to:e,mucUnique:!0},t)}}},{"lodash.foreach":166,"xmpp-jid":336}],274:[function(e,t,n){"use strict";var r="http://jabber.org/protocol/nick";t.exports=function(e){e.disco.addFeature(r),e.disco.addFeature(r+"+notify"),e.on("pubsub:event",function(t){t.event.updated&&t.event.updated.node===r&&e.emit("nick",{jid:t.from,nick:t.event.updated.published[0].nick})}),e.publishNick=function(e,t){return this.publish("",r,{nick:e},t)}}},{}],275:[function(e,t,n){"use strict";var r=e("../transports/old-websocket");t.exports=function(e){e.transports["old-websocket"]=r}},{"../transports/old-websocket":296}],276:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("jabber:x:oob")}},{}],277:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:ping"),e.on("iq:get:ping",function(t){e.sendIq(t.resultReply())}),e.ping=function(e,t){return this.sendIq({to:e,type:"get",ping:!0},t)}}},{}],278:[function(e,t,n){"use strict";t.exports=function(e){e.getPrivateData=function(e,t){return this.sendIq({type:"get",privateStorage:e},t)},e.setPrivateData=function(e,t){return this.sendIq({type:"set",privateStorage:e},t)}}},{}],279:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:psa")}},{}],280:[function(e,t,n){"use strict";t.exports=function(e){e.on("message",function(t){if(t.event){if(e.emit("pubsub:event",t),e.emit("pubsubEvent",t),t.event.updated){var n=t.event.updated.published,r=t.event.updated.retracted;n&&n.length&&e.emit("pubsub:published",t),r&&r.length&&e.emit("pubsub:retracted",t)}t.event.purged&&e.emit("pubsub:purged",t),t.event.deleted&&e.emit("pubsub:deleted",t),t.event.subscriptionChanged&&e.emit("pubsub:subscription",t),t.event.configurationChanged&&e.emit("pubsub:config",t)}t.pubsub&&t.pubsub.affiliations&&e.emit("pubsub:affiliation",t)}),e.subscribeToNode=function(t,n,r){return"string"==typeof n&&(n={node:n}),n.jid=n.jid||e.jid,this.sendIq({type:"set",to:t,pubsub:{subscribe:n}},r)},e.unsubscribeFromNode=function(t,n,r){return"string"==typeof n&&(n={node:n}),n.jid=n.jid||e.jid.bare,this.sendIq({type:"set",to:t,pubsub:{unsubscribe:n}},r)},e.publish=function(e,t,n,r){return this.sendIq({type:"set",to:e,pubsub:{publish:{node:t,item:n}}},r)},e.getItem=function(e,t,n,r){return this.sendIq({type:"get",to:e,pubsub:{retrieve:{node:t,item:n}}},r)},e.getItems=function(e,t,n,r){return n=n||{},n.node=t,this.sendIq({type:"get",to:e,pubsub:{retrieve:{node:t,max:n.max},rsm:n.rsm}},r)},e.retract=function(e,t,n,r,i){return this.sendIq({type:"set",to:e,pubsub:{retract:{node:t,notify:r,id:n}}},i)},e.purgeNode=function(e,t,n){return this.sendIq({type:"set",to:e,pubsubOwner:{purge:t}},n)},e.deleteNode=function(e,t,n){return this.sendIq({type:"set",to:e,pubsubOwner:{del:t}},n)},e.createNode=function(e,t,n,r){var i={type:"set",to:e,pubsub:{create:t}};return n&&(i.pubsub.config={form:n}),this.sendIq(i,r)},e.getSubscriptions=function(e,t,n){return t=t||{},this.sendIq({type:"get",to:e,pubsub:{subscriptions:t}},n)},e.getAffiliations=function(e,t,n){return t=t||{},this.sendIq({type:"get",to:e,pubsub:{affiliations:t}},n)},e.getNodeSubscribers=function(e,t,n,r){return n=n||{},n.node=t,this.sendIq({type:"get",to:e,pubsubOwner:{subscriptions:n}},r)},e.updateNodeSubscriptions=function(e,t,n,r){return this.sendIq({type:"set",to:e,pubsubOwner:{subscriptions:{node:t,list:n}}},r)},e.getNodeAffiliations=function(e,t,n,r){return n=n||{},n.node=t,this.sendIq({type:"get",to:e,pubsubOwner:{affiliations:n}},r)},e.updateNodeAffiliations=function(e,t,n,r){return this.sendIq({type:"set",to:e,pubsubOwner:{affiliations:{node:t,list:n}}},r)}}},{}],281:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:reach:0"),e.disco.addFeature("urn:xmpp:reach:0+notify"),e.on("pubsub:event",function(t){t.event.updated&&"urn:xmpp:reach:0"===t.event.updated.node&&e.emit("reachability",{jid:t.from,addresses:t.event.updated.published[0].reach})}),e.on("presence",function(t){t.reach&&t.reach.length&&e.emit("reachability",{jid:t.from,addresses:t.reach})}),e.publishReachability=function(e,t){return this.publish("","urn:xmpp:reach:0",{reach:e},t)}}},{}],282:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=n.sendReceipts!==!1;e.disco.addFeature("urn:xmpp:receipts"),e.on("message",function(t){var n={normal:!0,chat:!0,headline:!0};r&&n[t.type]&&t.requestReceipt&&!t.receipt&&e.sendMessage({to:t.from,type:t.type,receipt:t.id,id:t.id}),t.receipt&&(e.emit("receipt",t),e.emit("receipt:"+t.receipt))})}},{}],283:[function(e,t,n){"use strict";t.exports=function(e){e.getAccountInfo=function(e,t){return this.sendIq({type:"get",to:e,register:!0},t)},e.updateAccount=function(e,t,n){return this.sendIq({type:"set",to:e,register:t},n)},e.deleteAccount=function(e,t){return this.sendIq({type:"set",to:e,register:{remove:!0}},t)}}},{}],284:[function(e,t,n){"use strict";t.exports=function(e){e.on("iq:set:roster",function(t){var n={};return n[""]=!0,n[e.jid.bare]=!0,n[e.jid.domain]=!0,n[t.from.full]?(e.emit("roster:update",t),void e.sendIq({id:t.id,type:"result"})):e.sendIq(t.errorReply({error:{type:"cancel",condition:"service-unavailable"}}))}),e.getRoster=function(t){var n=this;return t=t||function(){},e.sendIq({type:"get",roster:{ver:n.config.rosterVer}}).then(function(e){if(e.roster){var t=e.roster.ver;t&&(n.config.rosterVer=t,n.emit("roster:ver",t))}return e}).then(function(e){return t&&t(null,e),e},function(e){if(!t)throw e;t(e)})},e.updateRosterItem=function(t,n){return e.sendIq({type:"set",roster:{items:[t]}},n)},e.removeRosterItem=function(t,n){return e.updateRosterItem({jid:t,subscription:"remove"},n)},e.subscribe=function(t){e.sendPresence({type:"subscribe",to:t})},e.unsubscribe=function(t){e.sendPresence({type:"unsubscribe",to:t})},e.acceptSubscription=function(t){e.sendPresence({type:"subscribed",to:t})},e.denySubscription=function(t){e.sendPresence({type:"unsubscribed",to:t})}}},{}],285:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:rtt:0"),e.on("message",function(t){t.rtt&&(e.emit("rtt",t),e.emit("rtt:"+t.rtt.event,t))})}},{}],286:[function(e,t,n){(function(e){"use strict";var n="urn:ietf:params:xml:ns:xmpp-sasl";t.exports=function(t,r){var i=r.getDefinition("auth",n),o=r.getDefinition("response",n),a=r.getDefinition("abort",n);t.registerFeature("sasl",100,function(t,n){var r=this,s=r.SASLFactory.create(t.sasl.mechanisms);if(!s)return r.releaseGroup("sasl"),r.emit("auth:failed"),n("disconnect","authentication failed");r.on("sasl:success","sasl",function(){r.features.negotiated.sasl=!0,r.releaseGroup("sasl"),r.emit("auth:success",r.config.credentials),n("restart")}),r.on("sasl:challenge","sasl",function(t){return s.challenge(new e(t.value,"base64").toString()),r.getCredentials(function(t,n){if(t)return r.send(new a);var i=s.response(n);r.send(i||""===i?new o({value:new e(i).toString("base64")}):new o),s.cache&&(Object.keys(s.cache).forEach(function(t){s.cache[t]&&(r.config.credentials[t]=new e(s.cache[t]))}),r.emit("credentials:update",r.config.credentials))})}),r.on("sasl:failure","sasl",function(){r.releaseGroup("sasl"),r.emit("auth:failed"),n("disconnect","authentication failed")}),r.on("sasl:abort","sasl",function(){r.releaseGroup("sasl"),r.emit("auth:failed"),n("disconnect","authentication failed")});var c={mechanism:s.name};return s.clientFirst?r.getCredentials(function(t,n){return t?r.send(new a):(c.value=new e(s.response(n)).toString("base64"),void r.send(new i(c)))}):void r.send(new i(c))}),t.on("disconnected",function(){t.features.negotiated.sasl=!1,t.releaseGroup("sasl")})}}).call(this,e("buffer").Buffer)},{buffer:9}],287:[function(e,t,n){"use strict";t.exports=function(e){e.registerFeature("session",1e3,function(e,t){var n=this;return e.session.optional||n.sessionStarted?(n.features.negotiated.session=!0,t()):void n.sendIq({type:"set",session:{}},function(e){return e?t("disconnect","session request failed"):(n.features.negotiated.session=!0,n.sessionStarted||(n.sessionStarted=!0,n.emit("session:started",n.jid)),void t())})}),e.on("disconnected",function(){e.sessionStarted=!1,e.features.negotiated.session=!1})}},{}],288:[function(e,t,n){"use strict";var r="http://jabber.org/protocol/shim";t.exports=function(e){e.disco.addFeature(r),e.disco.addFeature(r+"#SubID",r)}},{}],289:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=function(e,t){var r=this;return n.useStreamManagement?(r.on("stream:management:enabled","sm",function(e){r.sm.enabled(e),r.features.negotiated.streamManagement=!0,r.releaseGroup("sm"),t()}),r.on("stream:management:resumed","sm",function(e){r.sm.resumed(e),r.features.negotiated.streamManagement=!0,r.features.negotiated.bind=!0,r.sessionStarted=!0,r.releaseGroup("sm"),t("break")}),r.on("stream:management:failed","sm",function(){r.sm.failed(),r.emit("session:end"),r.releaseGroup("session"),r.releaseGroup("sm"),t()}),void(r.sm.id?r.sm.id&&r.sm.allowResume?r.sm.resume():(r.releaseGroup("sm"),t()):r.features.negotiated.bind?r.sm.enable():(r.releaseGroup("sm"),t()))):t()};e.on("disconnected",function(){e.features.negotiated.streamManagement=!1}),e.registerFeature("streamManagement",200,r),e.registerFeature("streamManagement",500,r)}},{}],290:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("urn:xmpp:time"),e.getTime=function(e,t){return this.sendIq({to:e,type:"get",time:!0},t)},e.on("iq:get:time",function(t){var n=new Date;e.sendIq(t.resultReply({time:{utc:n,tzo:n.getTimezoneOffset()}}))})}},{}],291:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("vcard-temp"),e.getVCard=function(e,t){return this.sendIq({to:e,type:"get",vCardTemp:!0},t)},e.publishVCard=function(e,t){return this.sendIq({type:"set",vCardTemp:e},t)}}},{}],292:[function(e,t,n){"use strict";t.exports=function(e){e.disco.addFeature("jabber:iq:version"),e.on("iq:get:version",function(t){e.sendIq(t.resultReply({version:e.config.softwareVersion||{name:"stanza.io"}}))}),e.getSoftwareVersion=function(e,t){return this.sendIq({to:e,type:"get",version:!0},t)}}},{}],293:[function(e,t,n){"use strict";var r=e("../transports/websocket");t.exports=function(e){e.transports.websocket=r}},{"../transports/websocket":297}],294:[function(e,t,n){"use strict";function r(e,t){return(e%t+t)%t}function i(e){this.client=e,this.id=!1,this.allowResume=!0,this.started=!1,this.inboundStarted=!1,this.outboundStarted=!1,this.lastAck=0,this.handled=0,this.windowSize=1,this.unacked=[],this.pendingAck=!1;var t="urn:xmpp:sm:3";this.stanzas={Enable:e.stanzas.getDefinition("enable",t),Resume:e.stanzas.getDefinition("resume",t),Ack:e.stanzas.getDefinition("a",t),Request:e.stanzas.getDefinition("r",t)}}var o=Math.pow(2,32);i.prototype={constructor:{value:i},enable:function(){var e=new this.stanzas.Enable;e.resume=this.allowResume,this.client.send(e),this.handled=0,this.outboundStarted=!0},resume:function(){var e=new this.stanzas.Resume({h:this.handled,previd:this.id});this.client.send(e),this.outboundStarted=!0},enabled:function(e){this.id=e.id,this.handled=0,this.inboundStarted=!0},resumed:function(e){this.id=e.previd,e.h&&this.process(e,!0),this.inboundStarted=!0},failed:function(){this.inboundStarted=!1,this.outboundStarted=!1,this.id=!1,this.lastAck=0,this.handled=0,this.unacked=[]},ack:function(){this.client.send(new this.stanzas.Ack({h:this.handled}))},request:function(){this.pendingAck=!0,this.client.send(new this.stanzas.Request)},process:function(e,t){var n=this,i=r(e.h-this.lastAck,o);this.pendingAck=!1;for(var a=0;i>a&&this.unacked.length>0;a++)this.client.emit("stanza:acked",this.unacked.shift());if(this.lastAck=e.h,t){var s=this.unacked;this.unacked=[],s.forEach(function(e){n.client.send(e)})}this.needAck()&&this.request()},track:function(e){var t=e._name,n={message:!0,presence:!0,iq:!0};this.outboundStarted&&n[t]&&(this.unacked.push(e),this.needAck()&&this.request())},handle:function(){this.inboundStarted&&(this.handled=r(this.handled+1,o))},needAck:function(){return!this.pendingAck&&this.unacked.length>=this.windowSize}},Object.defineProperties(i.prototype,{started:{get:function(){return this.outboundStarted&&this.inboundStarted},set:function(e){e||(this.outboundStarted=!1,this.inboundStarted=!1)}}}),t.exports=i},{}],295:[function(e,t,n){(function(n,r){"use strict";function i(e,t){var n;return Promise.race([e,new Promise(function(e,r){n=setTimeout(function(){r()},t);

})]).then(function(e){return clearTimeout(n),e})}function o(e){return new Promise(function(t){setTimeout(function(){t()},e)})}function a(e){return new Promise(function(t,n){p(e,function(e,r,i){return e?n(e):t([r,i])})})}function s(e,t,n){return i(a(e),1e3*(t||20)).then(function(e){var t=e[0],n=e[1];if(t.statusCode<200||t.statusCode>=400)throw new Error("HTTP Status Error"+t.statusCode);return n})["catch"](function(){if(n>0)return o(1e3).then(function(){return s(e,t,n-1)});throw new Error("Dead Connection, exceeded retry limit")})}function c(e,t){var n=this;f.call(this),n.sm=e,n.stanzas={BOSH:t.getDefinition("body","http://jabber.org/protocol/httpbind"),StreamError:t.getStreamError()},n.sendQueue=[],n.requests=[],n.maxRequests=void 0,n.sid="",n.on("raw:incoming",function(e){if(e=e.trim(),""!==e){var r,i;try{r=t.parse(e,n.stanzas.BOSH)}catch(o){return i=new n.stanzas.StreamError({condition:"invalid-xml"}),n.emit("stream:error",i,o),n.send(i),n.disconnect()}n.hasStream||(n.hasStream=!0,n.stream={id:r.sid||n.sid,lang:r.lang||"en",version:r.version||"1.0",to:r.to,from:r.from},n.sid=r.sid||n.sid,n.maxRequests=r.requests||n.maxRequests);var a=r.payload;a.forEach(function(e){e.lang||(e.lang=n.stream.lang),n.emit("stream:data",e)}),"terminate"===r.type&&(n.rid=void 0,n.sid=void 0,n.emit("bosh:terminate",r),n.emit("stream:end"),n.emit("disconnected",n))}})}var u=e("lodash.assign"),l=e("lodash.filter"),d=e("util"),p=e("request"),f=e("wildemitter");d.inherits(c,f),c.prototype.connect=function(e){var t=this;return t.config=u({rid:Math.ceil(9999999999*Math.random()),wait:30,maxRetries:5},e),t.hasStream=!1,t.sm.started=!1,t.url=e.boshURL,t.sid=t.config.sid,t.rid=t.config.rid,t.requests=[],t.sid?(t.hasStream=!0,t.stream={},t.emit("connected",t),t.emit("session:prebind",t.config.jid),void t.emit("session:started")):(t.rid++,void t.request(new t.stanzas.BOSH({version:t.config.version||"1.0",to:t.config.server,lang:t.config.lang||"en",wait:t.config.wait,ver:"1.6",hold:1})))},c.prototype.disconnect=function(){this.hasStream?(this.rid++,this.request(new this.stanzas.BOSH({type:"terminate"}))):(this.stream=void 0,this.sid=void 0,this.rid=void 0,this.emit("disconnected",this))},c.prototype.restart=function(){var e=this;e.rid++,e.request(new e.stanzas.BOSH({to:e.config.server,lang:e.config.lang||"en",restart:"true"}))},c.prototype.send=function(e){var t=this;t.hasStream&&(t.sendQueue.push(e),n.nextTick(t.longPoll.bind(t)))},c.prototype.longPoll=function(){var e=!this.maxRequests||this.requests.length<this.maxRequests,t=!this.maxRequests||this.sendQueue.length>0&&this.requests.length<this.maxRequests;if(this.sid&&(e||t)){var n=this.sendQueue;this.sendQueue=[],this.rid++,this.request(new this.stanzas.BOSH({payload:n}))}},c.prototype.request=function(e){var t=this,i={id:t.rid,request:null};e.rid=t.rid,e.sid=t.sid;var o=new r(e.toString(),"utf8").toString();t.emit("raw:outgoing",o),t.requests.push(i);var a=s({uri:t.url,body:o,method:"POST",strictSSL:!0},1.5*t.config.wait,this.config.maxRetries)["catch"](function(e){t.hasStream=!1;var n=new t.stanzas.StreamError({condition:"connection-timeout"});t.emit("stream:error",n,e),t.disconnect()});return i.request=a,a.then(function(e){t.emit("raw:incoming",new r(e,"utf8").toString())}),a.then(function(){t.requests=l(t.requests,function(e){return e.id!==i.id}),"terminate"===e.type||t.requests.length||n.nextTick(function(){n.nextTick(t.longPoll.bind(t))})})},t.exports=c}).call(this,e("_process"),e("buffer").Buffer)},{_process:8,buffer:9,"lodash.assign":163,"lodash.filter":165,request:329,util:309,wildemitter:328}],296:[function(e,t,n){"use strict";function r(e,t){function n(e){return[r.streamStart,e,r.streamEnd].join("")}o.call(this,e,t);var r=this;r.on("connected",function(){r.streamStart='<stream:stream xmlns:stream="http://etherx.jabber.org/streams">',r.streamEnd="</stream:stream>"}),r.off("raw:incoming"),r.on("raw:incoming",function(e){var o,a,s;if(e=e.trim(),e=e.replace(/^(\s*<\?.*\?>\s*)*/,""),""!==e){if(e.match(r.streamEnd))return r.disconnect();if(r.hasStream)try{o=t.parse(n(e))}catch(c){return s=new this.stanzas.StreamError({condition:"invalid-xml"}),r.emit("stream:error",s,c),r.send(s),r.disconnect()}else{var u=e.match(/^<(\S+:)?(\S+) /);r.streamStart=e,r.streamEnd="</"+(u[1]||"")+u[2]+">",a=!1;try{o=t.parse(e+r.streamEnd)}catch(c){try{o=t.parse(e),a=!0}catch(l){return s=new this.stanzas.StreamError({condition:"invalid-xml"}),r.emit("stream:error",s,l),r.send(s),r.disconnect()}}r.hasStream=!0,r.stream=o,r.emit("stream:start",o)}i(o._extensions,function(e){!e.lang&&r.stream&&(e.lang=r.stream.lang),r.emit("stream:data",e)}),a&&r.emit("stream:end")}})}var i=e("lodash.foreach"),o=e("./websocket"),a=e("util");a.inherits(r,o),r.prototype.startHeader=function(){return["<stream:stream",'xmlns:stream="http://etherx.jabber.org/streams"','xmlns="jabber:client"','version="'+(this.config.version||"1.0")+'"','xml:lang="'+(this.config.lang||"en")+'"','to="'+this.config.server+'">'].join(" ")},r.prototype.closeHeader=function(){return"</stream:stream>"},t.exports=r},{"./websocket":297,"lodash.foreach":166,util:309}],297:[function(e,t,n){(function(n){"use strict";function r(e,t){var r=this;o.call(this),r.sm=e,r.closing=!1,r.stanzas={Open:t.getDefinition("open","urn:ietf:params:xml:ns:xmpp-framing",!0),Close:t.getDefinition("close","urn:ietf:params:xml:ns:xmpp-framing",!0),StreamError:t.getStreamError()},r.sendQueue=a.queue(function(e,t){r.conn&&("string"!=typeof e&&(e=e.toString()),e=new n(e,"utf8").toString(),r.emit("raw:outgoing",e),r.conn.readyState===c&&r.conn.send(e)),t()},1),r.on("connected",function(){r.send(r.startHeader())}),r.on("raw:incoming",function(e){var n,i;if(e=e.trim(),""!==e){try{n=t.parse(e)}catch(o){return i=new r.stanzas.StreamError({condition:"invalid-xml"}),r.emit("stream:error",i,o),r.send(i),r.disconnect()}if("openStream"===n._name)return r.hasStream=!0,r.stream=n,r.emit("stream:start",n.toJSON());if("closeStream"===n._name)return r.emit("stream:end"),r.disconnect();!n.lang&&r.stream&&(n.lang=r.stream.lang),r.emit("stream:data",n)}})}var i=e("util"),o=e("wildemitter"),a=e("async"),s=e("faye-websocket")&&e("faye-websocket").Client?e("faye-websocket").Client:window.WebSocket,c=1;i.inherits(r,o),r.prototype.connect=function(e){var t=this;t.config=e,t.hasStream=!1,t.closing=!1,t.conn=new s(e.wsURL,"xmpp"),t.conn.onerror=function(e){e.preventDefault(),t.emit("disconnected",t)},t.conn.onclose=function(){t.emit("disconnected",t)},t.conn.onopen=function(){t.sm.started=!1,t.emit("connected",t)},t.conn.onmessage=function(e){t.emit("raw:incoming",new n(e.data,"utf8").toString())}},r.prototype.startHeader=function(){return new this.stanzas.Open({version:this.config.version||"1.0",lang:this.config.lang||"en",to:this.config.server})},r.prototype.closeHeader=function(){return new this.stanzas.Close},r.prototype.disconnect=function(){this.conn&&!this.closing&&this.hasStream?(this.closing=!0,this.send(this.closeHeader())):(this.hasStream=!1,this.stream=void 0,this.conn&&this.conn.readyState===c&&this.conn.close(),this.conn=void 0)},r.prototype.restart=function(){var e=this;e.hasStream=!1,e.send(this.startHeader())},r.prototype.send=function(e){this.sendQueue.push(e)},t.exports=r}).call(this,e("buffer").Buffer)},{async:298,buffer:9,"faye-websocket":7,util:309,wildemitter:328}],298:[function(e,t,n){(function(e,n,r){!function(){function i(){}function o(e){return e}function a(e){return!!e}function s(e){return!e}function c(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function u(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}function l(e){return B(e)||"number"==typeof e.length&&e.length>=0&&e.length%1===0}function d(e,t){for(var n=-1,r=e.length;++n<r;)t(e[n],n,e)}function p(e,t){for(var n=-1,r=e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function f(e){return p(Array(e),function(e,t){return t})}function h(e,t,n){return d(e,function(e,r,i){n=t(n,e,r,i)}),n}function m(e,t){d(G(e),function(n){t(e[n],n)})}function v(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}function g(e){var t,n,r=-1;return l(e)?(t=e.length,function(){return r++,t>r?r:null}):(n=G(e),t=n.length,function(){return r++,t>r?n[r]:null})}function y(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;n>i;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r)}}}function _(e){return function(t,n,r){return e(t,r)}}function S(e){return function(t,n,r){r=u(r||i),t=t||[];var o=g(t);if(0>=e)return r(null);var a=!1,s=0,l=!1;!function d(){if(a&&0>=s)return r(null);for(;e>s&&!l;){var i=o();if(null===i)return a=!0,void(0>=s&&r(null));s+=1,n(t[i],i,c(function(e){s-=1,e?(r(e),l=!0):d()}))}}()}}function b(e){return function(t,n,r){return e(N.eachOf,t,n,r)}}function C(e){return function(t,n,r,i){return e(S(n),t,r,i)}}function w(e){return function(t,n,r){return e(N.eachOfSeries,t,n,r)}}function E(e,t,n,r){r=u(r||i),t=t||[];var o=l(t)?[]:{};e(t,function(e,t,r){n(e,function(e,n){o[t]=n,r(e)})},function(e){r(e,o)})}function R(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(n){n&&i.push({index:t,value:e}),r()})},function(){r(p(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})}function P(e,t,n,r){R(e,t,function(e,t){n(e,function(e){t(!e)})},r)}function x(e,t,n){return function(r,i,o,a){function s(){a&&a(n(!1,void 0))}function c(e,r,i){return a?void o(e,function(r){a&&t(r)&&(a(n(!0,e)),a=o=!1),i()}):i()}arguments.length>3?e(r,i,c,s):(a=o,o=i,e(r,c,s))}}function T(e,t){return t}function L(e,t,n){n=n||i;var r=l(t)?[]:{};e(t,function(e,t,n){e(y(function(e,i){i.length<=1&&(i=i[0]),r[t]=i,n(e)}))},function(e){n(e,r)})}function O(e,t,n,r){var i=[];e(t,function(e,t,r){n(e,function(e,t){i=i.concat(t||[]),r(e)})},function(e){r(e,i)})}function I(e,t,n){function r(e,t,n,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");return e.started=!0,B(t)||(t=[t]),0===t.length&&e.idle()?N.setImmediate(function(){e.drain()}):(d(t,function(t){var o={data:t,callback:r||i};n?e.tasks.unshift(o):e.tasks.push(o),e.tasks.length===e.concurrency&&e.saturated()}),void N.setImmediate(e.process))}function o(e,t){return function(){a-=1;var n=!1,r=arguments;d(t,function(e){d(s,function(t,r){t!==e||n||(s.splice(r,1),n=!0)}),e.callback.apply(e,r)}),e.tasks.length+a===0&&e.drain(),e.process()}}if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var a=0,s=[],u={tasks:[],concurrency:t,payload:n,saturated:i,empty:i,drain:i,started:!1,paused:!1,push:function(e,t){r(u,e,!1,t)},kill:function(){u.drain=i,u.tasks=[]},unshift:function(e,t){r(u,e,!0,t)},process:function(){for(;!u.paused&&a<u.concurrency&&u.tasks.length;){var t=u.payload?u.tasks.splice(0,u.payload):u.tasks.splice(0,u.tasks.length),n=p(t,function(e){return e.data});0===u.tasks.length&&u.empty(),a+=1,s.push(t[0]);var r=c(o(u,t));e(n,r)}},length:function(){return u.tasks.length},running:function(){return a},workersList:function(){return s},idle:function(){return u.tasks.length+a===0},pause:function(){u.paused=!0},resume:function(){if(u.paused!==!1){u.paused=!1;for(var e=Math.min(u.concurrency,u.tasks.length),t=1;e>=t;t++)N.setImmediate(u.process)}}};return u}function M(e){return y(function(t,n){t.apply(null,n.concat([y(function(t,n){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&d(n,function(t){console[e](t)}))})]))})}function A(e){return function(t,n,r){e(f(t),n,r)}}function D(e){return y(function(t,n){var r=y(function(n){var r=this,i=n.pop();return e(t,function(e,t,i){e.apply(r,n.concat([i]))},i)});return n.length?r.apply(this,n):r})}function k(e){return y(function(t){var n=t.pop();t.push(function(){var e=arguments;r?N.setImmediate(function(){n.apply(null,e)}):n.apply(null,e)});var r=!0;e.apply(this,t),r=!1})}var j,N={},V="object"==typeof self&&self.self===self&&self||"object"==typeof n&&n.global===n&&n||this;null!=V&&(j=V.async),N.noConflict=function(){return V.async=j,N};var U=Object.prototype.toString,B=Array.isArray||function(e){return"[object Array]"===U.call(e)},F=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},G=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},q="function"==typeof r&&r,J=q?function(e){q(e)}:function(e){setTimeout(e,0)};N.nextTick="object"==typeof e&&"function"==typeof e.nextTick?e.nextTick:J,N.setImmediate=q?J:N.nextTick,N.forEach=N.each=function(e,t,n){return N.eachOf(e,_(t),n)},N.forEachSeries=N.eachSeries=function(e,t,n){return N.eachOfSeries(e,_(t),n)},N.forEachLimit=N.eachLimit=function(e,t,n,r){return S(t)(e,_(n),r)},N.forEachOf=N.eachOf=function(e,t,n){function r(e){s--,e?n(e):null===o&&0>=s&&n(null)}n=u(n||i),e=e||[];for(var o,a=g(e),s=0;null!=(o=a());)s+=1,t(e[o],o,c(r));0===s&&n(null)},N.forEachOfSeries=N.eachOfSeries=function(e,t,n){function r(){var i=!0;return null===a?n(null):(t(e[a],a,c(function(e){if(e)n(e);else{if(a=o(),null===a)return n(null);i?N.setImmediate(r):r()}})),void(i=!1))}n=u(n||i),e=e||[];var o=g(e),a=o();r()},N.forEachOfLimit=N.eachOfLimit=function(e,t,n,r){S(t)(e,n,r)},N.map=b(E),N.mapSeries=w(E),N.mapLimit=C(E),N.inject=N.foldl=N.reduce=function(e,t,n,r){N.eachOfSeries(e,function(e,r,i){n(t,e,function(e,n){t=n,i(e)})},function(e){r(e,t)})},N.foldr=N.reduceRight=function(e,t,n,r){var i=p(e,o).reverse();N.reduce(i,t,n,r)},N.transform=function(e,t,n,r){3===arguments.length&&(r=n,n=t,t=B(e)?[]:{}),N.eachOf(e,function(e,r,i){n(t,e,r,i)},function(e){r(e,t)})},N.select=N.filter=b(R),N.selectLimit=N.filterLimit=C(R),N.selectSeries=N.filterSeries=w(R),N.reject=b(P),N.rejectLimit=C(P),N.rejectSeries=w(P),N.any=N.some=x(N.eachOf,a,o),N.someLimit=x(N.eachOfLimit,a,o),N.all=N.every=x(N.eachOf,s,s),N.everyLimit=x(N.eachOfLimit,s,s),N.detect=x(N.eachOf,o,T),N.detectSeries=x(N.eachOfSeries,o,T),N.detectLimit=x(N.eachOfLimit,o,T),N.sortBy=function(e,t,n){function r(e,t){var n=e.criteria,r=t.criteria;return r>n?-1:n>r?1:0}N.map(e,function(e,n){t(e,function(t,r){t?n(t):n(null,{value:e,criteria:r})})},function(e,t){return e?n(e):void n(null,p(t.sort(r),function(e){return e.value}))})},N.auto=function(e,t,n){function r(e){g.unshift(e)}function o(e){var t=v(g,e);t>=0&&g.splice(t,1)}function a(){c--,d(g.slice(0),function(e){e()})}"function"==typeof arguments[1]&&(n=t,t=null),n=u(n||i);var s=G(e),c=s.length;if(!c)return n(null);t||(t=c);var l={},p=0,f=!1,g=[];r(function(){c||n(null,l)}),d(s,function(i){function s(){return t>p&&h(_,function(e,t){return e&&l.hasOwnProperty(t)},!0)&&!l.hasOwnProperty(i)}function c(){s()&&(p++,o(c),d[d.length-1](g,l))}if(!f){for(var u,d=B(e[i])?e[i]:[e[i]],g=y(function(e,t){if(p--,t.length<=1&&(t=t[0]),e){var r={};m(l,function(e,t){r[t]=e}),r[i]=t,f=!0,n(e,r)}else l[i]=t,N.setImmediate(a)}),_=d.slice(0,d.length-1),S=_.length;S--;){if(!(u=e[_[S]]))throw new Error("Has nonexistent dependency in "+_.join(", "));if(B(u)&&v(u,i)>=0)throw new Error("Has cyclic dependencies")}s()?(p++,d[d.length-1](g,l)):r(c)}})},N.retry=function(e,t,n){function r(e,t){if("number"==typeof t)e.times=parseInt(t,10)||o;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||o,e.interval=parseInt(t.interval,10)||a}}function i(e,t){function n(e,n){return function(r){e(function(e,t){r(!e||n,{err:e,result:t})},t)}}function r(e){return function(t){setTimeout(function(){t(null)},e)}}for(;c.times;){var i=!(c.times-=1);s.push(n(c.task,i)),!i&&c.interval>0&&s.push(r(c.interval))}N.series(s,function(t,n){n=n[n.length-1],(e||c.callback)(n.err,n.result)})}var o=5,a=0,s=[],c={times:o,interval:a},u=arguments.length;if(1>u||u>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=u&&"function"==typeof e&&(n=t,t=e),"function"!=typeof e&&r(c,e),c.callback=n,c.task=t,c.callback?i():i},N.waterfall=function(e,t){function n(e){return y(function(r,i){if(r)t.apply(null,[r].concat(i));else{var o=e.next();i.push(o?n(o):t),k(e).apply(null,i)}})}if(t=u(t||i),!B(e)){var r=new Error("First argument to waterfall must be an array of functions");return t(r)}return e.length?void n(N.iterator(e))():t()},N.parallel=function(e,t){L(N.eachOf,e,t)},N.parallelLimit=function(e,t,n){L(S(t),e,n)},N.series=function(e,t){L(N.eachOfSeries,e,t)},N.iterator=function(e){function t(n){function r(){return e.length&&e[n].apply(null,arguments),r.next()}return r.next=function(){return n<e.length-1?t(n+1):null},r}return t(0)},N.apply=y(function(e,t){return y(function(n){return e.apply(null,t.concat(n))})}),N.concat=b(O),N.concatSeries=w(O),N.whilst=function(e,t,n){if(n=n||i,e()){var r=y(function(i,o){i?n(i):e.apply(this,o)?t(r):n.apply(null,[null].concat(o))});t(r)}else n(null)},N.doWhilst=function(e,t,n){var r=0;return N.whilst(function(){return++r<=1||t.apply(this,arguments)},e,n)},N.until=function(e,t,n){return N.whilst(function(){return!e.apply(this,arguments)},t,n)},N.doUntil=function(e,t,n){return N.doWhilst(e,function(){return!t.apply(this,arguments)},n)},N.during=function(e,t,n){n=n||i;var r=y(function(t,r){t?n(t):(r.push(o),e.apply(this,r))}),o=function(e,i){e?n(e):i?t(r):n(null)};e(o)},N.doDuring=function(e,t,n){var r=0;N.during(function(e){r++<1?e(null,!0):t.apply(this,arguments)},e,n)},N.queue=function(e,t){var n=I(function(t,n){e(t[0],n)},t,1);return n},N.priorityQueue=function(e,t){function n(e,t){return e.priority-t.priority}function r(e,t,n){for(var r=-1,i=e.length-1;i>r;){var o=r+(i-r+1>>>1);n(t,e[o])>=0?r=o:i=o-1}return r}function o(e,t,o,a){if(null!=a&&"function"!=typeof a)throw new Error("task callback must be a function");return e.started=!0,B(t)||(t=[t]),0===t.length?N.setImmediate(function(){e.drain()}):void d(t,function(t){var s={data:t,priority:o,callback:"function"==typeof a?a:i};e.tasks.splice(r(e.tasks,s,n)+1,0,s),e.tasks.length===e.concurrency&&e.saturated(),N.setImmediate(e.process)})}var a=N.queue(e,t);return a.push=function(e,t,n){o(a,e,t,n)},delete a.unshift,a},N.cargo=function(e,t){return I(e,1,t)},N.log=M("log"),N.dir=M("dir"),N.memoize=function(e,t){var n={},r={},i=Object.prototype.hasOwnProperty;t=t||o;var a=y(function(o){var a=o.pop(),s=t.apply(null,o);i.call(n,s)?N.setImmediate(function(){a.apply(null,n[s])}):i.call(r,s)?r[s].push(a):(r[s]=[a],e.apply(null,o.concat([y(function(e){n[s]=e;var t=r[s];delete r[s];for(var i=0,o=t.length;o>i;i++)t[i].apply(null,e)})])))});return a.memo=n,a.unmemoized=e,a},N.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},N.times=A(N.map),N.timesSeries=A(N.mapSeries),N.timesLimit=function(e,t,n,r){return N.mapLimit(f(e),t,n,r)},N.seq=function(){var e=arguments;return y(function(t){var n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=i,N.reduce(e,t,function(e,t,r){t.apply(n,e.concat([y(function(e,t){r(e,t)})]))},function(e,t){r.apply(n,[e].concat(t))})})},N.compose=function(){return N.seq.apply(null,Array.prototype.reverse.call(arguments))},N.applyEach=D(N.eachOf),N.applyEachSeries=D(N.eachOfSeries),N.forever=function(e,t){function n(e){return e?r(e):void o(n)}var r=c(t||i),o=k(e);n()},N.ensureAsync=k,N.constant=y(function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}}),N.wrapSync=N.asyncify=function(e){return y(function(t){var n,r=t.pop();try{n=e.apply(this,t)}catch(i){return r(i)}F(n)&&"function"==typeof n.then?n.then(function(e){r(null,e)})["catch"](function(e){r(e.message?e:new Error(e))}):r(null,n)})},"object"==typeof t&&t.exports?t.exports=N:"function"==typeof define&&define.amd?define([],function(){return N}):V.async=N}()}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{_process:8,timers:303}],299:[function(e,t,n){(function(e){var n,r=e.crypto||e.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],300:[function(e,t,n){arguments[4][74][0].apply(n,arguments)},{"./rng":299,dup:74}],301:[function(e,t,n){function r(){i.call(this)}t.exports=r;var i=e("events").EventEmitter,o=e("inherits");o(r,i),r.Readable=e("readable-stream/readable.js"),r.Writable=e("readable-stream/writable.js"),r.Duplex=e("readable-stream/duplex.js"),r.Transform=e("readable-stream/transform.js"),r.PassThrough=e("readable-stream/passthrough.js"),r.Stream=r,r.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&u.pause&&u.pause()}function r(){u.readable&&u.resume&&u.resume()}function o(){l||(l=!0,e.end())}function a(){l||(l=!0,"function"==typeof e.destroy&&e.destroy())}function s(e){if(c(),0===i.listenerCount(this,"error"))throw e}function c(){u.removeListener("data",n),e.removeListener("drain",r),u.removeListener("end",o),u.removeListener("close",a),u.removeListener("error",s),e.removeListener("error",s),u.removeListener("end",c),u.removeListener("close",c),e.removeListener("close",c)}var u=this;u.on("data",n),e.on("drain",r),e._isStdio||t&&t.end===!1||(u.on("end",o),u.on("close",a));var l=!1;return u.on("error",s),e.on("error",s),u.on("end",c),u.on("close",c),e.on("close",c),e.emit("pipe",u),e}},{events:32,inherits:46,"readable-stream/duplex.js":193,"readable-stream/passthrough.js":204,"readable-stream/readable.js":205,"readable-stream/transform.js":206,"readable-stream/writable.js":207}],302:[function(e,t,n){function r(e){if(e&&!c(e))throw new Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function a(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var s=e("buffer").Buffer,c=s.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},u=n.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:return void(this.write=i)}this.charBuffer=new s(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(!(r>=55296&&56319>=r)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&56319>=r){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},u.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(2>=t&&n>>4==14){this.charLength=3;break}if(3>=t&&n>>3==30){this.charLength=4;break}}this.charReceived=t},u.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},{buffer:9}],303:[function(e,t,n){(function(t,r){function i(e,t){this._id=e,this._clearFn=t}var o=e("process/browser.js").nextTick,a=Function.prototype.apply,s=Array.prototype.slice,c={},u=0;n.setTimeout=function(){return new i(a.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new i(a.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n.setImmediate="function"==typeof t?t:function(e){var t=u++,r=arguments.length<2?!1:s.call(arguments,1);return c[t]=!0,o(function(){c[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))}),t},n.clearImmediate="function"==typeof r?r:function(e){delete c[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":304,timers:303}],304:[function(e,t,n){arguments[4][8][0].apply(n,arguments)},{dup:8}],305:[function(e,t,n){function r(e){return e.replace(/^\s*|\s*$/g,"")}n=t.exports=r,n.left=function(e){return e.replace(/^\s*/,"")},n.right=function(e){return e.replace(/\s*$/,"")}},{}],306:[function(e,t,n){(function(e){function n(e,t){function n(){if(!i){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}if(r("noDeprecation"))return e;var i=!1;return n}function r(t){try{if(!e.localStorage)return!1}catch(n){return!1}var r=e.localStorage[t];return null==r?!1:"true"===String(r).toLowerCase()}t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],307:[function(e,t,n){arguments[4][46][0].apply(n,arguments)},{dup:46}],308:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],309:[function(e,t,n){(function(t,r){function i(e,t){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(t)?r.showHidden=t:t&&n._extend(r,t),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),c(r,e,r.depth)}function o(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function a(e,t){return e}function s(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function c(e,t,r){if(e.customInspect&&t&&P(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return _(i)||(i=c(e,i,r)),i}var o=u(e,t);if(o)return o;var a=Object.keys(t),m=s(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),R(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(t);if(0===a.length){if(P(t)){var v=t.name?": "+t.name:"";return e.stylize("[Function"+v+"]","special")}if(C(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(E(t))return e.stylize(Date.prototype.toString.call(t),"date");if(R(t))return l(t)}var g="",y=!1,S=["{","}"];if(h(t)&&(y=!0,S=["[","]"]),P(t)){var b=t.name?": "+t.name:"";g=" [Function"+b+"]"}if(C(t)&&(g=" "+RegExp.prototype.toString.call(t)),E(t)&&(g=" "+Date.prototype.toUTCString.call(t)),R(t)&&(g=" "+l(t)),0===a.length&&(!y||0==t.length))return S[0]+g+S[1];if(0>r)return C(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var w;return w=y?d(e,t,r,m,a):a.map(function(n){return p(e,t,r,m,n,y)}),e.seen.pop(),f(w,g,S)}function u(e,t){if(b(t))return e.stylize("undefined","undefined");if(_(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return y(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i){for(var o=[],a=0,s=t.length;s>a;++a)o.push(I(t,String(a))?p(e,t,n,r,String(a),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(e,t,n,r,i,!0))}),o}function p(e,t,n,r,i,o){var a,s,u;if(u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},u.get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),I(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=v(n)?c(e,u.value,null):c(e,u.value,n-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n"))):s=e.stylize("[Circular]","special")),b(a)){if(o&&i.match(/^\d+$/))return s;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function f(e,t,n){var r=0,i=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function h(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function v(e){return null===e}function g(e){return null==e}function y(e){return"number"==typeof e}function _(e){return"string"==typeof e}function S(e){return"symbol"==typeof e}function b(e){return void 0===e}function C(e){return w(e)&&"[object RegExp]"===T(e)}function w(e){return"object"==typeof e&&null!==e}function E(e){return w(e)&&"[object Date]"===T(e)}function R(e){return w(e)&&("[object Error]"===T(e)||e instanceof Error)}function P(e){return"function"==typeof e}function x(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function T(e){return Object.prototype.toString.call(e)}function L(e){return 10>e?"0"+e.toString(10):e.toString(10)}function O(){var e=new Date,t=[L(e.getHours()),L(e.getMinutes()),L(e.getSeconds())].join(":");return[e.getDate(),k[e.getMonth()],t].join(" ")}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var M=/%[sdj%]/g;n.format=function(e){if(!_(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,o=r.length,a=String(e).replace(M,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),s=r[n];o>n;s=r[++n])a+=v(s)||!w(s)?" "+s:" "+i(s);return a},n.deprecate=function(e,i){function o(){if(!a){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),a=!0}return e.apply(this,arguments)}if(b(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(t.noDeprecation===!0)return e;var a=!1;return o};var A,D={};n.debuglog=function(e){if(b(A)&&(A=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!D[e])if(new RegExp("\\b"+e+"\\b","i").test(A)){var r=t.pid;D[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else D[e]=function(){};return D[e]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=h,n.isBoolean=m,n.isNull=v,n.isNullOrUndefined=g,n.isNumber=y,n.isString=_,n.isSymbol=S,n.isUndefined=b,n.isRegExp=C,n.isObject=w,n.isDate=E,n.isError=R,
n.isFunction=P,n.isPrimitive=x,n.isBuffer=e("./support/isBuffer");var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",O(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":308,_process:8,inherits:307}],310:[function(e,t,n){var r=e("./v1"),i=e("./v4"),o=i;o.v1=r,o.v4=i,t.exports=o},{"./v1":313,"./v4":314}],311:[function(e,t,n){function r(e,t){var n=t||0,r=i;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}for(var i=[],o=0;256>o;++o)i[o]=(o+256).toString(16).substr(1);t.exports=r},{}],312:[function(e,t,n){var r="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(r){var i=new Uint8Array(16);t.exports=function(){return r(i),i}}else{var o=new Array(16);t.exports=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},{}],313:[function(e,t,n){function r(e,t,n){var r=t&&n||0,l=t||[];e=e||{};var d=e.node||i,p=void 0!==e.clockseq?e.clockseq:o;if(null==d||null==p){var f=a();null==d&&(d=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=o=16383&(f[6]<<8|f[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:u+1,v=h-c+(m-u)/1e4;if(0>v&&void 0===e.clockseq&&(p=p+1&16383),(0>v||h>c)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=h,u=m,o=p,h+=122192928e5;var g=(1e4*(268435455&h)+m)%4294967296;l[r++]=g>>>24&255,l[r++]=g>>>16&255,l[r++]=g>>>8&255,l[r++]=255&g;var y=h/4294967296*1e4&268435455;l[r++]=y>>>8&255,l[r++]=255&y,l[r++]=y>>>24&15|16,l[r++]=y>>>16&255,l[r++]=p>>>8|128,l[r++]=255&p;for(var _=0;6>_;++_)l[r+_]=d[_];return t?t:s(l)}var i,o,a=e("./lib/rng"),s=e("./lib/bytesToUuid"),c=0,u=0;t.exports=r},{"./lib/bytesToUuid":311,"./lib/rng":312}],314:[function(e,t,n){function r(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;16>s;++s)t[r+s]=a[s];return t||o(a)}var i=e("./lib/rng"),o=e("./lib/bytesToUuid");t.exports=r},{"./lib/bytesToUuid":311,"./lib/rng":312}],315:[function(e,t,n){arguments[4][209][0].apply(n,arguments)},{dup:209}],316:[function(e,t,n){(function(n){"use strict";var r=e("./adapter_factory.js");t.exports=r({window:n.window})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adapter_factory.js":317}],317:[function(e,t,n){"use strict";var r=e("./utils");t.exports=function(t,n){var i=t&&t.window,o={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var a in n)hasOwnProperty.call(n,a)&&(o[a]=n[a]);var s=r.log,c=r.detectBrowser(i),u={browserDetails:c,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings},l=e("./chrome/chrome_shim")||null,d=e("./edge/edge_shim")||null,p=e("./firefox/firefox_shim")||null,f=e("./safari/safari_shim")||null,h=e("./common_shim")||null;switch(c.browser){case"chrome":if(!l||!l.shimPeerConnection||!o.shimChrome)return s("Chrome shim is not included in this adapter release."),u;s("adapter.js shimming chrome."),u.browserShim=l,h.shimCreateObjectURL(i),l.shimGetUserMedia(i),l.shimMediaStream(i),l.shimSourceObject(i),l.shimPeerConnection(i),l.shimOnTrack(i),l.shimAddTrackRemoveTrack(i),l.shimGetSendersWithDtmf(i),h.shimRTCIceCandidate(i);break;case"firefox":if(!p||!p.shimPeerConnection||!o.shimFirefox)return s("Firefox shim is not included in this adapter release."),u;s("adapter.js shimming firefox."),u.browserShim=p,h.shimCreateObjectURL(i),p.shimGetUserMedia(i),p.shimSourceObject(i),p.shimPeerConnection(i),p.shimOnTrack(i),h.shimRTCIceCandidate(i);break;case"edge":if(!d||!d.shimPeerConnection||!o.shimEdge)return s("MS edge shim is not included in this adapter release."),u;s("adapter.js shimming edge."),u.browserShim=d,h.shimCreateObjectURL(i),d.shimGetUserMedia(i),d.shimPeerConnection(i),d.shimReplaceTrack(i);break;case"safari":if(!f||!o.shimSafari)return s("Safari shim is not included in this adapter release."),u;s("adapter.js shimming safari."),u.browserShim=f,h.shimCreateObjectURL(i),f.shimRTCIceServerUrls(i),f.shimCallbacksAPI(i),f.shimLocalStreamsAPI(i),f.shimRemoteStreamsAPI(i),f.shimTrackEventTransceiver(i),f.shimGetUserMedia(i),f.shimCreateOfferLegacy(i),h.shimRTCIceCandidate(i);break;default:s("Unsupported browser!")}return u}},{"./chrome/chrome_shim":318,"./common_shim":320,"./edge/edge_shim":321,"./firefox/firefox_shim":323,"./safari/safari_shim":325,"./utils":326}],318:[function(e,t,n){"use strict";var r=e("../utils.js"),i=r.log,o={shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return n._ontrackpoly||(n._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.track.id}):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}),t.stream.getTracks().forEach(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.id}):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})},n.addEventListener("addstream",n._ontrackpoly)),t.apply(n,arguments)}}},shimGetSendersWithDtmf:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===t.kind?e.createDTMFSender(t):null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=this,o=n.apply(i,arguments);return o||(o=t(i,e),i._senders.push(o)),o};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;r.apply(t,arguments);var n=t._senders.indexOf(e);-1!==n&&t._senders.splice(n,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;n._senders=n._senders||[],i.apply(n,[e]),e.getTracks().forEach(function(e){n._senders.push(t(n,e))})};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[],o.apply(t,[e]),e.getTracks().forEach(function(e){var n=t._senders.find(function(t){return t.track===e});n&&t._senders.splice(t._senders.indexOf(n),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(e,[]);return t.forEach(function(t){t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}},shimSourceObject:function(e){var t=e&&e.URL;"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var n=this;return this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e?(this.src=t.createObjectURL(e),e.addEventListener("addtrack",function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)}),void e.addEventListener("removetrack",function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)})):void(this.src="")}}))},shimAddTrackRemoveTrack:function(e){function t(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}function n(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}var i=r.detectBrowser(e);if(!(e.RTCPeerConnection.prototype.addTrack&&i.version>=63)){var o=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=o.apply(this);return e._reverseStreams=e._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(n._streams=n._streams||{},n._reverseStreams=n._reverseStreams||{},t.getTracks().forEach(function(e){var t=n.getSenders().find(function(t){return t.track===e});if(t)throw new DOMException("Track already exists.","InvalidAccessError")}),!n._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());n._streams[t.id]=r,n._reverseStreams[r.id]=t,t=r}a.apply(n,[t])};var s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{},t._reverseStreams=t._reverseStreams||{},s.apply(t,[t._streams[e.id]||e]),delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id],delete t._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===r.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var o=r.getSenders().find(function(e){return e.track===t});if(o)throw new DOMException("Track already exists.","InvalidAccessError");r._streams=r._streams||{},r._reverseStreams=r._reverseStreams||{};var a=r._streams[n.id];if(a)a.addTrack(t),Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))});else{var s=new e.MediaStream([t]);r._streams[n.id]=s,r._reverseStreams[s.id]=n,r.addStream(s)}return r.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(n){var r=e.RTCPeerConnection.prototype[n];e.RTCPeerConnection.prototype[n]=function(){var e=this,n=arguments,i=arguments.length&&"function"==typeof arguments[0];return i?r.apply(e,[function(r){var i=t(e,r);n[0].apply(null,[i])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):r.apply(e,arguments).then(function(n){return t(e,n)})}});var c=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this;return arguments.length&&arguments[0].type?(arguments[0]=n(e,arguments[0]),c.apply(e,arguments)):c.apply(e,arguments)};var u=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=this,n=u.get.apply(this);return""===n.type?n:t(e,n)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===t.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var n=e._pc===t;if(!n)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");t._streams=t._streams||{};var r;Object.keys(t._streams).forEach(function(n){var i=t._streams[n].getTracks().find(function(t){return e.track===t});i&&(r=t._streams[n])}),r&&(1===r.getTracks().length?t.removeStream(t._reverseStreams[r.id]):r.removeTrack(e.track),t.dispatchEvent(new Event("negotiationneeded")))}}},shimPeerConnection:function(e){var t=r.detectBrowser(e);if(e.RTCPeerConnection){var n=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new n(e,t)},e.RTCPeerConnection.prototype=n.prototype,Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return n.generateCertificate}})}else e.RTCPeerConnection=function(t,n){return i("PeerConnection"),t&&t.iceTransportPolicy&&(t.iceTransports=t.iceTransportPolicy),new e.webkitRTCPeerConnection(t,n)},e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype,e.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.webkitRTCPeerConnection.generateCertificate}});var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,n){var r=this,i=arguments;if(arguments.length>0&&"function"==typeof e)return o.apply(this,arguments);if(0===o.length&&(0===arguments.length||"function"!=typeof arguments[0]))return o.apply(this,[]);var a=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){var c=function(e){i[1](s(a(e)))};return o.apply(this,[c,arguments[0]])}return new Promise(function(e,t){o.apply(r,[function(t){e(s(a(t)))},t])}).then(t,n)},t.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=arguments,t=this,r=new Promise(function(r,i){n.apply(t,[e[0],r,i])});return e.length<2?r:r.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),t.version<52&&["createOffer","createAnswer"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var t=1===arguments.length?arguments[0]:void 0;return new Promise(function(r,i){n.apply(e,[r,i,t])})}return n.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var a=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?a.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};t.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimAddTrackRemoveTrack:o.shimAddTrackRemoveTrack,shimGetSendersWithDtmf:o.shimGetSendersWithDtmf,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils.js":326,"./getusermedia":319}],319:[function(e,t,n){"use strict";var r=e("../utils.js"),i=r.log;t.exports=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var o={};"number"==typeof r.ideal?(o[i("min",n)]=r.ideal,t.optional.push(o),o={},o[i("max",n)]=r.ideal,t.optional.push(o)):(o[i("",n)]=r.ideal,t.optional.push(o))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},a=function(e,r){if(e=JSON.parse(JSON.stringify(e)),e&&"object"==typeof e.audio){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","googAutoGainControl"),a(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=o(e.audio)}if(e&&"object"==typeof e.video){var s=e.video.facingMode;s=s&&("object"==typeof s?s:{ideal:s});var c=t.version<61;if(!(!s||"user"!==s.exact&&"environment"!==s.exact&&"user"!==s.ideal&&"environment"!==s.ideal||n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete e.video.facingMode;var u;if("environment"===s.exact||"environment"===s.ideal?u=["back","rear"]:("user"===s.exact||"user"===s.ideal)&&(u=["front"]),u)return n.mediaDevices.enumerateDevices().then(function(t){t=t.filter(function(e){return"videoinput"===e.kind});var n=t.find(function(e){return u.some(function(t){return-1!==e.label.toLowerCase().indexOf(t)})});return!n&&t.length&&-1!==u.indexOf("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=s.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=o(e.video),i("chrome: "+JSON.stringify(e)),r(e)})}e.video=o(e.video)}return i("chrome: "+JSON.stringify(e)),r(e)},s=function(e){return{name:{PermissionDeniedError:"NotAllowedError",InvalidStateError:"NotReadableError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotReadableError",MediaDeviceKillSwitchOn:"NotReadableError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},c=function(e,t,r){a(e,function(e){n.webkitGetUserMedia(e,t,function(e){r&&r(s(e))})})};n.getUserMedia=c;var u=function(e){return new Promise(function(t,r){n.getUserMedia(e,t,r)})};if(n.mediaDevices||(n.mediaDevices={getUserMedia:u,enumerateDevices:function(){return new Promise(function(t){var n={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:n[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),n.mediaDevices.getUserMedia){var l=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return a(e,function(e){return l(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(s(e))})})}}else n.mediaDevices.getUserMedia=function(e){return u(e)};"undefined"==typeof n.mediaDevices.addEventListener&&(n.mediaDevices.addEventListener=function(){i("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof n.mediaDevices.removeEventListener&&(n.mediaDevices.removeEventListener=function(){i("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":326}],320:[function(e,t,n){"use strict";function r(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){r(n(e))};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return o.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)}})}}var i=e("sdp"),o=e("./utils");t.exports={shimRTCIceCandidate:function(e){if(!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){"object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&(e=JSON.parse(JSON.stringify(e)),e.candidate=e.candidate.substr(2));var n=new t(e),r=i.parseCandidate(e.candidate),o=Object.assign(n,r);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o},r(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})}},shimCreateObjectURL:function(e){var t=e&&e.URL;if(!("object"==typeof e&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL))return void 0;var n=t.createObjectURL.bind(t),r=t.revokeObjectURL.bind(t),i=new Map,a=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++a;return i.set(t,e),o.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),t}return n(e)},t.revokeObjectURL=function(e){r(e),i["delete"](e)};var s=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function(){return s.get.apply(this)},set:function(e){return this.srcObject=i.get(e)||null,s.set.apply(this,[e])}});var c=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=i.get(arguments[1])||null),c.apply(this,arguments)}}}},{"./utils":326,sdp:315}],321:[function(e,t,n){"use strict";var r=e("../utils"),i=e("rtcpeerconnection-shim");t.exports={shimGetUserMedia:e("./getusermedia"),shimPeerConnection:function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCPeerConnection=i(e,t.version)},shimReplaceTrack:function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}}},{"../utils":326,"./getusermedia":322,"rtcpeerconnection-shim":210}],322:[function(e,t,n){"use strict";t.exports=function(e){var t=e&&e.navigator,n=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}},r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e)["catch"](function(e){return Promise.reject(n(e))})}}},{}],323:[function(e,t,n){"use strict";var r=e("../utils"),i={shimOnTrack:function(e){"object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.transceiver={receiver:n.receiver},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}}),"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(e){"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(e){var t=r.detectBrowser(e);if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){e.RTCPeerConnection||(e.RTCPeerConnection=function(n,r){if(t.version<38&&n&&n.iceServers){for(var i=[],o=0;o<n.iceServers.length;o++){var a=n.iceServers[o];if(a.hasOwnProperty("urls"))for(var s=0;s<a.urls.length;s++){var c={url:a.urls[s]};0===a.urls[s].indexOf("turn")&&(c.username=a.username,c.credential=a.credential),i.push(c)}else i.push(n.iceServers[o])}n.iceServers=i}return new e.mozRTCPeerConnection(n,r)},e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype,e.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.mozRTCPeerConnection.generateCertificate}}),e.RTCSessionDescription=e.mozRTCSessionDescription,e.RTCIceCandidate=e.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var i=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t},o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,n,r){return a.apply(this,[e||null]).then(function(e){if(t.version<48&&(e=i(e)),t.version<53&&!n)try{e.forEach(function(e){e.type=o[e.type]||e.type})}catch(r){if("TypeError"!==r.name)throw r;e.forEach(function(t,n){e.set(n,Object.assign({},t,{type:o[t.type]||t.type}))})}return e}).then(n,r)}}}};t.exports={shimOnTrack:i.shimOnTrack,shimSourceObject:i.shimSourceObject,shimPeerConnection:i.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":326,"./getusermedia":324}],324:[function(e,t,n){"use strict";var r=e("../utils"),i=r.log;t.exports=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=e&&e.MediaStreamTrack,a=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},s=function(e,r,o){var s=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if((void 0!==r.min||void 0!==r.max||void 0!==r.exact)&&t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var i={};i[n]="number"==typeof r.ideal?{min:r.ideal,max:r.ideal}:r.ideal,e.advanced.push(i),delete r.ideal,Object.keys(r).length||delete e[n]}}}),t.length&&(e.require=t),e};return e=JSON.parse(JSON.stringify(e)),t.version<38&&(i("spec: "+JSON.stringify(e)),e.audio&&(e.audio=s(e.audio)),e.video&&(e.video=s(e.video)),i("ff37: "+JSON.stringify(e))),n.mozGetUserMedia(e,r,function(e){o(a(e))})},c=function(e){return new Promise(function(t,n){s(e,t,n)})};if(n.mediaDevices||(n.mediaDevices={getUserMedia:c,addEventListener:function(){},removeEventListener:function(){}}),n.mediaDevices.enumerateDevices=n.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})},t.version<41){var u=n.mediaDevices.enumerateDevices.bind(n.mediaDevices);n.mediaDevices.enumerateDevices=function(){return u().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(t.version<49){var l=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return l(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return t},function(e){return Promise.reject(a(e))})}}if(!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var d=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},p=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),d(e.audio,"autoGainControl","mozAutoGainControl"),d(e.audio,"noiseSuppression","mozNoiseSuppression")),p(e)},o&&o.prototype.getSettings){var f=o.prototype.getSettings;o.prototype.getSettings=function(){var e=f.apply(this,arguments);return d(e,"mozAutoGainControl","autoGainControl"),d(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var h=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),d(e,"autoGainControl","mozAutoGainControl"),d(e,"noiseSuppression","mozNoiseSuppression")),h.apply(this,[e])}}}n.getUserMedia=function(e,i,o){return t.version<44?s(e,i,o):(r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),void n.mediaDevices.getUserMedia(e).then(i,o))}}},{"../utils":326}],325:[function(e,t,n){"use strict";var r=e("../utils"),i={shimLocalStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;return this._localStreams&&this._localStreams.forEach(function(n){n.id===e&&(t=n)}),this._remoteStreams&&this._remoteStreams.forEach(function(n){
n.id===e&&(t=n)}),t}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(e)&&this._localStreams.push(e);var n=this;e.getTracks().forEach(function(r){t.call(n,r,e)})},e.RTCPeerConnection.prototype.addTrack=function(e,n){n&&(this._localStreams?-1===this._localStreams.indexOf(n)&&this._localStreams.push(n):this._localStreams=[n]),t.call(this,e,n)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var n=this,r=e.getTracks();this.getSenders().forEach(function(e){-1!==r.indexOf(e.track)&&n.removeTrack(e)})}})}},shimRemoteStreamsAPI:function(e){"object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),"onaddstream"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){var t=e.streams[0];if(this._remoteStreams||(this._remoteStreams=[]),!(this._remoteStreams.indexOf(t)>=0)){this._remoteStreams.push(t);var n=new Event("addstream");n.stream=e.streams[0],this.dispatchEvent(n)}}.bind(this))}}))},shimCallbacksAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var s=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=s}},shimGetUserMedia:function(e){var t=e&&e.navigator;t.getUserMedia||(t.webkitGetUserMedia?t.getUserMedia=t.webkitGetUserMedia.bind(t):t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t)))},shimRTCIceServerUrls:function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},shimTrackEventTransceiver:function(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var n=this;if(e){var r=n.getTransceivers().find(function(e){return e.sender.track&&"audio"===e.sender.track.kind});e.offerToReceiveAudio===!1&&r?"sendrecv"===r.direction?r.setDirection("sendonly"):"recvonly"===r.direction&&r.setDirection("inactive"):e.offerToReceiveAudio!==!0||r||n.addTransceiver("audio");var i=n.getTransceivers().find(function(e){return e.sender.track&&"video"===e.sender.track.kind});e.offerToReceiveVideo===!1&&i?"sendrecv"===i.direction?i.setDirection("sendonly"):"recvonly"===i.direction&&i.setDirection("inactive"):e.offerToReceiveVideo!==!0||i||n.addTransceiver("video")}return t.apply(n,arguments)}}};t.exports={shimCallbacksAPI:i.shimCallbacksAPI,shimLocalStreamsAPI:i.shimLocalStreamsAPI,shimRemoteStreamsAPI:i.shimRemoteStreamsAPI,shimGetUserMedia:i.shimGetUserMedia,shimRTCIceServerUrls:i.shimRTCIceServerUrls,shimTrackEventTransceiver:i.shimTrackEventTransceiver,shimCreateOfferLegacy:i.shimCreateOfferLegacy}},{"../utils":326}],326:[function(e,t,n){"use strict";var r=!0,i=!0,o={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(r=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(e,t){i&&console.warn(e+" is deprecated, please use "+t+" instead.")},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(e){var t=e&&e.navigator,n={};if(n.browser=null,n.version=null,"undefined"==typeof e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=this.extractVersion(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia)if(e.webkitRTCPeerConnection)n.browser="chrome",n.version=this.extractVersion(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!t.userAgent.match(/Version\/(\d+).(\d+)/))return n.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",n;n.browser="safari",n.version=this.extractVersion(t.userAgent,/AppleWebKit\/(\d+)\./,1)}else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=this.extractVersion(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!t.mediaDevices||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=this.extractVersion(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return n}};t.exports={log:o.log,deprecated:o.deprecated,disableLog:o.disableLog,disableWarnings:o.disableWarnings,extractVersion:o.extractVersion,shimCreateObjectURL:o.shimCreateObjectURL,detectBrowser:o.detectBrowser.bind(o)}},{}],327:[function(e,t,n){var r,i;window.mozRTCPeerConnection||navigator.mozGetUserMedia?(r="moz",i=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)):(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)&&(r="webkit",i=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10));var o=window.mozRTCPeerConnection||window.webkitRTCPeerConnection,a=window.mozRTCIceCandidate||window.RTCIceCandidate,s=window.mozRTCSessionDescription||window.RTCSessionDescription,c=window.webkitMediaStream||window.MediaStream,u="https:"===window.location.protocol&&("webkit"===r&&i>=26||"moz"===r&&i>=33),l=window.AudioContext||window.webkitAudioContext,d=document.createElement("video"),p=d&&d.canPlayType&&"probably"===d.canPlayType('video/webm; codecs="vp8", vorbis'),f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;t.exports={prefix:r,browserVersion:i,support:!!o&&p&&!!f,supportRTCPeerConnection:!!o,supportVp8:p,supportGetUserMedia:!!f,supportDataChannel:!!(o&&o.prototype&&o.prototype.createDataChannel),supportWebAudio:!(!l||!l.prototype.createMediaStreamSource),supportMediaStream:!(!c||!c.prototype.removeTrack),supportScreenSharing:!!u,dataChannel:!!(o&&o.prototype&&o.prototype.createDataChannel),webAudio:!(!l||!l.prototype.createMediaStreamSource),mediaStream:!(!c||!c.prototype.removeTrack),screenSharing:!!u,AudioContext:l,PeerConnection:o,SessionDescription:s,IceCandidate:a,MediaStream:c,getUserMedia:f}},{}],328:[function(e,t,n){arguments[4][36][0].apply(n,arguments)},{dup:36}],329:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<e.length;n++)t(e[n])}function i(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function o(e,t,n){var r=e;return d(t)?(n=t,"string"==typeof e&&(r={uri:e})):r=f(t,{uri:e}),r.callback=n,r}function a(e,t,n){return t=o(e,t,n),s(t)}function s(e){function t(){4===l.readyState&&setTimeout(o,0)}function n(){var e=void 0;if(e=l.response?l.response:l.responseText||c(l),S)try{e=JSON.parse(e)}catch(t){}return e}function r(e){return clearTimeout(h),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,u(e,b)}function o(){if(!f){var t;clearTimeout(h),t=e.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var r=b,i=null;return 0!==t?(r={body:n(),statusCode:t,method:v,headers:{},url:m,rawRequest:l},l.getAllResponseHeaders&&(r.headers=p(l.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),u(i,r,r.body)}}if("undefined"==typeof e.callback)throw new Error("callback argument missing");var s=!1,u=function(t,n,r){s||(s=!0,e.callback(t,n,r))},l=e.xhr||null;l||(l=e.cors||e.useXDR?new a.XDomainRequest:new a.XMLHttpRequest);var d,f,h,m=l.url=e.uri||e.url,v=l.method=e.method||"GET",g=e.body||e.data,y=l.headers=e.headers||{},_=!!e.sync,S=!1,b={body:void 0,headers:{},statusCode:0,method:v,url:m,rawRequest:l};if("json"in e&&e.json!==!1&&(S=!0,y.accept||y.Accept||(y.Accept="application/json"),"GET"!==v&&"HEAD"!==v&&(y["content-type"]||y["Content-Type"]||(y["Content-Type"]="application/json"),g=JSON.stringify(e.json===!0?g:e.json))),l.onreadystatechange=t,l.onload=o,l.onerror=r,l.onprogress=function(){},l.onabort=function(){f=!0},l.ontimeout=r,l.open(v,m,!_,e.username,e.password),_||(l.withCredentials=!!e.withCredentials),!_&&e.timeout>0&&(h=setTimeout(function(){if(!f){f=!0,l.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",r(e)}},e.timeout)),l.setRequestHeader)for(d in y)y.hasOwnProperty(d)&&l.setRequestHeader(d,y[d]);else if(e.headers&&!i(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(l.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(l),l.send(g||null),l}function c(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(n){}return null}function u(){}var l=e("global/window"),d=e("is-function"),p=e("parse-headers"),f=e("xtend");t.exports=a,t.exports["default"]=a,a.XMLHttpRequest=l.XMLHttpRequest||u,a.XDomainRequest="withCredentials"in new a.XMLHttpRequest?a.XMLHttpRequest:l.XDomainRequest,r(["get","put","post","patch","head","delete"],function(e){a["delete"===e?"del":e]=function(t,n,r){return n=o(t,n,r),n.method=e.toUpperCase(),s(n)}})},{"global/window":38,"is-function":49,"parse-headers":189,xtend:338}],330:[function(e,t,n){t.exports={Namespace:e("./lib/namespaces"),MUC:e("./lib/muc"),PubSub:e("./lib/pubsub"),Jingle:e("./lib/jingle"),Presence:e("./lib/presence")}},{"./lib/jingle":331,"./lib/muc":332,"./lib/namespaces":333,"./lib/presence":334,"./lib/pubsub":335}],331:[function(e,t,n){t.exports={Action:{CONTENT_ACCEPT:"content-accept",CONTENT_ADD:"content-add",CONTENT_MODIFY:"content-modify",CONTENT_REJECT:"content-reject",CONTENT_REMOVE:"content-remove",DESCRIPTION_INFO:"description-info",SECURITY_INFO:"security-info",SESSION_ACCEPT:"session-accept",SESSION_INFO:"session-info",SESSION_INITIATE:"session-initiate",SESSION_TERMINATE:"session-terminate",TRANSPORT_ACCEPT:"transport-accept",TRANSPORT_INFO:"transport-info",TRANSPORT_REJECT:"transport-reject",TRANSPORT_REPLACE:"transport-replace"},Reason:{ALTERNATIVE_SESSION:"alernative-session",BUSY:"busy",CANCEL:"cancel",CONNECTIVITY_ERROR:"connectivity-error",DECLINE:"decline",EXPIRED:"expired",FAILED_APPLICATION:"failed-application",FAILED_TRANSPORT:"failed-transport",GENERAL_ERROR:"general-error",GONE:"gone",INCOMPATIBLE_PARAMETERS:"incompatible-parameters",MEDIA_ERROR:"media-error",SECURITY_ERROR:"security-error",SUCCESS:"success",TIMEOUT:"timeout",UNSUPPORTED_APPLICATIONS:"unsupported-applications",UNSUPPORTED_TRANSPORTS:"unsupported-transports"},Condition:{OUT_OF_ORDER:"out-of-order",TIE_BREAK:"tie-break",UNKNOWN_SESSION:"unknown-session",UNSUPPORTED_INFO:"unsupported-info"}}},{}],332:[function(e,t,n){t.exports={Status:{REALJID_PUBLIC:"100",AFFILIATION_CHANGED:"101",UNAVAILABLE_SHOWN:"102",UNAVAILABLE_NOT_SHOWN:"103",CONFIGURATION_CHANGED:"104",SELF_PRESENCE:"110",LOGGING_ENABLED:"170",LOGGING_DISABLED:"171",NON_ANONYMOUS:"172",SEMI_ANONYMOUS:"173",FULLY_ANONYMOUS:"174",ROOM_CREATED:"201",NICK_ASSIGNED:"210",BANNED:"301",NEW_NICK:"303",KICKED:"307",REMOVED_AFFILIATION:"321",REMOVED_MEMBERSHIP:"322",REMOVED_SHUTDOWN:"332"},Affiliation:{ADMIN:"admin",MEMBER:"member",NONE:"none",OUTCAST:"outcast",OWNER:"owner"},Role:{MODERATOR:"moderator",NONE:"none",PARTICIPANT:"participant",VISITOR:"visitor"}}},{}],333:[function(e,t,n){t.exports={BIND:"urn:ietf:params:xml:ns:xmpp-bind",CLIENT:"jabber:client",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",SERVER:"jabber:server",SESSION:"urn:ietf:params:xml:ns:xmpp-session",STANZA_ERROR:"urn:ietf:params:xml:ns:xmpp-stanzas",STREAM:"http://etherx.jabber.org/streams",STREAM_ERROR:"urn:ietf:params:xml:ns:xmpp-streams",ROSTER:"jabber:iq:roster",ROSTER_VERSIONING:"urn:xmpp:features:rosterver",SUBSCRIPTION_PREAPPROVAL:"urn:xmpp:features:pre-approval",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",DATAFORM:"jabber:x:data",RPC:"jabber:iq:rpc",LAST_ACTIVITY:"jabber:iq:last",PRIVACY:"jabber:iq:privacy",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",ADDRESS:"http://jabber.org/protocol/address",MUC:"http://jabber.org/protocol/muc",MUC_ADMIN:"http://jabber.org/protocol/muc#admin",MUC_OWNER:"http://jabber.org/protocol/muc#owner",MUC_USER:"http://jabber.org/protocol/muc#user",IBB:"http://jabber.org/protocol/ibb",BOOKMARKS:"storage:bookmarks",PRIVATE:"jabber:iq:private",ADHOC_COMMANDS:"http://jabber.org/protocol/commands",VCARD_TEMP:"vcard-temp",SEARCH:"jabber:iq:search",RSM:"http://jabber.org/protocol/rsm",PUBSUB:"http://jabber.org/protocol/pubsub",PUBSUB_ERRORS:"http://jabber.org/protocol/pubsub#errors",PUBSUB_EVENT:"http://jabber.org/protocol/pubsub#event",PUBSUB_OWNER:"http://jabber.org/protocol/pubsub#owner",SOCKS5:"http://jabber.org/protocol/bytestreams",OOB_IQ:"jabber:iq:oob",OOB:"jabber:x:oob",HTTP_AUTH:"http://jabber.org/protocol/http-auth",XHTML_IM:"http://jabber.org/protocol/xhtml-im",REGISTER:"jabber:iq:register",AMP:"http://jabber.org/protocol/amp",GEOLOC:"http://jabber.org/protocol/geoloc",ROSTER_DELIMITER:"roster:delimiter",AVATAR_DATA:"urn:xmpp:avatar:data",AVATAR_METADATA:"urn:xmpp:avatar:metadata",CHAT_STATES:"http://jabber.org/protocol/chatstates",VERSION:"jabber:iq:version",MOOD:"http://jabber.org/protocol/mood",ACTIVITY:"http://jabber.org/protocol/activity",COMPONENT:"jabber:component:accept",CAPS:"http://jabber.org/protocol/caps",TUNE:"http://jabber.org/protocol/tune",DATAFORM_VALIDATION:"http://jabber.org/protocol/xdata-validate",BOSH:"http://jabber.org/protocol/httpbind",SHIM:"http://jabber.org/protocol/shim",COMPRESSION:"http://jabber.org/features/compress",DATAFORM_LAYOUT:"http://jabber.org/protocol/xdata-layout",ROSTER_EXCHANGE:"http://jabber.org/protocol/rosterx",ROSTER_NOTES:"storage:rosternotes",REACH_0:"urn:xmpp:reach:0",VCARD_TEMP_UPDATE:"vcard-temp:x:update",CAPTCHA:"urn:xmpp:captcha",JINGLE_1:"urn:xmpp:jingle:1",JINGLE_ERRORS_1:"urn:xmpp:jingle:errors:1",JINGLE_RTP_1:"urn:xmpp:jingle:apps:rtp:1",JINGLE_RTP_ERRORS_1:"urn:xmpp:jingle:apps:rtp:errors:1",JINGLE_RTP_INFO_1:"urn:xmpp:jingle:apps:rtp:info:1",LANG_TRANS:"urn:xmpp:langtrans",LANG_TRANS_ITEMS:"urn:xmpp:langtrans:items",NICK:"http://jabber.org/protocol/nick",JINGLE_ICE_UDP_1:"urn:xmpp:jingle:transports:ice-udp:1",JINGLE_RAW_UDP_1:"urn:xmpp:jingle:transports:raw-udp:1",RECEIPTS:"urn:xmpp:receipts",INVISIBLE_0:"urn:xmpp:invisible:0",BLOCKING:"urn:xmpp:blocking",SMACKS_3:"urn:xmpp:sm:3",PING:"urn:xmpp:ping",TIME:"urn:xmpp:time",DELAY:"urn:xmpp:delay",BOSH_XMPP:"urn:xmpp:xbosh",DISCO_EXTERNAL_1:"urn:xmpp:extdisco:1",DATAFORM_MEDIA:"urn:xmpp:media-element",ATTENTION_0:"urn:xmpp:attention:0",BOB:"urn:xmpp:bob",FILE_TRANSFER_3:"urn:xmpp:jingle:apps:file-transfer:3",FILE_TRANSFER_4:"urn:xmpp:jingle:apps:file-transfer:4",FILE_TRANSFER_5:"urn:xmpp:jingle:apps:file-transfer:5",MUC_DIRECT_INVITE:"jabber:x:conference",SEC_LABEL_0:"urn:xmpp:sec-label:0",SEC_LABEL_CATALOG_2:"urn:xmpp:sec-label:catalog:2",SEC_LABEL_ESS_0:"urn:xmpp:sec-label:ess:0",JINGLE_SOCKS5_1:"urn:xmpp:jingle:transports:s5b:1",JINGLE_IBB_1:"urn:xmpp:jingle:transports:ibb:1",JINGLE_RTP_ZRTP_1:"urn:xmpp:jingle:apps:rtp:zrtp:1",THUMBS_0:"urn:xmpp:thumbs:0",THUMBS_1:"urn:xmpp:thumbs:1",DECLOAKING_0:"urn:xmpp:decloaking:0",CARBONS_2:"urn:xmpp:carbons:2",JINGLE_RTP_RTCP_FB_0:"urn:xmpp:jingle:apps:rtp:rtcp-fb:0",JINGLE_RTP_HDREXT_0:"urn:xmpp:jingle:apps:rtp:rtp-hdrext:0",FORWARD_0:"urn:xmpp:forward:0",HASHES_1:"urn:xmpp:hashes:1",RTT_0:"urn:xmpp:rtt:0",MUC_UNIQUE:"http://jabber.org/protocol/muc#unique",CORRECTION_0:"urn:xmpp:message-correct:0",PSA:"urn:xmpp:psa",MAM_TMP:"urn:xmpp:mam:tmp",MAM_0:"urn:xmpp:mam:0",MAM_1:"urn:xmpp:mam:1",MAM_2:"urn:xmpp:mam:2",HATS_0:"urn:xmpp:hats:0",IDLE_1:"urn:xmpp:idle:1",JINGLE_DTLS_0:"urn:xmpp:jingle:apps:dtls:0",JID_PREP_0:"urn:xmpp:jidprep:0",HINTS:"urn:xmpp:hints",JSON_0:"urn:xmpp:json:0",EVENTLOG:"urn:xmpp:eventlog",JINGLE_GROUPING_0:"urn:xmpp:jingle:apps:grouping:0",JINGLE_RTP_SSMA_0:"urn:xmpp:jingle:apps:rtp:ssma:0",COLIBRI:"http://jitsi.org/protocol/colibri",DTLS_SCTP_1:"urn:xmpp:jingle:transports:dtls-sctp:1",CSI:"urn:xmpp:csi",JINGLE_MSG_INITIATE_0:"urn:xmpp:jingle:jingle-message:0",PUSH_0:"urn:xmpp:push:0",JINGLE_PUB_1:"urn:xmpp:jinglepub:1",STANZA_ID_0:"urn:xmpp:sid:0",HTTP_UPLOAD_0:"urn:xmpp:http:upload:0",JINGLE_HTTP_0:"urn:xmpp:jingle:transports:http:0",JINGLE_HTTP_UPLOAD_0:"urn:xmpp:jingle:transports:http:upload:0",REFERENCE_0:"urn:xmpp:reference:0",SPOILER_0:"urn:xmppp:spoiler:0"}},{}],334:[function(e,t,n){t.exports={Type:{SUBSCRIBE:"subscribe",SUBSCRIBED:"subscribed",UNSUBSCRIBE:"unsubscribe",UNSUBSCRIBED:"unsubscribed",PROBE:"probe",UNAVAILABLE:"unavailable"},Show:{CHAT:"chat",AWAY:"away",DO_NOT_DISTURB:"dnd",EXTENDED_AWAY:"xa"}}},{}],335:[function(e,t,n){t.exports={Affiliation:{MEMBER:"member",NONE:"none",OUTCAST:"outcast",OWNER:"owner",PUBLISHER:"publisher",PUBLISH_ONLY:"publish-only"},Subscription:{NONE:"none",PENDING:"pending",UNCONFIGURED:"unconfigured",SUBSCRIBED:"subscribed"},AccessModel:{OPEN:"open",PRESENCE:"presence",ROSTER:"roster",AUTHORIZE:"authorize",WHITELIST:"whitelist"},Condition:{CONFLICT:"conflict"}}},{}],336:[function(e,t,n){"use strict";function r(e,t){return e?e+"@"+t:t}function i(e,t,n){return n?r(e,t)+"/"+n:r(e,t)}var o=e("./lib/stringprep"),a=/^[\x00-\x7F]*$/;n.prep=function(e){var t=e.local,a=e.domain,s=e.resource,c=t;return t&&(t=o.nodeprep(t),c=n.unescape(t)),s&&(s=o.resourceprep(s)),"."===a[a.length-1]&&(a=a.slice(0,a.length-1)),a=o.nameprep(a.split(".").map(o.toUnicode).join(".")),{prepped:e.prepped||o.available,local:t,domain:a,resource:s,bare:r(t,a),full:i(t,a,s),unescapedLocal:c,unescapedBare:r(c,a),unescapedFull:i(c,a,s)}},n.parse=function(e,t){var r="",i="",o="";t=t||a.test(e);var s=e.indexOf("/");s>0&&(o=e.slice(s+1),e=e.slice(0,s));var c=e.indexOf("@");c>0&&(r=e.slice(0,c),e=e.slice(c+1)),i=e;var u=n.prep({local:r,domain:i,resource:o});return u.prepped=u.prepped||t,u},n.equal=function(e,t,r){return e=new n.JID(e),t=new n.JID(t),2===arguments.length&&(r=!0),e.local===t.local&&e.domain===t.domain&&e.resource===t.resource&&(r?e.prepped&&t.prepped:!0)},n.equalBare=function(e,t,r){return e=new n.JID(e),t=new n.JID(t),2===arguments.length&&(r=!0),e.local===t.local&&e.domain===t.domain&&(r?e.prepped&&t.prepped:!0)},n.isBare=function(e){e=new n.JID(e);var t=!!e.resource;return!t},n.isFull=function(e){e=new n.JID(e);var t=!!e.resource;return t},n.escape=function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\\5c/g,"\\5c5c").replace(/\\20/g,"\\5c20").replace(/\\22/g,"\\5c22").replace(/\\26/g,"\\5c26").replace(/\\27/g,"\\5c27").replace(/\\2f/g,"\\5c2f").replace(/\\3a/g,"\\5c3a").replace(/\\3c/g,"\\5c3c").replace(/\\3e/g,"\\5c3e").replace(/\\40/g,"\\5c40").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},n.unescape=function(e){return e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},n.create=function(e,t,r){return new n.JID(e,t,r)},n.JID=function(e,t,r){var i={};if(!e||t||r)if(t){var o=a.test(e)&&a.test(t);r&&(o=o&&a.test(r)),i=n.prep({local:n.escape(e),domain:t,resource:r,prepped:o})}else i={};else if("string"==typeof e)i=n.parse(e);else{if(!(e._isJID||e instanceof n.JID))throw new Error("Invalid argument type");i=e}this._isJID=!0,this.local=i.local||"",this.domain=i.domain||"",this.resource=i.resource||"",this.bare=i.bare||"",this.full=i.full||"",this.unescapedLocal=i.unescapedLocal||"",this.unescapedBare=i.unescapedBare||"",this.unescapedFull=i.unescapedFull||"",this.prepped=i.prepped},n.JID.prototype.toString=function(){return this.full},n.JID.prototype.toJSON=function(){return this.full}},{"./lib/stringprep":337}],337:[function(e,t,n){"use strict";var r=e("punycode");n.available=!1,n.toUnicode=r.toUnicode,n.nameprep=function(e){return e.toLowerCase()},n.nodeprep=function(e){return e.toLowerCase()},n.resourceprep=function(e){return e}},{punycode:191}],338:[function(e,t,n){function r(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)i.call(n,r)&&(e[r]=n[r])}return e}t.exports=r;var i=Object.prototype.hasOwnProperty},{}],339:[function(e,t,n){"use strict";function r(e){window.VC=e}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("es6-promise"),a=e("./vidyo_simple_api/VidyoSimple"),s=e("./IntergrationTestEvents"),c=function(e){function t(t,n){var r=e.call(this)||this;return window.VC=t||r,window.onVidyoClientLoaded({state:"READY"}),r._eventDispatcher=r._vidyoCore.EventDispatcher,r}return i(t,e),t.prototype.Connect=function(e,t,n,r,i,a,c){var u=this;return null!=i&&this._eventDispatcher.on(s.IntegrationTestEvents.Connect,i),null!=c&&this._eventDispatcher.on(s.IntegrationTestEvents.Disconnect,c),null!=a&&this._eventDispatcher.on(s.IntegrationTestEvents.ConnectionError,a),new o.Promise(function(e,n){u._eventDispatcher.on(s.IntegrationTestEvents.Connect,e),u._eventDispatcher.on(s.IntegrationTestEvents.Disconnect,e),u._eventDispatcher.on(s.IntegrationTestEvents.ConnectionError,n),"badToken"===t?u._eventDispatcher.emit(s.IntegrationTestEvents.ConnectionError,"Stubbed connection error"):u._eventDispatcher.emit(s.IntegrationTestEvents.Connect,"Stubbed connection")})},t.prototype.Disconnect=function(){this._eventDispatcher.emit(s.IntegrationTestEvents.Disconnect,"Stubbed disconnect")},t.prototype.GetVidyoClient=function(){return this},t}(a.VidyoSimple);n.StartVidyoSimple=c,n.SaveGlobalVidyoClient=r},{"./IntergrationTestEvents":340,"./vidyo_simple_api/VidyoSimple":495,"es6-promise":31}],340:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./core/utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Connect=new i.EventDescriptor,t.ConnectionError=new i.EventDescriptor,t.Disconnect=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.IntegrationTestEvents=i.CreateEventList("IntegrationTest",o)},{"./core/utils/EventListFactory":428}],341:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./controllers/StreamController/TrackMetaDataProvider");n.MediaTrackType=r.MediaTrackType;var i=function(){function e(e){this._vidyoCore=e}return Object.defineProperty(e.prototype,"AdvancedSettings",{get:function(){return this._vidyoCore.Controllers.AdvancedSettingsController},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Log",{get:function(){return this._vidyoCore.Controllers.LogController},enumerable:!0,configurable:!0}),e.prototype.GetLocalStreamMediaType=function(e){return this._vidyoCore.Controllers.LocalStreamController.GetTrackMediaType(e)},e}();n.SimplifiedVidyoCore=i},{"./controllers/StreamController/TrackMetaDataProvider":364}],342:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),e("./utils/WebRTCAdapterLoader");var r=e("../render/RendererFactory"),i=e("./controllers/AdvancedSettingsController"),o=e("./controllers/BaseController"),a=e("./controllers/CallStateController"),s=e("./controllers/ConferenceController/ConferenceController"),c=e("./controllers/ConnectionController"),u=e("./events/EventDispatcher"),l=e("./controllers/DeviceController"),d=e("../vidyo_simple_api/EndPoint"),p=e("./controllers/StreamController/LocalStreamController"),f=e("./controllers/LogController"),h=e("./controllers/ParticipantController"),m=e("./controllers/PersistedSettingsController"),v=e("./controllers/StreamController/RemoteStreamController"),g=e("./controllers/RendererController"),y=e("./controllers/RoomController"),_=e("./SimplifiedVidyoCore"),S=e("./controllers/StatisticsController"),b=e("./controllers/StreamController/TransmittedStreamController"),C=e("../vidyo_simple_api/User"),w=e("./controllers/UserController"),E=e("./xmpp/XmppProvider"),R=e("./models/LocalWebStorage"),P=e("./utils/ObjectUtils"),x=e("./controllers/MicrophoneEnergyLevelController"),T=e("./controllers/ResourcesController"),L=function(){function e(){this.Controllers=o.CreateControllers(this,{AdvancedSettingsController:i.AdvancedSettingsController,CallStateController:a.CallStateController,ConferenceController:s.ConferenceController,ConnectionController:c.ConnectionController,DeviceController:l.DeviceController,LocalStreamController:p.LocalStreamController,MicrophoneEnergyLevelController:x.MicrophoneEnergyLevelController,LogController:f.LogController,ParticipantController:h.ParticipantController,PersistedSettingsController:m.PersistedSettingsController,RendererController:g.RendererController,ResourcesController:T.ResourcesController,RoomController:y.RoomController,StatisticsController:S.StatisticsController,RemoteStreamController:v.RemoteStreamController,TransmittedStreamController:b.TransmittedStreamController,UserController:w.UserController}),this.Diagnostics=new O,this.Storage=R.localWebStorage,this.EventDispatcher=u.CreateEventDispatcher(),this.XmppProvider=new E.XmppProvider(this.EventDispatcher,new _.SimplifiedVidyoCore(this),this.Controllers.LogController),window["vidyoCore"+Math.floor(10*Math.random())]=this}return e.prototype.CreateEndpoint=function(e,t,n){return this._renderer=r.CreateRenderer(e,t,this),this.Controllers.ResourcesController.ReinitResourceController(n),new d.EndPoint(this)},e.prototype.CreateUser=function(e){return new C.User(this)},e.prototype.Disable=function(){var e=this;return this.Controllers.ConnectionController.Disable().then(function(){e.Controllers.MicrophoneEnergyLevelController.Disable()}).then(function(){e.Controllers.StatisticsController.Disable()}).then(function(){e.Controllers.LocalStreamController.Disable()}).then(function(){e.Controllers.RemoteStreamController.Disable()}).then(function(){e.Controllers.TransmittedStreamController.Disable()}).then(function(){e.Controllers.ResourcesController.Disable()}).then(function(){e._renderer&&e._renderer.Destroy()}).then(function(){e.Controllers.DeviceController.Disable()}).then(function(){e.Controllers.CallStateController.Disable()}).then(function(){e.Controllers.ConferenceController.Disable()}).then(function(){e.Controllers.RoomController.Disable()}).then(function(){e.Controllers.ParticipantController.Disable()}).then(function(){e.Controllers.UserController.Disable()}).then(function(){e.Controllers.RendererController.Disable()}).then(function(){e.Controllers.PersistedSettingsController.Disable()}).then(function(){e.Controllers.AdvancedSettingsController.Disable()}).then(function(){e.Controllers.LogController.Disable()}).then(function(){return e.EventDispatcher.releaseAll(),Promise.resolve(!0)})["catch"](function(e){throw e?e:new Error("Failed to Disable VidyoCore")})},e.prototype.Initialize=function(){var e=Object.values(this.Controllers);return Promise.all(e.map(function(e){return e.Initialize()["catch"](function(t){throw new Error("Failed to initialize controller "+e.constructor.name+" ("+t+")")})})).then(function(){return Promise.resolve(!0)})},e.Version="0.0.0.1",e}();n.VidyoCore=L;var O=function(){function e(){}return e.prototype.LayoutParameters=function(){var e=document.querySelector(".vidyo-rendering-container");if(!e)throw new Error("Failed to find .vidyo-rendering-container");var t=e.querySelectorAll("video"),n=P["default"].MapObject(t,function(e){return e.videoWidth}).filter(function(e){return e>0}),r=n.reduce(function(e,t){return e+t}),i=P["default"].MapObject(t,function(e){return e.videoHeight}).filter(function(e){return e>0}),o=i.reduce(function(e,t){return e+t}),a=r/o/(e.clientWidth/e.clientHeight);return t.length+" videos, "+e.clientWidth+" x "+e.clientHeight+" container,\n        average video is "+r/n.length+" x "+o/i.length+"\n        (threshold === "+a+")"},e}();n.VidyoDiagnostics=O},{"../render/RendererFactory":482,"../vidyo_simple_api/EndPoint":489,"../vidyo_simple_api/User":494,"./SimplifiedVidyoCore":341,"./controllers/AdvancedSettingsController":343,"./controllers/BaseController":344,"./controllers/CallStateController":345,"./controllers/ConferenceController/ConferenceController":346,"./controllers/ConnectionController":351,"./controllers/DeviceController":352,"./controllers/LogController":353,"./controllers/MicrophoneEnergyLevelController":354,"./controllers/ParticipantController":355,"./controllers/PersistedSettingsController":356,"./controllers/RendererController":357,"./controllers/ResourcesController":358,"./controllers/RoomController":359,"./controllers/StatisticsController":360,"./controllers/StreamController/LocalStreamController":361,"./controllers/StreamController/RemoteStreamController":362,"./controllers/StreamController/TransmittedStreamController":365,"./controllers/UserController":366,"./events/EventDispatcher":372,"./models/LocalWebStorage":381,"./utils/ObjectUtils":435,"./utils/WebRTCAdapterLoader":447,"./xmpp/XmppProvider":450}],343:[function(e,t,n){"use strict";function r(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AddGoogleConferenceFlag=!1,t.CodecExcludeFilter="",t.DisableStats=!1,t.EnableSimpleAPILogging=!1,t.EnableSimulcast=!1,t.EnableVidyoConnectorAPILogging=!1,t.EnableXMPPMessageLogging=!1,
t.ParticipantLimit=c.ParticipantLimit,t.ShowStatisticsOverlay=!1,t}return i(t,e),t}(e)}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("../events/AdvancedSettingsEvents"),a=e("./BaseController"),s=e("../utils/AutoPropertyHelper"),c=e("../utils/Constants"),u={AddGoogleConferenceFlag:o.Events.AddGoogleConferenceFlagChanged,CodecExcludeFilter:o.Events.CodecExcludeFilterChanged,DisableStats:o.Events.DisableStatsChanged,EnableSimpleAPILogging:o.Events.EnableSimpleAPILoggingChanged,EnableSimulcast:o.Events.EnableSimulcastChanged,EnableVidyoConnectorAPILogging:o.Events.EnableVidyoConnectorAPILoggingChanged,EnableXMPPMessageLogging:o.Events.EnableXMPPMessageLoggingChanged,ParticipantLimit:o.Events.ParticipantLimitChanged,ShowStatisticsOverlay:o.Events.ShowStatisticsOverlayChanged},l={CodecExcludeFilter:function(e){try{return new RegExp(e),!0}catch(t){return t}},ParticipantLimit:function(e){var t=1e3;return"number"==typeof e&&!isNaN(e)&&e>=0&&t>e}},d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Silent=!1,t}return i(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Initialize=function(){var t=this,n=r(Object),i=new n;return s.CreateAutoProperties(r,this,function(e){var n=i[e];return{get:function(){return n},set:function(r){var i=l[e]||function(){return!0},o=i(r);if(o===!0){var a=n!==r;n=r,a&&u[e]&&t._vidyoCore.EventDispatcher.emit(u[e],r)}else t.Silent||console.warn('Cannot assign "'+r+'" to AdvancedSettings.'+e+"."+("boolean"==typeof o?"":o))}}}),e.prototype.Initialize.call(this)},t}(r(a.BaseController));n.AdvancedSettingsController=d},{"../events/AdvancedSettingsEvents":367,"../utils/AutoPropertyHelper":422,"../utils/Constants":426,"./BaseController":344}],344:[function(e,t,n){"use strict";function r(e,t){var n={};return Object.keys(t).forEach(function(r){return n[r]=new t[r](e)}),n}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e){this._vidyoCore=e}return e.prototype.Disable=function(){return Promise.resolve(!0)},e.prototype.Initialize=function(){return Promise.resolve(void 0)},e}();n.BaseController=i,n.CreateControllers=r},{}],345:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../events/CallStateEvents"),o=e("../events/ConferenceEvents"),a=e("../events/ConnectionEvents"),s=e("./BaseController"),c=e("../events/EventDispatcher"),u=function(){function e(){this._name="<no name>"}return e.prototype.EnableMedia=function(){return this},e.prototype.StartTransmitting=function(){return this},e.prototype.StopTransmitting=function(){return this},e.prototype.toString=function(){return"MediaState."+this._name},e}();n.BaseMediaState=u;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="Off",t}return r(t,e),t.prototype.EnableMedia=function(){return n.MediaState.PreviewOnly},Object.defineProperty(t.prototype,"ShouldRenderMedia",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShouldTransmitMedia",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(u),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="PreviewOnly",t}return r(t,e),t.prototype.StartTransmitting=function(){return n.MediaState.Transmitting},Object.defineProperty(t.prototype,"ShouldRenderMedia",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShouldTransmitMedia",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(u),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="Transmitting",t}return r(t,e),t.prototype.StopTransmitting=function(){return n.MediaState.PreviewOnly},Object.defineProperty(t.prototype,"ShouldRenderMedia",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShouldTransmitMedia",{get:function(){return!0},enumerable:!0,configurable:!0}),t}(u);n.MediaState={Off:new l,PreviewOnly:new d,Transmitting:new p};var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mediaState=n.MediaState.Off,t}return r(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.EnableMedia=function(){this._transition(this._mediaState.EnableMedia())},t.prototype.Initialize=function(){var t=this;return this._vidyoCore.EventDispatcher.releaseGroup(c.CallStateControllerListeners),this._vidyoCore.EventDispatcher.on(o.Events.ConferenceJoined,c.CallStateControllerListeners,function(){return t._startTransmitting()}),this._vidyoCore.EventDispatcher.on(a.Events.Disconnected,c.CallStateControllerListeners,function(){return t._stopTransmitting()}),e.prototype.Initialize.call(this)},Object.defineProperty(t.prototype,"MediaState",{get:function(){return this._mediaState},enumerable:!0,configurable:!0}),t.prototype._startTransmitting=function(){this._transition(this._mediaState.StartTransmitting())},t.prototype._stopTransmitting=function(){this._transition(this._mediaState.StopTransmitting())},t.prototype._transition=function(e){e!==this._mediaState&&(this._vidyoCore.EventDispatcher.emit(i.Events.MediaStateTransition,e),this._mediaState=e)},t}(s.BaseController);n.CallStateController=f},{"../events/CallStateEvents":368,"../events/ConferenceEvents":369,"../events/ConnectionEvents":370,"../events/EventDispatcher":372,"./BaseController":344}],346:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../models/ConferenceCommandParameters"),o=e("../../events/ConferenceEvents"),a=e("../../events/ConnectionEvents"),s=e("../../events/RenderEvents"),c=e("../../events/EventDispatcher"),u=e("./ConferenceDialog"),l=e("../../models/ConferenceDialogIdentity"),d=e("../../utils/Constants"),p=e("../../models/Source"),f=e("../../models/Participant"),h=e("es6-promise"),m=e("../../models/RendererTypes"),v=e("./SubscriptionDialog"),g=e("../BaseController"),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.ActivateParticipant=function(e){var t=this,n=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e);n&&n.IsRemote&&(this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([{participantId:n.Id,update:{Active:!0}}]),n.Sources.forEach(function(e){e.Type===p.SourceMediaType.Video&&t._setSourceProperties({enable:!0,framesPerSec:30,height:360,pixelRate:6912e3,sourceId:Number(e.Ssrc),width:640})}))},t.prototype.DeactivateParticipant=function(e){var t=this,n=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e);n&&n.IsRemote&&(this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([{participantId:n.Id,update:{Active:!1}}]),n.Sources.forEach(function(e){e.Type===p.SourceMediaType.Video&&t._setSourceProperties({enable:!1,framesPerSec:30,height:360,pixelRate:6912e3,sourceId:Number(e.Ssrc),width:640})}))},t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Initialize=function(){var e=this;return this._nextLocalDialogId=0,this._dialogIdentity=new l.DialogIdentity,this._vidyoCore.EventDispatcher.releaseGroup(c.ConferenceControllerListeners),this._vidyoCore.EventDispatcher.on(a.Events.LmiXmppMucMediaConf,c.ConferenceControllerListeners,function(t){return e._onLmiXmppMucMediaConf(t)}),this._vidyoCore.EventDispatcher.on(a.Events.JingleAccepted,c.ConferenceControllerListeners,function(t){return e._onJingleAccepted(t)}),this._vidyoCore.EventDispatcher.on(a.Events.MediaSessionStarted,c.ConferenceControllerListeners,function(t){return e._onMediaSessionStarted(t)}),this._vidyoCore.EventDispatcher.on(a.Events.Disconnected,c.ConferenceControllerListeners,function(t){return e._onDisconnected(t)}),this._vidyoCore.EventDispatcher.on(s.Events.VideoResolutionChanged,c.ConferenceControllerListeners,function(){return e._onVideoResolutionChanged()}),this._vidyoCore.Controllers.ParticipantController.InitParticipantList(),h.Promise.resolve(void 0)},t.prototype.ShowSource=function(e){this.ConferenceDialog&&this.ConferenceDialog.Show({sourceId:e,state:"on"})},t.prototype.StartConferenceDialog=function(e){var t=this._dialogIdentity.Clone(this._generateLocalDialogId());this._ensureIdIsFinalized("start conference dialog",t),this.ConferenceDialog=new u.ConferenceDialog(this._vidyoCore.EventDispatcher,t.ToObject(),this._vidyoCore.XmppProvider),this.ConferenceDialog.Join(e)},t.prototype.StartParticipantSubscriptionDialog=function(e){var t=this;e["package"]="participant",this.ParticipantDialog=this.StartSubscriptionDialog(e),this.ParticipantDialog.OnNotifyParticipant(function(e){t._onParticipantNotifyMessage(e)})},t.prototype.StartSelectedParticipantSubscriptionDialog=function(e){var t=this;e["package"]="selectedparticipant",this.SelectedParticipantDialog=this.StartSubscriptionDialog(e),this.SelectedParticipantDialog.OnNotifySelectedParticipant(function(e){t._onSelectedParticipantNotifyMessage(e)})},t.prototype.StartSubscriptionDialog=function(e){var t=this._dialogIdentity.Clone(this._generateLocalDialogId());this._ensureIdIsFinalized("start subscription dialog",t);var n=new v.SubscriptionDialog(this._vidyoCore.EventDispatcher,t.ToObject(),this._vidyoCore.XmppProvider);return n.Subscribe(e),n},t.prototype._addParticipant=function(e){var t=e.participantUri,n=t===this._vidyoCore.Controllers.RoomController.RoomUserResourceId()?f.ParticipantOrigin.Local:f.ParticipantOrigin.Remote;this._vidyoCore.Controllers.ParticipantController.CreateParticipant(t,n,e.displayText)},t.prototype._addSource=function(e,t){var n=e.participantUri,r=new p.Source(t.id.toString(),t.name,t.type);return this._vidyoCore.Controllers.ParticipantController.UpdateParticipant(n,r),r},t.prototype._checkSourcesChanged=function(e){var t=this,n=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.participantUri);if(n){var r=[],i=n.Sources.filter(function(t){return e.sources&&e.sources.some(function(e){return e.idStr===t.Ssrc})?!0:(r.push({ssrc:t.Ssrc,participantId:n.Id,type:t.Type}),!1)});n.UpdateSources(i),r.forEach(function(e){t._vidyoCore.EventDispatcher.emit(o.Events.SourceRemoved,e)})}},t.prototype._ensureIdIsFinalized=function(e,t){if(!t.IsFinalized()){var n="ConferenceController: Cannot "+e+" without a complete DialogIdentity object.\nDialogIdentity: "+JSON.stringify(t,null,1).replace(/["\n]/g,"");throw new Error(n)}},t.prototype._generateLocalDialogId=function(){return this._nextLocalDialogId+=1,this._nextLocalDialogId},t.prototype._isNewSource=function(e,t){var n=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.participantUri);return n?!n.HasSource(t.idStr):!0},t.prototype._onDisconnected=function(e){var t=this;this._nextLocalDialogId=0,this._vidyoCore.Controllers.ParticipantController.GetParticipants().forEach(function(e){t._vidyoCore.Controllers.ParticipantController.RemoveParticipant(e.Id)}),this._dialogIdentity=new l.DialogIdentity},t.prototype._onJingleAccepted=function(e){this._dialogIdentity.Session=e.sid},t.prototype._onLmiXmppMucMediaConf=function(e){this._dialogIdentity.Conference=e.id,this._dialogIdentity.Reflector=e.reflector},t.prototype._onMediaSessionStarted=function(e){var t=this,n={displayText:this._vidyoCore.Controllers.UserController.UserDisplayName()};this._vidyoCore.Controllers.ConferenceController.StartConferenceDialog(n),this.ConferenceDialog&&this.ConferenceDialog.PromiseToOpen.then(function(){var e={duration:d.SubscriptionDialogDuration};t._vidyoCore.Controllers.ConferenceController.StartParticipantSubscriptionDialog(e),t._sendDynamicShow(),t._vidyoCore.Controllers.RendererController.RenderMode===m.RenderMode.Composite&&t._vidyoCore.Controllers.ConferenceController.StartSelectedParticipantSubscriptionDialog(e)})},t.prototype._onParticipantNotifyMessage=function(e){var t=this;i.IsSourceNotification(e)?e.notify.event.participantPackageContent.participants.forEach(function(e){t._processOnSourceNotification(e)}):i.IsLeaveNotification(e)&&e.notify.event.participantPackageContent.participants.forEach(function(e){t._vidyoCore.Controllers.ParticipantController.RemoveParticipant(e.participantUri)})},t.prototype._onSelectedParticipantNotifyMessage=function(e){var t=this,n={};e.notify.event.selectedParticipantPackageContent&&e.notify.event.selectedParticipantPackageContent.selectedParticipants&&e.notify.event.selectedParticipantPackageContent.selectedParticipants.forEach(function(e){n[e.id]=e.generation});var r=this._vidyoCore.Controllers.ParticipantController.GetParticipants(),a=this._vidyoCore.Controllers.ResourcesController.SelfViewPolicy(),s=0;if(r.length){var c=0,u=Object.keys(n).length,l=u;r.forEach(function(e){n.hasOwnProperty(e.Id)?(e.Generation=n[e.Id],(e.IsRemote||a===i.SelfViewPolicy.ShowSelf)&&s++):e.Generation=l++}),r=r.sort(function(e,t){return e.Generation-t.Generation});var d=this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit,p=(this._vidyoCore.Controllers.ResourcesController.AudioCount,Math.min(s,d));r.forEach(function(e){var n=!1;if(p>c){switch(a){case i.SelfViewPolicy.HideSelf:n=e.IsRemote;break;case i.SelfViewPolicy.ShowSelf:n=!0;break;case i.SelfViewPolicy.ShowSelfIfNoOther:n=e.IsRemote;break;default:n=!1,t._vidyoCore.Controllers.LogController.LogError("WRONG users's ACTIVE setting!")}n&&c++}e.Active=n});var f=function(e){return!(e.IsRemote&&e.Active)},h=a===i.SelfViewPolicy.ShowSelfIfNoOther;if(h&&r.every(f)){var m=r.filter(function(e){return e.IsLoopback})[0];m&&(m.Active=!0)}this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([]),this._vidyoCore.EventDispatcher.emit(o.Events.SelectedParticipantsChanged,{participants:r})}},t.prototype._onSourceNotification=function(e,t){if(this._isNewSource(e,t)){var n=this._addSource(e,t),r=this._vidyoCore.Controllers.ParticipantController.GetParticipant(e.participantUri);if("application"===n.Type){var i=10;this.ShowSource(parseInt(n.Ssrc,i))}this._vidyoCore.EventDispatcher.emit(o.Events.SourceDetected,{ssrc:n.Ssrc,name:t.name,origin:r.Origin,participantId:e.participantUri,participantName:e.displayText,type:n.Type})}},t.prototype._onVideoResolutionChanged=function(){this._sendDynamicShow()},t.prototype._processOnSourceNotification=function(e){var t=this;"join"===e.event&&this._addParticipant(e),("update"===e.event||"join"===e.event)&&(e.sources&&e.sources.forEach(function(n){t._onSourceNotification(e,n)}),this._checkSourcesChanged(e))},t.prototype._sendDynamicShow=function(){this._vidyoCore.Controllers.ResourcesController.SendDynamicShow()},t.prototype._setSourceProperties=function(e){var t={sourceId:e.sourceId,state:e.enable?i.SourceState.On:i.SourceState.Off,params:{windowSize:{height:e.height,width:e.width},framesPerSec:e.framesPerSec,pixelRate:e.pixelRate}};this.ConferenceDialog&&this.ConferenceDialog.Show(t)},t}(g.BaseController);n.ConferenceController=y},{"../../events/ConferenceEvents":369,"../../events/ConnectionEvents":370,"../../events/EventDispatcher":372,"../../events/RenderEvents":375,"../../models/ConferenceCommandParameters":379,"../../models/ConferenceDialogIdentity":380,"../../models/Participant":383,"../../models/RendererTypes":385,"../../models/Source":387,"../../utils/Constants":426,"../BaseController":344,"./ConferenceDialog":347,"./SubscriptionDialog":350,"es6-promise":31}],347:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i,o=e("../../events/ConferenceEvents"),a=e("./DialogBaseState"),s=e("../../events/EventDispatcher"),c=e("./Dialog"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.Join=function(e){return this._handleStateResult(this._state().Join(this._context,e))},t.prototype.Leave=function(e){return this._handleStateResult(this._state().Leave(this._context,e))},t.prototype.Show=function(e){return this._handleStateResult(this._state().Show(this._context,e))},t.prototype.ShowSelected=function(e){return this._handleStateResult(this._state().ShowSelected(this._context,e))},t.prototype.State=function(){return this._state().Name},t.prototype.Update=function(e){return this._handleStateResult(this._state().Update(this._context,e))},t.prototype._initialize=function(){var e=this;this._transitionTo(i.Closed),this._eventDispatcher.on(o.Events.ConferenceRejected.Scoped(this._id),s.ConnectonControllerListeners,function(t){e._transitionTo(e._state().AfterReject())}),this._eventDispatcher.on(o.Events.ConferenceAccepted.Scoped(this._id),s.ConnectonControllerListeners,function(t){e._transitionTo(e._state().AfterAccept(e._context,t)),e._eventDispatcher.emit(o.Events.ConferenceJoined)})},t.prototype._handleStateResult=function(e){return this._transitionTo(e.nextState),e.returnValue},t.prototype._state=function(){return this._readonlyState},t.prototype._transitionTo=function(e){var t=this._readonlyState&&this._readonlyState.Name;this._readonlyState=e,this._handleImportantStateTransitions(t,e.Name)},t}(c.Dialog);n.ConferenceDialog=u;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._dialogName="ConferenceDialog",t}return r(t,e),t.prototype.AfterAccept=function(e,t){return this},t.prototype.AfterReject=function(){return this},t.prototype.Join=function(e,t){return this._invalidAction("join")},t.prototype.Leave=function(e,t){return this._invalidAction("leave")},t.prototype.Show=function(e,t){return this._invalidAction("show")},t.prototype.ShowSelected=function(e,t){return this._invalidAction("show selected")},t.prototype.Update=function(e,t){return this._invalidAction("update")},t}(a.BaseState),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Closed",t}return r(t,e),t.prototype.Join=function(e,t){return{nextState:i.Pending,returnValue:e.Commands.ConferenceJoin(e.Identity,t)}},t}(l),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Pending",t}return r(t,e),t.prototype.AfterAccept=function(e,t){return t&&t.dialogId&&(e.Identity.RemoteId=t.dialogId.local),i.Open},t.prototype.AfterReject=function(){return i.Terminated},t}(l),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Open",t}return r(t,e),t.prototype.Leave=function(e,t){return{nextState:i.Terminated,returnValue:e.Commands.ConferenceLeave(e.Identity,t)}},t.prototype.Show=function(e,t){return{nextState:this,returnValue:e.Commands.ConferenceShow(e.Identity,t)}},t.prototype.ShowSelected=function(e,t){return{nextState:this,returnValue:e.Commands.ConferenceShowSelected(e.Identity,t)}},t.prototype.Update=function(e,t){return{nextState:this,returnValue:e.Commands.ConferenceUpdate(e.Identity,t)}},t}(l),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Terminated",t}return r(t,e),t}(l);i={Closed:new d,Pending:new p,Open:new f,Terminated:new h}},{"../../events/ConferenceEvents":369,"../../events/EventDispatcher":372,"./Dialog":348,"./DialogBaseState":349}],348:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("es6-promise"),i=function(){function e(e,t,n){var i=this;this._id=t.LocalId,this._eventDispatcher=e,this._context=new o(t,n),this.PromiseToOpen=new r.Promise(function(e,t){i._isOpen=e,i._cannotOpen=t}),this._initialize()}return e.prototype.Identity=function(){return this._context.Identity},e.prototype._handleImportantStateTransitions=function(e,t){"Open"===t&&this._isOpen(),"Terminated"===t&&"Pending"===e&&this._cannotOpen()},e.prototype._initialize=function(){},e}();n.Dialog=i;var o=function(){function e(e,t){this.Identity=e,this.Commands=t}return e}();n.DialogContext=o},{"es6-promise":31}],349:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this._dialogName="<this._dialogName is not defined>"}return e.prototype._invalidAction=function(e){throw new Error("CmcpStateError: cannot "+e+" when "+this._dialogName+" is in the '"+this.Name+"' state")},e}();n.BaseState=r},{}],350:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i,o=e("./Dialog"),a=e("./DialogBaseState"),s=e("../../events/EventDispatcher"),c=e("../../events/ConferenceEvents"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.OnNotifyParticipant=function(e){this._eventDispatcher.on(c.Events.NotifyParticipant.Scoped(this._id),s.ConnectonControllerListeners,e)},t.prototype.OnNotifySelectedParticipant=function(e){this._eventDispatcher.on(c.Events.NotifySelectedParticipant.Scoped(this._id),s.ConnectonControllerListeners,e)},t.prototype.State=function(){return this._state().Name},t.prototype.Subscribe=function(e){var t=this._state().Subscribe(this._context,e);return this._transitionTo(t.nextState),t.returnValue},t.prototype.Unsubscribe=function(e){var t=this._state().Unsubscribe(this._context,e);return this._transitionTo(t.nextState),t.returnValue},t.prototype._initialize=function(){var e=this;this._transitionTo(i.Closed),this._eventDispatcher.on(c.Events.Reply.Scoped(this._id),s.ConnectonControllerListeners,function(t){e._transitionTo(e._state().AfterSubscribeAck(e._context,t))}),this._eventDispatcher.on(c.Events.SubscribeTimeout.Scoped(this._id),s.ConnectonControllerListeners,function(){e._transitionTo(e._state().AfterSubscribeTimeout())})},t.prototype._state=function(){return this._readonlyState},t.prototype._transitionTo=function(e){var t=this._readonlyState&&this._readonlyState.Name;this._readonlyState=e,this._handleImportantStateTransitions(t,e.Name)},t}(o.Dialog);n.SubscriptionDialog=u;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._dialogName="SubscriptionDialog",t}return r(t,e),t.prototype.AfterSubscribeAck=function(e,t){return this},t.prototype.AfterSubscribeTimeout=function(){return this},t.prototype.Subscribe=function(e,t){return this._invalidAction("subscribe")},t.prototype.Unsubscribe=function(e,t){return this._invalidAction("unsubscribe")},t}(a.BaseState),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Closed",t}return r(t,e),t.prototype.Subscribe=function(e,t){var n=e.Commands.Subscribe(e.Identity,t);return{nextState:i.Pending,returnValue:n}},t}(l),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Pending",t}return r(t,e),t.prototype.AfterSubscribeAck=function(e,t){return t&&t.dialogId&&(e.Identity.RemoteId=t.dialogId.remote),i.Open},t.prototype.AfterSubscribeTimeout=function(){return i.Terminated},t}(l),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Open",t}return r(t,e),t.prototype.Unsubscribe=function(e,t){return{nextState:i.Terminated,returnValue:e.Commands.Unsubscribe(e.Identity,t)}},t}(l),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Name="Terminated",t}return r(t,e),t}(l);i={Closed:new d,Pending:new p,Open:new f,Terminated:new h}},{"../../events/ConferenceEvents":369,"../../events/EventDispatcher":372,"./Dialog":348,"./DialogBaseState":349}],351:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../events/ConnectionEvents"),o=e("../utils/Constants"),a=e("../utils/Messages"),s=e("../utils/TokenUtils"),c=e("../utils/XmlHttpRequest"),u=e("./BaseController"),l=e("../events/EventDispatcher"),d=e("es6-promise"),p=e("../utils/ReflectorPools"),f=e("../utils/ObjectUtils"),h=e("../utils/StringUtils"),m=e("../utils/TokenUtils"),v=e("../utils/LocationProvider"),g=e("../utils/OperatingSystemInfoProvider"),y=e("../events/ConnectionEvents"),_=e("../../vidyo_connector_api/VidyoConnector"),S=e("../models/VideoResolution"),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._disconnectingPromise=null,t}return r(t,e),t.prototype.AddStream=function(e){return this._vidyoCore.XmppProvider.AddStream(e)},t.prototype.Connect=function(){var e=this;this._vidyoCore.EventDispatcher.releaseGroup(l.ConnectonControllerListeners),this._vidyoCore.EventDispatcher.on(i.Events.Connected,l.ConnectonControllerListeners,function(t){return e._onConnected(t)}),this._vidyoCore.EventDispatcher.on(i.Events.LmiXmppMucMediaConf,l.ConnectonControllerListeners,function(t){return e._onLmiXmppMucMediaConf(t)}),this._vidyoCore.EventDispatcher.on(i.Events.JingleSourceView,l.ConnectonControllerListeners,function(t){return e._onJingleSourceView(t)}),this._vidyoCore.EventDispatcher.on(i.Events.JingleSessionTerminated,l.ConnectonControllerListeners,function(t){return e._onJingleSessionTerminated(t)}),this._vidyoCore.EventDispatcher.on(i.Events.IqSendingError,l.ConnectonControllerListeners,function(t){return e._onIqSendingError(t)}),this._vidyoCore.EventDispatcher.on(i.Events.MediaSessionFailed,l.ConnectonControllerListeners,function(t){return e._onMediaSessionFailed(t)}),this._vidyoCore.EventDispatcher.on(i.Events.MediaSessionEnded,l.ConnectonControllerListeners,function(t){return e._onMediaSessionEnded(t)}),this._vidyoCore.EventDispatcher.on(i.Events.SignallingDisconnected,l.ConnectonControllerListeners,function(t){return e._onSignallingDisconnected(t)}),this._vidyoCore.EventDispatcher.on(i.Events.SignallingError,l.ConnectonControllerListeners,function(t){return e._onSignallingDisconnected(t)}),this._vidyoCore.XmppProvider.Connect()},t.prototype.CreateConnection=function(e){var t={displayName:"anonymous",host:e.host,port:o.DefaultPort,saslMechanisms:["plain","anonymous"],sendReceipts:!0,serviceType:"wss",transports:["websocket"],websocketHost:"wss://"+e.host+":443/ws-xmpp"};e=f["default"].Merge(t,e),e.credentials&&e.credentials.token&&(e.credentials.password=e.credentials.password||e.credentials.token,e.credentials.username=e.credentials.username||s.DecodeUserName(e.credentials.token)),e.displayName&&this._vidyoCore.Controllers.UserController.SetUserDisplayName(e.displayName),this._vidyoCore.XmppProvider.CreateClient(e),this._vidyoCore.Controllers.ResourcesController.ReinitResourceController(),this._vidyoCore.Controllers.StatisticsController.SetClientConnectionStats(e.host,e.port,e.serviceType),this._reflectorsPoolUrl="https://"+e.host+o.ReflectorPoolsURL},t.prototype.Disable=function(){var t=this;return this.Disconnect(y.ConnectionEventsInfo.Disconnecting).then(function(){return e.prototype.Disable.call(t)})},t.prototype.Disconnect=function(e){var t=this;return this._vidyoCore.Controllers.ResourcesController.StopResourceManager(),this._disconnectingPromise||(console.log(new Date+': ConnectionController: Disconnecting - "'+e.msg+'"'),this._disconnectingPromise=this._vidyoCore.Controllers.RoomController.LeaveAll().then(function(){t._disconnect(e)})["catch"](function(n){return console.log("ConnectionController::__disconnect error during disconnection: "+n),t._disconnect(e),d.Promise.resolve()})),this._disconnectingPromise},t.prototype.Initialize=function(){var e=this;return v.LocationProvider.Initialize(),window.addEventListener("beforeunload",function(){e.Disconnect(y.ConnectionEventsInfo.Disconnecting)}),d.Promise.resolve(void 0)},t.prototype.InitializeJson=function(e){return this._jsonPool=e,this.Initialize()},t.prototype.Reflector=function(){return this._reflector},t.prototype.RemoveStream=function(e){return this._vidyoCore.XmppProvider.RemoveStream(e)},t.prototype.SendClientStats=function(e){this._vidyoCore.XmppProvider.SendClientStats(this._reflector,e)},t.prototype.StartMediaExchange=function(){var e=this,t=function(t){e._vidyoCore.XmppProvider.MediaStart({jid:e._vidyoCore.Controllers.RoomController.RoomJid(),start:{location:t}})};return v.LocationProvider.GetCurrentPosition().then(function(e){return t(e)})["catch"](function(n){e._vidyoCore.Controllers.LogController.LogWarning(n),e._findClosestReflectorPool().then(function(e){return t(e)})})},Object.defineProperty(t.prototype,"SessionState",{get:function(){return this.Session?this.Session.State():void 0},enumerable:!0,configurable:!0}),t.prototype.UpdateLocalStream=function(e,t){return void 0===t&&(t=!0),this._vidyoCore.XmppProvider.UpdateLocalStream(e,t)},t.prototype._buildIceSrv=function(e){var t={url:""},n=e.substring(0,e.indexOf("?"));n=n.replace("turns:","turn:");var r=m.ParseUrlParams(e);return t.url=n+(r.transport?"?transport="+r.transport:""),t.username=r.usr?r.usr:"some-user",t.credential=r.pwd?r.pwd:"some-password",t},t.prototype._disconnect=function(e){try{this._vidyoCore.XmppProvider.IsXMPPSessionAlive()&&this._vidyoCore.XmppProvider.Disconnect()}catch(t){console.log("ConnectionController::__disconnect error during disconnection: "+t)}try{this._vidyoCore.EventDispatcher.releaseGroup(l.ConnectonControllerListeners)}catch(t){console.log("ConnectionController::__disconnect error during disconnection: "+t)}this._disconnectingPromise=null,console.log(new Date+": ConnectionController: Disconnected."),e.code===y.ConnectionEventsInfo.Disconnecting.code&&(e=y.ConnectionEventsInfo.Disconnected),this._vidyoCore.EventDispatcher.emit(i.Events.Disconnected,e)},t.prototype._findClosestReflectorPool=function(){var e=this;return c.Get(this._reflectorsPoolUrl).then(function(t){var n=e._jsonPool;try{n=JSON.parse(t).pools}catch(r){var i=h["default"].Format(a.CouldNotParseString,{string:o.ReflectorPoolsURL});e._vidyoCore.Controllers.LogController.LogWarning(i)}if(!Array.isArray(n)||0===n.length)return d.Promise.resolve(void 0);var s=f["default"].Flatten(n.map(function(e){return p.SelectReflectors(e)}));return d.Promise.race(s.map(function(e){var t=e.Ip||e.Fqdn,n=performance.now();return c.Get("https://"+t).then(function(){var t=performance.now();return e.ResponseTime=Math.round(t-n),d.Promise.resolve(void 0)})})).then(function(){var e=s.slice().sort(function(e,t){return e.ResponseTime-t.ResponseTime}),t=e[0].Location;return d.Promise.resolve(t)})})},t.prototype._onConnected=function(e){},t.prototype._onIqSendingError=function(e){this._vidyoCore.Controllers.ResourcesController.OnXMPPError(),e&&e.data&&e.data.commands&&e.data.commands.command.conferenceShowSelected||e&&e.data&&e.data.notify&&e.data.notify.topic&&"client_stats"===e.data.notify.topic||this.Disconnect(y.ConnectionEventsInfo.SignallingError);

},t.prototype._onJingleSessionTerminated=function(e){this.Disconnect(y.ConnectionEventsInfo.Disconnecting)},t.prototype._onJingleSourceView=function(e){var t=this;e.sources.forEach(function(e){t._vidyoCore.Controllers.TransmittedStreamController.SetLocalSource(e)})},t.prototype._onLmiXmppMucMediaConf=function(e){var t=this;this._reflector=e.reflector,this._vidyoCore.Controllers.RoomController.SetConference(e.id);for(var n={url:""},r=0,o=e.properties;r<o.length;r++){var a=o[r];if(0===a.name.indexOf("turn.")){n=this._buildIceSrv(a.value);break}}this._vidyoCore.Controllers.ResourcesController.StartResourceManager(),g.OperatingSystemInfoProvider.IsChrome()&&this._vidyoCore.Controllers.ResourcesController.SetSmoothStartMode(),this._vidyoCore.XmppProvider.StartMediaSession({jid:this._reflector,stream:void 0,iceServer:n,addGoogleConferenceFlag:this._vidyoCore.Controllers.AdvancedSettingsController.AddGoogleConferenceFlag,enableSimulcast:this._vidyoCore.Controllers.AdvancedSettingsController.EnableSimulcast,displayName:this._vidyoCore.Controllers.UserController.UserDisplayName(),preferredCodec:S.GetPreferredCodec()}).then(function(e){t.Session=e,t._vidyoCore.EventDispatcher.emit(i.Events.MediaSessionStarted,{session:e})})["catch"](function(e){t._vidyoCore.Controllers.LogController.LogError(e),t._vidyoCore.EventDispatcher.emit(i.Events.MediaSessionFailed,new i.VidyoEventInfo(e.name,_.VidyoConnectorDisconnectReason.Terminated,e.message,"error"))})},t.prototype._onMediaSessionEnded=function(e){this.Disconnect(e)},t.prototype._onMediaSessionFailed=function(e){this.Disconnect(e)},t.prototype._onSignallingDisconnected=function(e){this.Disconnect(e)},t.prototype._onSignallingError=function(e){this.Disconnect(e)},t}(u.BaseController);n.ConnectionController=b},{"../../vidyo_connector_api/VidyoConnector":486,"../events/ConnectionEvents":370,"../events/EventDispatcher":372,"../models/VideoResolution":389,"../utils/Constants":426,"../utils/LocationProvider":430,"../utils/Messages":432,"../utils/ObjectUtils":435,"../utils/OperatingSystemInfoProvider":436,"../utils/ReflectorPools":439,"../utils/StringUtils":441,"../utils/TokenUtils":443,"../utils/XmlHttpRequest":448,"./BaseController":344,"es6-promise":31}],352:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../events/DeviceEvents"),o=e("../models/device/Camera"),a=e("../events/EventDispatcher"),s=e("./BaseController"),c=e("../models/device/DeviceList"),u=e("../models/device/DeviceSelection"),l=e("../utils/MediaDevicesProvider"),d=e("../models/device/Microphone"),p=e("es6-promise"),f=e("../models/device/Speaker"),h=e("../events/RenderEvents"),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._deviceDetectionStarted=!1,t._deviceSelection=new u.DeviceSelection,t}return r(t,e),t.prototype.ClearLocalCameras=function(){var e=this;this._deviceList.Cameras.All().forEach(function(t){e._deviceList.Cameras.Remove(t.Id),e._vidyoCore.EventDispatcher.emit(i.Events.CameraRemoved,{camera:t})}),this._deviceSelection.SelectCamera(void 0)},t.prototype.ClearLocalMicrophones=function(){var e=this;this._deviceList.Microphones.All().forEach(function(t){e._deviceList.Microphones.Remove(t.Id),e._vidyoCore.EventDispatcher.emit(i.Events.MicrophoneRemoved,{microphone:t})}),this._deviceSelection.SelectMicrophone(void 0)},t.prototype.ClearLocalSpeakers=function(){var e=this;this._deviceList.Speakers.All().forEach(function(t){e._deviceList.Speakers.Remove(t.Id),e._vidyoCore.EventDispatcher.emit(i.Events.SpeakerRemoved,{speaker:t})}),this._deviceSelection.SelectSpeaker(void 0)},t.prototype.CycleCamera=function(){this._checkPreconditions();var e;e=this._deviceSelection.Camera.Device?this._deviceList.Cameras.Next(this._deviceSelection.Camera.Device.Id):this._deviceList.Cameras.GetFirstDevice(),e&&this._selectCamera(e)},t.prototype.CycleMicrophone=function(){this._checkPreconditions();var e;e=this._deviceSelection.Microphone.Device?this._deviceList.Microphones.Next(this._deviceSelection.Microphone.Device.Id):this._deviceList.Microphones.GetFirstDevice(),e&&this._selectMicrophone(e)},t.prototype.CycleSpeaker=function(){this._checkPreconditions();var e;e=this._deviceSelection.Speaker.Device?this._deviceList.Speakers.Next(this._deviceSelection.Speaker.Device.Id):this._deviceList.Speakers.GetFirstDevice(),e&&this._selectSpeaker(e)},t.prototype.Disable=function(){return this.ClearLocalCameras(),this.ClearLocalMicrophones(),this.ClearLocalSpeakers(),e.prototype.Disable.call(this)},Object.defineProperty(t.prototype,"DevicesAreBeingDetected",{get:function(){return this._deviceDetectionStarted},enumerable:!0,configurable:!0}),t.prototype.GetAudioMuteState=function(){return!this._deviceSelection.Microphone.Enabled},t.prototype.GetCameraList=function(){return this._deviceList.Cameras.All()},t.prototype.GetMicrophoneList=function(){return this._deviceList.Microphones.All()},t.prototype.GetSelectedDevices=function(){return this._deviceSelection.Simplified},t.prototype.GetSpeakerList=function(){return this._deviceList.Speakers.All()},t.prototype.GetSpeakerMuteState=function(){return this._deviceSelection.Speaker.Muted},t.prototype.GetVideoMuteState=function(){return!this._deviceSelection.Camera.Enabled},t.prototype.Initialize=function(){return this._deviceList={Cameras:new c.DeviceList(o.Camera),Microphones:new c.DeviceList(d.Microphone),Speakers:new c.DeviceList(f.Speaker)},this._mediaDevices=l.MediaDevicesProvider.GetMediaDevices(),this._vidyoCore.EventDispatcher.releaseGroup(a.DeviceControllerListeners),p.Promise.resolve(void 0)},t.prototype.IsCameraSelected=function(){return!!this._deviceSelection.Camera.Device},t.prototype.IsDefaultCamera=function(e){var t=this._deviceList.Cameras.GetDefaultDevice();return!!t&&!!e&&t.Id===e.Id&&t.Name===e.Name},t.prototype.IsDefaultCameraSelected=function(){return this.IsDefaultCamera(this._deviceList.Cameras.GetDefaultDevice())},t.prototype.IsDefaultMicrophone=function(e){var t=this._deviceList.Microphones.GetDefaultDevice();return!!t&&!!e&&t.Id===e.Id&&t.Name===e.Name},t.prototype.IsDefaultMicrophoneSelected=function(){return this.IsDefaultMicrophone(this._deviceList.Microphones.GetDefaultDevice())},t.prototype.IsDefaultSpeaker=function(e){var t=this._deviceList.Speakers.GetDefaultDevice();return!!t&&!!e&&t.Id===e.Id&&t.Name===e.Name},t.prototype.IsDefaultSpeakerSelected=function(){return this.IsDefaultSpeaker(this._deviceList.Speakers.GetDefaultDevice())},t.prototype.IsMicrophoneSelected=function(){return!!this._deviceSelection.Microphone.Device},t.prototype.IsSpeakerSelected=function(){return!!this._deviceSelection.Speaker.Device},t.prototype.SelectCamera=function(e){this._checkPreconditions(),this._selectCamera(e)},t.prototype.SelectDefaultCamera=function(){this._checkPreconditions();var e=this._deviceList.Cameras.GetDefaultDevice();e||(e=this._deviceList.Cameras.GetFirstDevice()),e&&this._selectCamera(e)},t.prototype.SelectDefaultMicrophone=function(){this._checkPreconditions();var e=this._deviceList.Microphones.GetDefaultDevice();e||(e=this._deviceList.Microphones.GetFirstDevice()),e&&this._selectMicrophone(e)},t.prototype.SelectDefaultSpeaker=function(){this._checkPreconditions();var e=this._deviceList.Speakers.GetDefaultDevice();e||(e=this._deviceList.Speakers.GetFirstDevice()),e&&this._selectSpeaker(e)},t.prototype.SelectMicrophone=function(e){this._checkPreconditions(),this._selectMicrophone(e)},t.prototype.SelectMonitor=function(e){return e?this._vidyoCore.Controllers.LocalStreamController.StartMonitorShare(e.sourceId):(this._vidyoCore.Controllers.LocalStreamController.StopMonitorShare(),p.Promise.resolve())},t.prototype.SelectSpeaker=function(e){this._checkPreconditions(),this._selectSpeaker(e)},t.prototype.SelectWindowShare=function(e){return e?this._vidyoCore.Controllers.LocalStreamController.StartWindowShare(e.sourceId):(this._vidyoCore.Controllers.LocalStreamController.StopWindowShare(),p.Promise.resolve())},t.prototype.SetAudioMuteState=function(e){this._deviceSelection.Microphone.Muted=e,this._vidyoCore.EventDispatcher.emit(i.Events.MicrophoneSettingsChanged,this._deviceSelection.Microphone)},t.prototype.SetDefaultCamera=function(e){this._deviceList.Cameras.SetDefaultDevice(e)},t.prototype.SetDefaultMicrophone=function(e){this._deviceList.Microphones.SetDefaultDevice(e)},t.prototype.SetDefaultSpeaker=function(e){this._deviceList.Speakers.SetDefaultDevice(e)},t.prototype.SetSpeakerMuteState=function(e){this._deviceSelection.Speaker.Muted=e,this._vidyoCore.EventDispatcher.emit(i.Events.SpeakerSettingsChanged,this._deviceSelection.Speaker),this._vidyoCore.EventDispatcher.emit(h.Events.SpeakerPrivacyChanged,e)},t.prototype.SetVideoMuteState=function(e){this._deviceSelection.Camera.Muted=e,this._vidyoCore.EventDispatcher.emit(i.Events.CameraSettingsChanged,this._deviceSelection.Camera)},t.prototype.StartDeviceDetection=function(){var e=this;if(!this._deviceDetectionPromise){var t=this._identifyDeviceListChanges();this._mediaDevices.ondevicechange=function(){e._identifyDeviceListChanges()},this._deviceDetectionPromise=t.then(function(){return e._deviceDetectionStarted=!0,e._selectPreviousCamera(),e._selectPreviousMicrophone(),e._selectPreviousSpeaker(),!0})}return this._deviceDetectionPromise},t.prototype._checkPreconditions=function(){if(!this._deviceDetectionStarted)throw new Error("This method does nothing unless StartDeviceDetection is called first")},t.prototype._identifyDeviceListChanges=function(){var e=this;return this._mediaDevices.enumerateDevices().then(function(t){e._deviceList.Cameras.All().forEach(function(n){t.some(function(e){return"videoinput"===e.kind&&e.deviceId===n.Id&&e.label===n.Name})||(e._deviceList.Cameras.Remove(n.Id),e._vidyoCore.EventDispatcher.emit(i.Events.CameraRemoved,{camera:n}))}),e._deviceList.Microphones.All().forEach(function(n){t.some(function(e){return"audioinput"===e.kind&&e.deviceId===n.Id&&e.label===n.Name})||(e._deviceList.Microphones.Remove(n.Id),e._vidyoCore.EventDispatcher.emit(i.Events.MicrophoneRemoved,{microphone:n}))}),e._deviceList.Speakers.All().forEach(function(n){t.some(function(e){return"audiooutput"===e.kind&&e.deviceId===n.Id&&e.label===n.Name})||(e._deviceList.Speakers.Remove(n.Id),e._vidyoCore.EventDispatcher.emit(i.Events.SpeakerRemoved,{speaker:n}))}),t.forEach(function(t){switch(t.kind){case"videoinput":var n=e._deviceList.Cameras.Add(t.label,t.deviceId);n&&e._vidyoCore.EventDispatcher.emit(i.Events.CameraAdded,{camera:n});break;case"audioinput":var r=e._deviceList.Microphones.Add(t.label,t.deviceId);r&&e._vidyoCore.EventDispatcher.emit(i.Events.MicrophoneAdded,{microphone:r});break;case"audiooutput":var o=e._deviceList.Speakers.Add(t.label,t.deviceId);o&&e._vidyoCore.EventDispatcher.emit(i.Events.SpeakerAdded,{speaker:o})}})})},t.prototype._selectCamera=function(e){this._deviceSelection.SelectCamera(e),this._vidyoCore.Controllers.PersistedSettingsController.SelectedCamera=e?e.Id:void 0,this._vidyoCore.EventDispatcher.emit(i.Events.CameraSettingsChanged,this._deviceSelection.Camera),e&&this._vidyoCore.EventDispatcher.emit(i.Events.CameraSelected,{camera:e})},t.prototype._selectMicrophone=function(e){this._deviceSelection.SelectMicrophone(e),this._vidyoCore.Controllers.PersistedSettingsController.SelectedMicrophone=e?e.Id:void 0,this._vidyoCore.EventDispatcher.emit(i.Events.MicrophoneSettingsChanged,this._deviceSelection.Microphone),e&&this._vidyoCore.EventDispatcher.emit(i.Events.MicrophoneSelected,{microphone:e})},t.prototype._selectPreviousCamera=function(){var e=this._vidyoCore.Controllers.PersistedSettingsController.SelectedCamera;if(e){var t=this._deviceList.Cameras.Find(e);t&&this.SelectCamera(t)}},t.prototype._selectPreviousMicrophone=function(){var e=this._vidyoCore.Controllers.PersistedSettingsController.SelectedMicrophone;if(e){var t=this._deviceList.Microphones.Find(e);t&&this.SelectMicrophone(t)}},t.prototype._selectPreviousSpeaker=function(){var e=this._vidyoCore.Controllers.PersistedSettingsController.SelectedSpeaker;if(e){var t=this._deviceList.Speakers.Find(e);t&&this.SelectSpeaker(t)}},t.prototype._selectSpeaker=function(e){this._vidyoCore.Controllers.PersistedSettingsController.SelectedSpeaker=e?e.Id:void 0,e&&(this._deviceSelection.SelectSpeaker(e),this._vidyoCore.EventDispatcher.emit(i.Events.SpeakerSelected,{speaker:e}))},t}(s.BaseController);n.DeviceController=m},{"../events/DeviceEvents":371,"../events/EventDispatcher":372,"../events/RenderEvents":375,"../models/device/Camera":390,"../models/device/DeviceList":392,"../models/device/DeviceSelection":393,"../models/device/Microphone":394,"../models/device/Speaker":395,"../utils/MediaDevicesProvider":431,"./BaseController":344,"es6-promise":31}],353:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i,o=e("./BaseController"),a=e("../events/LogEvents"),s=e("../models/LogPayload"),c=e("json-decycle"),u=e("../utils/VidyoDebugger");!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(i=n.VidyoLogLevelEnum||(n.VidyoLogLevelEnum={}));var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._logLevel=i.Verbose,t}return r(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Initialize=function(){var e=this;return this._vidyoCore.EventDispatcher.on(a.Events.XMPPMessage,function(t){var n=new s["default"](t.name,t.data);e.LogVerbose(n.toString())}),u.VidyoDebugger.Initialize(this._vidyoCore),Promise.resolve(void 0)},t.prototype.LogError=function(e){e instanceof Error&&(e={name:e.name,message:e.message}),this._log("Error",e)},t.prototype.LogInfo=function(e){this._log("Info",e)},t.prototype.LogVerbose=function(e){this._log("Verbose",e)},t.prototype.LogWarning=function(e){this._log("Warning",e)},t.prototype.SetLogLevel=function(e){this._logLevel=i[e]},t.prototype._log=function(e,t){if(!(i[e]>this._logLevel)){var n=a.Events[e],r=2,o="string"==typeof t?t:JSON.stringify(t,c.decycle(),r);this._vidyoCore.EventDispatcher.emit(n,"Vidyo "+e+": "+o)}},t}(o.BaseController);n.LogController=l},{"../events/LogEvents":373,"../models/LogPayload":382,"../utils/VidyoDebugger":446,"./BaseController":344,"json-decycle":76}],354:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./BaseController"),o=e("../utils/TimingProvider"),a=e("../utils/AudioAnalyser"),s=e("../models/Participant"),c=e("../events/StreamEvents"),u=e("../events/EventDispatcher"),l=e("../../vidyo_simple_api/Participant"),d=e("../models/Participant"),p=e("../../vidyo_simple_api/Devices"),f=e("../models/device/Microphone"),h=e("../../vidyo_simple_api/Origin"),m=e("es6-promise"),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._intervalRefreshLocal=null,t._intervalRefreshRemote=null,t._remoteEnergyMeters={},t}return r(t,e),t.prototype.Disable=function(){return this._onDisconnected(),e.prototype.Disable.call(this)},t.prototype.Initialize=function(){return m.Promise.resolve(void 0)},t.prototype.RegisterLocalMicrophoneEnergyListener=function(e){var n=this;return this._clearLocalMeter(),this._vidyoCore.EventDispatcher.on(c.Events.TracksChanged,u.MicrophoneLocalEnergyLevelControllerListeners,function(e){return n._onLocalStreamChanged(e)}),this._processLocalStream(),this._intervalRefreshLocal=o.TimingProvider.Interval(e.meteringPeriod||t.period,function(){n._localEnergyMeter&&n._localEnergyMeter.renewMetering().then(function(t){t.suspendMetering(),t.audioEnabled&&e.onEnergy(t.GetMicrophone(),t.instantMaxEnergy)})}),m.Promise.resolve(!0)},t.prototype.RegisterRemoteMicrophoneEnergyListener=function(e){var n=this;this._clearRemoteMeters(),this._vidyoCore.EventDispatcher.on(c.Events.TracksChanged,u.MicrophoneRemoteEnergyLevelControllerListeners,function(e){return n._onRemoteStreamChanged(e)}),this._vidyoCore.EventDispatcher.on(c.Events.StreamListChanged,u.MicrophoneRemoteEnergyLevelControllerListeners,function(){return n._onRemoteStreamsChanged()}),this._vidyoCore.EventDispatcher.on(c.Events.MediaDisabled,u.MicrophoneRemoteEnergyLevelControllerListeners,function(){return n._onEvent(c.Events.MediaDisabled.toString())}),this._vidyoCore.EventDispatcher.on(c.Events.MediaFailed,u.MicrophoneRemoteEnergyLevelControllerListeners,function(){return n._onEvent(c.Events.MediaFailed.toString())}),this._vidyoCore.EventDispatcher.on(c.Events.RemoteMicrophoneAdded,u.MicrophoneRemoteEnergyLevelControllerListeners,function(){return n._onEvent(c.Events.RemoteMicrophoneAdded.toString())}),this._vidyoCore.EventDispatcher.on(c.Events.RemoteMicrophoneRemoved,u.MicrophoneRemoteEnergyLevelControllerListeners,function(){return n._onEvent(c.Events.RemoteMicrophoneRemoved.toString())}),this._vidyoCore.EventDispatcher.on(c.Events.RemoteMicrophoneStateUpdated,u.MicrophoneRemoteEnergyLevelControllerListeners,function(){return n._onEvent(c.Events.RemoteMicrophoneStateUpdated.toString())}),this._vidyoCore.EventDispatcher.on(c.Events.StreamEnableStateChanged,u.MicrophoneRemoteEnergyLevelControllerListeners,function(){return n._onEvent(c.Events.StreamEnableStateChanged.toString())});var r=this._vidyoCore.Controllers.ConnectionController.Session;if(r)for(var i=this._vidyoCore.Controllers.ParticipantController.GetParticipants(),a=0,s=i;a<s.length;a++){var l=s[a];this._addRemoteParticipant(l.Id)}return this._intervalRefreshRemote=o.TimingProvider.Interval(e.meteringPeriod||t.period,function(){for(var t in n._remoteEnergyMeters)n._remoteEnergyMeters.hasOwnProperty(t)&&n._remoteEnergyMeters[t].renewMetering().then(function(t){t.suspendMetering(),t.audioEnabled&&e.onEnergy(t.GetMicrophone(),t.GetParticipant(),t.instantMaxEnergy)})}),m.Promise.resolve(!0)},t.prototype.UnregisterLocalMicrophoneEnergyListener=function(){return this._clearLocalMeter(),m.Promise.resolve(!0)},t.prototype.UnregisterRemoteMicrophoneEnergyListener=function(){return this._clearRemoteMeters(),m.Promise.resolve(!0)},t.prototype._addRemoteParticipant=function(e){var t=this,n=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e);if(n&&n.Origin===s.ParticipantOrigin.Remote){var r=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantAudioStream(e);r&&setTimeout(function(){r&&(t._remoteEnergyMeters[e]=g.createMeter(r,t._getRemoteMicrophone(r,e),t._vidyoCore.Controllers.ParticipantController.GetParticipant(e)))})}},t.prototype._clearLocalMeter=function(){this._vidyoCore.EventDispatcher.releaseGroup(u.MicrophoneLocalEnergyLevelControllerListeners),null!==this._intervalRefreshLocal&&(o.TimingProvider.ClearInterval(this._intervalRefreshLocal),this._intervalRefreshLocal=null),this._localEnergyMeter&&(this._localEnergyMeter.stopMetering(),this._localEnergyMeter=null)},t.prototype._clearMeters=function(){this._clearRemoteMeters(),this._clearLocalMeter()},t.prototype._clearRemoteMeters=function(){this._vidyoCore.EventDispatcher.releaseGroup(u.MicrophoneRemoteEnergyLevelControllerListeners),null!==this._intervalRefreshRemote&&(o.TimingProvider.ClearInterval(this._intervalRefreshRemote),this._intervalRefreshRemote=null);for(var e in this._remoteEnergyMeters)this._remoteEnergyMeters.hasOwnProperty(e)&&(this._remoteEnergyMeters[e].stopMetering(),delete this._remoteEnergyMeters[e])},t.prototype._getParticipantIdForRemoteStream=function(e){for(var t in this._remoteEnergyMeters)if(this._remoteEnergyMeters.hasOwnProperty(t)&&(t===e||this._remoteEnergyMeters[t].roStream.Id===e))return t;return null},t.prototype._getRemoteMicrophone=function(e,t){var n=new f.Microphone("Remote Microphone "+t,t),r=e.GetAudioTracks();if(r&&r.length>0){var i=this._vidyoCore.Controllers.ParticipantController.GetParticipant(t).GetSourceBySSrc(r[0].Settings.deviceId);i&&(n=new f.Microphone(i.Name,i.Ssrc,i.ObjId))}return n},t.prototype._onDisconnected=function(){this._clearMeters()},t.prototype._onEvent=function(e){console.log("MicrophoneEnergyLevelController->onEvent(); eventName: "+e)},t.prototype._onLocalStreamChanged=function(e){var t=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream;t&&t.Id===e&&this._intervalRefreshLocal&&this._processLocalStream()},t.prototype._onRemoteStreamChanged=function(e){var t=this,n=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream;if((!n||n.Id!==e)&&this._intervalRefreshRemote){var r=this._getParticipantIdForRemoteStream(e);if(r){var i=this._remoteEnergyMeters[r];i.stopMetering(),delete this._remoteEnergyMeters[r],setTimeout(function(){i.roStream.GetClonedMediaStream().active&&i.roStream.GetAudioTracks().length>0&&r&&(t._remoteEnergyMeters[r]=g.createMeter(i.roStream,t._getRemoteMicrophone(i.roStream,r),t._vidyoCore.Controllers.ParticipantController.GetParticipant(r)))})}else this._onRemoteStreamsChanged()}},t.prototype._onRemoteStreamsChanged=function(){for(var e=Object.keys(this._remoteEnergyMeters),t=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:s.ParticipantOrigin.Remote}),n=t.map(function(e){return e.Id}),r=0,i=e;r<i.length;r++){var o=i[r];n.includes(o)||(this._remoteEnergyMeters[o].stopMetering(),delete this._remoteEnergyMeters[o])}for(var a=0,c=n;a<c.length;a++){var u=c[a];e.includes(u)||this._addRemoteParticipant(u)}},t.prototype._processLocalStream=function(){this._localEnergyMeter&&this._localEnergyMeter.stopMetering(),this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream&&(this._localEnergyMeter=g.createMeter(this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream,this._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Microphone,new d.Participant("me",s.ParticipantOrigin.Local,"Me")))},t.period=100,t}(i.BaseController);n.MicrophoneEnergyLevelController=v;var g=function(){function e(){this.audioEnabled=!1,this._bufferSize=8192,this._inProgress=!1,this._isLgScale=!0}return e.prototype.GetMicrophone=function(){return this._microphone},e.prototype.GetParticipant=function(){return this._participant},e.prototype.renewMetering=function(){var e=this;return this.audioEnabled=this._checkAudioEnabled(),this.audioEnabled?this._inProgress===!0?m.Promise.resolve(this):new m.Promise(function(t){e._inProgress=!0,e._meteringPromiseResolve=t,e._scriptProcessor.connect(e._audioContext.destination)}):m.Promise.resolve(this)},e.prototype.stopMetering=function(){try{this._mediaStreamAudioSource.disconnect(),this._scriptProcessor.disconnect(),this.instantMaxEnergy=this._isLgScale?e.MinLGAudioLevel:0}catch(t){}},e.prototype.suspendMetering=function(){this._inProgress=!1;try{this._scriptProcessor.disconnect()}catch(e){}},e.prototype._calculateEnergyLevel=function(t){this.instantMaxEnergy=this._isLgScale?e.MinLGAudioLevel:0;for(var n=0;n<t.inputBuffer.numberOfChannels;n++)this._calculateEnergyLevelForChannel(t,n);this._meteringPromiseResolve(this)},e.prototype._calculateEnergyLevelForChannel=function(t,n){for(var r=t.inputBuffer.getChannelData(n),i=0,o=0,a=r;o<a.length;o++){var s=a[o];i+=s*s}var c=i/r.length;this.instantMaxEnergy=Math.max(this.instantMaxEnergy,c),this.avgMaxEnergy=e.AVGMainWeight*this.avgMaxEnergy+e.AVGInstantWeight*this.instantMaxEnergy,this._isLgScale===!0&&(this.instantMaxEnergy=e.LGScaleMultiplier*Math.log10(this.instantMaxEnergy),this.instantMaxEnergy=Math.max(Math.min(e.MaxLGAudioLevel,this.instantMaxEnergy),e.MinLGAudioLevel))},e.prototype._checkAudioEnabled=function(){return this.roStream.GetAudioTracks().length>0&&this.roStream.GetAudioTracks()[0].IsActive()&&!this.roStream.GetAudioTracks()[0].Muted&&(this._coreParticipant.Origin===s.ParticipantOrigin.Local||this._coreParticipant.HasAudioSource())},e.prototype._initMetering=function(t,n,r){var i=this;this._audioContext=t||new AudioContext,this._isLgScale=r||!0,this.instantMaxEnergy=this._isLgScale?e.MinLGAudioLevel:0,this.avgMaxEnergy=0,this.roStream=n,this.audioEnabled=this._checkAudioEnabled(),this.audioEnabled&&(this._scriptProcessor=this._audioContext.createScriptProcessor(this._bufferSize,this.roStream.GetAudioTracks().length,this.roStream.GetAudioTracks().length),this._scriptProcessor.onaudioprocess=function(e){i._calculateEnergyLevel(e)},this._mediaStreamAudioSource=this._audioContext.createMediaStreamSource(this.roStream.GetClonedMediaStream()),this._mediaStreamAudioSource.connect(this._scriptProcessor))},e.createMeter=function(t,n,r){var i=new e;return i._coreParticipant=r,i._participant=new l.Participant(i._coreParticipant),i._microphone=new p.Microphone(n,h.FromCoreOrigin(i._coreParticipant.Origin)),i._initMetering(a.AudioAnalyser.getAudioContext(),t),i},e.AVGInstantWeight=.05,e.AVGMainWeight=.95,e.LGScaleMultiplier=10,e.MaxLGAudioLevel=0,e.MinLGAudioLevel=-127,e}()},{"../../vidyo_simple_api/Devices":488,"../../vidyo_simple_api/Origin":491,"../../vidyo_simple_api/Participant":492,"../events/EventDispatcher":372,"../events/StreamEvents":378,"../models/Participant":383,"../models/device/Microphone":394,"../utils/AudioAnalyser":421,"../utils/TimingProvider":442,"./BaseController":344,"es6-promise":31}],355:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../events/ConferenceEvents"),o=e("../events/ParticipantEvents"),a=e("../events/RenderEvents"),s=e("../models/Participant"),c=e("./BaseController"),u=e("../utils/Messages"),l=e("../events/EventDispatcher"),d=e("../models/device/Camera"),p=e("../utils/ObjectUtils"),f=e("../utils/StringUtils"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.CreateParticipant=function(e,t,n){var r=t===s.ParticipantOrigin.Remote&&0===this.GetParticipants({Id:e}).length;if(!this._participants[e]){var i=new s.Participant(e,t,n);this._participants[e]=i,this._vidyoCore.EventDispatcher.emit(o.Events.ParticipantsChanged),r&&this._vidyoCore.EventDispatcher.emit(o.Events.ParticipantJoined,{participant:i})}},t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.GetLocalParticipant=function(){var e=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:s.ParticipantOrigin.Local});return e&&e.length>0?e[0]:void 0},t.prototype.GetParticipant=function(e){var t=this._participants[e];if(t)return t;throw new Error(f["default"].Format(u.NoSuchParticipant,{id:e}))},t.prototype.GetParticipantBySsrc=function(e){for(var t in this._participants)if(this._participants.hasOwnProperty(t)){var n=this._participants[t];if(n.Sources.some(function(t){return t.Ssrc===e}))return n}return null},t.prototype.GetParticipants=function(e){return e?p["default"].Filter(this._participants,e):this._participants?Object.values(this._participants):[]},t.prototype.Initialize=function(){var e=this;return this._vidyoCore.EventDispatcher.releaseGroup(l.ParticipantControllerListeners),this._vidyoCore.EventDispatcher.on(i.Events.SelectedParticipantsChanged,l.ParticipantControllerListeners,function(t){return e._onSelectedParticipantsChanged(t)}),this._vidyoCore.EventDispatcher.on(i.Events.SelectedParticipantUnavailable,l.ParticipantControllerListeners,function(t){return e._onSelectedParticipantsRemoved(t)}),Promise.resolve(void 0)},t.prototype.InitParticipantList=function(){this._participants={}},t.prototype.RemoveParticipant=function(e){var t=!!this._participants[e];t&&this._vidyoCore.EventDispatcher.emit(o.Events.ParticipantLeft,{participant:this._participants[e]}),delete this._participants[e],t&&this._vidyoCore.EventDispatcher.emit(o.Events.ParticipantsChanged)},t.prototype.TryGetParticipant=function(e){return this._participants[e]},t.prototype.UpdateParticipant=function(e,t){var n=this._participants[e];n&&(t&&n.Sources.push(t),this._participants[e]=n,this._vidyoCore.EventDispatcher.emit(o.Events.ParticipantsChanged))},t.prototype.UpdateParticipants=function(e){var t=this;e.forEach(function(e){var n=t.GetParticipant(e.participantId);for(var r in e.update)e.update.hasOwnProperty(r)&&(n[r]=e.update[r])}),this._vidyoCore.EventDispatcher.emit(o.Events.ParticipantsChanged)},t.prototype._generateCameras=function(e){return e.map(function(e){var t=e.Sources[0]?new d.Camera(e.Sources[0].Name,e.Id,e.Sources[0].ObjId):new d.Camera(e.Id,e.Id,e.ObjId);return t})},t.prototype._loudestParticipant=function(){return this.GetParticipants({Generation:0})[0]},t.prototype._onSelectedParticipantsChanged=function(e){this._vidyoCore.EventDispatcher.emit(o.Events.DynamicParticipantChanged,{participants:e.participants,cameras:this._generateCameras(e.participants)}),this._vidyoCore.EventDispatcher.emit(o.Events.LoudestParticipantChanged,{participant:this._loudestParticipant()})},t.prototype._onSelectedParticipantsRemoved=function(e){this._participants.hasOwnProperty(e.id)&&(this._participants[e.id].Active=!1,this._vidyoCore.EventDispatcher.emit(a.Events.Update),this._vidyoCore.EventDispatcher.emit(a.Events.RecheckEachVideoSize))},t}(c.BaseController);n.ParticipantController=h},{"../events/ConferenceEvents":369,"../events/EventDispatcher":372,"../events/ParticipantEvents":374,"../events/RenderEvents":375,"../models/Participant":383,"../models/device/Camera":390,"../utils/Messages":432,"../utils/ObjectUtils":435,"../utils/StringUtils":441,"./BaseController":344}],356:[function(e,t,n){"use strict";function r(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SelectedCamera="",t.SelectedMicrophone="",t.SelectedSpeaker="",t}return i(t,e),t}(e)}var i=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=e("./BaseController"),a=e("../utils/AutoPropertyHelper"),s=e("../utils/LocalStorageProvider"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Initialize=function(){return a.CreateAutoProperties(r,this,function(e){var t="VidyoCore::"+e;return{get:function(){return s.LocalStorageProvider.Get(t)},set:function(e){return s.LocalStorageProvider.Set(t,e)}}}),Promise.resolve(void 0)},t}(r(o.BaseController));n.PersistedSettingsController=c},{"../utils/AutoPropertyHelper":422,"../utils/LocalStorageProvider":429,"./BaseController":344}],357:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,
new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../events/StreamEvents"),o=e("../events/DeviceEvents"),a=e("../events/ParticipantEvents"),s=e("../events/RenderEvents"),c=e("../events/StatisticsEvents"),u=e("./BaseController"),l=e("../models/VideoResolution"),d=e("../utils/Collection"),p=e("../models/renderer/GridLayout"),f=e("./StreamController/TrackMetaDataProvider"),h=e("es6-promise"),m=e("../events/EventDispatcher"),v=e("../utils/VideoPlaceholderTrack"),g=e("../utils/ObjectUtils"),y=e("../utils/TimingProvider"),_=function(){function e(){this.ParticipantCount=0,this.Resolutions=new l.VideoResolutionSet,this.VideoPlaceholders=new d.Collection(function(e){return new d.DataWithId(e,new v.VideoPlaceholderTrack)}),this.Views={}}return e}(),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ApplicationGridLayout=new p.GridLayout(0,0),t.DebounceTimeForResize=200,t.MaxNumberOfTracks=9,t.MediaGridSplit="horizontal",t.VideoGridLayout=new p.GridLayout,t._previewOn=!0,t._showLocalSharePreview=!1,t._state=new _,t}return r(t,e),Object.defineProperty(t.prototype,"ShowLocalSharePreview",{get:function(){return this._showLocalSharePreview},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"VideoResolutions",{get:function(){return this._state.Resolutions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Views",{get:function(){return this._state.Views},enumerable:!0,configurable:!0}),t.prototype.AssignViewToLocalCamera=function(e){var t={allowZoom:e.allowZoom,displayCropped:e.displayCropped,isLocal:!0,label:"Preview",streamId:"preview",viewId:e.viewId};this._state.Views[e.viewId]=g["default"].Merge({},this._state.Views[e.viewId],t)},t.prototype.AssignViewToRemoteCamera=function(e){var t=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.sourceId);if(t){var n={allowZoom:e.allowZoom,displayCropped:e.displayCropped,isLocal:!1,label:t.Name,streamId:t.Id,viewId:e.viewId};this._state.Views[e.viewId]=g["default"].Merge({},this._state.Views[e.viewId],n)}},t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.HideView=function(e){this._state.Views[e.viewId]&&(this._vidyoCore.Controllers.ConferenceController.DeactivateParticipant(this._state.Views[e.viewId].streamId),delete this._state.Views[e.viewId],this._vidyoCore.EventDispatcher.emit(s.Events.Hide,{viewId:e.viewId}))},t.prototype.Initialize=function(){var e=this;return this._vidyoCore.EventDispatcher.releaseGroup(m.RendererControllerListeners),this._vidyoCore.EventDispatcher.on(o.Events.SpeakerSelected,m.RendererControllerListeners,function(t){var n=t.speaker;return e._onSpeakerSelected(n)}),this._vidyoCore.EventDispatcher.on(i.Events.StreamListChanged,m.RendererControllerListeners,function(){return e._onStreamsChanged([])}),this._vidyoCore.EventDispatcher.on(i.Events.TracksChanged,m.RendererControllerListeners,function(t){return e._onStreamStateChanged(t)}),this._vidyoCore.EventDispatcher.on(i.Events.StreamEnableStateChanged,m.RendererControllerListeners,function(t){return e._onStreamStateChanged(t)}),this._vidyoCore.EventDispatcher.on(a.Events.ParticipantsChanged,m.RendererControllerListeners,function(){e._onParticipantsChanged()}),this._vidyoCore.EventDispatcher.on(c.Events.Update,m.RendererControllerListeners,function(){return e._onStatisticsChanged()}),this._debouncedNotifyOfVideoResolutionChanged=y.TimingProvider.Debounce(function(){return e._notifyOfVideoResolutionChanged()},this.DebounceTimeForResize),h.Promise.resolve(void 0)},t.prototype.SetPreview=function(e){this._previewOn=e.preview,this._vidyoCore.EventDispatcher.emit(s.Events.Update)},t.prototype.ShowLocalShare=function(e){this._showLocalSharePreview=e;var t=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream.Id;this._vidyoCore.EventDispatcher.emit(s.Events.UpdateSource,t)},t.prototype.ShowViewAt=function(e){return this._state.Views[e.viewId]=g["default"].Merge({},this._state.Views[e.viewId],{x:e.x,y:e.y,width:e.width,height:e.height,viewId:e.viewId}),this._vidyoCore.EventDispatcher.emit(s.Events.UpdatePosition,{viewId:e.viewId}),h.Promise.resolve(!0)},t.prototype.UpdateRenderer=function(){var e=this._vidyoCore.Controllers.ParticipantController.GetParticipants().length;e!==this._state.ParticipantCount&&(this._state.ParticipantCount=e,this._vidyoCore.EventDispatcher.emit(s.Events.Update),this._vidyoCore.EventDispatcher.emit(s.Events.RecheckEachVideoSize))},t.prototype.UpdateVideoResolutions=function(e,t){var n=this,r=0,i=0,o=0,a=0,c=0,u=0;t.forEach(function(e){var t=n._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantStream(e.Id)?n._vidyoCore.Controllers.RemoteStreamController.GetTrackMediaType(e.Id):n._vidyoCore.Controllers.LocalStreamController.GetStreamTrackMediaType(e.Id);t===f.MediaTrackType.Application?e.Width>0&&e.Height>0?(a+=e.AspectRatio,c+=1):u+=1:e.Width>0&&e.Height>0?(r+=e.AspectRatio,i+=1):o+=1;var l=n._state.Resolutions.Get(e.Id);l.AspectRatioRatioType!==e.AspectRatioRatioType&&n._vidyoCore.EventDispatcher.emit(s.Events.VideoCropSettingsChanged,e)});var l=t.some(function(e){var t=n._state.Resolutions.Get(e.Id).ContainerResolution,r=e.ContainerResolution,i=t.Width!==r.Width||t.Height!==r.Height;return i});this._state.Resolutions.UpdateVideoResolutions(e,t);var d=.8,p=0;c>0&&i>0?p=d:c>0&&0>=i&&(p=1);var h=1-p;e.AspectRatio<=1?(p=1/p,h=1/h,this.MediaGridSplit="vertical"):this.MediaGridSplit="horizontal";var m=this.VideoGridLayout.Update(i+o,e.AspectRatio*h,r/i),v=this.ApplicationGridLayout.Update(c+u,e.AspectRatio*p,a/c);(m||v)&&this._vidyoCore.EventDispatcher.emit(s.Events.GridLayoutChanged),l&&this._debouncedNotifyOfVideoResolutionChanged&&this._debouncedNotifyOfVideoResolutionChanged()},t.prototype._notifyOfVideoResolutionChanged=function(){this._vidyoCore.EventDispatcher.emit(s.Events.VideoResolutionChanged)},t.prototype._onParticipantsChanged=function(){this.UpdateRenderer(),this._vidyoCore.EventDispatcher.emit(s.Events.Update)},t.prototype._onSpeakerSelected=function(e){this._vidyoCore.EventDispatcher.emit(s.Events.SpeakerSelected,{speakerId:e.Id})},t.prototype._onStatisticsChanged=function(){this._vidyoCore.EventDispatcher.emit(s.Events.StatisticsUpdate)},t.prototype._onStreamsChanged=function(e){this.UpdateRenderer(),this._vidyoCore.EventDispatcher.emit(s.Events.Update,e)},t.prototype._onStreamStateChanged=function(e){this._vidyoCore.EventDispatcher.emit(s.Events.UpdateSource,e)},t.prototype._simplifyAspectRatio=function(e){var t=10,n=.75,r=.5,i=.25;if(e>=t)return t.toString();if(e>=1){var o=Math.floor(e);return o.toString()}return e>=n?"0.75":e>=r?"0.5":e>=i?"0.25":"0"},t}(u.BaseController);n.RendererController=S},{"../events/DeviceEvents":371,"../events/EventDispatcher":372,"../events/ParticipantEvents":374,"../events/RenderEvents":375,"../events/StatisticsEvents":377,"../events/StreamEvents":378,"../models/VideoResolution":389,"../models/renderer/GridLayout":397,"../utils/Collection":425,"../utils/ObjectUtils":435,"../utils/TimingProvider":442,"../utils/VideoPlaceholderTrack":445,"./BaseController":344,"./StreamController/TrackMetaDataProvider":364,"es6-promise":31}],358:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./BaseController"),o=e("../models/ConferenceCommandParameters"),a=e("../utils/Constants"),s=e("../models/VideoResolution"),c=e("../../vidyo_simple_api/stats/Stats"),u=e("../models/Participant"),l=e("../events/EventDispatcher"),d=e("../events/ParticipantEvents"),p=e("../utils/OperatingSystemInfoProvider"),f=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.AfterDecreaseStabilizationPeriods=2,n.AfterIncreaseStabilizationPeriods=3,n.AudioCount=a.NumberOfSelectedAudioSources,n.bulkChangingParticipantThreshold=2,n.bulkIncreasingParticipantMaxStep=4,n.currentBandwidth=t.defaultBandwidth,n.currentFPS=t.defaultFPS,n.currentResolution=new s.BasicVideoResolution,n.DefaultProcessStatisticsPeriods=1,n.NumberOfDynamicOffsToSend=5,n.OriginalParticipantLimit=a.ParticipantLimit,n.MinParticipantLimit=0,n.IsResourceManagementOn=!0,n._fpsDecreaseThreshold=5,n._forIncreaseStablePeriods=0,n._forIncreaseStablePeriodThreshold=30,n._forIncreaseStablePeriodsAudio=0,n._forIncreaseStablePeriodAudioThreshold=60,n._isResourceManagementOn=n.IsResourceManagementOn,n._periodSec=a.SendClientStatisticsInterval/a.SecToMsCoefficient,n._processStatisticsCount=0,n._processStatisticsPeriods=n.DefaultProcessStatisticsPeriods,n._selfViewPolicy=a.DefaultSelfViewPolicy,n._totalAudioDroppedPackets=0,n._totalPacketsLost=0,n._totalPacketsLostCrucialDecreaseThreshold=.22,n._totalPacketsLostDecreaseThreshold=.095,n._totalPacketsLostIncreaseThreshold=.02,n._xmppErrorsAmountThreshold=2,n._xmppErrorsNumber=0,n}return r(t,e),t.prototype.Initialize=function(){return e.prototype.Initialize.call(this)},t.prototype.OnXMPPError=function(){this.IsResourceManagementOn===!0&&this._isResourceManagementOn===!0&&(this._xmppErrorsNumber++,this._vidyoCore.Controllers.LogController.LogInfo("!!!!!!!!!!!!!!!!!!!!!!!!!!!!! "+new Date+" !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),this._vidyoCore.Controllers.LogController.LogInfo("ResourcesController.OnXMPPError  _xmppErrorsNumber="+this._xmppErrorsNumber+"; _xmppErrorsAmountThreshold="+this._xmppErrorsAmountThreshold),this._xmppErrorsNumber>=this._xmppErrorsAmountThreshold&&(this._decreaseCallEntirety(),this._xmppErrorsNumber=0,this.__reinitProcessStatistics(this.AfterDecreaseStabilizationPeriods,0,0)))},t.prototype.ProcessStatistics=function(e){if(this.IsResourceManagementOn===!0&&this._isResourceManagementOn===!0){var t=this._studyStatistics(e);this._applyStudyResults(t)}},t.prototype._studyStatistics=function(e){for(var n=0,r=0,i=0,o=0,a=0,s=0,c=this._vidyoCore.Controllers.ParticipantController.GetParticipants().length,u=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Active:!0}).length,l=Math.min(u,this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit),d=0,p=e.userStats;d<p.length;d++)for(var f=p[d],h=0,m=f.roomStats;h<m.length;h++){var v=m[h];s+=v.receiveBitRateAvailable;for(var g=0,y=v.participantStats;g<y.length;g++){for(var _=y[g],S=0,b=_.remoteCameraStats;S<b.length;S++){var C=b[S];r+=C.receiveNetworkPacketsLost,i+=C.fpsDecoded,o+=C.fpsRendered,a+=C.fpsDecoderInput}for(var w=0,E=_.remoteMicrophoneStats;w<E.length;w++){var R=E[w];n+=R.receiveNetworkDroppedPackets}}}var P=l>0?s/l|0:0,x=r-this._totalPacketsLost;this._totalPacketsLost=r;var T=n-this._totalAudioDroppedPackets;this._totalAudioDroppedPackets=n;var L=s/i|0,O=1500,I=x*O/this._periodSec|0,M=I/s,A=l>0?i/l|0:0;if(this._vidyoCore.Controllers.LogController.LogInfo("----------------------------- "+new Date+" ---------------------------------"),this._vidyoCore.Controllers.LogController.LogInfo("ResourcesController.ProcessStatistics  ParticipantsAmount="+c+"; activeParticipants="+u+"; ParticipantLimit="+this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit+" + 1(me)"),this._vidyoCore.Controllers.LogController.LogInfo("ResourcesController.ProcessStatistics bitsLostASecond="+I+"; assumedPacketSize="+O+"; avgFrameSize="+L),this._vidyoCore.Controllers.LogController.LogInfo("ResourcesController.ProcessStatistics packetsLost: abs="+x+", relative="+M+", incrThreshold="+this._totalPacketsLostIncreaseThreshold+", decrThreshold="+this._totalPacketsLostDecreaseThreshold+", decrCrucialThreshold="+this._totalPacketsLostCrucialDecreaseThreshold),this._vidyoCore.Controllers.LogController.LogInfo("ResourcesController.ProcessStatistics fpsDecoderInput="+a+"; fpsDecoded="+i+"; fpsRendered="+o+"; fpsPerParticipant="+A),this._vidyoCore.Controllers.LogController.LogInfo("ResourcesController.ProcessStatistics currentReceiveBitRateAvailable: "+s+": currentReceiveBitRateAvailablePerParticipant: "+P+": requestedBitRatePerParticipant: "+t.defaultBandwidth),this._vidyoCore.Controllers.LogController.LogInfo("ResourcesController.ProcessStatistics totalAudioDroppedPackets="+n+"; audioDroppedPackets="+T),1>l&&0>=s)return void 0;if(1>l&&s>t.defaultBandwidth_mod)return 1;if(A>0&&A<this._fpsDecreaseThreshold)return-1;if(P<t.defaultBandwidth){var D=(t.defaultBandwidth*l-s)/t.defaultBandwidth|0;if(D>=this.bulkChangingParticipantThreshold)return-D}else{var D=(s-t.defaultBandwidth_mod*l)/t.defaultBandwidth_mod|0;if(D>=this.bulkChangingParticipantThreshold)return D>this.bulkIncreasingParticipantMaxStep&&(D=this.bulkIncreasingParticipantMaxStep),D}return M>this._totalPacketsLostCrucialDecreaseThreshold?-1:M>this._totalPacketsLostDecreaseThreshold&&P<t.defaultBandwidth?-1:M<this._totalPacketsLostIncreaseThreshold?1:0},t.prototype._applyStudyResults=function(e){var t=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Active:!0}).length,n=Math.min(t,this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit);void 0===e?(this.__reinitProcessStatistics(this.DefaultProcessStatisticsPeriods,0),this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit<=0?this._forIncreaseStablePeriodsAudio++:this._forIncreaseStablePeriodsAudio=0,this._vidyoCore.Controllers.LogController.LogInfo("ResourcesController.ProcessStatistics AUDIO  stable period = "+this._forIncreaseStablePeriodsAudio*this._periodSec+" of "+this._forIncreaseStablePeriodAudioThreshold+" sec."),this._forIncreaseStablePeriodsAudio*this._periodSec>=this._forIncreaseStablePeriodAudioThreshold&&this._increaseCallEntirety()===!0&&this.__reinitProcessStatistics(this.AfterIncreaseStabilizationPeriods,0,0)):e>=this.bulkChangingParticipantThreshold?(this._alterParticipantsNumber(e+this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit),this.__reinitProcessStatistics(this.DefaultProcessStatisticsPeriods,0,0)):e<=-this.bulkChangingParticipantThreshold?(this._alterParticipantsNumber(e-(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit-n)),this.__reinitProcessStatistics(this.AfterDecreaseStabilizationPeriods,0,0)):(this._forIncreaseStablePeriodsAudio=0,this._processStatisticsCount++,1===e?this._forIncreaseStablePeriods++:this._forIncreaseStablePeriods=0,this._vidyoCore.Controllers.LogController.LogInfo("ResourcesController.ProcessStatistics VIDEO processStatisticsStep="+this._processStatisticsCount+" of "+this._processStatisticsPeriods+"; stable period="+this._forIncreaseStablePeriods*this._periodSec+" sec."),this._processStatisticsCount>=this._processStatisticsPeriods?(this.__reinitProcessStatistics(this.DefaultProcessStatisticsPeriods),-1===e?this._decreaseCallEntirety()===!0&&this.__reinitProcessStatistics(this.AfterDecreaseStabilizationPeriods,0,0):1===e&&this._forIncreaseStablePeriods*this._periodSec>=this._forIncreaseStablePeriodThreshold&&this._increaseCallEntirety()===!0&&this.__reinitProcessStatistics(this.AfterIncreaseStabilizationPeriods)):0===e&&(this._forIncreaseStablePeriods=0,this._forIncreaseStablePeriodsAudio=0))},t.prototype.ReinitResourceController=function(e){this.ResetParticipantLimit(e),this._processStatisticsPeriods=this.DefaultProcessStatisticsPeriods,this._processStatisticsCount=0,this._forIncreaseStablePeriods=0,this._forIncreaseStablePeriodsAudio=0},t.prototype.ResetParticipantLimit=function(e){void 0!==e&&(this.OriginalParticipantLimit=e),this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit=this.OriginalParticipantLimit},t.prototype.SelfViewPolicy=function(){return this._selfViewPolicy},t.prototype.SendDynamicShow=function(){var e=this._buildCurrentDynamicShowPayload();return this._vidyoCore.Controllers.ConferenceController.ConferenceDialog?(this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([]),this._vidyoCore.XmppProvider.ConferenceShowSelected(this._vidyoCore.Controllers.ConferenceController.ConferenceDialog.Identity(),e)):Promise.resolve()},t.prototype.SetSmoothStartMode=function(){var e=this;if(this.IsResourceManagementOn===!0){var t=1;this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit=t,this._vidyoCore.EventDispatcher.on(d.Events.ParticipantJoined,l.SmoothStartModeListeners,function(t){e._vidyoCore.EventDispatcher.releaseGroup(l.SmoothStartModeListeners),setTimeout(function(){e._smoothStartSetOriginalParticipantLimit(t)},0)})}},t.prototype.StartResourceManager=function(){this._isResourceManagementOn=this.IsResourceManagementOn,this.__reinitProcessStatistics(this.DefaultProcessStatisticsPeriods,0,0)},t.prototype.StopResourceManager=function(){this._isResourceManagementOn=!1},t.prototype._smoothStartIncreaseParticipantLimit=function(e){this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit!==this.OriginalParticipantLimit&&(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit=Math.min(this.OriginalParticipantLimit,e),this._vidyoCore.Controllers.LogController.LogInfo("SmoothStartMode::_smoothStartIncreaseParticipantLimit; Participants="+this._vidyoCore.Controllers.ParticipantController.GetParticipants().length+"; ParticipantLimit="+this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit),this.SendDynamicShow())},t.prototype._smoothStartSetOriginalParticipantLimit=function(e){var t=this;if(e.participant.IsRemote){var n=this._vidyoCore.Controllers.ParticipantController.GetParticipants().length;this._vidyoCore.Controllers.LogController.LogInfo("====================== SmoothStart Mode ======================"),this._vidyoCore.Controllers.LogController.LogInfo("Participants in the conference="+n);var r=4;if(!(n>r&&p.OperatingSystemInfoProvider.IsWindows())){var i=4;r>=n&&(i=this.OriginalParticipantLimit);var o=1e3,a=1500,s=this.OriginalParticipantLimit/i|0;s+=this.OriginalParticipantLimit%i>0?1:0;for(var c=function(e){setTimeout(function(){t._smoothStartIncreaseParticipantLimit(i*(e+1))},o+a*e)},u=0;s>u;u++)c(u)}}},t.prototype.__reinitProcessStatistics=function(e,t,n){this._processStatisticsPeriods=e,this._processStatisticsCount=0,void 0!==t&&(this._forIncreaseStablePeriods=t),void 0!==n&&(this._forIncreaseStablePeriodsAudio=n)},t.prototype._alterParticipantsNumber=function(e){if(0>e&&this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit<=this.MinParticipantLimit)return this._vidyoCore.Controllers.LogController.LogInfo("alterParticipantsNumber: IMPOSSIBLE to Decrease ParticipantsNumber"),Promise.resolve(void 0);if(e>0&&this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit>=this.OriginalParticipantLimit)return this._vidyoCore.Controllers.LogController.LogInfo("alterParticipantsNumber: no needed to adjust call quality"),Promise.resolve(void 0);this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit+=e,this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit<0&&(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit=this.MinParticipantLimit),this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit>this.OriginalParticipantLimit&&(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit=this.OriginalParticipantLimit),this._vidyoCore.Controllers.LogController.LogInfo(new Date+": #######################  _alterParticipantsNumber: new ParticipantLimit="+this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit+"  #######################");var t=this._buildDynamicShowPayload(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit,this.currentFPS,this.currentBandwidth,this.currentResolution),n=this._vidyoCore.Controllers.ConferenceController.ConferenceDialog;return n?(this._vidyoCore.Controllers.LogController.LogVerbose("----------- _alterParticipantsNumber: "+JSON.stringify(t)),this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([]),this._vidyoCore.XmppProvider.ConferenceShowSelected(n.Identity(),t)):Promise.reject("Not in conference")},t.prototype._buildCurrentDynamicShowPayload=function(){return this._buildDynamicShowPayload(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit,this.currentFPS,this.currentBandwidth,this.currentResolution)},t.prototype._buildDynamicShowPayload=function(e,t,n,r){var i,a=[],s=[];for(i=0;e>i;i++)n=n?n:this.currentBandwidth,a.push({id:i,state:o.SourceState.On,params:{windowSize:{width:r.Width,height:r.Height},framesPerSec:t}});var c=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:u.ParticipantOrigin.Remote});c=c.sort(function(e,t){return e.Generation-t.Generation});for(var l=e,d=Math.max(0,c.length-l)+this.NumberOfDynamicOffsToSend,p=0;d>p;p++)a.push({id:i+p,state:o.SourceState.Off}),s.push({id:i+p,state:o.SourceState.Off});c.forEach(function(e,t){t>l&&(e.Active=!1)});var f={audio:{count:this.AudioCount,policy:o.AudioPolicy.LoudestSpeaker},video:{policy:this.SelfViewPolicy(),dynamicViewPolicy:o.ViewPolicy.ShowIfNotStaticallyViewed,generation:a}};return f},t.prototype._decreaseCallEntirety=function(){return this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit>this.MinParticipantLimit?(this._decreaseParticipantsNumber(),!0):(this._vidyoCore.Controllers.LogController.LogInfo("ResourcesController: UNABLE TO ADJUST CALL QUALITY"),!1)},t.prototype._decreaseParticipantsNumber=function(){if(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit<1)return this._vidyoCore.Controllers.LogController.LogError("DecreaseParticipantsNumber: IMPOSSIBLE to Decrease ParticipantsNumber"),Promise.reject("DecreaseParticipantsNumber: IMPOSSIBLE to Decrease ParticipantsNumber");var e=this._vidyoCore.Controllers.ParticipantController.GetParticipants().length-1;1>=e?e=1:e--,e<this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit?this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit=e:this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit--,this._vidyoCore.Controllers.LogController.LogInfo(new Date+": vvvvvvvvvvvvvvvvvvvvvvv DecreaseParticipantsNumber: "+this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit+" vvvvvvvvvvvvvvvvvvvvvvv");var t=this._buildDynamicShowPayload(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit,this.currentFPS,this.currentBandwidth,this.currentResolution),n=this._vidyoCore.Controllers.ConferenceController.ConferenceDialog;return n?(this._vidyoCore.Controllers.LogController.LogVerbose("----------- DecreaseParticipantsNumber: "+JSON.stringify(t)),this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([]),this._vidyoCore.XmppProvider.ConferenceShowSelected(n.Identity(),t)):Promise.reject("Not in conference")},t.prototype._increaseCallEntirety=function(){return this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit<this._vidyoCore.Controllers.ParticipantController.GetParticipants().length&&this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit<this.OriginalParticipantLimit?(this._increaseParticipantsNumber(),!0):(this._vidyoCore.Controllers.LogController.LogInfo(new Date+": ResourcesController: no needed to adjust call quality"),!1)},t.prototype._increaseParticipantsNumber=function(){if(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit>=this.OriginalParticipantLimit)return Promise.resolve();this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit++,this._vidyoCore.Controllers.LogController.LogInfo(new Date+": ^^^^^^^^^^^^^^^^^^^^^^^ IncreaseParticipantsNumber: "+this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit+" ^^^^^^^^^^^^^^^^^^^^^^^");var e=this._buildDynamicShowPayload(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit,this.currentFPS,this.currentBandwidth,this.currentResolution);return this._vidyoCore.Controllers.ConferenceController.ConferenceDialog?(this._vidyoCore.Controllers.LogController.LogVerbose("----------- IncreaseParticipantsNumber: "+JSON.stringify(e)),this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([]),this._vidyoCore.XmppProvider.ConferenceShowSelected(this._vidyoCore.Controllers.ConferenceController.ConferenceDialog.Identity(),e)):Promise.reject("Not in conference")},t.prototype._setFPS=function(e){this.currentFPS=e,this.currentBandwidth=t.defaultBandwidth/(t.defaultFPS/e)|0,this._vidyoCore.Controllers.LogController.LogInfo(new Date+": ------------ _setFPS: "+this.currentFPS);var n=this._buildDynamicShowPayload(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit,this.currentFPS,this.currentBandwidth,this.currentResolution);return this._vidyoCore.Controllers.ConferenceController.ConferenceDialog?(this._vidyoCore.Controllers.LogController.LogVerbose("------------ _setFPS: "+JSON.stringify(n)),this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([]),this._vidyoCore.XmppProvider.ConferenceShowSelected(this._vidyoCore.Controllers.ConferenceController.ConferenceDialog.Identity(),n)):Promise.reject("Not in conference")},t.prototype._setResolution=function(e){this.currentResolution=e,this.currentBandwidth=t.defaultBandwidth/(t.defaultResolution.Width/e.Width)|0,this._vidyoCore.Controllers.LogController.LogInfo(new Date+": ------------ _setResolution: "+JSON.stringify(this.currentResolution));var n=this._buildDynamicShowPayload(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit,this.currentFPS,this.currentBandwidth,this.currentResolution);return this._vidyoCore.Controllers.ConferenceController.ConferenceDialog?(this._vidyoCore.Controllers.LogController.LogVerbose("------------ _setResolution: "+JSON.stringify(n)),this._vidyoCore.Controllers.ParticipantController.UpdateParticipants([]),this._vidyoCore.XmppProvider.ConferenceShowSelected(this._vidyoCore.Controllers.ConferenceController.ConferenceDialog.Identity(),n)):Promise.reject("Not in conference")},t.prototype._getCurrentStatistics=function(){var e=this;return this._vidyoCore.Controllers.StatisticsController._updateStatistics().then(function(){var t=new c.EndpointStats(e._vidyoCore.Controllers.StatisticsController.GetEndpointStatistics());return t})},t.defaultBandwidth=524288,t.defaultBandwidth_mod=393216,t.defaultBandwidth_low=262144,t.defaultBandwidth_min=131072,t.defaultFPS=30,t.defaultFPS_1=1,t.defaultFPS_12=12,t.defaultFPS_24=24,t.defaultResolution=new s.BasicVideoResolution,t._vp8AvgFrameSize=1e4,t._vp8MinBitRate=25e4,t}(i.BaseController);n.ResourcesController=f},{"../../vidyo_simple_api/stats/Stats":515,"../events/EventDispatcher":372,"../events/ParticipantEvents":374,"../models/ConferenceCommandParameters":379,"../models/Participant":383,"../models/VideoResolution":389,"../utils/Constants":426,"../utils/OperatingSystemInfoProvider":436,"./BaseController":344}],359:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i,o=e("../utils/Constants"),a=e("../utils/Errors"),s=e("../xmpp/XmppProvider"),c=e("./BaseController"),u=e("../events/RoomEvents"),l=e("es6-promise"),d=e("../models/Room"),p=e("../../vidyo_simple_api/Room"),f=e("../utils/TokenUtils"),h=e("../utils/LocationProvider"),m=e("../events/ConnectionEvents"),v=e("../events/ConnectionEvents"),g=e("../../vidyo_connector_api/VidyoConnector");!function(e){e[e.VIDYO_USERROOMCREATERESULT_DUPLICATENAME=0]="VIDYO_USERROOMCREATERESULT_DUPLICATENAME",e[e.VIDYO_USERROOMCREATERESULT_MISCLOCALERROR=1]="VIDYO_USERROOMCREATERESULT_MISCLOCALERROR",e[e.VIDYO_USERROOMCREATERESULT_MISCREMOTEERROR=2]="VIDYO_USERROOMCREATERESULT_MISCREMOTEERROR",e[e.VIDYO_USERROOMCREATERESULT_NORESPONSE=3]="VIDYO_USERROOMCREATERESULT_NORESPONSE",e[e.VIDYO_USERROOMCREATERESULT_NOTFOUND=4]="VIDYO_USERROOMCREATERESULT_NOTFOUND",e[e.VIDYO_USERROOMCREATERESULT_OK=5]="VIDYO_USERROOMCREATERESULT_OK",e[e.VIDYO_USERROOMCREATERESULT_UNAUTHORIZED=6]="VIDYO_USERROOMCREATERESULT_UNAUTHORIZED"}(i=n.CreateRoomResults||(n.CreateRoomResults={}));var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.ConferenceJoin=function(e){return this._vidyoCore.XmppProvider.ConferenceJoin({Session:e,Conference:this._conference,Reflector:this._vidyoCore.Controllers.ConnectionController.Reflector(),LocalId:1},{})},t.prototype.CreateRoom=function(e){var t=this,n=this._createRoomJID(e);return this.FindRoomOnServer(n).then(function(t){if(t&&e.isNewRoom)throw new a.DuplicateNameError}).then(function(){var e=function(e){return t._vidyoCore.XmppProvider.SendPresence(e),t._vidyoCore.XmppProvider.JoinRoom({jid:n,user:t._vidyoCore.XmppProvider.Jid().resource})},r={to:n+"/"+t._vidyoCore.XmppProvider.Jid().resource,displayName:t._vidyoCore.Controllers.UserController.UserDisplayName(),idName:"VidyoTechnology",idVersion:o.LibVersion,maxStanzas:0};return h.LocationProvider.GetCurrentPosition().then(function(t){return r.location=t,e(r)})["catch"](function(){return e(r)})}).then(function(n){t._room.Jid=n.roomJid,t._room.LocalUserId=t._vidyoCore.XmppProvider.Jid().resource,t._room.InRoom=!0,t._vidyoCore.EventDispatcher.emit(u.Events.Created,{room:new p.Room(t._vidyoCore,t._room),result:i[i.VIDYO_USERROOMCREATERESULT_OK],token:e.token})}).then(function(){return e.subject?t._vidyoCore.XmppProvider.SetRoomSubject(n,e.subject):l.Promise.resolve(void 0)})["catch"](function(n){var r;switch(n.name){case a.TimeOutError.Name:r=i[i.VIDYO_USERROOMCREATERESULT_NORESPONSE];break;case a.DuplicateNameError.Name:r=i[i.VIDYO_USERROOMCREATERESULT_DUPLICATENAME];break;default:r=i[i.VIDYO_USERROOMCREATERESULT_MISCREMOTEERROR]}n.message=r,t._vidyoCore.Controllers.LogController.LogError(n),t._vidyoCore.EventDispatcher.emit(u.Events.Created,{room:new p.Room(t._vidyoCore,t._room),result:r,token:e.token}),t._vidyoCore.EventDispatcher.emit(m.Events.SignallingError,new v.VidyoEventInfo("SignallingError",g.VidyoConnectorDisconnectReason.MiscError,r,"error"))})},t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Enter=function(e){var t=this;if(e.InRoom)return this._vidyoCore.EventDispatcher.emit(u.Events.Entered,{roomJid:e.Jid}),l.Promise.resolve(void 0);var n={to:e.Jid+"/"+e.LocalUserId,displayName:this._vidyoCore.Controllers.UserController.UserDisplayName()};return this._vidyoCore.XmppProvider.SendPresence(n),this._vidyoCore.XmppProvider.JoinRoom({jid:e.Jid,user:e.LocalUserId}).then(function(n){return e.InRoom=!0,t._vidyoCore.EventDispatcher.emit(u.Events.Entered,{roomJid:e.Jid}),l.Promise.resolve(void 0)})},t.prototype.FindRoomOnServer=function(e){return this._vidyoCore.XmppProvider.GetDiscoInfo(e).then(function(e){return e.type===s.StanzaTypes[s.StanzaTypes.result]})},t.prototype.GetConference=function(){return this._conference},t.prototype.Initialize=function(){return this._room=new d.Room,l.Promise.resolve(void 0)},t.prototype.Leave=function(e){var t=this;return e.InRoom&&this._vidyoCore.XmppProvider.IsXMPPSessionAlive()?this._vidyoCore.XmppProvider.LeaveRoom({jid:e.Jid,user:e.LocalUserId}).then(function(){return e.InRoom=!1,t._vidyoCore.EventDispatcher.emit(u.Events.Left,{roomJid:e.Jid}),l.Promise.resolve(void 0)}):(e.InRoom=!1,this._vidyoCore.EventDispatcher.emit(u.Events.Left,{roomJid:e.Jid}),l.Promise.resolve(void 0))},t.prototype.LeaveAll=function(){return this.Leave(this._room)},t.prototype.RoomJid=function(){return this._room.Jid},t.prototype.RoomUserResourceId=function(){return this._room.LocalUserId},t.prototype.SetConference=function(e){this._conference=e},t.prototype._createRoomJID=function(e){var t=e.resourceId+o.ResourceIdDomainSeparator+f.DecodeUserDomainName(e.token);

return t+o.Muc+this._vidyoCore.XmppProvider.Domain()},t}(c.BaseController);n.RoomController=y},{"../../vidyo_connector_api/VidyoConnector":486,"../../vidyo_simple_api/Room":493,"../events/ConnectionEvents":370,"../events/RoomEvents":376,"../models/Room":386,"../utils/Constants":426,"../utils/Errors":427,"../utils/LocationProvider":430,"../utils/TokenUtils":443,"../xmpp/XmppProvider":450,"./BaseController":344,"es6-promise":31}],360:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../events/ConferenceEvents"),o=e("../events/ConnectionEvents"),a=e("../utils/Constants"),s=e("../events/StatisticsEvents"),c=e("./BaseController"),u=e("../models/statistics/Statistics"),l=e("../events/EventDispatcher"),d=e("../utils/TimingProvider"),p=e("../../vidyo_simple_api/stats/Stats"),f=e("../utils/OperatingSystemInfoProvider"),h=e("../models/Source"),m=e("../utils/AudioAnalyser"),v=e("../utils/ObjectUtils"),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.EndpointStatistic=new u.EndpointStatistics,t.RoomStatistics=new u.RoomStatistics,t.UserStatistic=new u.UserStatistics,t._intervalRefreshHandle=null,t._intervalSendStatsHandle=null,t._roomJoinedTimestamp=0,t._statsOn=!1,t}return r(t,e),t.prototype.Disable=function(){return this._onDisconnected(),e.prototype.Disable.call(this)},t.prototype.GetCallStats=function(){var e=new u.CallStatistics;return e.FillFromBandwidthSummaryStatistics(this.RoomStatistics.BandwidthVideo),v["default"].IsNotEmpty(this.EndpointStatistic.LocalMicrophoneStats)&&e.FillFromLocalMicrophoneStatistics(this.EndpointStatistic.LocalMicrophoneStats[0]),v["default"].IsNotEmpty(this.EndpointStatistic.LocalCameraStats)&&e.FillFromLocalVideoSourceStatistics(this.EndpointStatistic.LocalCameraStats[0]),this.RoomStatistics.ParticipantStats.forEach(function(t){var n=e.ParticipantStatistics.Get(t.Id);n.ParticipantIsActive=t.ParticipantIsActive,v["default"].IsNotEmpty(t.RemoteMicrophoneStats)&&n.FillFromRemoteMicrophoneStatistics(t.RemoteMicrophoneStats[0]);var r;v["default"].IsNotEmpty(t.RemoteCameraStats)?r=t.RemoteCameraStats[0]:v["default"].IsNotEmpty(t.RemoteWindowShareStats)&&(r=t.RemoteWindowShareStats[0]),r&&n.FillFromRemoteVideoSourceStatistics(r),n.SSRCs.Push(t.SSRCs)}),e},t.prototype.GetEndpointStatistics=function(){return this.EndpointStatistic},t.prototype.GetUserStatistics=function(){return this.UserStatistic},t.prototype.Initialize=function(){var e=this;return this._initStatistics(),this._vidyoCore.EventDispatcher.releaseGroup(l.StatisticsControllerListeners),this._vidyoCore.EventDispatcher.on(i.Events.ConferenceJoined,l.StatisticsControllerListeners,function(){return e._onConferenceJoined()}),this._vidyoCore.EventDispatcher.on(o.Events.Disconnected,l.StatisticsControllerListeners,function(){return e._onDisconnected()}),Promise.resolve(void 0)},t.prototype.SetClientConnectionStats=function(e,t,n){this.UserStatistic.Host=e,this.UserStatistic.Port=t||0,this.UserStatistic.ServiceType=n||""},t.prototype._clearIntervals=function(){null!==this._intervalRefreshHandle&&(d.TimingProvider.ClearInterval(this._intervalRefreshHandle),this._intervalRefreshHandle=null),null!==this._intervalSendStatsHandle&&(d.TimingProvider.ClearInterval(this._intervalSendStatsHandle),this._intervalSendStatsHandle=null)},t.prototype._fillLocalRendererStats=function(){var e=this,t=this._vidyoCore.Controllers.RendererController.Views;this.EndpointStatistic.LocalRendererStats.length=0,Object.keys(t).forEach(function(n){var r=t[n],i=new u.LocalRendererStatistics;i.Id=r.viewId,i.Width=r.width||0,i.Height=r.height||0,e.EndpointStatistic.LocalRendererStats.push(i)})},t.prototype._fillLocalSpeakerStatistics=function(){var e=this._vidyoCore.Controllers.DeviceController.GetSelectedDevices(),t=new u.LocalSpeakerStatistics,n=e.Speaker;t.Id=n.Id||"",t.Name=n.Name||"",this.EndpointStatistic.LocalSpeakerStats.length=0,this.EndpointStatistic.LocalSpeakerStats.push(t)},t.prototype._initStatistics=function(){this.TransportInformation=this.RoomStatistics.TransportInformation,this.UserStatistic.RoomStats=[this.RoomStatistics],this.EndpointStatistic.UserStats=[this.UserStatistic];var e=f.OperatingSystemInfoProvider.GetOSInfo();this.EndpointStatistic.OsName=e.OSName||"",this.EndpointStatistic.OsVersion=e.OSVersion||""},t.prototype._onConferenceJoined=function(){var e=this;this._vidyoCore.Controllers.AdvancedSettingsController.DisableStats||(this._roomJoinedTimestamp=Date.now(),this._clearIntervals(),this._intervalRefreshHandle=d.TimingProvider.Interval(a.StatisticsRefreshInterval,function(){e._updateStatistics(),e._vidyoCore.EventDispatcher.emit(s.Events.Update)}),this._intervalSendStatsHandle=d.TimingProvider.Interval(a.SendClientStatisticsInterval,function(){return e._sendClientStatistic()}))},t.prototype._onDisconnected=function(){this._clearIntervals()},t.prototype._processLocalAudioTrackStats=function(e,t){var n=new u.LocalMicrophoneStatistics;n.FillFromRTCStats(t,e),this.EndpointStatistic.LocalMicrophoneStats=[n]},t.prototype._processLocalStreamStatistic=function(e,t){var n=this,r=t.trackIds;r.forEach(function(t){var r=e.get(t);switch(r.kind){case"video":n._processLocalVideoTrackStats(e,t);break;case"audio":n._processLocalAudioTrackStats(e,t)}})},t.prototype._processLocalVideoTrackStats=function(e,t){var n=new u.LocalVideoSourceStatistics;n.FillFromRTCStats(t,e,this._lastStats),this.EndpointStatistic.LocalCameraStats=[n]},t.prototype._processParticipantAudioTrack=function(e,t,n){var r=new u.RemoteMicrophoneStatistics;r.FillFromRTCStats(t,e,this._lastStats);var i=m.AudioAnalyser.GetAudioStats(n.Id);r.FillFromAudioAnalyzerStats(i),n.RemoteMicrophoneStats=[r]},t.prototype._processParticipantStreamStatistic=function(e,t){var n=this,r=t.streamIdentifier,i=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(r);if(i&&i.IsRemote){var o=i.Id,a=this.RoomStatistics.ParticipantStats.find(function(e){return e.Id===o});a||(a=new u.ParticipantStatistic,a.Id=o,a.Name=i.Name,this.RoomStatistics.ParticipantStats.push(a)),a.ParticipantIsActive=i.Active,a.EmptyStats();var s=t.trackIds;s.forEach(function(t){var r=e.get(t);if(r)switch(a.SSRCs.push(r.trackIdentifier),r.kind){case"video":n._processParticipantVideoTrack(e,t,a,i);break;case"audio":n._processParticipantAudioTrack(e,t,a)}})}},t.prototype._processParticipantVideoTrack=function(e,t,n,r){var i=new u.RemoteVideoSourceStatistics;i.FillFromRTCStats(t,e,this._lastStats);var o,a=e.get(t),s=e.get("RTCInboundRTPVideoStream_"+a.trackIdentifier);s&&r&&(o=r.GetSourceBySSrc(s.ssrc)),o&&o.Type===h.SourceMediaType.Application?n.RemoteWindowShareStats=[i]:n.RemoteCameraStats=[i]},t.prototype._processTransportStatistic=function(e,t,n){var r=new u.MediaConnectionTransportInformation;r.FillFromRTCStats(n,e);var i=e.get(t.selectedCandidatePairId);if(i){var o=e.get(i.localCandidateId);"udp"===o.protocol?(this.EndpointStatistic.BytesReceivedUdp+=t.bytesReceived||0,this.EndpointStatistic.BytesSentUdp+=t.bytesSent||0):(this.EndpointStatistic.BytesReceivedTcp+=t.bytesReceived||0,this.EndpointStatistic.BytesSentTcp+=t.bytesSent||0),this.RoomStatistics.ReceiveBitRateAvailable=i.availableIncomingBitrate||0,this.RoomStatistics.SendBitRateAvailable=i.availableOutgoingBitrate||0}this.TransportInformation.push(r)},t.prototype._sendClientStatistic=function(){this.EndpointStatistic.TimeStamp=(new Date).toUTCString(),this.EndpointStatistic.RoomEnterTimeConsumedMs=Date.now()-this._roomJoinedTimestamp,this.RoomStatistics.ReflectorId=this._vidyoCore.Controllers.ConnectionController.Reflector(),this.RoomStatistics.ConferenceId=this._vidyoCore.Controllers.RoomController.GetConference(),this.RoomStatistics.Id=this._vidyoCore.Controllers.RoomController.RoomJid(),this._fillLocalSpeakerStatistics(),this._fillLocalRendererStats();var e=new p.EndpointStats(this.EndpointStatistic);this._vidyoCore.Controllers.ConnectionController.SendClientStats(JSON.stringify(e)),this._vidyoCore.Controllers.ResourcesController.ProcessStatistics(e)},t.prototype._updateStatistics=function(){var e=this,t=this._vidyoCore.Controllers.ConnectionController.Session;t&&(this.TransportInformation.length=0,this.EndpointStatistic.EmptyBytesCountStatistic(),t.GetStats().then(function(t){t.forEach(function(n,r){switch(n.type){case"stream":r.match(/.+_local_.+/)?e._processLocalStreamStatistic(t,n):e._processParticipantStreamStatistic(t,n);break;case"transport":e._processTransportStatistic(t,n,r)}}),e._lastStats=t}))},t}(c.BaseController);n.StatisticsController=g},{"../../vidyo_simple_api/stats/Stats":515,"../events/ConferenceEvents":369,"../events/ConnectionEvents":370,"../events/EventDispatcher":372,"../events/StatisticsEvents":377,"../models/Source":387,"../models/statistics/Statistics":416,"../utils/AudioAnalyser":421,"../utils/Constants":426,"../utils/ObjectUtils":435,"../utils/OperatingSystemInfoProvider":436,"../utils/TimingProvider":442,"./BaseController":344}],361:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i,o=e("../../events/CallStateEvents"),a=e("../../utils/Constants"),s=e("../../events/DeviceEvents"),c=e("../../events/StreamEvents"),u=e("../../utils/Messages"),l=e("../BaseController"),d=e("../../events/EventDispatcher"),p=e("../../models/stream/ReadOnlyMediaStream"),f=e("../../utils/UserMediaProvider"),h=e("es6-promise"),m=e("./StreamEventHelper"),v=e("./TrackMetaDataProvider"),g=e("async"),y=e("../../utils/ObjectUtils"),_=e("../../utils/StringUtils");!function(e){e.Camera="Camera",e.Microphone="Microphone",e.Monitor="Monitor",e.WindowShare="WindowShare"}(i||(i={}));var S=function(e){function t(t){var n=e.call(this,t)||this;return n._hasMonitorShare=!1,n._hasWindowShare=!1,n._localVideoStreamConstraints={width:a.DefaultLocalStreamWidth,height:a.DefaultLocalStreamHeight,frameRate:a.DefaultLocalStreamFrameRate},n._trackIndex={Camera:{},Microphone:{},Monitor:{},WindowShare:{}},n._transmittedStream=new MediaStream,n._userMediaProvider=new f.UserMediaProvider,n._localStreamsMap={},n._localStreamsMap.Camera=new MediaStream,n._localStreamsMap.Microphone=n._localStreamsMap.Camera,n._localStreamsMap.Monitor=new MediaStream,n._localStreamsMap.WindowShare=new MediaStream,n._mediaActionsQueue=g.queue(function(e,t){e().then(t)["catch"](t)}),n}return r(t,e),Object.defineProperty(t.prototype,"AudioVideoStream",{get:function(){return new p.ReadOnlyMediaStream(this._localStreamsMap[i.Camera])},enumerable:!0,configurable:!0}),t.prototype.Disable=function(){return this.StopMedia(),e.prototype.Disable.call(this)},t.prototype.GetApplicationStreams=function(){var e=[];return this._hasMonitorShare&&e.push(this.MonitorShareStream),this._hasWindowShare&&e.push(this.WindowShareStream),e},t.prototype.GetLocalStreamVideoConstraints=function(){return this._localVideoStreamConstraints},t.prototype.GetStreamTrackMediaType=function(e){var t,n=(r={},r[this._localStreamsMap.Camera.id]=v.MediaTrackType.Video,r[this._localStreamsMap.Monitor.id]=v.MediaTrackType.Application,r[this._localStreamsMap.WindowShare.id]=v.MediaTrackType.Application,r);return t=n[e],t||v.UnknownMediaTrackType;var r},t.prototype.GetTrackMediaType=function(e){for(var t=v.UnknownMediaTrackType,n=this._transmittedStream.id,r=(d={},d[i.Camera]=v.MediaTrackType.Video,d[i.Monitor]=v.MediaTrackType.Application,d[i.WindowShare]=v.MediaTrackType.Application,d[i.Microphone]=v.MediaTrackType.Audio,d),o=0,a=Object.entries(r);o<a.length;o++){var s=a[o],c=s[0],u=s[1],l=this._trackIndex[c][n];if(l&&l.id===e){t=u;break}}return t;var d},t.prototype.GetTransmittedStream=function(){return this._transmittedStream},t.prototype.Initialize=function(){var t=this;return this._streamEventHelper=new m.StreamEventHelper(this._vidyoCore.EventDispatcher),this._vidyoCore.EventDispatcher.releaseGroup(d.LocalStreamControllerListeners),this._vidyoCore.EventDispatcher.on(o.Events.MediaStateTransition,d.LocalStreamControllerListeners,function(e){return t._mediaStateTransition(e)}),this._vidyoCore.EventDispatcher.on(s.Events.MicrophoneSettingsChanged,d.LocalStreamControllerListeners,function(e){return t.StartOrStopAudio()}),this._vidyoCore.EventDispatcher.on(s.Events.CameraSettingsChanged,d.LocalStreamControllerListeners,function(e){return t.StartOrStopVideo()}),this._vidyoCore.EventDispatcher.on(c.Events.LocalVideoTrackConstraintsChanged,d.LocalStreamControllerListeners,function(e){return t._videoStreamConstraintsChanged(e)}),e.prototype.Initialize.call(this).then(function(){return t._userMediaProvider.Initialize()})},t.prototype.IsTransmittedStream=function(e){return this._transmittedStream.id===e.id},Object.defineProperty(t.prototype,"MonitorShareStream",{get:function(){return new p.ReadOnlyMediaStream(this._localStreamsMap[i.Monitor])},enumerable:!0,configurable:!0}),t.prototype.StartMedia=function(){var e=this,t=[],n=!!this._trackIndex.Microphone[this._localStreamsMap[i.Camera].id],r=!!this._trackIndex.Camera[this._localStreamsMap[i.Camera].id],o=!!this._trackIndex.WindowShare[this._localStreamsMap[i.WindowShare].id],a=!!this._trackIndex.WindowShare[this._localStreamsMap[i.Monitor].id];if(n||t.push(this.StartOrStopAudio()),r||t.push(this.StartOrStopVideo()),!(a||o||n||r)){var s=function(e){return e["catch"](function(){return h.Promise.resolve()})};t=t.map(s),h.Promise.all(t).then(function(){e._streamEventHelper.AttachStreamEvents(e.AudioVideoStream),e._streamEventHelper.AttachStreamEvents(e.WindowShareStream),e._streamEventHelper.AttachStreamEvents(e.MonitorShareStream),e._vidyoCore.EventDispatcher.emit(c.Events.LocalStreamReady)})}},t.prototype.StartMonitorShare=function(e){var t=this;return this._pushToAsyncQueue(function(){return t._hasMonitorShare&&t.StopMonitorShare(),t._startMonitorShare(e)})},t.prototype.StartOrStopAudio=function(){return this._vidyoCore.Controllers.DeviceController.GetAudioMuteState()?this.StopAudio():this._startAudio()},t.prototype.StartOrStopVideo=function(){return this._vidyoCore.Controllers.DeviceController.GetVideoMuteState()?this.StopVideo():this._startVideo()},t.prototype.StartWindowShare=function(e){var t=this;return this._pushToAsyncQueue(function(){return t._hasWindowShare&&t.StopWindowShare(),t._startWindowShare(e)})},t.prototype.StopAudio=function(){var e=this;return this._pushToAsyncQueue(function(){return e._removeTrack(i.Microphone),h.Promise.resolve()})},t.prototype.StopMedia=function(){this.StopAudio(),this.StopVideo(),this.StopWindowShare(),this.StopMonitorShare()},t.prototype.StopMonitorShare=function(){var e=this;return this._pushToAsyncQueue(function(){e._hasMonitorShare=!1;var t=e._trackIndex[i.Monitor][e._localStreamsMap[i.Monitor].id];return e._removeTrack(i.Monitor),t&&e._vidyoCore.EventDispatcher.emit(c.Events.LocalMonitorDeselected),h.Promise.resolve()})},t.prototype.StopVideo=function(){var e=this;return this._pushToAsyncQueue(function(){return e._removeTrack(i.Camera),h.Promise.resolve()})},t.prototype.StopWindowShare=function(){var e=this;return this._pushToAsyncQueue(function(){e._hasWindowShare=!1;var t=e._trackIndex[i.WindowShare][e._localStreamsMap[i.WindowShare].id];return e._removeTrack(i.WindowShare),t&&e._vidyoCore.EventDispatcher.emit(c.Events.LocalWindowShareDeselected),h.Promise.resolve()})},Object.defineProperty(t.prototype,"WindowShareStream",{get:function(){return new p.ReadOnlyMediaStream(this._localStreamsMap[i.WindowShare])},enumerable:!0,configurable:!0}),t.prototype._addVideoElement=function(e,t){this._addVideoElementToStream(t,this._localStreamsMap[t],e),this._addVideoElementToStream(t,this._transmittedStream,e.clone())},t.prototype._addVideoElementToStream=function(e,t,n){t.addTrack(n),t.dispatchEvent(new Event("addtrack")),this._trackIndex[e][t.id]=n},t.prototype._mediaStateTransition=function(e){e.ShouldRenderMedia?this.StartMedia():this.StopMedia()},t.prototype._pushToAsyncQueue=function(e){var t=this;return new h.Promise(function(n,r){t._mediaActionsQueue.push(e,function(e){e?r(e):n()})})},t.prototype._removeTrack=function(e){this._removeTrackFromStream(e,this._localStreamsMap[e]),this._removeTrackFromStream(e,this._transmittedStream)},t.prototype._removeTrackFromStream=function(e,t){var n=this._trackIndex[e][t.id];n&&(n.stop(),t.removeTrack(n),t.dispatchEvent(new Event("removetrack")),delete this._trackIndex[e][t.id])},t.prototype._startAudio=function(){var e=this;return this._pushToAsyncQueue(function(){var t=e._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Microphone;return e._startTrack(i.Microphone,function(){return e._userMediaProvider.GetAudioTrack(t||!0)})})},t.prototype._startMonitorShare=function(e){var t=this;return this._hasMonitorShare=!0,this._startTrack(i.Monitor,function(){return t._userMediaProvider.GetWindowShareTrack(e)}).then(function(){var e=t._trackIndex[i.Monitor][t._localStreamsMap[i.Monitor].id];e&&(t._vidyoCore.EventDispatcher.emit(c.Events.LocalMonitorSelected),e.addEventListener("ended",function(){t.StopMonitorShare()}))})},t.prototype._startTrack=function(e,t){var n=this,r=this._vidyoCore.Controllers.CallStateController.MediaState;if(r.ShouldRenderMedia)return this._removeTrack(e),t().then(function(t){return n._addVideoElement(t,e),h.Promise.resolve()});var i={mediaType:e,mediaState:r.toString()},o=_["default"].Format(u.LocalMediaOperationNotPermitted,i);return h.Promise.reject(o)},t.prototype._startVideo=function(){var e=this;return this._pushToAsyncQueue(function(){var t=e._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Camera;return e._startTrack(i.Camera,function(){return e._userMediaProvider.GetVideoTrack(t||!0,y["default"].Copy(e._localVideoStreamConstraints))})})},t.prototype._startWindowShare=function(e){var t=this;return this._hasWindowShare=!0,this._startTrack(i.WindowShare,function(){return t._userMediaProvider.GetWindowShareTrack(e)}).then(function(){var e=t._trackIndex[i.WindowShare][t._localStreamsMap[i.WindowShare].id];e&&(t._vidyoCore.EventDispatcher.emit(c.Events.LocalWindowShareSelected),e.addEventListener("ended",function(){t.StopWindowShare()}))})},t.prototype._videoStreamConstraintsChanged=function(e){var t=this;Object.assign(this._localVideoStreamConstraints,e);var n=this._trackIndex[i.Camera][this._transmittedStream.id];if(n){var r={width:{ideal:this._localVideoStreamConstraints.width},height:{ideal:this._localVideoStreamConstraints.height},frameRate:{ideal:this._localVideoStreamConstraints.frameRate}};n.applyConstraints(r).then(function(){t._vidyoCore.Controllers.LogController.LogInfo(new Date+" : LocalStreamController: video constraints changed. "+JSON.stringify(r))})["catch"](function(e){t._vidyoCore.Controllers.LogController.LogError(e)})}},t}(l.BaseController);n.LocalStreamController=S},{"../../events/CallStateEvents":368,"../../events/DeviceEvents":371,"../../events/EventDispatcher":372,"../../events/StreamEvents":378,"../../models/stream/ReadOnlyMediaStream":418,"../../utils/Constants":426,"../../utils/Messages":432,"../../utils/ObjectUtils":435,"../../utils/StringUtils":441,"../../utils/UserMediaProvider":444,"../BaseController":344,"./StreamEventHelper":363,"./TrackMetaDataProvider":364,async:2,"es6-promise":31}],362:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../events/ConferenceEvents"),o=e("../../events/ConnectionEvents"),a=e("../../utils/Messages"),s=e("../../events/StreamEvents"),c=e("../BaseController"),u=e("../../models/stream/ReadOnlyMediaStream"),l=e("../../events/EventDispatcher"),d=e("./StreamEventHelper"),p=e("./TrackMetaDataProvider"),f=e("../../models/device/Microphone"),h=e("../../models/device/Camera"),m=e("../../models/device/WindowShare"),v=e("../../utils/StringUtils"),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._participantStreamsData={},t._participantStreamsMap={},t._streams={},t._trackMetaData={},t}return r(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.GetNetworkStream=function(e){var t=this.TryGetNetworkStream(e);if(t)return t;throw new Error(v["default"].Format(a.NoSuchStream,{id:e}))},t.prototype.GetParticipantApplicationStreams=function(e){var t=[];return this._participantStreamsData[e]&&(t=Object.values(this._participantStreamsData[e].Application).map(function(e){return new u.ReadOnlyMediaStream(e.stream)})),t},t.prototype.GetTrackMediaType=function(e){var t,n=this.TryGetParticipantStream(e);if(n){var r=n.GetVideoTracks()[0];r&&(t=this._trackMetaData[r.Id])}return t||"unknown"},t.prototype.Initialize=function(){var t=this;return this._streamEventHelper=new d.StreamEventHelper(this._vidyoCore.EventDispatcher),this._vidyoCore.EventDispatcher.releaseGroup(l.RemoteStreamControllerListeners),this._vidyoCore.EventDispatcher.on(o.Events.JingleRemoteStreamAdded,l.RemoteStreamControllerListeners,function(e){var n=e.stream;return t._onRemoteStreamAdded(n)}),this._vidyoCore.EventDispatcher.on(o.Events.JingleRemoteStreamRemoved,l.RemoteStreamControllerListeners,function(e){var n=e.stream;return t._onRemoteStreamRemoved(n)}),this._vidyoCore.EventDispatcher.on(i.Events.SourceDetected,l.RemoteStreamControllerListeners,function(e){return t._onRemoteTrackMetaData(e)}),this._vidyoCore.EventDispatcher.on(i.Events.SourceRemoved,l.RemoteStreamControllerListeners,function(e){return t._onRemoteTrackRemoved(e)}),e.prototype.Initialize.call(this)},t.prototype.TryGetNetworkStream=function(e){return this._streams[e]},t.prototype.TryGetParticipantAudioStream=function(e){var t;return this._participantStreamsData[e]&&(t=new u.ReadOnlyMediaStream(this._participantStreamsData[e].Audio.stream)),t},t.prototype.TryGetParticipantStream=function(e){var t;return this._participantStreamsMap[e]&&(t=new u.ReadOnlyMediaStream(this._participantStreamsMap[e])),t},t.prototype.TryGetParticipantVideoStream=function(e){var t;return this._participantStreamsData[e]&&(t=new u.ReadOnlyMediaStream(this._participantStreamsData[e].Video.stream)),t},t.prototype._checkAndAddParticipantStreamsDataTrack=function(e,t){var n=this,r=t.getTracks();r.forEach(function(t){var r=n._trackMetaData[t.id];switch(r){case p.MediaTrackType.Audio:if(!e.MediaTrackMap[t.id]){var i=t.clone();n._trackMetaData[i.id]=r,e.MediaTrackMap[t.id]=i,e.Audio.stream.addTrack(i),e.Audio.device=new f.Microphone(t.id,t.label),n._vidyoCore.EventDispatcher.emit(s.Events.RemoteMicrophoneAdded,{microphone:e.Audio.device,participant:e.Participant})}break;case p.MediaTrackType.Video:if(!e.MediaTrackMap[t.id]){var i=t.clone();n._trackMetaData[i.id]=r,e.MediaTrackMap[t.id]=i,e.Video.stream.addTrack(i),e.Video.device=new h.Camera(t.id,t.label),n._vidyoCore.EventDispatcher.emit(s.Events.RemoteCameraAdded,{camera:e.Video.device,participant:e.Participant})}break;case p.MediaTrackType.Application:if(!e.Application[t.id]){var o=new MediaStream,i=t.clone();n._trackMetaData[i.id]=r,o.addTrack(i),n._participantStreamsMap[o.id]=o,e.Application[t.id]={device:new m.WindowShare(t.id,t.label),stream:o},n._vidyoCore.EventDispatcher.emit(s.Events.RemoteWindowShareAdded,{participant:e.Participant,windowShare:e.Application[t.id].device});break}}})},t.prototype._checkAndRemoveParticipantStreamsDataTracks=function(e,t){for(var n=0,r=Object.entries(e.MediaTrackMap);n<r.length;n++){var i=r[n],o=i[0],a=i[1];if(-1===t.indexOf(o))switch(a.stop(),this._trackMetaData[a.id]){case p.MediaTrackType.Audio:e.Audio.stream.removeTrack(a),e.Audio.device&&(this._vidyoCore.EventDispatcher.emit(s.Events.RemoteMicrophoneRemoved,{microphone:e.Audio.device,participant:e.Participant}),e.Audio.device=null);break;case p.MediaTrackType.Video:e.Video.stream.removeTrack(a),e.Video.device&&(this._vidyoCore.EventDispatcher.emit(s.Events.RemoteCameraRemoved,{camera:e.Video.device,participant:e.Participant}),e.Video.device=null)}}for(var c=0,u=Object.entries(e.Application);c<u.length;c++){var l=u[c],o=l[0],a=l[1];if(-1===t.indexOf(o)){var d=e.Application[o].stream.getVideoTracks()[0];e.Application[o].stream.removeTrack(d),e.Application[o].stream.dispatchEvent(new Event("removetrack")),e.Application[o].device&&(this._vidyoCore.EventDispatcher.emit(s.Events.RemoteWindowShareRemoved,{participant:e.Participant,windowShare:e.Application[o].device}),e.Video.device=null),delete this._trackMetaData[d.id],delete e.Application[o]}}},t.prototype._createParticipantStreamsData=function(e){var t=this,n=new MediaStream,r=this._vidyoCore.Controllers.ParticipantController.GetParticipant(e.id),i={Application:{},Audio:{device:null,stream:new MediaStream},MediaTrackMap:{},Participant:r,Video:{device:null,stream:n}};this._participantStreamsMap[n.id]=n,this._checkAndAddParticipantStreamsDataTrack(i,e),e.addEventListener("addtrack",function(){t._checkAndAddParticipantStreamsDataTrack(i,e)}),e.addEventListener("removetrack",function(){var n=e.getTracks().map(function(e){return e.id});t._checkAndRemoveParticipantStreamsDataTracks(i,n)}),this._participantStreamsData[e.id]=i,this._streamEventHelper.AttachStreamEvents(new u.ReadOnlyMediaStream(n))},t.prototype._onRemoteStreamAdded=function(e){var t=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e.id);if(t){var n=new u.ReadOnlyMediaStream(e);this._createParticipantStreamsData(e),this._streams[e.id]=n,this._streamEventHelper.AttachStreamEvents(n)}},t.prototype._onRemoteStreamRemoved=function(e){var t=this._streams[e.id];t&&(t.UnregisterEventListeners(),delete this._participantStreamsData[e.id],delete this._streams[e.id],this._vidyoCore.EventDispatcher.emit(s.Events.StreamListChanged))},t.prototype._onRemoteTrackMetaData=function(e){this._trackMetaData[e.ssrc]=e.type},t.prototype._onRemoteTrackRemoved=function(e){var t=this._streams[e.participantId];if(t){var n=t.GetTracks().map(function(e){return e.Id});n=n.filter(function(t){return t!==e.ssrc}),this._checkAndRemoveParticipantStreamsDataTracks(this._participantStreamsData[e.participantId],n),this._vidyoCore.EventDispatcher.emit(s.Events.TracksChanged,e.participantId)}},t}(c.BaseController);n.RemoteStreamController=g},{"../../events/ConferenceEvents":369,"../../events/ConnectionEvents":370,"../../events/EventDispatcher":372,"../../events/StreamEvents":378,"../../models/device/Camera":390,"../../models/device/Microphone":394,"../../models/device/WindowShare":396,"../../models/stream/ReadOnlyMediaStream":418,"../../utils/Messages":432,"../../utils/StringUtils":441,"../BaseController":344,"./StreamEventHelper":363,"./TrackMetaDataProvider":364}],363:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../events/StreamEvents"),i=function(){function e(e){this._eventDispatcher=e}return e.prototype.AttachStreamEvents=function(e){var t=this;e.OnTrackAdded(function(){return t._tracksChanged(e.Id)}),e.OnTrackRemoved(function(){return t._tracksChanged(e.Id)}),e.OnTrackEnabledChanged(function(){return t._streamEnableStateChanged(e.Id)}),this._eventDispatcher.emit(r.Events.StreamListChanged)},e.prototype._streamEnableStateChanged=function(e){this._eventDispatcher.emit(r.Events.StreamEnableStateChanged,e)},e.prototype._tracksChanged=function(e){this._eventDispatcher.emit(r.Events.TracksChanged,e)},e}();n.StreamEventHelper=i},{"../../events/StreamEvents":378}],364:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../models/Source");n.UnknownMediaTrackType="unknown",n.MediaTrackType=r.SourceMediaType},{"../../models/Source":387}],365:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../BaseController"),o=e("../../events/CallStateEvents"),a=e("../../events/ConnectionEvents"),s=e("../../events/StreamEvents"),c=e("../../events/EventDispatcher"),u=e("../../utils/Constants"),l=e("../../utils/NotEqual"),d=e("../../events/ConnectionEvents"),p=e("../../models/VideoResolution"),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._inCall=!1,t._localStreamBandwidth=0,t}return r(t,e),t.prototype.Initialize=function(){var t=this,n=this._vidyoCore.Controllers.LocalStreamController.GetTransmittedStream();return n.addEventListener("addtrack",function(){return t._updateStreamTracks(n)}),n.addEventListener("removetrack",function(){return t._updateStreamTracks(n)}),this._vidyoCore.EventDispatcher.releaseGroup(c.TransmittedStreamControllerListeners),this._vidyoCore.EventDispatcher.on(a.Events.MediaSessionStarted,c.TransmittedStreamControllerListeners,function(e){return t._onMediaSessionStarted(e)}),this._vidyoCore.EventDispatcher.on(o.Events.MediaStateTransition,c.TransmittedStreamControllerListeners,function(e){return t._mediaStateTransition(e,n)}),e.prototype.Initialize.call(this)},t.prototype.SetLocalSource=function(e){var t=this._detectAboveThreshouldCondition(e);if(t.isVideoConstraintsAboveThreshould&&this._vidyoCore.EventDispatcher.emit(s.Events.LocalVideoTrackConstraintsChanged,t.videoStreamConstraints),t.isBandwidthAboveThreshould){var n=Math.round(t.bandwidth/u.KiloCoefficient);this._localStreamBandwidth=t.bandwidth,this._vidyoCore.Controllers.ConnectionController.UpdateLocalStream({bandwidth:n},!1)}},t.prototype._detectAboveThreshouldCondition=function(e){var t={bandwidth:p.GetStdOutgoingBandwidth(this._getCurrentCodec()),isBandwidthAboveThreshould:!1,isVideoConstraintsAboveThreshould:!1,videoStreamConstraints:{}};if(e.params){var n=10;if(e.params.height&&e.params.width){var r=this._vidyoCore.Controllers.LocalStreamController.GetLocalStreamVideoConstraints(),i=parseInt(e.params.height,n),o=parseInt(e.params.width,n);(l.NotEqual(r.height,i,u.Threshould)||l.NotEqual(r.width,o,u.Threshould))&&(t.isVideoConstraintsAboveThreshould=!0,t.videoStreamConstraints.height=i,t.videoStreamConstraints.width=o)}if(e.params.minFrameRate||e.params.framerate){var a=parseInt(e.params.minFrameRate,n)||parseInt(e.params.framerate,n),r=this._vidyoCore.Controllers.LocalStreamController.GetLocalStreamVideoConstraints();r.frameRate!==a&&(t.isVideoConstraintsAboveThreshould=!0,t.videoStreamConstraints.frameRate=a)}if(e.params.bandwidth){var s=parseInt(e.params.bandwidth+"",n),c=e.params.minBandwidth?parseInt(e.params.minBandwidth+"",n):s,d=Math.min(s,c);d=this._pickSuitableBandwidth(d,t.videoStreamConstraints.height),l.NotEqual(this._localStreamBandwidth,d,u.Threshould)&&(this._vidyoCore.Controllers.LogController.LogInfo("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ adjusting encoder bitrate: requested="+s+"; requestedMin="+c+"; CALCULATED NEW="+d+(this._localStreamBandwidth>0?"; prev="+this._localStreamBandwidth:"")),t.isBandwidthAboveThreshould=!0,t.bandwidth=d)}}return t},t.prototype._getCurrentCodec=function(){return p.GetPreferredCodec()},t.prototype._mediaStateTransition=function(e,t){var n=this;e.ShouldTransmitMedia?(this._inCall=!0,this._vidyoCore.Controllers.ConnectionController.AddStream(t)["catch"](function(e){
n._inCall=!1,console.log("TransmittedStreamController::_mediaStateTransition error"+(e?": "+e:"")),n._vidyoCore.EventDispatcher.emit(a.Events.MediaSessionFailed,d.ConnectionEventsInfo.MediaSessionAddingStreamError)})):this._inCall&&(this._vidyoCore.Controllers.ConnectionController.RemoveStream(t),this._inCall=!1)},t.prototype._onMediaSessionStarted=function(e){this._localStreamBandwidth=0},t.prototype._pickSuitableBandwidth=function(e,t){var n=this._vidyoCore.Controllers.LocalStreamController.GetLocalStreamVideoConstraints();void 0===t&&(t=n.height,void 0===t&&(t=0));var r=this._getCurrentCodec(),i=p.BandwidthPreferred[r],o=p.GetStdOutgoingBandwidth(r);for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];if(t<=s.Height){o=s.Bandwidth;break}}return Math.min(e,o)},t.prototype._updateStreamTracks=function(e){this._vidyoCore.XmppProvider.UpdateStreamTracks(e)},t}(i.BaseController);n.TransmittedStreamController=f},{"../../events/CallStateEvents":368,"../../events/ConnectionEvents":370,"../../events/EventDispatcher":372,"../../events/StreamEvents":378,"../../models/VideoResolution":389,"../../utils/Constants":426,"../../utils/NotEqual":433,"../BaseController":344}],366:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../models/User"),o=e("./BaseController"),a=function(e){function t(t){var n=e.call(this,t)||this;return n._coreUser=new i.User,n}return r(t,e),t.prototype.Disable=function(){return e.prototype.Disable.call(this)},t.prototype.Initialize=function(){return e.prototype.Initialize.call(this)},t.prototype.SetUserDisplayName=function(e){this._coreUser.DisplayName=e},t.prototype.UserDisplayName=function(){return this._coreUser.DisplayName},t}(o.BaseController);n.UserController=a},{"../models/User":388,"./BaseController":344}],367:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AddGoogleConferenceFlagChanged=new i.EventDescriptor,t.CodecExcludeFilterChanged=new i.EventDescriptor,t.DisableStatsChanged=new i.EventDescriptor,t.EnableSimpleAPILoggingChanged=new i.EventDescriptor,t.EnableSimulcastChanged=new i.EventDescriptor,t.EnableVidyoConnectorAPILoggingChanged=new i.EventDescriptor,t.EnableXMPPMessageLoggingChanged=new i.EventDescriptor,t.ParticipantLimitChanged=new i.EventDescriptor,t.ShowStatisticsOverlayChanged=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.Events=i.CreateEventList("AdvancedSettings",o)},{"../utils/EventListFactory":428}],368:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MediaStateTransition=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.Events=i.CreateEventList("CallState",o)},{"../utils/EventListFactory":428}],369:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ConferenceAccepted=new i.EventDescriptor,t.ConferenceJoined=new i.EventDescriptor,t.ConferenceRejected=new i.EventDescriptor,t.NotifyParticipant=new i.EventDescriptor,t.NotifySelectedParticipant=new i.EventDescriptor,t.Reply=new i.EventDescriptor,t.SelectedParticipantsChanged=new i.EventDescriptor,t.SelectedParticipantUnavailable=new i.EventDescriptor,t.SourceDetected=new i.EventDescriptor,t.SourceRemoved=new i.EventDescriptor,t.SubscribeTimeout=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.Events=i.CreateEventList("Conference",o)},{"../utils/EventListFactory":428}],370:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=e("../utils/Messages"),a=e("../../vidyo_connector_api/VidyoConnector"),s=function(){function e(e,t,n,r){this.code=e,this.msg=n,this.reasonCode=t,this.type=r?r:"info"}return e}();n.VidyoEventInfo=s;var c=function(){function e(){}return e.ConnectionLost=new s("ConnectionLost",a.VidyoConnectorDisconnectReason.ConnectionLost,o.ConnectionLost,"error"),e.ConnectionTimeout=new s("ConnectionTimeout",a.VidyoConnectorDisconnectReason.ConnectionTimeout,o.ConnectionTimeout,"error"),e.Disconnected=new s("Disconnected",a.VidyoConnectorDisconnectReason.Disconnected,o.Disconnected),e.Disconnecting=new s("Disconnecting",a.VidyoConnectorDisconnectReason.Disconnected,o.Disconnected),e.MediaSessionAddingStreamError=new s("MediaSessionAddingStreamError",a.VidyoConnectorDisconnectReason.MiscError,o.MediaSessionAddingStreamError,"error"),e.MediaSessionEnded=new s("MediaSessionEnded",a.VidyoConnectorDisconnectReason.Disconnected,o.MediaSessionEnded,"error"),e.MediaSessionError=new s("MediaSessionError",a.VidyoConnectorDisconnectReason.MiscError,o.MediaSessionError),e.MediaSessionTransportError=new s("MediaSessionTransportError",a.VidyoConnectorDisconnectReason.MiscError,o.MediaSessionTransportError,"error"),e.MiscError=new s("MiscError",a.VidyoConnectorDisconnectReason.MiscError,o.MiscError,"error"),e.MiscLocalError=new s("MiscLocalError",a.VidyoConnectorDisconnectReason.MiscLocalError,o.MiscLocalError,"error"),e.MiscRemoteError=new s("MiscRemoteError",a.VidyoConnectorDisconnectReason.MiscRemoteError,o.MiscRemoteError,"error"),e.NoResponse=new s("NoResponse",a.VidyoConnectorDisconnectReason.NoResponse,o.NoResponse,"error"),e.SignallingError=new s("SignallingError",a.VidyoConnectorDisconnectReason.MiscError,o.SignallingError,"error"),e.SignallingTransportError=new s("SignallingTransportError",a.VidyoConnectorDisconnectReason.MiscError,o.SignallingTransportError,"error"),e.Terminated=new s("Terminated",a.VidyoConnectorDisconnectReason.Terminated,o.Terminated,"error"),e}();n.ConnectionEventsInfo=c;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Available=new i.EventDescriptor,t.Connected=new i.EventDescriptor,t.ConnectionStatusChanged=new i.EventDescriptor,t.Disconnected=new i.EventDescriptor,t.GetWebProxyCredentials=new i.EventDescriptor,t.IqSendingError=new i.EventDescriptor,t.JingleAccepted=new i.EventDescriptor,t.JingleRemoteStreamAdded=new i.EventDescriptor,t.JingleRemoteStreamRemoved=new i.EventDescriptor,t.JingleSessionTerminated=new i.EventDescriptor,t.JingleSourceView=new i.EventDescriptor,t.LmiXmppMucMediaConf=new i.EventDescriptor,t.MediaSessionEnded=new i.EventDescriptor,t.MediaSessionFailed=new i.EventDescriptor,t.MediaSessionStarted=new i.EventDescriptor,t.SignallingDisconnected=new i.EventDescriptor,t.SignallingError=new i.EventDescriptor,t.TokenReceived=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=u,n.Events=i.CreateEventList("Connection",u)},{"../../vidyo_connector_api/VidyoConnector":486,"../utils/EventListFactory":428,"../utils/Messages":432}],371:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.CameraAdded=new i.EventDescriptor,t.CameraRemoved=new i.EventDescriptor,t.CameraSelected=new i.EventDescriptor,t.CameraSettingsChanged=new i.EventDescriptor,t.MicrophoneAdded=new i.EventDescriptor,t.MicrophoneRemoved=new i.EventDescriptor,t.MicrophoneSelected=new i.EventDescriptor,t.MicrophoneSettingsChanged=new i.EventDescriptor,t.SpeakerAdded=new i.EventDescriptor,t.SpeakerRemoved=new i.EventDescriptor,t.SpeakerSelected=new i.EventDescriptor,t.SpeakerSettingsChanged=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.Events=i.CreateEventList("Device",o)},{"../utils/EventListFactory":428}],372:[function(e,t,n){"use strict";function r(){var e=this,t={};return o.mixin(t),t.releaseAll=function(){t.callbacks=t.callbacks||{};for(var n in t.callbacks)if(t.callbacks.hasOwnProperty(n)){for(var r=t.callbacks[n],i=r.length;i>0;i--)r.pop();delete t.callbacks[n]}return e},t.getGroupCallbacks=function(e){var n=[];t.callbacks=t.callbacks||{};for(var r in t.callbacks)if(t.callbacks.hasOwnProperty(r))for(var i=t.callbacks[r],o=i.length-1;o>=0;o--)i[o]._groupName===e&&n.push(i[o]);return n},t}function i(e){var t=e.callbacks||{};for(var n in t)if(t.hasOwnProperty(n)){for(var r=t[n],i=r.length;i>0;i--)r.pop();delete t[n]}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("wildemitter");n.CallStateControllerListeners="CallStateControllerListeners",n.ConferenceControllerListeners="ConferenceControllerListeners",n.ConnectonControllerListeners="ConnectonControllerListeners",n.DeviceControllerListeners="DeviceControllerListeners",n.LocalStreamControllerListeners="LocalStreamControllerListeners",n.MicrophoneLocalEnergyLevelControllerListeners="MicrophoneLocalEnergyLevelControllerListeners",n.MicrophoneRemoteEnergyLevelControllerListeners="MicrophoneRemoteEnergyLevelControllerListeners",n.ParticipantControllerListeners="ParticipantControllerListeners",n.RenderListeners="RenderListeners",n.RendererControllerListeners="RendererControllerListeners",n.ResourceControllerListeners="ResourceControllerListeners",n.SmoothStartModeListeners="SmoothStartModeListeners",n.StatisticsControllerListeners="StatisticsControllerListeners",n.StreamControllerListeners="StreamControllerListeners",n.RemoteStreamControllerListeners="RemoteStreamControllerListeners",n.TransmittedStreamControllerListeners="TransmittedStreamControllerListeners",n.VidyoAdvancedSettingsEventListeners="VidyoAdvancedSettingsEventListeners",n.VidyoEnableMediaRoomListeners="VidyoEnableMediaRoomListeners",n.VidyoEndpointListeners="VidyoEndpointListeners",n.VidyoEnterRoomListeners="VidyoEnterRoomListeners",n.VidyoLocalCameraEventListeners="VidyoLocalCameraEventListeners",n.VidyoLocalMicrophoneEventListeners="VidyoLocalMicrophoneEventListeners",n.VidyoLocalMonitorEventListeners="VidyoLocalMonitorEventListeners",n.VidyoLocalSpeakerEventListeners="VidyoLocalSpeakerEventListeners",n.VidyoLocalWindowShareEventListeners="VidyoLocalWindowShareEventListeners",n.VidyoRemoteCameraEventListeners="VidyoRemoteCameraEventListeners",n.VidyoRemoteMicrophoneEventListeners="VidyoRemoteMicrophoneEventListeners",n.VidyoRemoteWindowShareEventListeners="VidyoRemoteWindowShareEventListeners",n.VidyoRoomParticipantEventListeners="VidyoRoomParticipantEventListeners",n.VidyoUserListeners="VidyoUserListeners",n.CreateEventDispatcher=r,n.ReleaseAllEventListeners=i},{wildemitter:328}],373:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Error=new i.EventDescriptor,t.Info=new i.EventDescriptor,t.Verbose=new i.EventDescriptor,t.Warning=new i.EventDescriptor,t.XMPPMessage=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.Events=i.CreateEventList("Log",o)},{"../utils/EventListFactory":428}],374:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.DynamicParticipantChanged=new i.EventDescriptor,t.LoudestParticipantChanged=new i.EventDescriptor,t.ParticipantJoined=new i.EventDescriptor,t.ParticipantLeft=new i.EventDescriptor,t.ParticipantsChanged=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.Events=i.CreateEventList("Participant",o)},{"../utils/EventListFactory":428}],375:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AddLocalStream=new i.EventDescriptor,t.AddRemoteStream=new i.EventDescriptor,t.GridLayoutChanged=new i.EventDescriptor,t.Hide=new i.EventDescriptor,t.RecheckEachVideoSize=new i.EventDescriptor,t.SpeakerPrivacyChanged=new i.EventDescriptor,t.SpeakerSelected=new i.EventDescriptor,t.StatisticsUpdate=new i.EventDescriptor,t.Update=new i.EventDescriptor,t.UpdatePosition=new i.EventDescriptor,t.UpdateSource=new i.EventDescriptor,t.UpdateSourcesState=new i.EventDescriptor,t.VideoCropSettingsChanged=new i.EventDescriptor,t.VideoResolutionChanged=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.Events=i.CreateEventList("Render",o)},{"../utils/EventListFactory":428}],376:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Created=new i.EventDescriptor,t.Entered=new i.EventDescriptor,t.Left=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.Events=i.CreateEventList("Room",o)},{"../utils/EventListFactory":428}],377:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Update=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.Events=i.CreateEventList("Statistics",o)},{"../utils/EventListFactory":428}],378:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../utils/EventListFactory"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LocalMonitorAdded=new i.EventDescriptor,t.LocalMonitorDeselected=new i.EventDescriptor,t.LocalMonitorRemoved=new i.EventDescriptor,t.LocalMonitorSelected=new i.EventDescriptor,t.LocalStreamReady=new i.EventDescriptor,t.LocalVideoTrackConstraintsChanged=new i.EventDescriptor,t.LocalWindowShareAdded=new i.EventDescriptor,t.LocalWindowShareDeselected=new i.EventDescriptor,t.LocalWindowShareRemoved=new i.EventDescriptor,t.LocalWindowShareSelected=new i.EventDescriptor,t.MediaDisabled=new i.EventDescriptor,t.MediaEnabled=new i.EventDescriptor,t.MediaFailed=new i.EventDescriptor,t.RemoteCameraAdded=new i.EventDescriptor,t.RemoteCameraRemoved=new i.EventDescriptor,t.RemoteCameraStateUpdated=new i.EventDescriptor,t.RemoteMicrophoneAdded=new i.EventDescriptor,t.RemoteMicrophoneRemoved=new i.EventDescriptor,t.RemoteMicrophoneStateUpdated=new i.EventDescriptor,t.RemoteWindowShareAdded=new i.EventDescriptor,t.RemoteWindowShareRemoved=new i.EventDescriptor,t.RemoteWindowShareStateUpdated=new i.EventDescriptor,t.StreamEnableStateChanged=new i.EventDescriptor,t.StreamListChanged=new i.EventDescriptor,t.TracksChanged=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.EventList=o,n.Events=i.CreateEventList("Stream",o);var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.TrackEnded=new i.EventDescriptor,t.TrackMute=new i.EventDescriptor,t.TrackOverconstrained=new i.EventDescriptor,t.TrackUnmute=new i.EventDescriptor,t}return r(t,e),t}(i.EventListBase);n.TrackEventList=a,n.TrackEvents=i.CreateEventList("Track",a)},{"../utils/EventListFactory":428}],379:[function(e,t,n){"use strict";function r(e){return e.notify.event&&e.notify.event.participantPackageContent&&e.notify.event.participantPackageContent.participants&&e.notify.event.participantPackageContent.participants.some(function(e){return"leave"===e.event})}function i(e){return e.notify.event&&e.notify.event.participantPackageContent&&e.notify.event.participantPackageContent.participants&&e.notify.event.participantPackageContent.participants.some(function(e){return!("update"!==e.event&&"join"!==e.event)})}Object.defineProperty(n,"__esModule",{value:!0});var o;!function(e){e.LoudestSpeaker="loudestSpeaker"}(o=n.AudioPolicy||(n.AudioPolicy={}));var a;!function(e){e.HideSelf="Hide Self",e.ShowSelf="Show Self",e.ShowSelfIfNoOther="Show Self If No Other"}(a=n.SelfViewPolicy||(n.SelfViewPolicy={}));var s;!function(e){e.On="on",e.Off="off"}(s=n.SourceState||(n.SourceState={}));var c;!function(e){e.ShowIfNotStaticallyViewed="Show If Not Statically Viewed",e.ShowEvenIfStaticallyViewed="Show Even If Statically Viewed"}(c=n.ViewPolicy||(n.ViewPolicy={})),n.IsLeaveNotification=r,n.IsSourceNotification=i},{}],380:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){"undefined"!=typeof e&&(this.LocalId=e)}return e.prototype.Clone=function(t){var n=new e(t);return n.Session=this.Session,n.Conference=this.Conference,n.Reflector=this.Reflector,n},e.prototype.IsFinalized=function(){return!!(this.LocalId&&this.Session&&this.Conference&&this.Reflector)},e.prototype.ToObject=function(){var e={Session:this.Session||"",Conference:this.Conference||"",Reflector:this.Reflector||"",LocalId:this.LocalId};return this.RemoteId&&(e.RemoteId=this.RemoteId),e},Object.defineProperty(e.prototype,"Session",{get:function(){return this._session},set:function(e){this._set("Session","_session",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LocalId",{get:function(){return this._localId},set:function(e){this._set("LocalId","_localId",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Conference",{get:function(){return this._conference},set:function(e){this._set("Conference","_conference",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Reflector",{get:function(){return this._reflector},set:function(e){this._set("Reflector","_reflector",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RemoteId",{get:function(){return this._remoteId},set:function(e){this._set("RemoteId","_remoteId",e)},enumerable:!0,configurable:!0}),e.prototype._readOnlyError=function(e){return new Error(e+" has already been set and is now read-only")},e.prototype._set=function(e,t,n){if(this[t])throw this._readOnlyError(e);this[t]=n},e}();n.DialogIdentity=r},{}],381:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.GetLocal=function(e){return localStorage.getItem(e)},e.prototype.SetLocal=function(e,t){return localStorage.setItem(e,t),this},e.GetInstance=function(){return e._lwStorage||(e._lwStorage=new e),e._lwStorage},e}();n.LocalWebStorage=r,n.localWebStorage=r.GetInstance()},{}],382:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){this._name=e,this._data=t}return e.prototype.toString=function(){var e=2,t="["+this._name+"]";("connected"===this._name||"disconnected"===this._name)&&(t+="Client instance: ");try{t+="string"==typeof this._data?this._data:JSON.stringify(this._data,null,e)}catch(n){t="Error while generating log message: "+n}return t},e}();n["default"]=r},{}],383:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("../utils/Messages"),o=e("./Source"),a=e("uuid");!function(e){e.Local="local",e.Remote="remote"}(r=n.ParticipantOrigin||(n.ParticipantOrigin={}));var s=function(){function e(e,t,n){if(this.Id=e,this.Origin=t,this.Active=!1,this.Generation=1/0,this.ObjId=a.v4(),this.Sources=[],!this.Id||0===this.Id.length)throw new Error(i.IdCannotBeEmpty);this.Name=n||this.Id}return e.prototype.GetSourceBySSrc=function(e){return this.Sources.find(function(t){return t.Ssrc===e})},e.prototype.HasAudioSource=function(){return this.Sources.some(function(e){return e.Type===o.SourceMediaType.Audio})},e.prototype.HasSource=function(e){return this.Sources.some(function(t){return t.Ssrc===e})},e.prototype.HasVideoSource=function(){return this.Sources.some(function(e){return e.Type===o.SourceMediaType.Video})},Object.defineProperty(e.prototype,"IsLoopback",{get:function(){return this.Origin===r.Local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsRemote",{get:function(){return this.Origin===r.Remote},enumerable:!0,configurable:!0}),e.prototype.UpdateSources=function(e){this.Sources=e},e}();n.Participant=s},{"../utils/Messages":432,"./Source":387,uuid:310}],384:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){this.ResponseTime=Number.MAX_VALUE,this.Fqdn=t.fqdn,t.addresses&&t.addresses.length>0&&(this.Ip=t.addresses[0].ip),this.Location={Latitude:e.location.lat,Longitude:e.location.lon}}return e}();n["default"]=r},{}],385:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.RenderMode={Composite:"Composite",Custom:"Custom"}},{}],386:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e}();n.Room=r},{}],387:[function(e,t,n){"use strict";function r(e){return"video"===e||"audio"===e}Object.defineProperty(n,"__esModule",{value:!0});var i=e("uuid");n.SourceMediaType={Video:"video",Audio:"audio",Application:"application"},n.IsSourceMediaType=r,n.SourceType={Loopback:"loopback",Preview:"preview",Remote:"remote"};var o=function(){function e(e,t,n){this.Name=t,this.Ssrc=e,this.Type=n,this.ObjId=i.v4()}return e}();n.Source=o},{uuid:310}],388:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e}();n.User=r},{}],389:[function(e,t,n){"use strict";function r(e,t){void 0===t&&(t=!1),e||(e=i());var r=n.BandwidthPreferred[e].filter(function(e){return e.Height===a.DefaultLocalStreamHeight})[0].Bandwidth;return t?Math.round(r/a.KiloCoefficient):r}function i(){return s.OperatingSystemInfoProvider.IsChrome()?f.VP8:s.OperatingSystemInfoProvider.IsSafari()?f.H264:f.VP8}var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var a=e("../utils/Constants"),s=e("../utils/OperatingSystemInfoProvider"),c=function(){function e(e,t){void 0===e&&(e=640),void 0===t&&(t=360),this.Width=e,this.Height=t}return Object.defineProperty(e.prototype,"AspectRatio",{get:function(){return 0===this.Height?0:this.Width/this.Height},enumerable:!0,configurable:!0}),e.prototype.Clone=function(){return new e(this.Width,this.Height)},e}();n.BasicVideoResolution=c;var u;!function(e){e.Taller="Taller",e.Wider="Wider"}(u=n.AspectRatioRatioType||(n.AspectRatioRatioType={}));var l=function(e){function t(t,n,r,i){void 0===i&&(i=new c);var o=e.call(this,n,r)||this;return o.Id=t,o.ContainerResolution=i,o}return o(t,e),Object.defineProperty(t.prototype,"AspectRatioRatio",{get:function(){return 0===this.AspectRatio?0:this.ContainerResolution.AspectRatio/this.AspectRatio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AspectRatioRatioType",{get:function(){return this.AspectRatioRatio<1?u.Wider:u.Taller},enumerable:!0,configurable:!0}),t.prototype.Clone=function(){return new t(this.Id,this.Width,this.Height,this.ContainerResolution.Clone())},t}(c);n.VideoResolution=l;var d=function(){function e(){this.ContainerResolution=new c,this._videoResolutions={}}return e.prototype.All=function(){return Object.values(this._videoResolutions)},e.prototype.Get=function(e){return this._videoResolutions[e]||new l(e)},e.prototype.UpdateVideoResolutions=function(e,t){var n=this;this.ContainerResolution=e.Clone(),this._videoResolutions={},t.forEach(function(e){n._videoResolutions[e.Id]=e.Clone()})},e}();n.VideoResolutionSet=d;var p=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.Bandwidth=r,i}return o(t,e),t}(c);n.VideoStreamConstraints=p;var f;!function(e){e.H264="H264",e.H265="H265",e.VP8="VP8",e.VP9="VP9"}(f=n.CodecName||(n.CodecName={})),n.BandwidthNominal=(h={},h[f[f.H264]]=[new p(160,120,5e4),new p(320,180,1e5),new p(320,240,1e5),new p(352,288,2e5),new p(640,360,24e4),new p(640,480,32e4),new p(1280,720,1e6),new p(1920,1080,19e5)],h[f[f.H265]]=[new p(160,120,25e3),new p(320,180,5e4),new p(320,240,5e4),new p(352,288,1e5),new p(640,360,12e4),new p(640,480,16e4),new p(1280,720,5e5),new p(1920,1080,95e4)],h[f[f.VP8]]=[new p(160,120,58e3),new p(320,180,115e3),new p(320,240,115e3),new p(352,288,23e4),new p(640,360,276e3),new p(640,480,368e3),new p(1280,720,118e4),new p(1920,1080,228e4)],h[f[f.VP9]]=[new p(160,120,4e4),new p(320,180,8e4),new p(320,240,8e4),new p(352,288,16e4),new p(640,360,187e3),new p(640,480,25e4),new p(1280,720,75e4),new p(1920,1080,14e5)],h),n.BandwidthPreferred=(m={},m[f[f.H264]]=[new p(160,120,23e4),new p(320,180,5e5),new p(320,240,5e5),new p(352,288,67e4),new p(640,360,712e3),new p(640,480,95e4),new p(1280,720,2e6),new p(1920,1080,4e6)],m[f[f.H265]]=[new p(160,120,23e4),new p(320,180,4e5),new p(320,240,4e5),new p(352,288,5e5),new p(640,360,487e3),new p(640,480,65e4),new p(1280,720,15e5),new p(1920,1080,3e6)],m[f[f.VP8]]=[new p(160,120,23e4),new p(320,180,5e5),new p(320,240,5e5),new p(352,288,67e4),new p(640,360,712e3),new p(640,480,95e4),new p(1280,720,2e6),new p(1920,1080,4e6)],m[f[f.VP9]]=[new p(160,120,23e4),new p(320,180,4e5),new p(320,240,4e5),new p(352,288,5e5),new p(640,360,487e3),new p(640,480,65e4),new p(1280,720,15e5),new p(1920,1080,3e6)],m),n.GetStdOutgoingBandwidth=r,n.GetPreferredCodec=i;var h,m},{"../utils/Constants":426,"../utils/OperatingSystemInfoProvider":436}],390:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./Device"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype._getType=function(){return"Camera"},t}(i.Device);n.Camera=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.AllowRemoteCameraControl=function(e){throw new Error("Method is not implemented yet")},t.prototype.ControlPTZ=function(e,t,n){throw new Error("Method is not implemented yet")},t.prototype.GetBacklightCompensation=function(){throw new Error("Method is not implemented yet")},t.prototype.GetFramerateTradeOffProfile=function(){throw new Error("Method is not implemented yet")},t.prototype.GetId=function(){throw new Error("Method is not implemented yet")},t.prototype.GetName=function(){throw new Error("Method is not implemented yet")},t.prototype.GetPosition=function(){throw new Error("Method is not implemented yet")},t.prototype.GetPreviewLabel=function(){throw new Error("Method is not implemented yet")},t.prototype.GetResolutionTradeOffProfile=function(){throw new Error("Method is not implemented yet")},t.prototype.IsControlDigital=function(){throw new Error("Method is not implemented yet")},t.prototype.IsSuspended=function(){throw new Error("Method is not implemented yet")},t.prototype.SetAspectRatioConstraint=function(e,t){throw new Error("Method is not implemented yet")},t.prototype.SetBacklightCompensation=function(e){throw new Error("Method is not implemented yet")},t.prototype.SetControlDigital=function(e){throw new Error("Method is not implemented yet")},t.prototype.SetFramerateTradeOffProfile=function(e){throw new Error("Method is not implemented yet")},t.prototype.SetMaxConstraint=function(e,t,n){throw new Error("Method is not implemented yet")},t.prototype.SetNudgeTimes=function(e,t,n){throw new Error("Method is not implemented yet")},t.prototype.SetPreviewLabel=function(e){throw new Error("Method is not implemented yet")},t.prototype.SetResolutionTradeOffProfile=function(e){throw new Error("Method is not implemented yet")},t.prototype.SetTargetBitRate=function(e){throw new Error("Method is not implemented yet")},t.prototype.ShowCameraControl=function(e){throw new Error("Method is not implemented yet")},t}(o);n.CoreLocalCamera=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.ControlPTZ=function(e,t,n){throw new Error("Method is not implemented yet");

},t.prototype.GetId=function(){throw new Error("Method is not implemented yet")},t.prototype.GetName=function(){throw new Error("Method is not implemented yet")},t.prototype.GetPosition=function(){throw new Error("Method is not implemented yet")},t.prototype.IsControllable=function(){throw new Error("Method is not implemented yet")},t.prototype.ShowCameraControl=function(e){throw new Error("Method is not implemented yet")},t}(o);n.CoreRemoteCamera=s},{"./Device":391}],391:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("uuid"),i=function(){function e(e,t,n){void 0===n&&(n=r.v4()),this.Name=e,this.Id=t,this.Type=this._getType(),this.ObjId=n}return e}();n.Device=i},{uuid:310}],392:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){this._defaultDevice=null,this._deviceList=[],this._deviceConstructor=e}return e.prototype.Add=function(e,t){var n=this._findDeviceIndexByID(t);if(n>=0)return!1;var r=new this._deviceConstructor(e,t);return this._deviceList.push(r),r},e.prototype.All=function(){for(var e=[],t=this._deviceList.length;t--;)e[t]=this._deviceList[t];return e},e.prototype.Find=function(e){var t=this._findDeviceIndexByID(e);return t>=0?this._deviceList[t]:!1},e.prototype.GetDefaultDevice=function(){if(this._defaultDevice){var t=this.Find(this._defaultDevice.Id);if(t)return t;throw new Error(e.notInListMsg)}return!1},e.prototype.GetFirstDevice=function(){return this._deviceList.length>0?this._deviceList[0]:!1},e.prototype.Next=function(e){var t=this._findDeviceIndexByID(e);if(t>=0){var n=(t+1)%this._deviceList.length;return this._deviceList[n]}return!1},e.prototype.Remove=function(e){this._defaultDevice&&this._defaultDevice.Id===e&&(this._defaultDevice=null);var t=this._findDeviceIndexByID(e);return t>=0?(this._deviceList.splice(t,1),!0):!1},e.prototype.SetDefaultDevice=function(t){if(!t)return void(this._defaultDevice=null);if(this.Find(t.Id)!==!1)return void(this._defaultDevice=t);throw new Error(e.notInListMsg)},e.prototype._findDeviceIndexByID=function(e){return this._deviceList.findIndex(function(t){return t.Id===e})},e.notInListMsg="Default device not in the device list",e}();n.DeviceList=r},{}],393:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(){this.Muted=!1}return Object.defineProperty(e.prototype,"Enabled",{get:function(){return!this.Muted&&!!this.Device},enumerable:!0,configurable:!0}),e.prototype.Simplify=function(){return this.Device||!0},e}();n.DeviceSelectionInfo=i;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(i);n.CameraSelectionInfo=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(i);n.MicrophoneSelectionInfo=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(i);n.SpeakerSelectionInfo=s;var c=function(){function e(){this.Camera=new o,this.Microphone=new a,this.Speaker=new s}return e.prototype.SelectCamera=function(e){this.Camera.Device=e},e.prototype.SelectMicrophone=function(e){this.Microphone.Device=e},e.prototype.SelectSpeaker=function(e){this.Speaker.Device=e},Object.defineProperty(e.prototype,"Simplified",{get:function(){return{Camera:this.Camera.Simplify(),Microphone:this.Microphone.Simplify(),Speaker:this.Speaker.Simplify()}},enumerable:!0,configurable:!0}),e}();n.DeviceSelection=c},{}],394:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./Device"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype._getType=function(){return"Microphone"},t}(i.Device);n.Microphone=o},{"./Device":391}],395:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./Device"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype._getType=function(){return"Speaker"},t}(i.Device);n.Speaker=o},{"./Device":391}],396:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./Device"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype._getType=function(){return"WindowShare"},t}(i.Device);n.WindowShare=o},{"./Device":391}],397:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../utils/ObjectUtils"),i=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),void 0===n&&(n=[]),this._columns=e,this._rows=t,this._spaceBefore=n}return Object.defineProperty(e.prototype,"Cells",{get:function(){return this._columns*this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Columns",{get:function(){return this._columns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SpaceBefore",{get:function(){return this._spaceBefore},enumerable:!0,configurable:!0}),e.prototype.Update=function(e,t,n){var i,o,a=this._rows,s=this._columns,c=this._spaceBefore,u=[];if(0>=e)i=0,o=0;else{var l=.7;if(l>n/t){var d=Math.sqrt(e*n/t);i=Math.ceil(d-1+l),o=Math.ceil(e/i)}else{var p=Math.sqrt(e*t/n);o=Math.ceil(p-1+l),i=Math.ceil(e/o)}var f=i*o-e;if(f>0&&u.push(1),f>1){var h=o*(i-1);u.push(h)}}return this._rows=i,this._columns=o,this._spaceBefore=u,a!==i||s!==o||r["default"].IsNotEqual(c,u)},e.MinimizedVideoAreaGridRows=2,e.VideoAreaGridCols=12,e.VideoAreaGridRows=26,e}();n.GridLayout=i},{"../../utils/ObjectUtils":435}],398:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.ActualEncoderBitRate=0,this.AvailableBandwidth=0,this.AvailableRecieveBandwidth=0,this.LeakyBucketDelay=0,this.RetransmitBitRate=0,this.TargetEncoderBitRate=0,this.TotalTransmitBitRate=0}return e}();n.BandwidthSummaryStatistics=r},{}],399:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.ApplicationTag="",this.BuildTag="",this.BytesReceivedTcp=0,this.BytesReceivedUdp=0,this.BytesSentTcp=0,this.BytesSentUdp=0,this.ConnectTime="",this.Id="",this.LibraryVersion="",this.LocalCameraStats=[],this.LocalMicrophoneStats=[],this.LocalMonitorStats=[],this.LocalRendererStats=[],this.LocalSpeakerStats=[],this.LocalWindowShareStats=[],this.LoginTimeConsumedMs=0,this.MaxEncodePixelRateInitial=0,this.MediaEnableTimeConsumedMs=0,this.MediaRouteAcquireTimeConsumedMs=0,this.NetworkInterfaceStats=[],this.OsName="",this.OsVersion="",this.ProcessorBrand="",this.ProcessorLogicalCores=0,this.ProcessorModel="",this.ProcessorPhysicalCores=0,this.ProcessorSpeed=0,this.RoomEnterTimeConsumedMs=0,this.TimeStamp="",this.UserStats=[]}return e.prototype.EmptyBytesCountStatistic=function(){this.BytesSentUdp=0,this.BytesSentTcp=0,this.BytesReceivedUdp=0,this.BytesReceivedTcp=0},e}();n.EndpointStatistics=r},{}],400:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Statistics"),i=function(){function e(){this.AecEchoCoupling=0,this.AgcAverageGain=0,this.AudioLevel=0,this.AudioPacketsLost=0,this.BitsPerSample=0,this.BytesSentUdp=0,this.CodecName="",this.Format="",this.Id="",this.LocalSpeakerStreams=[],this.Name="",this.NoiseSuppressionSnr=0,this.NumberOfChannels=0,this.RemoteSpeakerStreams=[],this.SampleRateMeasured=0,this.SampleRateSet=0}return e.prototype.FillFromRTCStats=function(e,t){if(t){var n=t.get(e);if(n){this.AudioLevel=n.audioLevel||0;var i=r.CutSsrcFromTrackId(n.id||""),o=t.get("RTCOutboundRTPAudioStream_"+i);this._fillFromRTCOutboundRTPStreamStats(o,t)}}},e.prototype._fillFromCodecStats=function(e){e&&(this.CodecName=e.mimeType)},e.prototype._fillFromRTCOutboundRTPStreamStats=function(e,t){if(e){this.BytesSentUdp=e.bytesSent||0;var n=t.get(e.codecId);this._fillFromCodecStats(n)}},e}();n.LocalMicrophoneStatistics=i},{"./Statistics":416}],401:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.Format="",this.FrameIntervalMeasured=0,this.FrameIntervalSet=0,this.Height=0,this.Id="",this.Name="",this.TotalFrames=0,this.TotalPixels=0,this.Width=0}return e}();n.LocalRendererStatistics=r},{}],402:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.BufferDropped=0,this.BufferSize=0,this.Height=0,this.Id="",this.Name="",this.Width=0}return e}();n.LocalRendererStreamStatistics=r},{}],403:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.BitsPerSample=0,this.Format="",this.Id="",this.Name="",this.NumberOfChannels=0,this.SampleRateMeasured=0,this.SampleRateSet=0}return e}();n.LocalSpeakerStatistics=r},{}],404:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.BitsPerSample=0,this.Delay=0,this.Format="",this.HighestThreshold=0,this.HighThreshold=0,this.LastEnergy=0,this.LastPlayed=0,this.LowestThreshold=0,this.LowThreshold=0,this.MaxThreshold=0,this.Name="",this.NumberOfChannels=0,this.Overrun=0,this.Played=0,this.SampleRate=0,this.Underrun=0}return e}();n.LocalSpeakerStreamStatistics=r},{}],405:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Statistics"),i=e("../../utils/Constants"),o=function(){function e(){this.BytesSentUdp=0,this.CodecName="",this.FirsReceived=0,this.Format="",this.FrameIntervalMeasured=0,this.FrameIntervalSet=0,this.Height=0,this.Id="",this.LocalRendererStreams=[],this.NacksReceived=0,this.Name="",this.PlisReceived=0,this.RemoteRendererStreams=[],this.TotalFrames=0,this.VideoEncodeUsagePercent=0,this.VideoFrameRateInput=0,this.VideoFrameRateSent=0,this.VideoFramesEncoded=0,this.VideoPacketsLost=0,this.VideoResolutionLimitedByBandwidth=!1,this.VideoResolutionLimitedByCPU=!1,this.Width=0}return e.prototype.FillFromRTCStats=function(e,t,n){if(t){var r=t.get(e);r&&(this._fillFromRTCMediaStreamTrackStats(r,t),n&&this._calculateFrameRateSent(r,n.get(r.id)))}},e.prototype._calculateFrameRateSent=function(e,t){if(e&&t){var n=e.framesSent||0,r=e.timestamp||0,o=t.framesSent||0,a=t.timestamp||0,s=(n-o)/(r-a);this.VideoFrameRateSent=Math.round(s*i.SecToMsCoefficient)}},e.prototype._fillFromCodecStats=function(e){e&&(this.CodecName=e.mimeType)},e.prototype._fillFromRTCMediaStreamTrackStats=function(e,t){if(e){this.Height=e.frameHeight||0,this.Width=e.frameWidth||0,this.TotalFrames=e.framesSent||0;var n=r.CutSsrcFromTrackId(e.id||""),i=t.get("RTCOutboundRTPVideoStream_"+n);if(this._fillFromRTCOutboundRTPStreamStats(i),i){var o=t.get(i.codecId);this._fillFromCodecStats(o)}}},e.prototype._fillFromRTCOutboundRTPStreamStats=function(e){e&&(this.BytesSentUdp=e.bytesSent||0,this.FirsReceived=e.firCount||0,this.NacksReceived=e.nackCount||0,this.PlisReceived=e.pliCount||0,this.VideoFramesEncoded=e.framesEncoded||0)},e}();n.LocalVideoSourceStatistics=o},{"../../utils/Constants":426,"./Statistics":416}],406:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.AddressType="",this.ComponentType="",this.ConnectionId=0,this.ConnectionType="",this.ExternalLocalAddr="",this.ExternalRemoteAddr="",this.InterfaceName="",this.InterfaceType="",this.InternalLocalAddr="",this.InternalRemoteAddr="",this.TransportPlugIn=""}return e.prototype.FillFromRTCStats=function(e,t){if(t){var n=t.get(e);if(n){var r=t.get(n.selectedCandidatePairId);this._fillFromCandidatePair(r,t),e.match(/RTCTransport_audio_/)?this.ConnectionType="audio":e.match(/RTCTransport_video/)&&(this.ConnectionType="video")}}},e.prototype._fillFromCandidatePair=function(e,t){if(e){var n=t.get(e.localCandidateId);n&&(this.InternalLocalAddr=n.ip,this.ExternalLocalAddr=n.ip);var r=t.get(e.remoteCandidateId);r&&(this.InternalRemoteAddr=r.ip,this.ExternalRemoteAddr=r.ip)}},e}();n.MediaConnectionTransportInformation=r},{}],407:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.IsUp=!1,this.Name="",this.Type=""}return e}();n.NetworkInterfaceStatistics=r},{}],408:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.CameraId="",this.CameraName="",this.Enabled=!1,this.FrameInterval=0,this.Height=0,this.Id="",this.Name="",this.PixelRate=0,this.Width=0}return e}();n.ParticipantGenerationStatistics=r},{}],409:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.Id="",this.Name="",this.ParticipantIsActive=!1,this.RemoteCameraStats=[],this.RemoteMicrophoneStats=[],this.RemoteWindowShareStats=[],this.SSRCs=[],this.UserId=""}return e.prototype.EmptyStats=function(){this.RemoteCameraStats=[],this.RemoteMicrophoneStats=[],this.RemoteWindowShareStats=[],this.SSRCs=[]},e}();n.ParticipantStatistic=r},{}],410:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.DelayNormal=0,this.DelayRetransmit=0,this.DropNormal=0,this.PacketsNormal=0,this.PacketsRetransmit=0}return e}();n.RateShaperStatistics=r},{}],411:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../utils/Constants"),i=function(){function e(){this.AudioBytesReceived=0,this.AudioDecodingMuted=0,this.AudioDecodingNormal=0,this.BitsPerSample=0,this.CodecDtx=0,this.CodecName="",this.CodecQualitySetting=0,this.Id="",this.LocalSpeakerStreams=[],this.Name="",this.NumberOfChannels=0,this.ReceiveNetworkBitRate=0,this.ReceiveNetworkDelay=0,this.ReceiveNetworkDroppedPackets=0,this.ReceiveNetworkJitter=0,this.SampleRateMeasured=0,this.SampleRateSet=0}return e.prototype.FillFromAudioAnalyzerStats=function(e){e&&(this.BitsPerSample=e.sampleSize,this.NumberOfChannels=e.channelsCount,this.SampleRateSet=e.sampleRate,this.SampleRateMeasured=e.sampleRate)},e.prototype.FillFromRTCStats=function(e,t,n){if(t){var r=t.get(e);if(r){var i=t.get("RTCInboundRTPAudioStream_"+r.trackIdentifier);this._fillFromRTCInboundRTPStreamStats(i,t,n)}}},e.prototype._calculateBitrate=function(e,t){if(e&&t){var n=e.bytesReceived||0,i=e.timestamp||0,o=t.bytesReceived||0,a=t.timestamp||0,s=r.BitsInByteValue*(n-o)/(i-a);this.ReceiveNetworkBitRate=s*r.SecToMsCoefficient}},e.prototype._fillFromCodecStats=function(e){e&&(this.CodecName=e.mimeType)},e.prototype._fillFromRTCInboundRTPStreamStats=function(e,t,n){if(e){this.ReceiveNetworkJitter=e.jitter||0,this.AudioBytesReceived=e.bytesReceived||0,n&&this._calculateBitrate(e,n.get(e.id));var r=t.get(e.codecId);this._fillFromCodecStats(r)}},e}();n.RemoteMicrophoneStatistics=i},{"../../utils/Constants":426}],412:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.CodecFir=0,this.CodecIFrames=0,this.CodecLayers=0,this.CodecNacks=0,this.CodecName="",this.Fps=0,this.FpsInput=0,this.FpsSent=0,this.FramesDropped=0,this.Height=0,this.LastHeight=0,this.LastWidth=0,this.Name="",this.SendNetworkBitRate=0,this.SendNetworkRtt=0,this.Width=0}return e}();n.RemoteRendererStreamStatistics=r},{}],413:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.BitsPerSample=0,this.CodecDtx=0,this.CodecName="",this.CodecQualitySetting=0,this.Name="",this.NumberOfChannels=0,this.SampleRate=0,this.SendNetworkBitRate=0,this.SendNetworkRtt=0}return e}();n.RemoteSpeakerStreamStatistics=r},{}],414:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../utils/Constants"),i=function(){function e(){this.CodecFir=0,this.CodecIFrames=0,this.CodecLayers=0,this.CodecNacks=0,this.CodecName="",this.FpsDecoded=0,this.FpsDecoderInput=0,this.FpsRendered=0,this.Height=0,this.Id="",this.JitterBuffer=0,this.LocalRendererStreams=[],this.MaxStreamFrameRate=0,this.MaxStreamHeight=0,this.MaxStreamWidth=0,this.Name="",this.PlisSent=0,this.ReceiveNetworkBitRate=0,this.ReceiveNetworkPacketsConcealed=0,this.ReceiveNetworkPacketsLost=0,this.ReceiveNetworkPacketsReordered=0,this.ReceiveNetworkRecoveredWithFec=0,this.ShowFrameRate=0,this.ShowHeight=0,this.ShowPixelRate=0,this.ShowState="",this.ShowWidth=0,this.VideoFrameRateDecoded=0,this.VideoFrameRateOutput=0,this.VideoFrameRateReceived=0,this.VideoFramesDecoded=0,this.VideoPacketsReceived=0,this.Width=0}return e.prototype.FillFromRTCStats=function(e,t,n){if(t){var r=t.get(e);this._fillFromRTCMediaStreamTrackStats(r);var i=t.get("RTCInboundRTPVideoStream_"+r.trackIdentifier);this._fillFromRTCInboundRTPStreamStats(i,t),n&&this._calculateFPS(r,n.get(r.id))}},e.prototype._calculateFPS=function(e,t){if(t){var n=e.framesDecoded||0,i=e.timestamp||0,o=t.framesDecoded||0,a=t.timestamp||0,s=(n-o)/(i-a);this.FpsDecoded=Math.round(s*r.SecToMsCoefficient),this.VideoFrameRateDecoded=this.FpsDecoded;{e.framesReceived||0,t.framesReceived||0}this.FpsRendered=Math.round(s*r.SecToMsCoefficient),this.VideoFrameRateReceived=this.FpsRendered}},e.prototype._fillFromCodecStats=function(e){e&&(this.CodecName=e.mimeType)},e.prototype._fillFromRTCInboundRTPStreamStats=function(e,t){if(e){this.CodecFir=e.firCount||0,this.CodecNacks=e.nackCount||0,this.ReceiveNetworkPacketsLost=e.packetsLost||0,this.VideoPacketsReceived=e.packetsReceived||0,this.PlisSent=e.pliCount||0;var n=t.get(e.codecId);this._fillFromCodecStats(n)}},e.prototype._fillFromRTCMediaStreamTrackStats=function(e){e&&(this.Width=e.frameWidth||0,this.Height=e.frameHeight||0,this.VideoFramesDecoded=e.framesDecoded||0)},e}();n.RemoteVideoSourceStatistics=i},{"../../utils/Constants":426}],415:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./BandwidthSummaryStatistics"),i=e("./RateShaperStatistics"),o=function(){function e(){this.BandwidthApp=new r.BandwidthSummaryStatistics,this.BandwidthAudio=new r.BandwidthSummaryStatistics,this.BandwidthVideo=new r.BandwidthSummaryStatistics,this.ConferenceId="",this.CpuUsage=0,this.CurrentBandwidthDecodePixelRate=0,this.CurrentBandwidthEncodePixelRate=0,this.CurrentCpuDecodePixelRate=0,this.CurrentCpuEncodePixelRate=0,this.Id="",this.MaxDecodePixelRate=0,this.MaxEncodePixelRate=0,this.MaxVideoSources=0,this.ParticipantGenerationStats=[],this.ParticipantStats=[],this.RateShaperApp=new i.RateShaperStatistics,this.RateShaperAudio=new i.RateShaperStatistics,this.RateShaperVideo=new i.RateShaperStatistics,this.ReceiveBitRateAvailable=0,this.ReceiveBitRateTotal=0,this.ReflectorId="",this.SendBitRateAvailable=0,this.SendBitRateTotal=0,this.StaticSources=0,this.TransportInformation=[]}return e}();n.RoomStatistics=o},{"./BandwidthSummaryStatistics":398,"./RateShaperStatistics":410}],416:[function(e,t,n){"use strict";function r(e){var t=e.match(/\d+$/),n="0";return t&&t.length&&(n=t[0]),n}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../utils/PrettyNumber"),o=e("../../utils/Collection"),a=e("../../utils/ObjectUtils"),s=function(){function e(){this.AudioBytesSent=new i.PrettyNumber,this.AudioCodec="",this.AudioLevel=new i.PrettyNumber,this.AudioPacketsLost=new i.PrettyNumber,this.AvailableRecieveBandwidth=new i.PrettyNumber,this.AvailableSendBandwidth=new i.PrettyNumber,this.EncodeBitrate=new i.PrettyNumber,this.FirsReceived=new i.PrettyNumber,this.NacksReceived=new i.PrettyNumber,this.ParticipantStatistics=new o.Collection(function(e){return new c(e)}),this.PlisReceived=new i.PrettyNumber,this.TargetEncodeBitrate=new i.PrettyNumber,this.TransmitBitrate=new i.PrettyNumber,this.VideoBytesSent=new i.PrettyNumber,this.VideoCodec="",this.VideoEncodeUsagePercent=new i.PrettyNumberWithUnits("%"),this.VideoFrameRateInput=new i.PrettyNumber,this.VideoFrameRateSent=new i.PrettyNumber,this.VideoFramesEncoded=new i.PrettyNumber,this.VideoPacketsLost=new i.PrettyNumber,this.VideoResolutionSent=new i.PrettyTuple("x")}return Object.defineProperty(e.prototype,"RemoteParticipantAverageFrameRate",{get:function(){var e=this._activeParticipantsStatistics.map(function(e){return e.VideoFrameRateOutput.Value});return new i.PrettyNumber(a["default"].MeanValueOfArray(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RemoteParticipantAverageResolution",{get:function(){var e=this._activeParticipantsStatistics.map(function(e){return e.VideoResolutionReceived.Values[0]}),t=this._activeParticipantsStatistics.map(function(e){return e.VideoResolutionReceived.Values[1]}),n=a["default"].MeanValueOfArray(e),r=a["default"].MeanValueOfArray(t);return new i.PrettyTuple("x",n,r)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RemoteParticipantTotalFirsSent",{get:function(){return this._calculateStatisticsTotalBy("FirsSent")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RemoteParticipantTotalNacksSent",{get:function(){return this._calculateStatisticsTotalBy("NacksSent")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RemoteParticipantTotalPlisSent",{get:function(){return this._calculateStatisticsTotalBy("PlisSent")},enumerable:!0,configurable:!0}),e.prototype.FillFromBandwidthSummaryStatistics=function(e){this.TargetEncodeBitrate.Value=e.TargetEncoderBitRate,this.TransmitBitrate.Value=e.TotalTransmitBitRate,this.EncodeBitrate.Value=e.ActualEncoderBitRate,this.AvailableRecieveBandwidth.Value=e.AvailableRecieveBandwidth,this.AvailableSendBandwidth.Value=e.AvailableBandwidth},e.prototype.FillFromLocalMicrophoneStatistics=function(e){this.AudioCodec=e.CodecName,this.AudioBytesSent.Value=e.BytesSentUdp,this.AudioLevel.Value=e.AudioLevel,this.AudioPacketsLost.Value=e.AudioPacketsLost},e.prototype.FillFromLocalVideoSourceStatistics=function(e){this.VideoCodec=e.CodecName,this.FirsReceived.Value=e.FirsReceived,this.NacksReceived.Value=e.NacksReceived,this.PlisReceived.Value=e.PlisReceived,this.VideoBytesSent.Value=e.BytesSentUdp,this.VideoEncodeUsagePercent.Value=e.VideoEncodeUsagePercent,this.VideoFrameRateInput.Value=e.VideoFrameRateInput,this.VideoFrameRateSent.Value=e.VideoFrameRateSent,this.VideoFramesEncoded.Value=e.VideoFramesEncoded,this.VideoPacketsLost.Value=e.VideoPacketsLost,this.VideoResolutionSent.SetValues(e.Width,e.Height),this.VideoResolutionLimitedByBandwidth=e.VideoResolutionLimitedByBandwidth,this.VideoResolutionLimitedByCPU=e.VideoResolutionLimitedByCPU},Object.defineProperty(e.prototype,"_activeParticipantsStatistics",{get:function(){return this.ParticipantStatistics.Where({ParticipantIsActive:!0})},enumerable:!0,configurable:!0}),e.prototype._calculateStatisticsTotalBy=function(e){var t=0,n=function(t,n){return t+n[e].Value};return new i.PrettyNumber(this.ParticipantStatistics.All().reduce(n,t))},e}();n.CallStatistics=s;var c=function(){function e(e){this.Id=e,this.AudioBytesReceived=new i.PrettyNumber,this.AudioCodec="",this.AudioDecodingMuted=new i.PrettyNumber,this.AudioDecodingNormal=new i.PrettyNumber,this.FirsSent=new i.PrettyNumber,this.JitterBuffer=new i.PrettyNumber,this.NacksSent=new i.PrettyNumber,this.PlisSent=new i.PrettyNumber,this.SSRCs=new i.PrettyList,this.VideoCodec="",this.VideoFrameRateDecoded=new i.PrettyNumber,this.VideoFrameRateOutput=new i.PrettyNumber,this.VideoFrameRateReceived=new i.PrettyNumber,this.VideoFramesDecoded=new i.PrettyNumber,this.VideoPacketsLost=new i.PrettyNumber,this.VideoPacketsReceived=new i.PrettyNumber,this.VideoResolutionReceived=new i.PrettyTuple("x")}return e.prototype.FillFromRemoteMicrophoneStatistics=function(e){this.AudioBytesReceived.Value=e.AudioBytesReceived,this.AudioCodec=e.CodecName,this.AudioDecodingMuted.Value=e.AudioDecodingMuted,this.AudioDecodingNormal.Value=e.AudioDecodingNormal},e.prototype.FillFromRemoteVideoSourceStatistics=function(e){this.FirsSent.Value=e.CodecFir,this.JitterBuffer.Value=e.JitterBuffer,this.NacksSent.Value=e.CodecNacks,this.PlisSent.Value=e.PlisSent,this.VideoCodec=e.CodecName,this.VideoFrameRateDecoded.Value=e.VideoFrameRateDecoded,this.VideoFrameRateOutput.Value=e.VideoFrameRateOutput,this.VideoFrameRateReceived.Value=e.VideoFrameRateReceived,this.VideoFramesDecoded.Value=e.VideoFramesDecoded,this.VideoPacketsLost.Value=e.ReceiveNetworkPacketsLost,this.VideoPacketsReceived.Value=e.VideoPacketsReceived,this.VideoResolutionReceived.SetValues(e.Width,e.Height)},e}();n.ParticipantStatistics=c;var u=e("./BandwidthSummaryStatistics");n.BandwidthSummaryStatistics=u.BandwidthSummaryStatistics;var l=e("./EndpointStatistics");n.EndpointStatistics=l.EndpointStatistics;var d=e("./LocalMicrophoneStatistics");n.LocalMicrophoneStatistics=d.LocalMicrophoneStatistics;var p=e("./LocalRendererStatistics");n.LocalRendererStatistics=p.LocalRendererStatistics;var f=e("./LocalRendererStreamStatistics");n.LocalRendererStreamStatistics=f.LocalRendererStreamStatistics;var h=e("./LocalSpeakerStatistics");n.LocalSpeakerStatistics=h.LocalSpeakerStatistics;var m=e("./LocalSpeakerStreamStatistics");n.LocalSpeakerStreamStatistics=m.LocalSpeakerStreamStatistics;var v=e("./LocalVideoSourceStatistics");n.LocalVideoSourceStatistics=v.LocalVideoSourceStatistics;var g=e("./MediaConnectionTransportInformation");n.MediaConnectionTransportInformation=g.MediaConnectionTransportInformation;var y=e("./NetworkInterfaceStatistics");n.NetworkInterfaceStatistics=y.NetworkInterfaceStatistics;var _=e("./ParticipantGenerationStatistics");n.ParticipantGenerationStatistics=_.ParticipantGenerationStatistics;var S=e("./ParticipantStatistic");n.ParticipantStatistic=S.ParticipantStatistic;var b=e("./RateShaperStatistics");n.RateShaperStatistics=b.RateShaperStatistics;var C=e("./RemoteMicrophoneStatistics");n.RemoteMicrophoneStatistics=C.RemoteMicrophoneStatistics;var w=e("./RemoteRendererStreamStatistics");n.RemoteRendererStreamStatistics=w.RemoteRendererStreamStatistics;var E=e("./RemoteSpeakerStreamStatistics");n.RemoteSpeakerStreamStatistics=E.RemoteSpeakerStreamStatistics;var R=e("./RemoteVideoSourceStatistics");n.RemoteVideoSourceStatistics=R.RemoteVideoSourceStatistics;var P=e("./RoomStatistics");n.RoomStatistics=P.RoomStatistics;var x=e("./UserStatistics");n.UserStatistics=x.UserStatistics,n.CutSsrcFromTrackId=r},{"../../utils/Collection":425,"../../utils/ObjectUtils":435,"../../utils/PrettyNumber":437,"./BandwidthSummaryStatistics":398,"./EndpointStatistics":399,"./LocalMicrophoneStatistics":400,"./LocalRendererStatistics":401,"./LocalRendererStreamStatistics":402,"./LocalSpeakerStatistics":403,"./LocalSpeakerStreamStatistics":404,"./LocalVideoSourceStatistics":405,"./MediaConnectionTransportInformation":406,"./NetworkInterfaceStatistics":407,"./ParticipantGenerationStatistics":408,"./ParticipantStatistic":409,"./RateShaperStatistics":410,"./RemoteMicrophoneStatistics":411,"./RemoteRendererStreamStatistics":412,"./RemoteSpeakerStreamStatistics":413,"./RemoteVideoSourceStatistics":414,"./RoomStatistics":415,"./UserStatistics":417}],417:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){this.Host="",this.Id="",this.Port=0,this.RoomStats=[],this.ServiceType=""}return e}();n.UserStatistics=r},{}],418:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./ReadOnlyMediaTrack"),i=function(){function e(e){this._mediaStream=e,this._callbacksToRemove=[]}return e.prototype.GetAudioTracks=function(){return this._mediaStream.getAudioTracks().map(function(e){return new r.ReadOnlyMediaTrack(e)})},e.prototype.GetClonedMediaStream=function(){return this._mediaStream},e.prototype.GetTracks=function(){return this._mediaStream.getTracks().map(function(e){return new r.ReadOnlyMediaTrack(e)})},e.prototype.GetVideoTracks=function(){return this._mediaStream.getVideoTracks().map(function(e){return new r.ReadOnlyMediaTrack(e)})},e.prototype.OnTrackAdded=function(e){this._mediaStream.addEventListener("addtrack",e),this._callbacksToRemove.push(new o("addtrack",e))},e.prototype.OnTrackEnabledChanged=function(e){this._mediaStream.addEventListener("trackenabledchanged",e),this._callbacksToRemove.push(new o("trackenabledchanged",e))},e.prototype.OnTrackRemoved=function(e){this._mediaStream.addEventListener("removetrack",e),this._callbacksToRemove.push(new o("removetrack",e))},e.prototype.UnregisterEventListeners=function(){var e=this;this._callbacksToRemove.forEach(function(t){return e._mediaStream.removeEventListener(t.EventType,t.Listener)})},Object.defineProperty(e.prototype,"Id",{get:function(){return this._mediaStream.id},enumerable:!0,configurable:!0}),e}();n.ReadOnlyMediaStream=i;var o=function(){function e(e,t){this.EventType=e,this.Listener=t}return e}()},{"./ReadOnlyMediaTrack":419}],419:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Source"),i=function(){function e(e){this._mediaTrack=e}return e.prototype.IsActive=function(){return this.Enabled&&!this.Muted},Object.defineProperty(e.prototype,"Enabled",{get:function(){return this._mediaTrack.enabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Id",{get:function(){return this._mediaTrack.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Kind",{get:function(){var e=this._mediaTrack.kind;if(r.IsSourceMediaType(e))return e;throw new Error("Unknown track type: "+e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Label",{get:function(){return this._mediaTrack.label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Muted",{get:function(){return this._mediaTrack.muted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Settings",{get:function(){return this._mediaTrack.getSettings()},enumerable:!0,configurable:!0}),e}();n.ReadOnlyMediaTrack=i},{"../Source":387}],420:[function(e,t,n){"use strict";function r(e,t,n){Object.defineProperty(e,t,{get:function(){return n},configurable:!0})}Object.defineProperty(n,"__esModule",{value:!0}),n.AssignHiddenPropertyValue=r},{}],421:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.CalculateSampleSize=function(e){var t=8,n=16,r=32,i=Math.log2(e);return i=t>=i?t:i>t&&n>=i?n:r},e.getAudioContext=function(){return e._audioContext},e.GetAudioStats=function(t){var n,r=e._state[t];return r&&(n=r.stats),n},e.Monitor=function(t,n){if(e._audioContext&&!(t.getAudioTracks().length<=0)){var r=e._audioContext.createAnalyser(),i=e._audioContext.createMediaStreamSource(t),o=8192,a=e._audioContext.createScriptProcessor(o,1,1);e._state[t.id]={analyser:r,microphone:i,javascriptNode:a,stats:{}};var s=t.id,c=.8;r.smoothingTimeConstant=c;var u=1024;r.fftSize=u,i.connect(r),r.connect(a),a.connect(e._audioContext.destination),
a.onaudioprocess=function(t){var i=new Uint8Array(r.frequencyBinCount);r.getByteFrequencyData(i);for(var o=0,a=i.length,c=0;a>c;c++)o+=i[c];var u=o/a,l=e._state[s];l&&(l.stats={sampleRate:t.inputBuffer.sampleRate,channelsCount:t.inputBuffer.numberOfChannels,sampleSize:e.CalculateSampleSize(t.inputBuffer.sampleRate)}),n(u)}}},e.StopMonitoring=function(t){var n=e._state[t];n&&(n.javascriptNode.onaudioprocess=null,n.microphone.disconnect(),n.analyser.disconnect(),e._state[t]=null)},e._audioContext="undefined"!=typeof AudioContext?new AudioContext:void 0,e._state={},e}();n.AudioAnalyser=r},{}],422:[function(e,t,n){"use strict";function r(e,t,n){var r=e(Object),i=new r;Object.getOwnPropertyNames(i).forEach(function(e){return Object.defineProperty(t,e,n(e))})}Object.defineProperty(n,"__esModule",{value:!0}),n.CreateAutoProperties=r},{}],423:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./ChromeWebstoreProvider"),i=function(){function e(){}return e.AssertInstalled=function(){return e.ExtensionIsInstalled()?Promise.resolve(void 0):e.Install()},e.ExtensionIsInstalled=function(){return!!document.getElementById("vidyowebrtcscreenshare_is_installed")},e.Install=function(){return e._insertChromeWebStoreItemLink(),new Promise(function(t,n){r.ChromeWebstoreProvider.GetChromeWebstore().install(e._extensionUrl,t,n),e._removeChromeWebStoreItemLink()})["catch"](function(t){function n(e){return"Inline install failed ("+t+"); Attempted to fall back to Chrome Store but "+e}if(["User cancelled install"].indexOf(t)>=0)return Promise.reject(t);var r=window.open(e._extensionUrl);if(r){if(e._pendingInstall)throw n("extension install is already in progress");e._pendingInstall=!0;var i=30,o=1e3,a=i*o,s=0,c=10;return new Promise(function(t,r){function o(){s>=a?r(n("the user did not install the extension within "+i+" seconds")):(s+=c,e.ExtensionIsInstalled()?t():setTimeout(o,c))}o()}).then(function(){e._pendingInstall=!1})["catch"](function(t){throw e._pendingInstall=!1,t})}throw n("pop-ups are blocked")})["catch"](function(e){throw"Installing Screen Share Extension failed: "+e})},e.StopWaitingForInstall=function(){e._pendingInstall=!1},Object.defineProperty(e,"_extensionUrl",{get:function(){return"https://chrome.google.com/webstore/detail/"+e._extensionId},enumerable:!0,configurable:!0}),Object.defineProperty(e,"_extensionChromeWebStoreItemLinkSelector",{get:function(){return"link[rel='chrome-webstore-item'][href='"+e._extensionUrl+"']"},enumerable:!0,configurable:!0}),e._insertChromeWebStoreItemLink=function(){if(!document.querySelector(e._extensionChromeWebStoreItemLinkSelector)){var t=document.createElement("link");t.rel="chrome-webstore-item",t.href=e._extensionUrl,document.head.appendChild(t)}},e._removeChromeWebStoreItemLink=function(){var t=document.querySelector(e._extensionChromeWebStoreItemLinkSelector);t&&t.parentNode&&t.parentNode.removeChild(t)},e._extensionId="fadjebjcpiiklefiadeicakcnkhgbaoo",e._pendingInstall=!1,e}();n.ChromeExtensionProvider=i},{"./ChromeWebstoreProvider":424}],424:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.GetChromeWebstore=function(){return chrome.webstore},e}();n.ChromeWebstoreProvider=r},{}],425:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./ObjectUtils"),i=function(){function e(e,t){this.Id=e,this.Data=t}return e}();n.DataWithId=i;var o=function(){function e(e){this._createDefaultValue=e,this._collection={}}return e.prototype.Add=function(e){this._collection[e.Id]=e},e.prototype.All=function(){return Object.values(this._collection)},e.prototype.Create=function(e){var t=this._createDefaultValue(e);return this._collection[e]=t,t},e.prototype.Get=function(e){return this._collection[e]||this.Create(e),this._collection[e]},e.prototype.Remove=function(e){delete this._collection[e]},e.prototype.Where=function(e){return r["default"].Filter(this._collection,e)},e}();n.Collection=o},{"./ObjectUtils":435}],426:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../models/ConferenceCommandParameters");n.BitsInByteValue=8,n.DefaultLocalStreamFrameRate=30,n.DefaultLocalStreamHeight=360,n.DefaultLocalStreamWidth=640,n.DefaultPort=443,n.DefaultSelfViewPolicy=r.SelfViewPolicy.HideSelf,n.DefaultTimeOut=60,n.AtomicTimeOut=15,n.BatchTimeOut=30,n.KiloCoefficient=1e3,n.Muc="@muc.",n.NumberOfSelectedAudioSources=3,n.ParticipantLimit=8,n.PreviewParticipantId="__preview",n.ResourceIdDomainSeparator="_",n.SecToMsCoefficient=1e3,n.StatisticsRefreshInterval=1e3,n.SendClientStatisticsInterval=1e4,n.StreamMonitoringInterval=250,n.SubscriptionDialogDuration=3600,n.Threshould=.1,n.ReflectorPoolsURL="/static/poolreflectors.json",n.LibVersion="4.1.22",n.LibBuild="90"},{"../models/ConferenceCommandParameters":379}],427:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=function(e){function t(n){var r=e.call(this,n)||this;return r.name=t.Name,r}return r(t,e),t.Name="DuplicateNameError",t}(Error);n.DuplicateNameError=i;var o=function(e){function t(n){var r=e.call(this,n)||this;return r.name=t.Name,r}return r(t,e),t.Name="TimeOutError",t}(Error);n.TimeOutError=o},{}],428:[function(e,t,n){"use strict";function r(e,t){for(var n=new t,r=0,o=Object.keys(n);r<o.length;r++){var a=o[r],s=(n[a],new i(e+":"+a));n[a]=s}return n}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e){this._name=e||""}return e.prototype.Scoped=function(t){return new e(this.toString()+":"+t)},e.prototype.slice=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(n=this.toString()).slice.apply(n,e);var n},e.prototype.toString=function(){return this._name},e}();n.EventDescriptor=i;var o=function(){function e(){}return e}();n.EventListBase=o,n.CreateEventList=r},{}],429:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.Clear=function(){localStorage.clear()},e.Get=function(e){return localStorage.getItem(e)||void 0},e.Set=function(e,t){t?localStorage.setItem(e,t):localStorage.removeItem(e)},e}();n.LocalStorageProvider=r},{}],430:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./LocalStorageProvider"),i=function(){function e(){}return e.GetCurrentPosition=function(){var e=r.LocalStorageProvider.Get("location");return e?Promise.resolve(JSON.parse(e)):Promise.reject("location request is denied")},e.Initialize=function(){var t=function(t){e.setCoords(t.coords)};r.LocalStorageProvider.Get("location")||navigator.geolocation.getCurrentPosition(t),navigator.geolocation.watchPosition(t)},e.setCoords=function(e){var t=60,n={latitude:e.latitude*t|0,longitude:e.longitude*t|0};r.LocalStorageProvider.Set("location",JSON.stringify(n))},e}();n.LocationProvider=i},{"./LocalStorageProvider":429}],431:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.GetMediaDevices=function(){return navigator.mediaDevices},e}();n.MediaDevicesProvider=r},{}],432:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ConnectionController="Connection Controller: ",n.ConnectionLost="Connection lost",n.ConnectionTimeout="Connection timeout",n.CouldNotGetAudioTrack="Could not get audio tracks: there were no audio tracks returned by the browser",n.CouldNotGetResponseFromMUC="Could not get response from MUC",n.CouldNotGetVideoTrack="Could not get video tracks: there were no video tracks returned by the browser",n.CouldNotGetWindowShareTrack="Could not get window share tracks: there were no window share tracks returned by the browser",n.CouldNotGetWindowShareTrackBecauseUserCancelled="Could not get window share tracks: the operation was cancelled by the user",n.CouldNotParseString='Could not parse "${string}".',n.Disconnecting="Normal disconnecting",n.Disconnected="Normal disconnected",n.ErrorInFindRoomOnServer="Error in FindRoomOnServer",n.ErrorInSendTokenQuery="Error in SendTokenQuery",n.IdCannotBeEmpty="Id cannot be empty",n.LocalMediaOperationNotPermitted="Operation Not Permitted: LocalStreamController will not start a ${mediaType} when it is in ${mediaState}",n.MediaSessionAddingStreamError="Media session adding stream error",n.MediaSessionEnded="Media session ended",n.MediaSessionError="Media session error",n.MediaSessionTransportError="Media session transport error",n.MiscError="Miscellaneous errors",n.MiscLocalError="Miscellaneous local errors",n.MiscRemoteError="Miscellaneous remote errors",n.NoResponse="No response",n.NoSuchParticipant='Could not find participant with id "${id}".',n.NoSuchStream='Could not find stream with id "${id}".',n.NotImplemented="Not implemented.",n.SignallingError="Signalling error",n.SignallingTransportError="Signalling transport error",n.Terminated="Terminated",n.TheElementIdDoesntExist='The element "${id}" doesn`t exist.',n.TheElementOfClassDoesntExist='The element of "${className}" class doesn`t exist.',n.TheViewStyleViewStyleIsNotSupported='The view style "${viewStyle}" is not supported.',n.ValidationErrorInParentRequiredFieldNameIsNotFound='Validation error in "${parent}": required field "${name}" is not found.'},{}],433:[function(e,t,n){"use strict";function r(e,t,n){return 0===e||Math.abs((e-t)/e)>n}Object.defineProperty(n,"__esModule",{value:!0}),n.NotEqual=r},{}],434:[function(e,t,n){"use strict";function r(){throw new Error(i.NotImplemented)}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./Messages");n.NotImplemented=r},{"./Messages":432}],435:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.BaseAssign=function(e,t){for(var n in t)"constructor"!==n&&(e[n]=t[n])},e.Copy=function(e){var t=e instanceof Array?[]:{};return this.Merge(t,e)},e.Difference=function(e,t){return e.filter(function(e){return-1===t.indexOf(e)})},e.Filter=function(e,t){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],o=!0;for(var a in t)if(i[a]!==t[a]){o=!1;break}o&&n.push(i)}return n},e.Flatten=function(e){return[].concat.apply([],e)},e.IsEmpty=function(e){return 0===Object.keys(e).length},e.IsEqual=function(e,t){if(e.length!==t.length)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0},e.IsNotEmpty=function(e){return!this.IsEmpty(e)},e.IsNotEqual=function(e,t){return!this.IsEqual(e,t)},e.MapObject=function(e,t){return e instanceof Array?e.map(t):Object.values(e).map(t)},e.MeanValueOfArray=function(e){return e.reduce(function(e,t){return e+t},0)/e.length},e.Merge=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return e._merge(t,n)})},e._merge=function(e,t){if(void 0===e&&(e={}),void 0===t&&(t={}),!e||!t)return e||t||{};var n=function(e){return e instanceof Object&&!(e instanceof Array)};for(var r in t)n(t[r])?(n(e[r])||(e[r]={}),this._merge(e[r],t[r])):r in e&&"undefined"==typeof t[r]||(e[r]=t[r]instanceof Array?this._merge([],t[r]):t[r]);return e},e}();n["default"]=r},{}],436:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.GetOSInfo=function(){return e._osInfo||(e._osInfo=e._getOSInfo()),e._osInfo},e.IsChrome=function(){return void 0===e._isChrome&&(e._isChrome=navigator.userAgent.indexOf("Chrome")>0&&navigator.userAgent.indexOf("OPR")<0&&navigator.userAgent.indexOf("Firefox")<0),e._isChrome},e.IsSafari=function(){return void 0===e._isSafari&&(e._isSafari=navigator.userAgent.indexOf("Chrome")<0&&navigator.userAgent.indexOf("Safari")>=0),e._isSafari},e.IsWindows=function(){return this.GetOSInfo(),e._osInfo?e._osInfo.OSName.toLowerCase().indexOf("windows")>=0:!1},e._getOSInfo=function(){var e,t=navigator.appVersion,n=navigator.userAgent,r="",i=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 10",r:/(Windows 10|Windows NT 10)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];e=i.find(function(e){return e.r.test(n)})||"",e&&(r=e.s);var o="";if(/Windows/.test(r)){var a=/Windows (.*)/.exec(r);a&&a.length>1&&(o=a[1]),r="Windows"}switch(r){case"Mac OS X":e=/Mac OS X (10[\.\_\d]+)/.exec(n),e&&e.length>1&&(o=e[1]);break;case"Android":e=/Android ([\.\_\d]+)/.exec(n),e&&e.length>1&&(o=e[1]);break;case"iOS":e=/OS (\d+)_(\d+)_?(\d+)?/.exec(t);var s=1,c=2,u=3;o=e[s]+"."+e[c]+"."+(e[u]||0)}return{OSName:r,OSVersion:o}},e}();n.OperatingSystemInfoProvider=r},{}],437:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("short-number"),o=function(){function e(e){void 0===e&&(e=0),this.Value=e}return e}();n.PrettyNumberBase=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.toString=function(){var e=1e3;if(this.Value<e){var t=100,n=10,r=void 0;return r=this.Value<t?n:1,(Math.round(this.Value*r)/r).toString()}return i(this.Value).toString()},t}(o);n.PrettyNumber=a;var s=function(e){function t(t,n){void 0===n&&(n=0);var r=e.call(this,n)||this;return r._unit=t,r}return r(t,e),t.prototype.toString=function(){return""+this.Value+this._unit},t}(o);n.PrettyNumberWithUnits=s;var c=function(){function e(e){void 0===e&&(e=[]),this.Values=e}return e.prototype.Push=function(e){var t=this;e.forEach(function(e){t.PushIfNew(e)})},e.prototype.PushIfNew=function(e){this.Values.indexOf(e)<0&&this.Values.push(e)},e.prototype.toString=function(){return this.Values.join(", ")},e}();n.PrettyList=c;var u=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this._seperator=e,this._first=t,this._second=n}return Object.defineProperty(e.prototype,"Values",{get:function(){return[this._first,this._second]},enumerable:!0,configurable:!0}),e.prototype.SetValues=function(e,t){this._first=e,this._second=t},e.prototype.toString=function(){return Math.round(this._first)+" "+this._seperator+" "+Math.round(this._second)},e}();n.PrettyTuple=u},{"short-number":239}],438:[function(e,t,n){"use strict";function r(){var e=void 0,t=void 0,n=new a.Promise(function(n,r){e=n,t=r});return{promise:n,reject:t,resolve:e}}function i(e,t){return a.Promise.race([e,new a.Promise(function(e,n){t.timeoutRef=setTimeout(function(){t.cleanUp&&t.cleanUp(),n(new o.TimeOutError("timeout"))},t.delay)})]).then(function(e){return clearTimeout(t.timeoutRef),t.timeoutRef=0,t.cleanUp&&t.cleanUp(),e})}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./Errors"),a=e("es6-promise");n.MakePromiseWithCallback=r;var s=function(){function e(e,t){this.timeoutRef=0,this.delay=e,this.cleanUp=t}return e}();n.PromiseTimeout=s,n.ApplyTimeout=i},{"./Errors":427,"es6-promise":31}],439:[function(e,t,n){"use strict";function r(e){return function(t){return new o["default"](e,t)}}function i(e){return e.reflectors.map(r(e))}Object.defineProperty(n,"__esModule",{value:!0});var o=e("../models/Reflector");n.SelectReflectors=i},{"../models/Reflector":384}],440:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./TimingProvider"),i=function(){function e(){}return e.Start=function(e,t){var n={height:-1,width:-1};r.TimingProvider.BeforeEachRepaint(function(){(n.height!==e.clientHeight||n.width!==e.clientWidth)&&(n={height:e.clientHeight,width:e.clientWidth},t(n))})},e}();n.SizeObserver=i},{"./TimingProvider":442}],441:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.Format=function(e,t){var n=e;for(var r in t)if(t.hasOwnProperty(r)){var i=new RegExp("(<%=\\s?"+r+"\\s?%>)|(\\$\\{"+r+"\\})","gm");n=n.replace(i,t[r])}return n},e}();n["default"]=r},{}],442:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(){}return e.BeforeEachRepaint=function(e){function t(){window.requestAnimationFrame(t),e()}window.requestAnimationFrame(t)},e.ClearInterval=function(e){clearInterval(e)},e.Debounce=function(e,t){void 0===t&&(t=0);var n=!1;return function(){if(!n){n=!0;var r=function(){e(),n=!1};setTimeout(r,t)}}},e.Interval=function(e,t){return setInterval(t,e)},e}();n.TimingProvider=r},{}],443:[function(e,t,n){"use strict";function r(e){var t=atob(e).split("\x00");return t[1].replace("@","_").toLowerCase()}function i(e){var t="",n=atob(e).split("\x00");if(n[1]){var r=n[1].split("@"),i=(r[0],r[1]);i&&(t=i.toLowerCase())}return t}function o(e){var t={};return e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(e,n,r,i){return t[n]=i,""}),t}Object.defineProperty(n,"__esModule",{value:!0}),n.DecodeUserName=r,n.DecodeUserDomainName=i,n.ParseUrlParams=o},{}],444:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Constants"),i=e("./Messages"),o=e("./ChromeExtensionProvider"),a=e("./MediaDevicesProvider"),s=function(){function e(){this._windowShareQueue=[],this._listenForChromeExtensionMessages()}return e.prototype.GetAudioTrack=function(e){void 0===e&&(e=!0);var t={audio:e===!0?!0:{deviceId:e.Id}};return a.MediaDevicesProvider.GetMediaDevices().getUserMedia(t).then(function(e){var t=e.getAudioTracks()[0];if(!t)throw i.CouldNotGetAudioTrack;return t})},e.prototype.GetVideoTrack=function(e,t){void 0===e&&(e=!0);var n=t?t:{width:r.DefaultLocalStreamWidth,height:r.DefaultLocalStreamHeight},o={video:n};if(e!==!0&&(o.video.deviceId={exact:e.Id}),navigator.userAgent.indexOf("Chrome")<0&&navigator.userAgent.indexOf("Safari")>=0){var s=480,c=640;o.video.height=s,o.video.width=c}return a.MediaDevicesProvider.GetMediaDevices().getUserMedia(o).then(function(e){var t=e.getVideoTracks()[0];if(!t)throw i.CouldNotGetVideoTrack;return t})},e.prototype.GetWindowShareTrack=function(e){var t=this;return e?this._getWindowShareTrack(e):o.ChromeExtensionProvider.AssertInstalled().then(function(){return window.postMessage({type:"VidyoRequestGetWindowsAndDesktops"},"*"),new Promise(function(e,n){t._windowShareQueue.push(function(r){t._getWindowShareTrack(r).then(e)["catch"](n)})})})},e.prototype.Initialize=function(){return a.MediaDevicesProvider.GetMediaDevices().getUserMedia({audio:!0,video:!0}).then(function(e){return e.getTracks().forEach(function(e){e.stop()}),e.stop(),Promise.resolve(void 0)})["catch"](function(){})},e.prototype._getWindowShareTrack=function(e){return new Promise(function(t,n){if(!e)return void n(i.CouldNotGetWindowShareTrackBecauseUserCancelled);var r={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxWidth:1920,maxHeight:1080,maxFrameRate:3}}};a.MediaDevicesProvider.GetMediaDevices().getUserMedia(r).then(function(e){var r=e.getVideoTracks()[0];r?t(r):n(i.CouldNotGetWindowShareTrack)})["catch"](n)})},e.prototype._listenForChromeExtensionMessages=function(){var e=this;window.addEventListener("message",function(t){if(t.origin===window.location.origin&&"VidyoOutEventSourceId"===t.data.type){var n=e._windowShareQueue.pop();n&&n(t.data.sourceId)}})},e}();n.UserMediaProvider=s},{"./ChromeExtensionProvider":423,"./Constants":426,"./MediaDevicesProvider":431,"./Messages":432}],445:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=500,i=function(){function e(){this._height=r,this._width=r;var e=this._createCanvas();if(e){this._canvas=e;var t=this._canvas.getContext("2d");if(!t)throw new Error("Could not get canvas context when creating placeholder track");this._canvasContext=t;var n=30,i=this._canvas.captureStream(n),o=this._createProfileImage();o&&(this._profileImage=o,this._drawImageOnCanvas(),this.Track=i.getVideoTracks()[0])}}return e.prototype.Resize=function(e,t){this._width=e,this._height=t,this._drawImageOnCanvas()},e.prototype._createCanvas=function(){var e=document.createElement("canvas");return e.captureStream?e:!1},e.prototype._createProfileImage=function(){var e=new Image;return e.src='data:image/svg+xml;utf8,\n      <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n         viewBox="0 0 500 500" preserveAspectRatio="xMidYMid meet" style="enable-background:new 0 0 500 500;" xml:space="preserve">\n      <style type="text/css">\n        .st0{fill:#C5DBDE;}\n      </style>\n      <path class="st0" d="M349.5,150.8c0,55.1-44.7,99.8-99.8,99.8S150,205.8,150,150.8S194.7,51,249.8,51S349.5,95.7,349.5,150.8z\n         M405.6,337L405.6,337c-98-49-213.3-49.1-311.4-0.2l-0.4,0.2c-26.6,13.3-43.4,40.5-43.4,70.2V500H449v-92.8\n        C449,377.5,432.2,350.3,405.6,337z"/>\n      </svg>\n      '.replace(/\n/g,""),e},e.prototype._drawImageOnCanvas=function(){this._canvas.width=this._width,this._canvas.height=this._height,this._canvasContext.fillStyle="#202020",this._canvasContext.fillRect(0,0,this._width,this._height);var e=this._width/this._height<1,t=e?this._width:this._height,n=2,r=e?0:(this._width-t)/n,i=e?(this._height-t)/n:0;this._canvasContext.drawImage(this._profileImage,r,i,t,t)},e}();n.VideoPlaceholderTrack=i},{}],446:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("../events/AdvancedSettingsEvents");!function(e){e.Simple="Simple",e.VidyoConnector="VidyoConnector"}(r=n.API||(n.API={}));var o=function(){function e(){}return e.Debug=function(t,n,r){var i=function(i){if("function"==typeof t[i]&&"_"!==(""+i)[0]){var o=t[i];t[i]=function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(e.isEnabledAPI[n]&&e.log){var c=e.getFileName(r||"<filename>");e.log.LogVerbose(" "+c+": "+i+" method was called")}return o.apply(t,a)}}};for(var o in t)i(o)},e.Initialize=function(t){e._vidyoCore=t,e.log=t.Controllers.LogController,this._vidyoCore.EventDispatcher.on(i.Events.EnableSimpleAPILoggingChanged,function(t){e.isEnabledSimpleAPI=t}),this._vidyoCore.EventDispatcher.on(i.Events.EnableVidyoConnectorAPILoggingChanged,function(t){e.isEnabledVidyoConnectorAPI=t})},e.getFileName=function(e){var t=e.split("\\");return t[t.length-1]},Object.defineProperty(e,"isEnabledSimpleAPI",{get:function(){return e.isEnabledAPI.Simple},set:function(t){e.isEnabledAPI.Simple=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isEnabledVidyoConnectorAPI",{get:function(){return e.isEnabledAPI.VidyoConnector},set:function(t){e.isEnabledAPI.VidyoConnector=t},enumerable:!0,configurable:!0}),e.isEnabledAPI={Simple:!1,VidyoConnector:!1},e}();n.VidyoDebugger=o},{"../events/AdvancedSettingsEvents":367}],447:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=window.RTCPeerConnection.prototype.getStats;e("webrtc-adapter"),window.RTCPeerConnection.prototype.getStats=r},{"webrtc-adapter":316}],448:[function(e,t,n){"use strict";function r(e,t){return new i.Promise(function(n,r){var i=new XMLHttpRequest;i.open("GET",e),t&&t.forEach(function(e){i.setRequestHeader(e.name,e.value)}),i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE?n(i.responseText):r(new Error(i.response))},i.send(null)})}Object.defineProperty(n,"__esModule",{value:!0});var i=e("es6-promise");n.Get=r},{"es6-promise":31}],449:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r;!function(e){e[e.get=0]="get",e[e.error=1]="error",e[e.result=2]="result",e[e.set=3]="set"}(r=n.StanzaTypes||(n.StanzaTypes={}));var i;!function(e){e[e.NormalClosure=1e3]="NormalClosure",e[e.NoStatusProvided=1005]="NoStatusProvided",e[e.AbnormalClosure=1006]="AbnormalClosure"}(i=n.CloseEventCode||(n.CloseEventCode={}))},{}],450:[function(e,t,n){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./stanzaio/StanzaXmppProvider");n.XmppProvider=i.StanzaXmppProvider,r(e("./XmppBase"))},{"./XmppBase":449,"./stanzaio/StanzaXmppProvider":456}],451:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e){this._simplifiedVidyoCore=e}return e.prototype.AdjustInboundJingleContents=function(e){},e.prototype.AdjustOutboundJingleContents=function(e){},e.prototype._hasPayloads=function(e){return e.application&&e.application.payloads},e}();n.BaseJingleContentAdjustor=i;var o=function(e){function t(t){var n=e.call(this,t)||this;return n._adjustors=[new a(t),new s(t)],n}return r(t,e),t.prototype.AdjustInboundJingleContents=function(e){this._adjustors.forEach(function(t){t.AdjustInboundJingleContents(e)})},t.prototype.AdjustOutboundJingleContents=function(e){this._adjustors.forEach(function(t){t.AdjustOutboundJingleContents(e)})},t}(i);n.JingleContentAdjustor=o;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._nameChanges=[{BrowserName:"VP9",ReflectorName:"preVP9"},{BrowserName:"opus",ReflectorName:"OPUS"}],t}return r(t,e),t.prototype.AdjustInboundJingleContents=function(e){var t=this;this._hasPayloads(e)&&e.application.payloads.forEach(function(e){t._nameChanges.forEach(function(t){e.name===t.ReflectorName&&(e.name=t.BrowserName)})})},t.prototype.AdjustOutboundJingleContents=function(e){var t=this;this._hasPayloads(e)&&e.application.payloads.forEach(function(e){t._nameChanges.forEach(function(t){e.name===t.BrowserName&&(e.name=t.ReflectorName)})})},t}(i),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.AdjustOutboundJingleContents=function(e){var t,n=this._simplifiedVidyoCore.AdvancedSettings.CodecExcludeFilter;try{t=new RegExp(n)}catch(r){t=!1}n&&t&&this._hasPayloads(e)&&e.application.payloads.forEach(function(n,r){if(n.name.match(t)){e.application.payloads.splice(r,1);var i=e.application.payloads.findIndex(function(e){var t=e.parameters.find(function(e){return"apt"===e.key});return"rtx"===e.name&&t&&t.value===n.id});i>=0&&e.application.payloads.splice(i,1)}})},t}(i)},{}],452:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("uuid"),o=e("./JingleContentAdjustor"),a=e("./RtcPeerConnection"),s=e("../../SimplifiedVidyoCore"),c=e("async"),u=e("../../utils/ObjectUtils");!function(e){e.InteractiveAudio="interactive audio",e.InteractiveVideo="interactive video",e.NonInteractiveVideo="non-interactive video"}(r||(r={}));var l=function(){function e(e,t){this._rtcPeerConnectionHelper=e,this._simplifiedVidyoCore=t,this._contentAdjustor=new o.JingleContentAdjustor(this._simplifiedVidyoCore),this._helpers=new d(this._simplifiedVidyoCore)}return e.prototype.GetLocalStreamMediaType=function(e){this._helpers.GetLocalStreamMediaType=e},e.prototype._afterConstruction=function(){this.ACTIONS={"content-accept":"onContentAccept","content-add":"onContentAdd","content-modify":"onContentModify","content-reject":"onContentReject","content-remove":"onContentRemove","description-info":"onDescriptionInfo","security-info":"onSecurityInfo","session-accept":"onSessionAccept","session-info":"onSessionInfo","session-initiate":"onSessionInitiate","session-terminate":"onSessionTerminate","transport-accept":"onTransportAccept","transport-info":"onTransportInfo","transport-reject":"onTransportReject","transport-replace":"onTransportReplace","source-add":"onSourceAdd","source-remove":"onSourceRemove","anonymous-async-action":"anonymousAsyncAction"};var e=this;this.processingQueue=c.queue(function(t,n){if(e.ended)return n();var r=t.action,i=t.changes,o=t.cb;return e._log("debug",r),e.ACTIONS[r]?void e[e.ACTIONS[r]](i,function(e,t){return o(e,t),n()}):(e._log("error","Invalid action: "+r),o({condition:"bad-request"}),n())}),u["default"].BaseAssign(this.pc,new a.RtcPeerConnection(this._rtcPeerConnectionHelper))},e.prototype.pushToQueue=function(e,t){this.processingQueue.push({action:"anonymous-async-action",changes:e,cb:t||function(){}})},e.prototype.anonymousAsyncAction=function(e,t){e(t)},e.prototype.send=function(e,t){t=t||{},t.sid=this.sid,t.action=e,this.emit("send",{to:this.peer,id:i.v4(),type:"set",jingle:t})},e.prototype.start=function(e,t){var n=this;this.state="pending",this.candidates=[],t=t||function(){},this.pc.isInitiator=!0,e&&e.initialBandwidth&&(this.pc.initialBandwidth=e.initialBandwidth),this.pc.offer(e.offerOptions,function(r,i){return r?(n._log("error","Could not create WebRTC offer",r),n.end("failed-application",!0)):(n._rtcPeerConnectionHelper.CacheCodecList(i.jingle),e.offerOptions&&e.offerOptions.mandatory&&i.jingle.contents.forEach(function(t){var n=t.application.media;t.description&&"rtp"===t.application.applicationType&&(e.offerOptions.mandatory.OfferToReceiveAudio||"audio"!==n||(t.senders="initiator"),e.offerOptions.mandatory.OfferToReceiveVideo||"video"!==n||(t.senders="initiator"))}),i.jingle.contents.forEach(n._helpers.filterUnusedLabels),n._helpers.adjustSourceAttributes(i.jingle),n.waitForEndOfCandidates?n.once("endOfCandidates",function(t){n.addAccumulatedCandidates(i.jingle),i.jingle.LmiJingleName={value:e.displayName},n.send("session-initiate",i.jingle)}):(i.jingle.LmiJingleName={value:e.displayName},n.send("session-initiate",i.jingle)),void t())})},e.prototype.end=function(e,t){var n=this;console.log(new Date+': JingleMediaSession: session ended. Reason = "'+e+'"'),this.streams.forEach(function(e){n.onRemoveStream({stream:e})}),this._super.ended||(this.pc.close(),this._super.end.call(this,e,t),this.emit("mediaSessionEnded",e))},e.prototype.onIceCandidate=function(e,t){this._log("info","Discovered new ICE candidate",t.jingle),t.jingle.contents.forEach(function(e){e.transport.candidates.forEach(function(e){e.protocol=e.protocol.toUpperCase()})}),this.candidates.push(t),this.waitForEndOfCandidates||this.send("transport-info",t.jingle),e.signalEndOfCandidates&&(this.lastCandidate=t)},e.prototype.onIceEndOfCandidates=function(e){if(this._log("info","ICE end of candidates"),e.signalEndOfCandidates){var t=this.lastCandidate.jingle;t.contents[0].transport={transportType:t.contents[0].transport.transportType,gatheringComplete:!0},this.lastCandidate=null,this.waitForEndOfCandidates?this.emit("endOfCandidates",t):this.send("transport-info",t)}},e.prototype.onIceStateChange=function(){switch(this.pc.iceConnectionState){case"checking":this.connectionState="connecting";break;case"completed":case"connected":this.connectionState="connected";break;

case"disconnected":this.connectionState="stable"===this.pc.signalingState?"interrupted":"disconnected";break;case"failed":this.connectionState="failed",console.log(new Date+': JingleMediaSession::onIceStateChange: error "failed-transport".'),this.end("failed-transport");break;case"closed":this.connectionState="disconnected"}},e.prototype.addAccumulatedCandidates=function(e){e.contents.forEach(function(e){var t=this.candidates.filter(function(t){return t.jingle.contents[0].name===e.name&&t.jingle.contents[0].transport.candidates});e.transport.candidates=t.map(function(e){return e.jingle.contents[0].transport.candidates[0]})},this)},e.prototype.onSessionAccept=function(e,t){var n=this;e.contents.forEach(function(e){n._contentAdjustor.AdjustInboundJingleContents(e)});var r=this;this.state="active",this.pc.handleAnswer({type:"answer",jingle:e},function(e){return e?(r._log("error","Could not process WebRTC answer"),t({condition:"general-error"})):(r.emit("accepted",r),t(),void(r.pc.initialBandwidth&&(console.log("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ setup initial encoder bitrate: new="+r.pc.initialBandwidth+";"),r.UpdateLocalStream({bandwidth:r.pc.initialBandwidth},function(){},!1),delete r.pc.initialBandwidth)))})},e.prototype.onSourceAdd=function(e,t){var n=this;this._log("info","Adding new stream source"),e.contents.forEach(function(e,t){"application"===e.name&&(e.name="video",e.application.media="video")}),this._helpers.prepareSourcesForMerging(e);var r=u["default"].Copy(this.pc.remoteDescription);n._helpers.mergeSources(r,e),this.pc.handleOffer({type:"offer",jingle:r},function(e){return e?(n._log("error","Error adding new stream source"),t({condition:"general-error"})):void n.pc.answer(n.constraints,function(e){return e?(n._log("error","Error adding new stream source"),t({condition:"general-error"})):void t()})})},e.prototype.onContentModify=function(e,t){var n=this;this._log("info","Handling incoming content-modify request"),e.contents.forEach(function(e){n._contentAdjustor.AdjustInboundJingleContents(e),e.transport.fingerprints.forEach(function(e){e.setup="actpass"})}),this._helpers.prepareSourcesForMerging(e);var r=u["default"].Copy(e);n._helpers.mergeSources(r,this.pc.remoteDescription),n._helpers.mergeSources(r,e),n.pc.handleOffer({type:"offer",jingle:r},function(e){return e?(n._log("error","Error while handling content-modify requset"),t({condition:"general-error"})):void n.pc.answer(n.constraints,function(e,r){return e?(n._log("error","Error while answering to content-modify requset"),t({condition:"general-error"})):(r.jingle.contents.forEach(function(e){e.transport.candidates.forEach(function(e){e.protocol=e.protocol.toUpperCase()})}),n._helpers.adjustSourceAttributes(r.jingle),n.pushToQueue(function(e){n.send("content-accept",r.jingle),e()}),void t())})})},e.prototype.onSessionInfo=function(e,t){return e.ringing?(this._log("info","Outgoing session is ringing"),this.ringing=!0,this.emit("ringing",this),t()):e.hold?(this._log("info","On hold"),this.emit("hold",this),t()):e.active?(this._log("info","Resuming from hold"),this.emit("resumed",this),t()):e.mute?(this._log("info","Muting",e.mute),this.emit("mute",this,e.mute),t()):e.unmute?(this._log("info","Unmuting",e.unmute),this.emit("unmute",this,e.unmute),t()):void t()},e.prototype.onSourceRemove=function(e,t){var n=this;this._log("info","Removing stream source");var r=u["default"].Copy(this.pc.remoteDescription);this.pc.remoteDescription.contents.forEach(function(t,n){var i=t.application,o=i.sources||[],a=i.sourceGroups||[];e.contents.forEach(function(e){if(t.name===e.name){for(var i,s=e.application,c=s.sources||[],u=s.sourceGroups||[],l=0,d=c;l<d.length;l++){var p=d[l];i=-1;for(var f in o)if(p.ssrc===o[f].ssrc){i=f;break}i>-1&&(o.splice(i,1),r.contents[n].application.sources=JSON.parse(JSON.stringify(o)))}for(var h=0,m=u;h<m.length;h++){var v=m[h];i=-1;for(var f in a)if(v.semantics===a[f].semantics&&v.sources.length===a[f].sources.length){var g=!0;for(var y in v.sources)if(v.sources[y]!==a[f].sources[y]){g=!1;break}if(g){i=f;break}}i>-1&&(a.splice(i,1),r.contents[n].application.sourceGroups=JSON.parse(JSON.stringify(a)))}}})}),this.pc.handleOffer({type:"offer",jingle:r},function(e){return e?(n._log("error","Error removing stream source"),t({condition:"general-error"})):void n.pc.answer(n.constraints,function(e){return e?(n._log("error","Error removing stream source"),t({condition:"general-error"})):void t()})}),this.emit("peerSourceRemoved",this.pc.remoteDescription)},e.prototype.onAddStream=function(e){this._log("info","Stream added"),this.emit("peerStreamAdded",this,e.stream)},e.prototype.onRemoveStream=function(e){this._log("info","Stream removed"),this.emit("peerStreamRemoved",this,e.stream)},e.prototype.addStream=function(e,t,n){var r=this;this._log("info","Adding local stream"),this.pushToQueue(function(n){if(e.getTracks().forEach(function(t){r.pc.pc.addTrack(t,e)}),!t)return n();var i=u["default"].Copy(r.pc.remoteDescription);r.pc.handleOffer({type:"offer",jingle:i},function(e){return e?(r._log("error","Could not process offer for adding new stream"),n(e)):void r.pc.answer(r.constraints,function(e,t){if(e)return r._log("error","Could not create answer for adding new stream"),n(e);r._answerJingle=u["default"].Copy(t.jingle);var i=u["default"].Copy(r._answerJingle);return r._helpers.adjustContentJingle(i),r.send("content-add",i),r._helpers.adjustSourceAttributes(t.jingle),r.send("content-modify",t.jingle),n(null,t.jingle)})})},n)},e.prototype.removeStream=function(e,t,n){var r=this;this._log("info","Removing local stream"),this.pushToQueue(function(n){if(e.getTracks().forEach(function(e){var t=r.pc.pc.getSenders().find(function(t){return t.track.id===e.id});t&&r.pc.pc.removeTrack(t)}),!t)return n();var i=u["default"].Copy(r.pc.remoteDescription);r.pc.handleOffer({type:"offer",jingle:i},function(e){return e?(r._log("error","Could not process offer for removing stream"),n(e)):void r.pc.answer(r.constraints,function(e,t){if(e)return r._log("error","Could not create answer for removing stream"),n(e);var i=u["default"].Copy(r._answerJingle);return r._helpers.adjustContentJingle(i),r.send("content-remove",i),r._answerJingle=u["default"].Copy(t.jingle),r._helpers.fixProtocolNameCase(t.jingle),r._helpers.adjustSourceAttributes(t.jingle),r.send("content-modify",t.jingle),n(null,t.jingle)})})},n)},e.prototype.UpdateStreamTracks=function(e,t){var n=this;this.pushToQueue(function(t){var r=n.pc.pc.getSenders().map(function(e){return e.track}),i=e.getTracks(),o=u["default"].Difference(r,i),a=u["default"].Difference(i,r);if(o.forEach(function(e){var t=n.pc.pc.getSenders().find(function(t){return t.track.id===e.id});t&&n.pc.pc.removeTrack(t)}),a.forEach(function(t){n.pc.pc.addTrack(t,e)}),u["default"].IsEmpty(a)&&u["default"].IsEmpty(o))return t();var s=u["default"].Copy(n.pc.remoteDescription);n.pc.handleOffer({type:"offer",jingle:s},function(e){return e?(n._log("error","Could not process offer for renegotiating stream"),t(e)):void n.pc.answer(n.constraints,function(e,r){if(e)return n._log("error","Could not create answer for renegotiating stream"),t(e);var i=function(e,t){return t.filter(function(t){var n=t.parameters.find(function(e){return"label"===e.key});return!("undefined"==typeof n)&&e.indexOf(n.value)>-1})};if(u["default"].IsNotEmpty(o)){var s=o.map(function(e){return e.id}),c=u["default"].Copy(n._answerJingle);c.contents.forEach(function(e){e.application.sources=i(s,e.application.sources)}),n._helpers.adjustContentJingle(c),n.send("content-remove",c)}if(u["default"].IsNotEmpty(a)){n._answerJingle=u["default"].Copy(r.jingle);var l=a.map(function(e){return e.id}),d=u["default"].Copy(n._answerJingle);d.contents.forEach(function(e){e.application.sources=i(l,e.application.sources)}),n._helpers.adjustContentJingle(d),n.send("content-add",d),n._helpers.adjustSourceAttributes(r.jingle),n.send("content-modify",r.jingle)}return t(null,r.jingle)})})},t)},e.prototype.UpdateLocalStream=function(e,t,n){void 0===n&&(n=!0);var r=this;this._log("info","Updating local stream"),this.pushToQueue(function(t){r.pc.handleOffer({type:"offer",jingle:u["default"].Copy(r.pc.remoteDescription)},function(i){return i?(r._log("error","Could not process offer for updating stream"),t(i)):(r._rtcPeerConnectionHelper.Options=u["default"].Merge({},r._rtcPeerConnectionHelper.Options,e),void r.pc.answer(r.constraints,function(e,i){return e?(r._log("error","Could not create answer for updating stream"),t(e)):(r._helpers.fixProtocolNameCase(i.jingle),r._helpers.adjustSourceAttributes(i.jingle),n===!0&&r.send("content-modify",i.jingle),t())}))})},t)},e}();n.JingleMediaSession=l;var d=function(){function e(e){this._contentAdjustor=new o.JingleContentAdjustor(e)}return e.prototype.prepareSourcesForMerging=function(e){var t={};e.contents.forEach(function(e){t[e.name]?(t[e.name].application.sources?(n=t[e.name].application.sources).push.apply(n,u["default"].Copy(e.application.sources)):t[e.name].application.sources=u["default"].Copy(e.application.sources),t[e.name].application.sourceGroups?(r=t[e.name].application.sourceGroups).push.apply(r,u["default"].Copy(e.application.sourceGroups)):t[e.name].application.sourceGroups=u["default"].Copy(e.application.sourceGroups)):t[e.name]=u["default"].Copy(e);var n,r}),e.contents=Object.values(t)},e.prototype.mergeSources=function(e,t){var n=this;e.contents.forEach(function(r,i){var o=r.application.sources||[],a=r.application.sourceGroups||[];t.contents.forEach(function(t){if(r.name===t.name){var s=t.application.sources||[];if(s.length>0){var c=s[0].parameters[1].value.split(" ")[0];o=o.filter(function(e){return c!==e.parameters[1].value.split(" ")[0]})}s.forEach(function(e){var t=o.some(function(t){return t.ssrc===e.ssrc});t||o.push(e)}),e.contents[i].application.sources=JSON.parse(JSON.stringify(o));var u=t.application.sourceGroups||[];u.forEach(function(e){var t=a.some(function(t){return t.sources.length===e.sources.length&&t.sources.reduce(function(t,n,r){return t||n===e.sources[r]},!1)});t||a.push(e)}),e.contents[i].application.sourceGroups=JSON.parse(JSON.stringify(a)),n.filterOutUnusedGroups(e.contents[i])}})})},e.prototype.filterOutUnusedGroups=function(e){e.application.sourceGroups&&(e.application.sourceGroups=e.application.sourceGroups.filter(function(t){var n=!0;return t.sources.forEach(function(t){var r=e.application.sources.some(function(e){return e.ssrc===t});n=n&&r}),n}))},e.prototype.filterContentSources=function(e){"rtp"===e.application.applicationType&&(delete e.transport,delete e.application.payloads,delete e.application.headerExtensions,e.application.mux=!1,this.filterOutUnusedGroups(e))},e.prototype.fixProtocolNameCase=function(e){e.contents.forEach(function(e){e.transport.candidates.forEach(function(e){e.protocol=e.protocol.toUpperCase()})})},e.prototype.adjustSourceAttributes=function(e){var t=this;e.contents.forEach(function(e){var n={};e.application.sources.forEach(function(i){var o=i.parameters.find(function(e){return"label"===e.key});if(o=o?o.value:"",n[o])n[o].ssrcs.push({id:i.ssrc});else{i.name=i.ssrc;var a=i.parameters.find(function(e){return"cname"===e.key});i.cname=a?a.value:"",e.application.media===s.MediaTrackType.Video&&(i.content=t.GetLocalStreamMediaType(o)===s.MediaTrackType.Application?r.NonInteractiveVideo:r.InteractiveVideo),e.application.media===s.MediaTrackType.Audio&&(i.content=r.InteractiveAudio),i.parameters=[],i.ssrcs=[{id:i.ssrc}],i.ssrc=void 0,n[o]=i}}),e.application.sources=Object.entries(n).map(function(e){return e[1]}),t._contentAdjustor.AdjustOutboundJingleContents(e),e.transport=e.transport||{transportType:"iceUdp"},e.application.ssrc=void 0})},e.prototype.filterUnusedLabels=function(e){var t=e.application.sources||[];t.forEach(function(e){e.parameters=e.parameters.filter(function(e){return!("mslabel"===e.key||"label"===e.key)})})},e.prototype.adjustContentJingle=function(e){var t=this;this.fixProtocolNameCase(e),e.contents.forEach(function(e){t.filterContentSources(e)}),e.contents=e.contents.filter(function(e){return"rtp"===e.application.applicationType&&e.application.sources&&e.application.sources.length}),delete e.groups,this.adjustSourceAttributes(e)},e.prototype.adjustCName=function(e,t,n){for(var r=function(t){if(t.application.sources&&t.application.sources.length>0){var r=e.getTracks().filter(function(e){return e.kind===t.application.media});r&&r.length>0&&(n&&(r=r.filter(function(e){return n.includes(e.id)})),r&&r.length>0&&(t.application.sources[0].cname=r[0].label))}},i=0,o=t.contents;i<o.length;i++){var a=o[i];r(a)}},e}()},{"../../SimplifiedVidyoCore":341,"../../utils/ObjectUtils":435,"./JingleContentAdjustor":451,"./RtcPeerConnection":454,async:2,uuid:310}],453:[function(e,t,n){"use strict";function r(e){var t=e;return t.utils.addValidation=function(e,t){return{get:e.get,set:function(n){t(n),e.set&&e.set.bind(this,n)()}}},t.utils.multiNumberSub=function(e,n){var r=t.utils.multiTextSub(e,n);return{get:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.get.bind(this,e)(),i=10;return n.map(function(e){return parseInt(e,i)})},set:r.set}},t.utils.speciallyParsedAttribute=function(e,n){var r=t.utils.attribute(e);return{get:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=r.get.bind(this,e)();return n(i)},set:r.set}},t.utils.stringAsBoolAttribute=function(e){var n=t.utils.attribute(e);return{get:function(){if(n.get){var e=n.get.bind(this)();return"true"===e}return!1},set:function(e){var t=e?"true":"false";n.set&&n.set.bind(this,t)()}}},t}Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendJXT=r},{}],454:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("sdp-jingle-json"),i=e("../../utils/ObjectUtils"),o=function(){function e(e){this._helper=e}return e.prototype._answer=function(e,t){t=t||function(){};var n=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");return"closed"===this.pc.signalingState?t("Already closed"):void n.pc.createAnswer(function(e){var o=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});n._helper.CorrectCodecs(o)&&(e.sdp=r.toSessionSDP(o,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}));var a=[];if(n.enableChromeNativeSimulcast&&(e.jingle=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name)){var s=e.jingle.contents[1].application.sourceGroups||[],c=!1;if(s.forEach(function(e){"SIM"===e.semantics&&(c=!0)}),!c&&e.jingle.contents[1].application.sources.length){var u=JSON.parse(JSON.stringify(e.jingle.contents[1].application.sources[0]));u.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(u),a.push(e.jingle.contents[1].application.sources[0].ssrc),a.push(u.ssrc),s.push({semantics:"SIM",sources:a});var l=JSON.parse(JSON.stringify(u));l.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(l),s.push({semantics:"FID",sources:[u.ssrc,l.ssrc]}),e.jingle.contents[1].application.sourceGroups=s,e.sdp=r.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"})}}var d={type:"answer",sdp:e.sdp,jingle:void 0};if(n.assumeSetLocalSuccess){var p=i["default"].Copy(d);n.emit("answer",p),t(null,p)}n._candidateBuffer=[],n._helper.Log.LogVerbose("SDP Answer sent to the Reflector"),n._helper.Log.LogVerbose(e.sdp),n._helper.Log.LogVerbose("Jingle Answer sent to the Reflector");var f=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});n._helper.Log.LogVerbose(f),n.pc.setLocalDescription(e,function(){if(n.config.useJingle){var o=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});o.sid=n.config.sid,n.localDescription=o,d.jingle=o}if(n.enableChromeNativeSimulcast&&(d.jingle||(d.jingle=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})),d.jingle.contents[1].application.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),d.sdp=r.toSessionSDP(d.jingle,{sid:n.sdpSessionID,role:n._role(),direction:"outgoing"})),d.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),!n.assumeSetLocalSuccess){var a=i["default"].Copy(d);n.emit("answer",a),t(null,a)}},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},e)},e.prototype.handleOffer=function(e,t){t=t||function(){};var n=this;if(e.type="offer",e.jingle){if(n._helper.Options.addGoogleConferenceFlag&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.application.googConferenceFlag=!0)}),e.jingle.contents.forEach(function(e){var t=e.application.sources||[];(0===t.length||"3735928559"!==t[0].ssrc)&&(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"a"},{key:"msid",value:"b c"}]}),e.application.sources=t)}),n.restrictBandwidth>0&&e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name){var i=e.jingle.contents[1],o=i.application&&i.application.bandwidth&&i.application.bandwidth.bandwidth;o||(e.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:n.restrictBandwidth.toString()},e.sdp=r.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}))}e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),e.sdp=r.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n._helper.Log.LogVerbose("SDP Offer received from Reflector"),n._helper.Log.LogVerbose(e.sdp),n._helper.Log.LogVerbose("Jingle Offer received from the Reflector"),n._helper.Log.LogVerbose(e.jingle),n.remoteDescription=e.jingle}e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n._helper.MangleOffer(e),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){t()},t)},e.prototype.offer=function(e,t){var n=this,i=2===arguments.length,o=i&&e?e:{offerToReceiveAudio:!0,offerToReceiveVideo:!0};return t=i?t:e,t=t||function(){},"closed"===this.pc.signalingState?t("Already closed"):void this.pc.createOffer(function(e){var i={type:"offer",sdp:e.sdp,jingle:void 0};n.assumeSetLocalSuccess&&(n.emit("offer",i),t(null,i)),n._candidateBuffer=[],n._helper.Log.LogVerbose("SDP Offer generated by the client"),n._helper.Log.LogVerbose(e.sdp),n.pc.setLocalDescription(e,function(){if(n.config.useJingle){var o=r.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});o.sid=n.config.sid,n.localDescription=o,o.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),i.jingle=o}i.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("offer",i),t(null,i))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},o)},e}();n.RtcPeerConnection=o},{"../../utils/ObjectUtils":435,"sdp-jingle-json":225}],455:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../utils/ObjectUtils"),i=function(){function e(e){this.Log=e,this.Options={}}return e.prototype.CacheCodecList=function(e){var t=this;e&&e.contents&&e.contents.forEach(function(e){"video"===e.name&&e.application&&(t._cachedVideoPayloads=r["default"].Copy(e.application.payloads)),"audio"===e.name&&e.application&&(t._cachedAudioPayloads=r["default"].Copy(e.application.payloads))})},e.prototype.CorrectCodecs=function(e){var t=this,n=!1;return(this._cachedAudioPayloads||this._cachedVideoPayloads)&&e&&e.contents&&e.contents.forEach(function(e){"video"===e.name&&e.application&&t._cachedVideoPayloads&&(e.application.payloads=r["default"].Copy(t._cachedVideoPayloads),n=!0),"audio"===e.name&&e.application&&t._cachedAudioPayloads&&(e.application.payloads=r["default"].Copy(t._cachedAudioPayloads),n=!0)}),n},e.prototype.MangleOffer=function(e){this._addBandwidthAttribute(e),this._addTemporalScalabilityAttribute(e)},e.prototype._addBandwidthAttribute=function(e){this.Options.bandwidth&&(e.sdp=e.sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+this.Options.bandwidth+"\r\n"))},e.prototype._addTemporalScalabilityAttribute=function(e){this.Options.addGoogleConferenceFlag&&(e.sdp=e.sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\na=x-google-flag:conference\r\n"))},e}();n.RtcPeerConnectionHelper=i},{"../../utils/ObjectUtils":435}],456:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../events/ConferenceEvents"),i=e("../../events/ConnectionEvents"),o=e("../../utils/Constants"),a=e("../../utils/Errors"),s=e("jingle-media-session"),c=e("../../utils/Messages"),u=e("stanza.io"),l=e("../../utils/PromiseHelper"),d=e("../../events/AdvancedSettingsEvents"),p=e("../../events/LogEvents"),f=e("./JingleMediaSession"),h=e("./xmpp_plugins/Plugins"),m=e("es6-promise"),v=e("./RtcPeerConnectionHelper"),g=e("../../utils/ObjectUtils"),y=e("../XmppBase"),_=e("../../events/ConnectionEvents"),S=e("../../events/ConnectionEvents"),b=e("../../../vidyo_connector_api/VidyoConnector"),C=e("../../models/VideoResolution"),w=function(){function e(e,t,n){this._eventDispatcher=e,this._simplifiedVidyoCore=t,this._logger=n,this._operationTimeouts=[],this._xmppMessageLogging=!1,this._rtcPeerConnectionHelper=new v.RtcPeerConnectionHelper(this._simplifiedVidyoCore.Log),s.Extend(new f.JingleMediaSession(this._rtcPeerConnectionHelper,this._simplifiedVidyoCore)),this._mapEventDispatcherEvents()}return e.prototype.AddStream=function(e,t){var n=this,r=new m.Promise(function(t,r){n._session.AddStream(e,!0,function(n,i){if(n)r(n);else if(i){var o={},a=e.getTracks();a.forEach(function(e){i.contents.forEach(function(t){t.application&&t.application.media===e.kind&&t.application.sources.forEach(function(t){o[t.name]=e.id})})}),t({trackIdsBySsrc:o})}})});return l.ApplyTimeout(r,this._timeOut(function(){}))["catch"](function(e){throw n._mapError(e)})},e.prototype.ConferenceJoin=function(e,t){return this._client.CmcpCommands.ConferenceJoin(e,t)},e.prototype.ConferenceLeave=function(e,t){return this._client.CmcpCommands.ConferenceLeave(e,t)},e.prototype.ConferenceShow=function(e,t){return this._client.CmcpCommands.ConferenceShow(e,t)},e.prototype.ConferenceShowSelected=function(e,t){return this._client.CmcpCommands.ConferenceShowSelected(e,t)},e.prototype.ConferenceUpdate=function(e,t){return this._client.CmcpCommands.ConferenceUpdate(e,t)},e.prototype.Connect=function(){this._client.connect()},e.prototype.CreateClient=function(e){var t=g["default"].Merge({},{credentials:e.credentials,server:e.host,wsURL:e.websocketHost,sasl:e.saslMechanisms,sendReceipts:e.sendReceipts,transports:e.transports,timeout:o.AtomicTimeOut});this._client=u.createClient(t),this._addForceDisconnect(),this._addIqSendingErrorChecker(),this._addTransportErrorChecker(),this._client.jingle.config.peerConnectionConfig.iceServers=[],this._client.jingle.iceServers=[],window["client"+Math.floor(10*Math.random())]=this._client,this._mapEvents(),this._loadPlugins()},e.prototype.Disconnect=function(){for(var e=0,t=this._operationTimeouts;e<t.length;e++){var n=t[e];if(0!==n.timeoutRef){if(clearTimeout(n.timeoutRef),n.cleanUp)try{n.cleanUp()}catch(r){this._logger.LogError("StanzaXmppProvider::Disconnect: operationTimeouts cleanUp error: "+r)}n.timeoutRef=0}}this.IsXMPPSessionAlive()&&this._client.jingle.endAllSessions(),this._client&&this._client.disconnect()},e.prototype.Domain=function(){return this._client.jid.domain},e.prototype.FinalizeMedia=function(e){this._client.LmiXmppMucMediaStop(e)},e.prototype.GetDiscoInfo=function(e){var t=this;return this._client.getDiscoInfo(e)["catch"](function(e){throw t._mapError(e)})},e.prototype.IsXMPPSessionAlive=function(){return this._client&&this._client.sessionStarted&&this._client.transport&&this._client.transport.closing!==!0&&this._client.transport.conn&&1===this._client.transport.conn.readyState},e.prototype.Jid=function(){return this._client.jid},e.prototype.JoinRoom=function(e){var t=this,n=e.id||this._client.nextId(),r=new m.Promise(function(r,i){t._client.on("muc:join",n,function(t){t.from.bare.toLowerCase()===e.jid.toLowerCase()&&t.from.resource===e.user&&r({roomJid:t.from.bare})}),t._client.joinRoom(e.jid,e.user,{id:n,joinMuc:{history:{maxstanzas:e.maxStanzas||"0"}}})});return l.ApplyTimeout(r,this._timeOut(function(){t._client.releaseGroup(n)}))["catch"](function(e){throw t._mapError(e)})},e.prototype.LeaveRoom=function(e){var t=this,n=e.id||this._client.nextId(),r=new m.Promise(function(r,i){t._client.on("muc:leave",n,function(t){t.from.bare.toLowerCase()===e.jid.toLowerCase()&&t.from.resource===e.user&&r({roomJid:t.from.bare})}),t._client.leaveRoom(e.jid,e.user)});return l.ApplyTimeout(r,this._timeOut(function(){t._client.releaseGroup(n)}))["catch"](function(e){throw t._mapError(e)})},e.prototype.MediaStart=function(e){this._client.LmiXmppMucMediaStart(e.jid,e.start)},e.prototype.RemoveStream=function(e){var t=this,n=e.id,r=new m.Promise(function(r,i){var o;t._session.On("send",n,function(e){e.jingle&&"content-modify"===e.jingle.action&&(o=e.id)}),t._session.RemoveStream(e,!0,function(e,a){e?i(e):a?t._client.on("iq:*",n,function(e,t){if(t&&t.id===o&&"result"===t.type){var n=[];a.contents.forEach(function(e){e.application&&e.application.sources.forEach(function(e){n.push(e.name)})}),r({ssrcs:n})}}):r({ssrc:[]})})});return l.ApplyTimeout(r,this._timeOut(function(){t._client.releaseGroup(n),t._session.ReleaseGroup(n)}))["catch"](function(e){throw t._mapError(e)})},e.prototype.SendClientStats=function(e,t){this.IsXMPPSessionAlive()&&this._client.LmiXmppComponentMessageNotify(e,"client_stats",t)},e.prototype.SendPresence=function(e){this._client.sendPresence({to:e.to,ident:{name:e.idName,version:e.idVersion},props:{loc:e.location,name:e.displayName},x:{history:{maxStanzas:e.maxStanzas}}})},e.prototype.SendTokenQuery=function(){var e=this,t=this._client.nextId();return this._client.LmiXmppTokenAuthQuery().then(function(){var n=new m.Promise(function(n,r){e._client.on("iq:get:lmiXmppTokenAuthItems",t,function(e){n({accessToken:e.items.access_token,refreshToken:e.items.refresh_token})})});return l.ApplyTimeout(n,e._timeOut(function(){e._client.releaseGroup(t)}))})["catch"](function(t){throw e._mapError(t)})},e.prototype.SetRoomSubject=function(e,t){var n=this,r=this._client.nextId(),i=new m.Promise(function(i,o){n._client.on("muc:subject",r,function(e){e.id===r&&i(void 0)}),n._client.setSubject(e,t)});return l.ApplyTimeout(i,this._timeOut(function(){n._client.releaseGroup(r)}))["catch"](function(e){throw n._mapError(e)})},e.prototype.StartMediaSession=function(e){var t=this,n=this._client.nextId(),r=new m.Promise(function(r,i){e.iceServer&&t._client.jingle.addICEServer(e.iceServer);var o="";t._client.on("iq:set:*",n,function(e,t){t.jingle&&t.jingle.sid===n&&"session-accept"===t.jingle.action&&(o=t.id)});var a=null;t._client.on("jingle:accepted",n,function(e){e&&e.sid===n&&(a=t._mapMediaSession(e))}),t._client.on("raw:outgoing",n,function(e){"string"==typeof e&&a&&e.match('<iq xmlns="jabber:client')&&e.match('id="'+o+'"')&&e.match('type="result"')&&r(a)}),t._rtcPeerConnectionHelper.Options.addGoogleConferenceFlag=e.addGoogleConferenceFlag,e.enableSimulcast&&t._client.jingle.config.peerConnectionConstraints.optional.push({enableChromeNativeSimulcast:!0});var s=t._client.jingle.createMediaSession(e.jid,n);s.on("mediaSessionEnded",function(e){t._onMediaSessionEnded(e)}),s.GetLocalStreamMediaType&&s.GetLocalStreamMediaType(function(e){return t._simplifiedVidyoCore.GetLocalStreamMediaType(e)}),e.stream&&s.addStream(e.stream,!0),s.start({displayName:e.displayName,initialBandwidth:C.GetStdOutgoingBandwidth(e.preferredCodec,!0)})});return l.ApplyTimeout(r,this._timeOut(function(){t._client.releaseGroup(n)})).then(function(e){return t._session=e,e})["catch"](function(e){throw e instanceof Error&&"timeout"===e.message&&(e.message=c.CouldNotGetResponseFromMUC),t._mapError(e)})},e.prototype.Subscribe=function(e,t){return this._client.CmcpCommands.Subscribe(e,t)},e.prototype.Unsubscribe=function(e,t){return this._client.CmcpCommands.Unsubscribe(e,t)},e.prototype.UpdateLocalStream=function(e,t){var n=this;void 0===t&&(t=!0);var r=new m.Promise(function(r,i){n._session.UpdateLocalStream(e,function(e){e?i(e):r()},t)});return l.ApplyTimeout(r,this._timeOut(function(){}))["catch"](function(e){throw n._mapError(e)})},e.prototype.UpdateStreamTracks=function(e){this._session&&this._session.UpdateStreamTracks(e)},e.prototype._addForceDisconnect=function(){this._client.__disconnect=this._client.disconnect,this._client.disconnect=function(){var e=this;this.__disconnect(),setTimeout(function(){e.transport&&e.transport.closing===!0&&e.transport.conn&&1===e.transport.conn.readyState&&e.transport.conn.close()},o.AtomicTimeOut)}.bind(this._client)},e.prototype._addIqSendingErrorChecker=function(){this._client.__sendIq=this._client.sendIq,this._client.sendIq=function(e,t){var n=this,r=this.__sendIq(e,t);return m.Promise.all([r])["catch"](function(){n.emit("stanza",{type:"error",action:"iq-sending-error",data:e})}),r}.bind(this._client)},e.prototype._addTransportErrorChecker=function(){var e=this._client.connect;this._client.connect=function(t,n){e.call(this,t,n);var r=this.transport;r.__conn_onerror=r.conn.onerror,r.conn.onerror=function(e){r._transportCloseEventCode=y.CloseEventCode.AbnormalClosure,r.__conn_onerror(e)}.bind(this.transport.conn),r.__conn_onclose=r.conn.onclose,r.conn.onclose=function(e){r._transportCloseEventCode=e.code?e.code:y.CloseEventCode.NoStatusProvided,r.__conn_onclose(e)}.bind(this.transport.conn)}.bind(this._client)},e.prototype._disableXMPPMessageLogging=function(){this._xmppMessageLogging=!1},e.prototype._enableXMPPMessageLogging=function(){this._xmppMessageLogging=!0},e.prototype._loadPlugins=function(){var e=this;h.Plugins.forEach(function(t){return e._client.use(t)})},e.prototype._mapError=function(e){return e instanceof Error?e:"timeout"===e.error.condition?new a.TimeOutError(e.error.condition):new Error(e.error.condition)},e.prototype._mapEventDispatcherEvents=function(){var e=this;this._eventDispatcher.on(d.Events.EnableXMPPMessageLoggingChanged,function(t){t?e._enableXMPPMessageLogging():e._disableXMPPMessageLogging()})},e.prototype._mapEvents=function(){var e=this;this._client.on("*",function(t,n){if(e._xmppMessageLogging){var r={name:t,data:n};if("string"==typeof r.data){var i=e._client.stanzas.parse(r.data);r.data=r.data+"\n"+JSON.stringify(i,null,"  ")}e._eventDispatcher.emit(p.Events.XMPPMessage,r)}}),this._client.on("presence",function(t){t&&"unavailable"===t.type&&(e._logger.LogInfo('StanzaXmppProvider: on presence = "'+(t?JSON.stringify(t):"")+'"'),e._eventDispatcher.emit(r.Events.SelectedParticipantUnavailable,{id:t.from.resource}))}),this._client.on("available",function(t){var n=t.muc?t.muc.jid.full:t.from.full;e._eventDispatcher.emit(i.Events.Available,{jid:n})}),this._client.on("stream:end",function(t){e._logger.LogInfo("StanzaXmppProvider: on stream:end"),e._client.jingle.endAllSessions(),e._eventDispatcher.emit(i.Events.SignallingDisconnected,_.ConnectionEventsInfo.Disconnected)}),this._client.on("stream:error",function(t){e._logger.LogError("StanzaXmppProvider: on stream:error"),e._client.jingle.endAllSessions(),e._eventDispatcher.emit(i.Events.SignallingError,_.ConnectionEventsInfo.SignallingError)}),this._client.on("stream:data",function(t){if(t&&t.xml&&t.xml.name)switch(t.xml.name){case"error":var n=t.xml.getChild("text");e._logger.LogError("StanzaXmppProvider: on Error"+(n?' - "'+n.textContent+'"':".")),t&&!t.closing&&e.IsXMPPSessionAlive()&&e._client.jingle.endAllSessions();var r=_.ConnectionEventsInfo.SignallingError;n.textContent&&(r=new S.VidyoEventInfo("SignallingError",b.VidyoConnectorDisconnectReason.MiscError,n.textContent,"error")),e._eventDispatcher.emit(i.Events.SignallingError,r)}}),this._client.on("disconnected",function(t){e._logger.LogInfo("StanzaXmppProvider: on disconnected"),
t&&!t.closing&&e._client.jingle.endAllSessions(),t&&t._transportCloseEventCode&&t._transportCloseEventCode!==y.CloseEventCode.NormalClosure&&t._transportCloseEventCode!==y.CloseEventCode.NoStatusProvided?e._eventDispatcher.emit(i.Events.SignallingDisconnected,_.ConnectionEventsInfo.SignallingTransportError):e._eventDispatcher.emit(i.Events.SignallingDisconnected,_.ConnectionEventsInfo.Disconnected)}),this._client.on("stanza",function(t){t&&"error"===t.type&&t.jingle&&"session-terminate"===t.jingle.action&&"failed-transport"===t.jingle.reason.condition&&e._eventDispatcher.emit(i.Events.SignallingDisconnected,_.ConnectionEventsInfo.SignallingTransportError),t&&"error"===t.type&&"iq-sending-error"===t.action&&(e.IsXMPPSessionAlive()?(e._logger.LogInfo(new Date+"  XMPP IQ Sending error"),e._logger.LogVerbose(new Date+"  XMPP IQ Sending error: "+JSON.stringify(t)),e._eventDispatcher.emit(i.Events.IqSendingError,t)):e._logger.LogVerbose(new Date+"  XMPP IQ: trying to send/or_receive_confirmation IQ while XMPP session is not alive: "+JSON.stringify(t)))}),this._client.on("iq:set:conference",function(t){e._eventDispatcher.emit(i.Events.LmiXmppMucMediaConf,t.conference)}),this._client.on("iq:set:lmiCmcpConferenceAccept",function(t){e._eventDispatcher.emit(r.Events.ConferenceAccepted.Scoped(t.dialogId.remote),t)}),this._client.on("iq:set:lmiCmcpConferenceReject",function(t){e._eventDispatcher.emit(r.Events.ConferenceRejected.Scoped(t.dialogId.remote),t)}),this._client.on("iq:set:lmiCmcpNotifyParticipant",function(t){e._eventDispatcher.emit(r.Events.NotifyParticipant.Scoped(t.dialogId.remote),t)}),this._client.on("iq:set:lmiCmcpNotifySelectedParticipant",function(t){e._eventDispatcher.emit(r.Events.NotifySelectedParticipant.Scoped(t.dialogId.remote),t)}),this._client.on("iq:result:lmiCmcpReply",function(t){e._eventDispatcher.emit(r.Events.Reply.Scoped(t.dialogId.local),t)}),this._client.on("jingle:error",function(t){var n=e._client.CmcpCommands.CheckSubscribeHistory(t.id);n&&"timeout"===t.error.condition&&e._eventDispatcher.emit(r.Events.SubscribeTimeout.Scoped(n.LocalId),{dialogId:{local:n.LocalId}})}),this._client.on("iq:set:lmiJingleSourceView",function(t){e._eventDispatcher.emit(i.Events.JingleSourceView,t.jingle.view)}),this._client.on("jingle:accepted",function(t){e._eventDispatcher.emit(i.Events.JingleAccepted,e._mapMediaSession(t))}),this._client.on("jingle:remotestream:added",function(t,n){e._eventDispatcher.emit(i.Events.JingleRemoteStreamAdded,{stream:n})}),this._client.on("jingle:remotestream:removed",function(t,n){e._eventDispatcher.emit(i.Events.JingleRemoteStreamRemoved,{stream:n})}),this._client.on("session:started",function(t){e._eventDispatcher.emit(i.Events.Connected,t)})},e.prototype._mapMediaSession=function(e){var t={sid:e.sid,Accept:function(){e.accept()},AddStream:function(t,n,r){e.addStream(t,n,r)},GetStats:function(){return new m.Promise(function(t){e.pc.getStats(function(e,n){return t(n)})})},MuteAudio:function(t){e.muteAudio(t)},On:function(t,n,r){e.on(t,n,r)},ReleaseGroup:function(t){e.releaseGroup(t)},RemoveStream:function(t,n,r){e.removeStream(t,n,r)},State:function(){return e._connectionState},UpdateLocalStream:function(t,n,r){void 0===r&&(r=!0),e.UpdateLocalStream(t,n,r)},UpdateStreamTracks:function(t){return e.UpdateStreamTracks(t)}};return t},e.prototype._onMediaSessionEnded=function(e){switch(e){case"failed-application":this._eventDispatcher.emit(i.Events.MediaSessionFailed,_.ConnectionEventsInfo.MediaSessionError);break;case"failed-transport":this._eventDispatcher.emit(i.Events.MediaSessionFailed,_.ConnectionEventsInfo.MediaSessionTransportError);break;default:this._eventDispatcher.emit(i.Events.MediaSessionEnded,_.ConnectionEventsInfo.MediaSessionEnded)}},e.prototype._timeOut=function(e){var t=new l.PromiseTimeout((o.BatchTimeOut||this._client.config.timeout)*o.SecToMsCoefficient,e);return this._operationTimeouts.push(t),t},e}();n.StanzaXmppProvider=w},{"../../../vidyo_connector_api/VidyoConnector":486,"../../events/AdvancedSettingsEvents":367,"../../events/ConferenceEvents":369,"../../events/ConnectionEvents":370,"../../events/LogEvents":373,"../../models/VideoResolution":389,"../../utils/Constants":426,"../../utils/Errors":427,"../../utils/Messages":432,"../../utils/ObjectUtils":435,"../../utils/PromiseHelper":438,"../XmppBase":449,"./JingleMediaSession":452,"./RtcPeerConnectionHelper":455,"./xmpp_plugins/Plugins":461,"es6-promise":31,"jingle-media-session":65,"stanza.io":240}],457:[function(e,t,n){"use strict";function r(e,t){function n(e,t){"audio"===t.type&&delete t.secondaryId;var n=[],r=e,i=t.idStr;[t.id,t.secondaryId].forEach(function(e){e&&n.push({ssrc:e.toString(),parameters:[{key:"cname",value:t.name},{key:"msid",value:r+" "+i},{key:"mslabel",value:r},{key:"label",value:i}]})});var o=[];return t.secondaryId&&o.push({semantics:"FID",sources:[t.id.toString(),t.secondaryId.toString()]}),{creator:"initiator",disposition:"session",name:t.type,senders:"both",application:{ssrc:t.id.toString(),applicationType:"rtp",media:t.type,sources:n,sourceGroups:o},transport:{transportType:"iceUdp"}}}function r(t){var n=Object.keys(e.jingle.sessions)[0],r=e.jingle.sessions[n].pc.remoteDescription.contents;return r.forEach(function(e){e.application.sources=e.application.sources.filter(function(e){return!e.parameters.some(function(e){return"mslabel"===e.key&&e.value===t})}),e.application.sourceGroups=e.application.sourceGroups.filter(function(t){return t.sources.some(function(t){return e.application.sources.some(function(e){return e.ssrc===t.toString()})})})}),r}function s(t,n,r){var i={from:t,jingle:{sid:Object.keys(e.jingle.sessions)[0],action:n,contents:r}};e.emit("iq:set:jingle",i)}var c=i.ExtendJXT(t),u=c.utils,l="http://www.vidyo.com/ns/LmiCmcp.xsd",d=c.define({name:"event",namespace:l,element:"event"}),p=c.define({name:"notify",namespace:l,element:"notify",fields:{resource:u.textSub(l,"resource"),"package":u.textSub(l,"package"),eTag:u.textSub(l,"eTag"),event:u.extension(d)}}),f=c.define({name:"conferenceLeave",namespace:l,element:"conferenceLeave",fields:{conference:u.textSub(l,"conference"),reason:u.numberSub(l,"reason")}}),h=c.define({name:"subscribe",namespace:l,element:"subscribe",fields:{"package":u.textSub(l,"package"),resource:u.textSub(l,"resource"),duration:u.numberSub(l,"duration"),suppressIfMatch:u.attribute("suppressIfMatch")}}),m=c.define({name:"unsubscribe",namespace:l,element:"unsubscribe",fields:{"package":u.textSub(l,"package"),resource:u.textSub(l,"resource")}}),v=c.define({name:"audio",namespace:l,element:"audio",fields:{count:u.numberSub(l,"count"),policy:u.textSub(l,"policy")}}),g=c.define({name:"generation",namespace:l,element:"generation",fields:{id:u.numberAttribute("id"),state:u.attribute("state")}}),y={policy:u.speciallyParsedAttribute("policy",function(e){var t=e;return t}),dynamicViewPolicy:u.speciallyParsedAttribute("dynamicViewPolicy",function(e){var t=e;return t}),generation:u.multiExtension(g)},_=c.define({name:"video",namespace:l,element:"video",fields:y}),S=c.define({name:"application",namespace:l,element:"application",fields:y}),b=c.define({name:"conferenceShowSelected",namespace:l,element:"conferenceShowSelected",fields:{audio:u.extension(v),video:u.extension(_),application:u.extension(S)}}),C=c.define({name:"conferenceJoin",namespace:l,element:"conferenceJoin",fields:{gm:u.attribute("gm"),displayText:u.textSub(l,"displayText"),recording:u.boolAttribute("recording"),hidden:u.boolAttribute("hidden"),selectable:u.boolAttribute("selectable"),conference:u.textSub(l,"conference"),meshId:u.textSub(l,"meshId"),localConferenceId:u.textSub(l,"localConferenceId"),password:u.textSub(l,"password"),session:u.textSub(l,"session")}}),w=c.define({name:"conferenceShow",namespace:l,element:"conferenceShow",fields:{sourceId:u.numberSub(l,"sourceId"),state:u.textSub(l,"state")}}),E=c.define({name:"conferenceUpdate",namespace:l,element:"conferenceUpdate",fields:{recording:u.boolAttribute("recording"),hidden:u.boolAttribute("hidden"),selectable:u.boolAttribute("selectable")}}),R=c.define({name:"command",namespace:l,element:"command",fields:{conferenceAccept:u.boolSub(l,"conferenceAccept"),conferenceReject:u.boolSub(l,"conferenceReject")}});c.extend(R,p),c.extend(R,h),c.extend(R,m),c.extend(R,C),c.extend(R,f),c.extend(R,w),c.extend(R,E),c.extend(R,b);var P=5,x=c.define({name:"commands",namespace:l,element:"commands",fields:{from:u.jidSub(l,"from"),atomic:u.boolAttribute("atomic"),command:u.extension(R),version:u.numberAttribute("version",!1,P)}}),T=c.define({name:"reply",namespace:l,element:"reply",fields:{result:u.attribute("result"),errorInfo:u.textSub(l,"errorInfo")}}),L=c.define({name:"replies",namespace:l,element:"replies",fields:{version:u.numberAttribute("version"),from:u.jidSub(l,"from")}});c.withDefinition("replies",l,function(e){c.extend(e,T,"replies")}),c.withIQ(function(e){c.extend(e,x),c.extend(e,L)}),e.CmcpCommands=new o.CmcpCommands(e),e.on("iq:set:commands",function(t){if(a.IsCmcpIq(t)){if(e.CmcpCommands.ResultReply(t,"200"),t.commands.command.conferenceAccept){var i={dialogId:t.commands.command.dialogId,conferenceAccept:!0};e.emit("iq:set:lmiCmcpConferenceAccept",i)}if(t.commands.command.conferenceReject){var i={dialogId:t.commands.command.dialogId,conferenceReject:!0};e.emit("iq:set:lmiCmcpConferenceReject",i)}if(t.commands.command.notify){var i={dialogId:t.commands.command.dialogId,notify:t.commands.command.notify};e.emit("iq:set:lmiCmcpNotifySelectedParticipant",i)}if(t.commands.command.notify){var i={dialogId:t.commands.command.dialogId,notify:t.commands.command.notify};e.emit("iq:set:lmiCmcpNotifyParticipant",i),i&&i.notify&&i.notify.event&&i.notify.event.participantPackageContent&&i.notify.event.participantPackageContent.participants&&i.notify.event.participantPackageContent.participants.forEach(function(e){if(e.sources){var i=[];e.sources.forEach(function(t){i.push(n(e.participantUri,t))}),s(t.from,"source-add",i)}else if("leave"===e.event){var o=[];o.push(r(e.participantUri)),s(t.from,"source-remove",o)}})}}}),e.on("iq:*",function(t,n){"iq:result:lmiCmcpReply"!==t&&a.IsCmcpReplyIq(n)&&n.replies.replies.forEach(function(t){e.emit("iq:result:lmiCmcpReply",t)})})}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../JxtExtension"),o=e("./LmiCmcp/CmcpCommands"),a=e("./LmiCmcp/CmcpTypes");n.LmiCmcp=r},{"../../JxtExtension":453,"./LmiCmcp/CmcpCommands":458,"./LmiCmcp/CmcpTypes":460}],458:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./CmcpMediaSource"),i=e("./CmcpTypes"),o=e("../../../../../utils/ObjectUtils"),a=function(){function e(e){this.ConferenceState=i.CmcpConferenceState,this.MediaSource=r.CmcpMediaSource,this._subscribeHistory={},this._client=e}return e.prototype.CheckSubscribeHistory=function(e){return this._subscribeHistory[e]},e.prototype.ConferenceJoin=function(e,t){var n={conference:e.Conference,localConferenceId:e.Conference,session:e.Session};return n=o["default"].Merge(n,t),this._sendCmcpIq(e,{conferenceJoin:n})},e.prototype.ConferenceLeave=function(e,t){return this._sendCmcpIq(e,{conferenceLeave:{conference:e.Conference,reason:t.reason}})},e.prototype.ConferenceShow=function(e,t){return this._sendCmcpIq(e,{conferenceShow:t})},e.prototype.ConferenceShowSelected=function(e,t){return this._sendCmcpIq(e,{conferenceShowSelected:t})},e.prototype.ConferenceUpdate=function(e,t){return this._sendCmcpIq(e,{conferenceUpdate:{recording:!!(t.conferenceState&i.CmcpConferenceState.Recording),hidden:!!(t.conferenceState&i.CmcpConferenceState.Hidden),selectable:!!(t.conferenceState&i.CmcpConferenceState.Selectable)}})},e.prototype.ErrorReply=function(e,t,n){return this._client.sendIq(e.errorReply(this._replyData(t,n)))},e.prototype.ResultReply=function(e,t){return this._client.sendIq(e.resultReply(this._replyData(t)))},e.prototype.Subscribe=function(e,t){var n={resource:e.Conference};n=o["default"].Merge(n,t);var r=this._sendCmcpIq(e,{subscribe:n},!0),i=r.promise,a=r.id;return this._subscribeHistory[a]=e,i},e.prototype.Unsubscribe=function(e,t){var n={resource:e.Conference};return n=o["default"].Merge(n,t),this._sendCmcpIq(e,{unsubscribe:n})},e.prototype._replyData=function(e,t){return{replies:{version:5,from:this._client.jid.full,reply:{result:e,errorInfo:t,dialogId:{local:10886,remote:2}}}}},e.prototype._sendCmcpIq=function(e,t,n){var r=this._client.nextId(),i={dialogId:{local:e.LocalId},id:r};e.RemoteId&&(i.dialogId.remote=e.RemoteId),Object.keys(t).forEach(function(e){i[e]=t[e]});var o=5,a=this._client.sendIq({from:this._client.jid.full,to:e.Reflector,type:"set",commands:{from:this._client.jid.full,command:i,version:o}});return n?{id:r,promise:a}:a},e}();n.CmcpCommands=a},{"../../../../../utils/ObjectUtils":435,"./CmcpMediaSource":459,"./CmcpTypes":460}],459:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e){switch(this.enabled=!0,e.Type){case"Camera":this.type="video";break;case"Microphone":this.type="audio";break;default:Error("Not suppported device type: "+e.Type+".")}this.ssrcMap={connId:1,ssrc:[1,2,3]};var t=10;if(this.id=parseInt(e.Id,t),this.idStr=e.Id,"video"===this.type){var n=567;this.secondaryId=n}else{var r=456;this.secondaryId=r}this.name=e.Name,this.label=e.Name}return e}();n.CmcpMediaSource=r},{}],460:[function(e,t,n){"use strict";function r(e){var t=e;return!(!t.commands||!t.commands.command)}function i(e){return!!(e.replies&&e.replies.replies&&e.replies.replies.length)}Object.defineProperty(n,"__esModule",{value:!0}),n.IsCmcpIq=r,n.IsCmcpReplyIq=i;var o;!function(e){e[e.Recording=1]="Recording",e[e.Hidden=2]="Hidden",e[e.Selectable=4]="Selectable"}(o=n.CmcpConferenceState||(n.CmcpConferenceState={}))},{}],461:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Cmcp/LmiCmcp"),i=e("./Signaling/LmiComponentProperties"),o=e("./Xmpp/jingle/LmiJingle"),a=e("./Xmpp/jingle/LmiJingleConfInfo"),s=e("./Xmpp/jingle/LmiJingleErrors"),c=e("./Xmpp/jingle/LmiJingleRtcpFeedback"),u=e("./Xmpp/jingle/LmiJingleRtp"),l=e("./Xmpp/jingle/LmiJingleRtpErrors"),d=e("./Xmpp/jingle/LmiJingleRtpHeaderExt"),p=e("./Xmpp/jingle/LmiJingleRtpInfo"),f=e("./Xmpp/jingle/LmiJingleSource"),h=e("./Xmpp/jingle/LmiJingleSourceView"),m=e("./Xmpp/jingle/LmiJingleTransport"),v=e("./Signaling/LmiParticipantPackage"),g=e("./Signaling/LmiProtocol"),y=e("./Signaling/LmiSelectedParticipantPackage"),_=e("./Xmpp/LmiXmppComponentMessage"),S=e("./Xmpp/LmiXmppMucMedia"),b=e("./Xmpp/LmiXmppTokenAuth");n.Plugins=[r.LmiCmcp,i.LmiComponentProperties,o.LmiJingle,a.LmiJingleConfInfo,s.LmiJingleErrors,c.LmiJingleRtcpFeedback,u.LmiJingleRtp,l.LmiJingleRtpErrors,d.LmiJingleRtpHeaderExt,p.LmiJingleRtpInfo,f.LmiJingleSource,h.LmiJingleSourceView,m.LmiJingleTransport,v.LmiParticipantPackage,g.LmiProtocol,y.LmiSelectedParticipantPackage,_.LmiXmppComponentMessage,S.LmiXmppMucMedia,b.LmiXmppTokenAuth]},{"./Cmcp/LmiCmcp":457,"./Signaling/LmiComponentProperties":462,"./Signaling/LmiParticipantPackage":463,"./Signaling/LmiProtocol":464,"./Signaling/LmiSelectedParticipantPackage":465,"./Xmpp/LmiXmppComponentMessage":466,"./Xmpp/LmiXmppMucMedia":467,"./Xmpp/LmiXmppTokenAuth":468,"./Xmpp/jingle/LmiJingle":469,"./Xmpp/jingle/LmiJingleConfInfo":470,"./Xmpp/jingle/LmiJingleErrors":471,"./Xmpp/jingle/LmiJingleRtcpFeedback":472,"./Xmpp/jingle/LmiJingleRtp":473,"./Xmpp/jingle/LmiJingleRtpErrors":474,"./Xmpp/jingle/LmiJingleRtpHeaderExt":475,"./Xmpp/jingle/LmiJingleRtpInfo":476,"./Xmpp/jingle/LmiJingleSource":477,"./Xmpp/jingle/LmiJingleSourceView":478,"./Xmpp/jingle/LmiJingleTransport":479}],462:[function(e,t,n){"use strict";function r(e,t){var n=i.ExtendJXT(t),r=n.utils,o="http://www.vidyo.com/ns/LmiProps.xsd",a=n.define({name:"x",namespace:"http://jabber.org/protocol/muc",element:"x",fields:{history:{set:function(e){var t=r.createElement(o,"history",o);this.xml.appendChild(t),t.setAttribute("maxstanzas",""+e.maxStanzas)}}}}),s=n.define({name:"props",namespace:o,element:"props",fields:{name:r.textSub(o,"name")}}),c=n.define({name:"loc",namespace:o,element:"loc",fields:{latitude:r.numberSub(o,"lat"),longitude:r.numberSub(o,"lon")}}),u=n.define({name:"ident",namespace:"jabber:client",element:"id",fields:{name:r.textSub("http://www.vidyo.com/ns/LmiProtocol.xsd","name"),version:r.textSub("http://www.vidyo.com/ns/LmiProtocol.xsd","version")}});n.extend(s,c),n.withPresence(function(e){n.extend(e,s),n.extend(e,a),n.extend(e,u)})}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../JxtExtension");n.LmiComponentProperties=r},{"../../JxtExtension":453}],463:[function(e,t,n){"use strict";function r(e,t){var n=i.ExtendJXT(t),r=n.utils,o="http://www.vidyo.com/ns/LmiParticipantPackage.xsd",a=n.define({name:"participant",namespace:o,element:"p",fields:{participantUri:r.textSub(o,"uri"),displayText:r.textSub(o,"dt"),duration:r.textSub(o,"dur"),confUri:r.textSub(o,"c"),event:r.textSub(o,"evt")}}),s=n.define({name:"participantPackageContent",namespace:o,element:"content",fields:{status:r.attribute("status"),participants:r.multiExtension(a)}});n.withDefinition("event","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,s)})}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../JxtExtension");n.LmiParticipantPackage=r},{"../../JxtExtension":453}],464:[function(e,t,n){"use strict";function r(e,t){var n=i.ExtendJXT(t),r=n.utils,o="http://www.vidyo.com/ns/LmiProtocol.xsd",a=n.define({name:"identity",namespace:o,element:"id",fields:{name:r.textSub(o,"name"),version:r.textSub(o,"version")}}),s=n.define({name:"dialogId",namespace:o,element:"dialogId",fields:{local:r.numberSub(o,"local"),remote:r.numberSub(o,"remote")}}),c=n.define({name:"ssrcMap",namespace:o,element:"ssrcMap",fields:{connId:r.numberAttribute("connId"),ssrc:r.multiNumberSub(o,"ssrc")}}),u=n.define({name:"source",namespace:"http://www.vidyo.com/ns/LmiParticipantPackage.xsd",element:"src",fields:{enabled:r.boolSub("http://www.vidyo.com/ns/LmiParticipantPackage.xsd","enabled"),type:r.attribute("type"),id:r.numberAttribute("id"),idStr:r.attribute("idStr"),secondaryId:r.numberAttribute("secondaryId"),name:r.attribute("name"),label:r.attribute("label"),ssrcMap:r.extension(c)}}),l={width:r.numberSub(o,"width"),height:r.numberSub(o,"height")},d=n.define({name:"windowSize",namespace:o,element:"windowSize",fields:l}),p=n.define({name:"minWindowSize",namespace:o,element:"minWindowSize",fields:l}),f=n.define({name:"params",namespace:o,element:"params",fields:{windowSize:r.extension(d),framesPerSec:r.numberSub(o,"framesPerSec"),pixelRate:r.numberSub(o,"pixelRate"),preference:r.numberSub(o,"preference"),bandwidth:r.numberSub(o,"bandwidth"),minWindowSize:r.extension(p),minFramesPerSec:r.numberSub(o,"minFramesPerSec"),minPixelRate:r.numberSub(o,"minPixelRate"),minBandwidth:r.numberSub(o,"minBandwidth"),temporalSpatialTradeoff:r.numberSub(o,"temporalSpatialTradeoff"),connectionId:r.numberSub(o,"connectionId")}});n.withDefinition("jingle","urn:xmpp:jingle:1",function(e){n.extend(e,a)}),n.withDefinition("p","http://www.vidyo.com/ns/LmiParticipantPackage.xsd",function(e){n.extend(e,a),n.extend(e,u,"sources")}),n.withDefinition("conferenceJoin","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,u,"sources")}),n.withDefinition("command","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,s)}),n.withDefinition("reply","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,s)}),n.withDefinition("generation","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,f)}),n.withDefinition("conferenceShow","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,f)})}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../JxtExtension");n.LmiProtocol=r},{"../../JxtExtension":453}],465:[function(e,t,n){"use strict";function r(e,t){var n=i.ExtendJXT(t),r=n.utils,o="http://www.vidyo.com/ns/LmiSelectedParticipantPackage.xsd",a=n.define({name:"selectedParticipant",namespace:o,element:"sp",fields:{active:r.attribute("active"),generation:r.numberAttribute("generation",!1),id:r.attribute("id"),value:r.text()}}),s=72,c=n.define({name:"selectedParticipantPackageContent",namespace:o,element:"content",fields:{conference:r.textSub(o,"c"),version:r.numberAttribute("version",!1,s)}});n.extend(c,a,"selectedParticipants",!0),n.withDefinition("event","http://www.vidyo.com/ns/LmiCmcp.xsd",function(e){n.extend(e,c)})}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../JxtExtension");n.LmiSelectedParticipantPackage=r},{"../../JxtExtension":453}],466:[function(e,t,n){"use strict";function r(e,t){var n=t.utils,r="http://www.vidyo.com/ns/LmiXmppComponentMessage.xsd",i=t.define({name:"notify",namespace:r,element:"notify",fields:{topic:n.textSub(r,"topic"),message:n.textSub(r,"message")}}),o=t.define({name:"request",namespace:r,element:"request",fields:{topic:n.textSub(r,"topic"),message:n.textSub(r,"message")}}),a=t.define({name:"reply",namespace:r,element:"reply",fields:{topic:n.textSub(r,"topic"),message:n.textSub(r,"message")}});t.withIQ(function(e){t.extend(e,o),t.extend(e,a),t.extend(e,i)}),e.LmiXmppComponentMessageNotify=function(t,n,r){return e.sendIq({to:t,type:"set",notify:{topic:n,message:r}})}}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiXmppComponentMessage=r},{}],467:[function(e,t,n){"use strict";function r(e,t){var n=t.utils,r="http://www.vidyo.com/ns/LmiXmppMucMedia.xsd",i=t.define({name:"conference",namespace:r,element:"conf",fields:{id:n.attribute("id"),reflector:n.attribute("reflector")}}),o=t.define({name:"_propertry",namespace:r,element:"prop",fields:{name:n.attribute("name"),value:n.attribute("value"),type:n.attribute("type")}});t.extend(i,o,"properties");var a=t.define({name:"start",namespace:r,element:"start",fields:{ips:n.multiTextSub(r,"ip")}}),s=t.define({name:"location",namespace:r,element:"loc",fields:{latitude:n.numberAttribute("lat",!0),longitude:n.numberAttribute("lon",!0)}});t.extend(a,s);var c=t.define({name:"stop",namespace:r,element:"stop",fields:{}});t.withIQ(function(e){t.extend(e,i),t.extend(e,a),t.extend(e,c)}),e.LmiXmppMucMediaStart=function(t,n){return e.sendIq({to:t,type:"set",start:n})},e.LmiXmppMucMediaStop=function(t){return e.sendIq({to:t,type:"set",stop:{}})},e.on("iq:set:conference",function(t){t.conference&&e.sendIq(t.resultReply())})}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiXmppMucMedia=r},{}],468:[function(e,t,n){"use strict";function r(e,t){var n=t.utils,r="erlang-solutions.com:xmpp:token-auth:0",i=t.define({name:"lmiXmppTokenAuthQuery",namespace:r,element:"query"}),o=t.define({name:"lmiXmppTokenAuthItems",namespace:r,element:"items",fields:{accessToken:n.textSub(r,"access_token"),refreshToken:n.textSub(r,"refresh_token")}});t.withIQ(function(e){t.extend(e,i),t.extend(e,o)}),e.LmiXmppTokenAuthQuery=function(){return e.sendIq({to:e.jid.domain,type:"get",lmiXmppTokenAuthQuery:{}})}}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiXmppTokenAuth=r},{}],469:[function(e,t,n){"use strict";function r(e,t){var n=t.utils,r=t.define({name:"LmiJingleName",namespace:"urn:xmpp:jingle:1",element:"name",fields:{value:n.text()}});t.withDefinition("jingle","urn:xmpp:jingle:1",function(e){t.extend(e,r)})}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingle=r},{}],470:[function(e,t,n){"use strict";function r(e,t){var n=t.utils,r=t.define({name:"LmiJingleConfInfo",namespace:"urn:xmpp:jingle:apps:coin:1",element:"conference-info",fields:{dummy:n.boolSub("dummy"),isfocus:n.boolAttribute("isfocus")}});t.withDefinition("jingle","urn:xmpp:jingle:1",function(e){t.extend(e,r)})}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleConfInfo=r},{}],471:[function(e,t,n){"use strict";function r(e,t){}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleErrors=r},{}],472:[function(e,t,n){"use strict";function r(e,t){}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleRtcpFeedback=r},{}],473:[function(e,t,n){"use strict";function r(e,t){}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleRtp=r},{}],474:[function(e,t,n){"use strict";function r(e,t){}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleRtpErrors=r},{}],475:[function(e,t,n){"use strict";function r(e,t){}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleRtpHeaderExt=r},{}],476:[function(e,t,n){"use strict";function r(e,t){}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleRtpInfo=r},{}],477:[function(e,t,n){"use strict";function r(e,t){var n=i.ExtendJXT(t),r=n.utils,s="urn:xmpp:jingle:apps:rtp:src-desc:1",c=n.define({name:"_ssrc",namespace:s,element:"ssrc",fields:{id:r.attribute("id")}}),u=n.define({name:"_ssrcGroup",namespace:s,element:"ssrc-group",fields:{semantic:r.attribute("semantic"),srefs:r.multiTextSub(s,"sref")}}),l=n.define({name:"_parameter",namespace:s,element:"parameter",fields:{name:r.attribute("name"),value:r.attribute("value")}}),d=n.define({name:"_source",namespace:s,element:"source",fields:{name:r.attribute("name"),cname:r.attribute("cname"),content:r.attribute("content"),ssrcs:r.multiExtension(c),ssrcGroups:r.multiExtension(u),parameters:r.multiExtension(l)}}),p=o.ValidationErrorInParentRequiredFieldNameIsNotFound;n.withDefinition("description","urn:xmpp:jingle:apps:rtp:1",function(e){n.add(e,"sources",r.addValidation(r.multiExtension(d),function(e){e.forEach(function(e){if(!e.name)throw new Error(a["default"].Format(p,{parent:"source",name:"name"}));if(!e.cname)throw new Error(a["default"].Format(p,{parent:"source",name:"cname"}));if(!e.content)throw new Error(a["default"].Format(p,{parent:"source",name:"content"}))})}))})}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../../JxtExtension"),o=e("../../../../../utils/Messages"),a=e("../../../../../utils/StringUtils");n.LmiJingleSource=r},{"../../../../../utils/Messages":432,"../../../../../utils/StringUtils":441,"../../../JxtExtension":453}],478:[function(e,t,n){"use strict";function r(e,t){var n=t.utils,r=t.define({name:"view",namespace:"http://www.vidyo.com/ns/LmiJingleSource.xsd",element:"view",fields:{}}),i=t.define({name:"_source",namespace:"http://www.vidyo.com/ns/LmiJingleSource.xsd",element:"source",fields:{id:n.attribute("id"),enable:n.boolAttribute("enable")}}),o=t.define({name:"params",namespace:"http://www.vidyo.com/ns/LmiJingleSource.xsd",element:"params",fields:{width:n.attribute("width"),height:n.attribute("height"),framerate:n.attribute("framerate"),pixelrate:n.attribute("pixelrate"),bandwidth:n.attribute("bandwidth"),preference:n.attribute("preference"),tsto:n.attribute("tsto"),minWidth:n.attribute("minWidth"),minHeight:n.attribute("minHeight"),minFrameRate:n.attribute("minFrameRate"),minPixelRate:n.attribute("minPixelRate"),minBandwidth:n.attribute("minBandwidth")}});t.extend(i,o),t.extend(r,i,"sources"),t.withDefinition("jingle","urn:xmpp:jingle:1",function(e){t.extend(e,r)}),e.on("iq:set:jingle",function(t){t.jingle.view&&e.emit("iq:set:lmiJingleSourceView",t)})}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleSourceView=r},{}],479:[function(e,t,n){"use strict";function r(e,t){var n=t.utils;t.withDefinition("transport","urn:xmpp:jingle:transports:ice-udp:1",function(e){t.add(e,"usertcpmux",n.attribute("usertcpmux"))})}Object.defineProperty(n,"__esModule",{value:!0}),n.LmiJingleTransport=r},{}],480:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("./IntegrationTestHelper"),o=e("./vidyo_connector_api/VidyoConnector");!function(e){var t=function(){function e(e,t){return setTimeout(function(){t({state:"READY",description:"Native XMPP + WebRTC"})}),o.VidyoConnector}return e}();e.VidyoClient=t,e.IntegrationTestHelper=i}(r=n.VidyoClientLib||(n.VidyoClientLib={})),window.StartVidyoSimple=i.StartVidyoSimple,window.saveGlobalVidyoClient=i.SaveGlobalVidyoClient,window.VCState="READY",window.VidyoClientLib={VidyoClient:r.VidyoClient}},{"./IntegrationTestHelper":339,"./vidyo_connector_api/VidyoConnector":486}],481:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../core/events/EventDispatcher"),i=e("../core/events/RenderEvents"),o=e("./Templates"),a=e("../core/models/VideoResolution"),s=e("../core/utils/NotImplemented"),c=e("../core/utils/SizeObserver"),u=e("../core/utils/AudioAnalyser"),l=e("../core/utils/StringUtils"),d="aspectRatioTooHigh",p="aspectRatioTooWide",f="aspectRatioInversed",h=function(){function e(e){var t=this;this._streamPopups={},this._vidyoCore=e;window.addEventListener("beforeunload",function(){Object.keys(t._streamPopups).forEach(function(e){t._closeStreamPopup(e)})})}return e.prototype.CreateView=function(e){var t=this;this._vidyoCore.EventDispatcher.releaseGroup(r.RenderListeners),this._vidyoCore.EventDispatcher.on(i.Events.SpeakerSelected,r.RenderListeners,function(e){return t._onSpeakerSelected(e)}),this._vidyoCore.EventDispatcher.on(i.Events.SpeakerPrivacyChanged,r.RenderListeners,function(e){return t._onSpeakerPrivacyChanged(e)}),this._vidyoCore.EventDispatcher.on(i.Events.VideoCropSettingsChanged,r.RenderListeners,function(e){return t._onVideoCropSettingsChanged(e)}),this._vidyoCore.EventDispatcher.on(i.Events.RecheckEachVideoSize,r.RenderListeners,function(){return t._onRecheckEachVideoSize()}),this._vidyoCore.EventDispatcher.on(i.Events.StatisticsUpdate,r.RenderListeners,function(){return t._onStatisticsUpdate()}),this._onRecheckEachVideoSizeRef=this._onRecheckEachVideoSize.bind(this),this._parent=this._createParent(e),this._parent&&c.SizeObserver.Start(this._parent,function(){return t._onRecheckEachVideoSize()})},e.prototype.Destroy=function(){s.NotImplemented()},e.prototype._addVideoElement=function(e,t,n,r,i,o,a){var s=r.Id,c={name:n.name,updateGeneration:(n.updateGeneration||1/0).toString(),participantId:""+i,streamId:""+s,cellId:""+s,trackId:s+"-track",trackType:o?"local-track":"remote-track",displayCroppedText:n.displayCropped?"displayCropped":"",allowZoomText:n.allowZoom?"allowZoom":""},u=document.createElement("div");u.innerHTML=l["default"].Format(e,c);var d=u.firstElementChild;if(d&&t){var p=a?"application-type":"video-type";d.classList.add(p),this._attachDragEventsToElement(d);var f=document.getElementById("vidyo-global-stats-overlay");if(f?t.insertBefore(d,f):t.appendChild(d),a){var h=d.querySelector(".video-placeholder");h&&h.classList.add("hide"),this._initApplicationPopup(t,d,r,n.name,i,s)}var m=document.getElementById(c.trackId);if(m){m.autoplay=!0;var v=r.GetClonedMediaStream();m.srcObject=v,m.addEventListener("resize",this._onRecheckEachVideoSizeRef),navigator.userAgent.indexOf("iPhone")>=0&&navigator.userAgent.indexOf("Safari")>=0&&navigator.userAgent.indexOf("Chrome")<0&&m.setAttribute("playsinline","true"),m.classList.add("video-loading"),m.addEventListener("play",function(){m.classList.remove("video-loading")}),m.addEventListener("loadstart",function(){m.classList.add("video-loading")});var g=d.querySelector(".volume-indicator");if(g&&!a){var y=void 0;if(o)y=v;else{var _=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantAudioStream(i);_&&(y=_.GetClonedMediaStream())}y&&this._monitorTrackAudio(y,g)}}}return d},e.prototype._attachDragEventsToElement=function(e){var t,n,r,i=!1,o=0,a=0,s=function(){var t=!!e.closest(".application-grid");t||(i=new Promise(function(t,i){return(n=e.querySelector("video"))?void setTimeout(function(){n&&setTimeout(function(){if(!n)return void i("Failed to find video element");if(r=n.closest(".video-container"),!r)return void i("Failed to find parent container");var e=r.getBoundingClientRect(),s=e.height,c=e.width,u=n.getBoundingClientRect(),l=u.height,d=u.width,p=2;o=Math.abs((d-c)/p),a=Math.abs((l-s)/p),t()})}):void i("Failed to find video element")}).then(function(){i=!0}))},c=function(){i=!1,t=void 0},u=function(e){if(i){var r=function(){if(!t){var r=10;if(!n)return;var i=parseInt(n.style.marginTop,r),s=isNaN(i)?0:i,c=parseInt(n.style.marginLeft,r),u=isNaN(c)?0:c;t={dragStartTop:e.clientY,dragStartLeft:e.clientX,elementTop:s,
elementLeft:u}}var l=-1*(t.dragStartLeft-e.clientX)+t.elementLeft,d=-1*(t.dragStartTop-e.clientY)+t.elementTop;l=0===l?0:Math.abs(l)<o?l:l/Math.abs(l)*o,d=0===d?0:Math.abs(d)<a?d:d/Math.abs(d)*a,n&&(n.style.marginLeft=0===l?"":l.toString()+"px",n.style.marginTop=0===d?"":d.toString()+"px")};i!==!0&&i.then?i.then(r):r()}};e.addEventListener("mousedown",s),e.addEventListener("mouseleave",c),e.addEventListener("mouseup",c),e.addEventListener("mousemove",u)},e.prototype._closeStreamPopup=function(e){this._streamPopups[e]&&(this._streamPopups[e].popup.onbeforeunload=function(){},this._streamPopups[e].popup.close(),delete this._streamPopups[e])},e.prototype._createParent=function(e){return s.NotImplemented()},e.prototype._eachVideoElement=function(e){if(this._parent){var t=this._parent.querySelectorAll(".vidyo-rendering-container .video-container");Array.prototype.forEach.call(t,e)}},e.prototype._elementsApplicationForParticipant=function(e){var t=document.querySelectorAll(".vidyo-rendering-container .application-type.video-container[data-participant-id='"+e+"']");return Array.from(t)},e.prototype._elementsForParticipant=function(e){var t=document.querySelectorAll(".vidyo-rendering-container .video-container[data-participant-id='"+e+"']");return Array.from(t)},e.prototype._elementsVideoForParticipant=function(e){var t=document.querySelectorAll(".vidyo-rendering-container .video-type.video-container[data-participant-id='"+e+"']");return Array.from(t)},e.prototype._getVideoMediaResolution=function(e){return{width:e.videoWidth,height:e.videoHeight}},e.prototype._monitorTrackAudio=function(e,t){var n=t.getContext("2d");n&&(n.fillStyle="green",u.AudioAnalyser.Monitor(e,function(e){if(n){n.clearRect(0,0,t.width,t.height);var r=130,i=e/r;n.fillRect(0,0,t.width*i,t.height)}}))},e.prototype._onRecheckEachVideoSize=function(){var e=this,t=new a.BasicVideoResolution;this._parent&&(t.Width=this._parent.clientWidth,t.Height=this._parent.clientHeight);var n=[];this._eachVideoElement(function(t){var r=new a.BasicVideoResolution(t.clientWidth,t.clientHeight),i=t.getElementsByTagName("video")[0],o=new a.VideoResolution(t.getAttribute("data-stream-id")||"");if(o.ContainerResolution=r,i){var s=e._getVideoMediaResolution(i);o.Width=s.width,o.Height=s.height}e._setAspectRatioClassToContainer(t,o),n.push(o)}),this._vidyoCore.Controllers.RendererController.UpdateVideoResolutions(t,n)},e.prototype._onVideoCropSettingsChanged=function(e){var t=this,n=this._parent.querySelectorAll("[data-participant-id='"+e.Id+"']");Array.prototype.forEach.call(n,function(n){t._setAspectRatioClassToContainer(n,e)})},e.prototype._safelyRemoveAllMediaElement=function(e){this._safelyRemoveVideoElement(e),this._safelyRemoveApplicationElement(e)},e.prototype._safelyRemoveApplicationElement=function(e){var t=this;this._elementsApplicationForParticipant(e).forEach(function(e){t._removeVideoElements(e)});for(var n=0,r=Object.entries(this._streamPopups);n<r.length;n++){var i=r[n],o=i[0],a=i[1];a.participantId===e&&this._closeStreamPopup(o)}},e.prototype._safelyRemoveVideoElement=function(e){var t=this;u.AudioAnalyser.StopMonitoring(e),this._elementsVideoForParticipant(e).forEach(function(e){t._removeVideoElements(e)})},e.prototype._setSinkId=function(e,t){return e.setSinkId(t)["catch"](function(t){var n=["AbortError: The operation could not be performed and was aborted"];if(n.indexOf(t.toString())<0)throw new Error("Failed to set speaker for "+e.id+". "+t)})},e.prototype._containerHasAspectRatioClass=function(e){return[d,p].some(function(t){return e.classList.contains(t)})},e.prototype._createApplicationPopup=function(e,t,n,r){var i=this,a=window.open("","","width=1280,height=720,status=0,menubar=0,toolbar=0,location=0"),s=document.createElement("title");s.innerHTML=r,a.document.head.appendChild(s);var c=document.createElement("style");c.innerHTML=o.streamPopupStyle,a.document.head.appendChild(c);var u=document.createElement("video");u.autoplay=!0,u.muted=!0,a.document.body.appendChild(u);var l=document.createElement("img");l.src=o.dockSVGImage,a.document.body.appendChild(l);var d=document.createElement("span");return d.className="name",d.innerHTML=r,a.document.body.appendChild(d),l.onclick=function(){a.close()},setTimeout(function(){u.srcObject=n.GetClonedMediaStream(),u.load()},0),e.removeChild(t),a.onbeforeunload=function(){e.appendChild(t);var n=t.querySelector("video");n&&n.load(),i._onRecheckEachVideoSize()},a},e.prototype._getElementAspectRatio=function(e){return e.clientWidth/e.clientHeight},e.prototype._initApplicationPopup=function(e,t,n,r,i,o){var a=this,s=t.querySelector(".popup-application");s&&(s.classList.remove("hide"),s.addEventListener("click",function(){var s=a._createApplicationPopup(e,t,n,r);a._onRecheckEachVideoSize(),a._streamPopups[o]={element:t,participantId:i,popup:s}}))},e.prototype._onSpeakerPrivacyChanged=function(e){if(this._parent){var t=this._parent.querySelectorAll(".vidyo-rendering-container .audio-container video");Array.prototype.forEach.call(t,function(t){t.muted=e})}},e.prototype._onSpeakerSelected=function(e){var t=this;if(this._parent){var n=this._parent.querySelectorAll(".vidyo-rendering-container .audio-container video");Array.prototype.forEach.call(n,function(n){e.speakerId?(t._setSinkId(n,e.speakerId),n.muted=!1):n.muted=!0})}},e.prototype._onStatisticsUpdate=function(){var e=this,t=this._vidyoCore.Controllers.StatisticsController.GetCallStats(),n=[],r=this._vidyoCore.Controllers.AdvancedSettingsController.ShowStatisticsOverlay;t.ParticipantStatistics.All().forEach(function(t){var i=e._parent.querySelectorAll("[data-participant-id='"+t.Id+"'] .stats-overlay")[0];if(i){e._setElementVisible(i,r);var a=["FillFromRemoteMicrophoneStatistics","FillFromRemoteVideoSourceStatistics"],s=e._statisticsToFormattedHTML(t,a);i.innerHTML=l["default"].Format(o.statisticsBlock,{lines:s})}else{var c=t.AudioBytesReceived+" audio bytes",u=t.VideoPacketsReceived+" video packets";n.push(["Orphaned stream '"+t.Id+"'",c+", "+u])}});var i=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream,a=this._parent.querySelectorAll("[data-participant-id='"+i.Id+"'] .stats-overlay")[0];if(a)if(this._setElementVisible(a,r),r){var s=["ParticipantStatistics","FillFromBandwidthSummaryStatistics","FillFromLocalMicrophoneStatistics","FillFromLocalVideoSourceStatistics","_activeParticipantsStatistics","_calculateStatisticsTotalBy"],c=this._statisticsToFormattedHTML(t,s),u=this._statisticsToFormattedHTML(n),d=c+"\n"+u;a.innerHTML=l["default"].Format(o.statisticsBlock,{lines:d})}else a.innerHTML=""},e.prototype._removeVideoElement=function(e){e.removeEventListener("resize",this._onRecheckEachVideoSizeRef),e.pause&&(e.pause(),e.src="",e.load())},e.prototype._removeVideoElements=function(e){var t=this;if(e.parentNode){var n=e.getElementsByTagName("video");Array.prototype.forEach.call(n,function(e){t._removeVideoElement(e)}),e.parentNode.removeChild(e)}},e.prototype._setAspectRatioClassToContainer=function(e,t){var n=e.querySelector("video");t.AspectRatio<1?(e.classList.contains(p)&&e.classList.remove(p),e.classList.contains(d)&&e.classList.remove(d),e.classList.contains(f)||e.classList.add(f)):t.AspectRatioRatioType===a.AspectRatioRatioType.Taller?(e.classList.contains(f)&&e.classList.remove(f),e.classList.contains(p)&&e.classList.remove(p),e.classList.contains(d)||e.classList.add(d),n&&(n.style.marginLeft="")):(e.classList.contains(f)&&e.classList.remove(f),e.classList.contains(d)&&e.classList.remove(d),e.classList.contains(p)||e.classList.add(p),n&&(n.style.marginTop=""))},e.prototype._setElementVisible=function(e,t){t?e.classList.remove("hide"):e.classList.add("hide")},e.prototype._statisticsToArray=function(e,t){void 0===t&&(t=[]);var n=[];for(var r in e)t.indexOf(r)<0&&n.push([r,e[r].toString()]);return n},e.prototype._statisticsToFormattedHTML=function(e,t){void 0===t&&(t=[]);var n=this._statisticsToArray(e,t),r=n.map(function(e){return l["default"].Format(o.statisticsBlockLine,{statKey:e[0],statValue:e[1]})}).join("\n");return r},e}();n.RendererBase=h},{"../core/events/EventDispatcher":372,"../core/events/RenderEvents":375,"../core/models/VideoResolution":389,"../core/utils/AudioAnalyser":421,"../core/utils/NotImplemented":434,"../core/utils/SizeObserver":440,"../core/utils/StringUtils":441,"./Templates":483}],482:[function(e,t,n){"use strict";function r(e,t,n){if(n.Controllers.RendererController.RenderMode=e?s.RenderMode.Composite:s.RenderMode.Custom,l[n.Controllers.RendererController.RenderMode]){var r=new l[n.Controllers.RendererController.RenderMode](n);return r.CreateView(e),r}var i=new Error(u["default"].Format(a.TheViewStyleViewStyleIsNotSupported,{viewStyle:t}));throw n.Controllers.LogController.LogError(i),i}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./composite/VidyoRenderer"),o=e("./custom/CustomVidyoRenderer"),a=e("../core/utils/Messages"),s=e("../core/models/RendererTypes"),c=e("./RendererBase");n.Type=c.RendererBase;var u=e("../core/utils/StringUtils"),l={};l[s.RenderMode.Composite]=i.VidyoRenderer,l[s.RenderMode.Custom]=o.CustomVidyoRenderer,n.CreateRenderer=r},{"../core/models/RendererTypes":385,"../core/utils/Messages":432,"../core/utils/StringUtils":441,"./RendererBase":481,"./composite/VidyoRenderer":484,"./custom/CustomVidyoRenderer":485}],483:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.containerTemplate="<div class='vidyo-rendering-container'>\n  <style></style>\n  <div class='media-grid video-grid'></div>\n  <div class='media-grid application-grid'></div>\n  <div class='audio-container'></div>\n </div>",n.dockSVGImage='data:image/svg+xml;utf8,\n  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n     viewBox="0 0 1000 1000" style="enable-background:new 0 0 1000 1000;" xml:space="preserve">\n  <style type="text/css">\n    .st0{fill:#FFFFFF;}\n  </style>\n  <path class="st0" d="M688.4,248.8H311.6c-34.6,0-62.8,28.2-62.8,62.8v376.8c0,34.6,28.2,62.8,62.8,62.8h376.8\n    c34.6,0,62.8-28.2,62.8-62.8V311.6C751.2,277,723,248.8,688.4,248.8z M311.6,688.4l94.2-125.6l63.8,85.1l93.3-116.5l125.6,157H311.6\n    L311.6,688.4z M820,100h-80H260h-80c-44,0-80,36-80,80v80v480v80c0,44,36,80,80,80h80h480h80c44,0,80-36,80-80v-80V260v-80\n    C900,136,864,100,820,100z M820,740v80h-80H260h-80v-80V260v-80h80h480h80v80V740z"/>\n  </svg>\n',n.undockSVGImage='data:image/svg+xml;utf8,\n  <svg version="1.1" id="Layer_3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n     viewBox="0 0 1000 1000" style="enable-background:new 0 0 1000 1000;" xml:space="preserve">\n  <style type="text/css">\n    .st0{fill:#FFFFFF;}\n  </style>\n  <path class="st0" d="M820,686.2V820H180V180h133.8v-80H180c-44,0-80,36-80,80v640c0,44,36,80,80,80h640c44,0,80-36,80-80V686.2H820z\n     M937.2,25H560.4c-34.6,0-62.8,28.2-62.8,62.8v376.8c0,34.6,28.2,62.8,62.8,62.8h376.8c34.6,0,62.8-28.2,62.8-62.8V87.8\n    C1000,53.2,971.8,25,937.2,25z M560.4,464.6L654.6,339l63.8,85.1l93.3-116.5l125.6,157H560.4z"/>\n  </svg>\n',n.trackTemplate="<div\n  id='<%= cellId %>'\n  data-participant-id='<%= participantId %>'\n  data-stream-id='<%= streamId %>'\n  class='video-container <%= trackType %> <%= displayCroppedText %> <%= allowZoomText %>'>\n    <div class='video-display-name-wrapper'>\n      <span class='video-display-name'><%= name %></span>\n      <canvas class='volume-indicator'></canvas>\n    </div>\n    <div class='stats-overlay hide'></div>\n    <div>\n      <div class='video-wrapper'>\n        <video id='<%= trackId %>' autoplay muted>\n        </video>\n        <img class='video-placeholder' src='data:image/svg+xml;utf8,\n            <svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\n               viewBox=\"0 0 500 500\n               \" style=\"enable-background:new 0 0 500 500;\" xml:space=\"preserve\">\n            <style type=\"text/css\">\n              .st0{fill:#C5DBDE;}\n            </style>\n            <path class=\"st0\" d=\"M349.5,150.8c0,55.1-44.7,99.8-99.8,99.8S150,205.8,150,150.8S194.7,51,249.8,51S349.5,95.7,349.5,150.8z\n               M405.6,337L405.6,337c-98-49-213.3-49.1-311.4-0.2l-0.4,0.2c-26.6,13.3-43.4,40.5-43.4,70.2V500H449v-92.8\n              C449,377.5,432.2,350.3,405.6,337z\"/>\n            </svg>\n          '></img>\n        <img src='"+n.undockSVGImage+"' class='popup-application hide' />\n      </div>\n    </div>\n </div>",n.customTrackTemplate="<div class='vidyo-rendering-container'>\n  <div "+n.trackTemplate+"</div>\n</div>",n.statisticsBlock="<ul class='statistics-list'>\n<%= lines %>\n</ul>\n",n.statisticsBlockLine="<li class='statistics-line'>\n  <span class='statistics-key'><%= statKey %></span>: <span class='statistics-value'><%= statValue %></span>\n</li>",n.compositeLayoutDefaultStyle="\n.media-grid {\n  grid-template-columns: 1fr, 1fr;\n  grid-template-rows: 1fr;\n}",n.compositeLayoutStyle="\n.media-grid<%= scope %> {\n  grid-template-columns: repeat(calc(<%= columns %> * 2), 1fr);\n  grid-template-rows: repeat(<%= rows %>, 1fr);\n}",n.compositeLayoutStyleSpaceBeforeVideo="\n.media-grid<%= scope %> .video-container:nth-of-type(<%= index %>) {\n  grid-column-start: 2;\n}",n.compositeLayoutGridSplitStyle=function(e,t){switch(e){case"VideoOnly":return'\n.vidyo-rendering-container {\n  grid-template-columns: 1fr;\n  grid-template-rows: 1fr;\n  grid-template-areas: "video";\n}';case"HorizontalSplit":return"\n.vidyo-rendering-container {\n  grid-template-columns: "+(t>1?"7fr 3fr;":"4fr 1fr;")+'\n  grid-template-rows: 1fr;\n  grid-template-areas: "application video";\n}';case"VerticalSplit":return'\n.vidyo-rendering-container {\n  grid-template-columns: 1fr;\n  grid-template-rows: 4fr 1fr;\n  grid-template-areas:\n    "application"\n    "video";\n}'}},n.streamPopupStyle="\nbody {\n  background-color: #000000;\n  margin: 0;\n  padding: 0;\n  position: relative;\n  font-family: 'robotolight', 'Open Sans', 'Helvetica', 'Arial', sans-serif;\n}\n\nvideo {\n  width: 100%;\n  height: 100%;\n}\n\nimg {\n  bottom: 60px;\n  left: 60px;\n  position: absolute;\n  width: 50px;\n  height: 50px;\n}\n\nspan.name {\n  justify-content: left;\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  color: white;\n  background: black;\n  opacity: 0.25;\n  padding: 0 1em;\n  font-size: 2em;\n  width: 100%;\n  line-height: 1.5em;\n}\n"},{}],484:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../core/events/EventDispatcher"),o=e("../../core/utils/Messages"),a=e("../../core/events/RenderEvents"),s=e("../Templates"),c=e("../../core/models/Participant"),u=e("../RendererBase"),l=e("../../core/utils/AudioAnalyser"),d=e("../../core/utils/ObjectUtils"),p=e("../../core/utils/StringUtils"),f=function(e){function t(t){var n=e.call(this,t)||this;return n._streamCache={},n}return r(t,e),t.prototype.CreateView=function(t){var n=this;e.prototype.CreateView.call(this,t),this._vidyoCore.EventDispatcher.on(a.Events.Update,i.RenderListeners,function(e){return n._onUpdate(e)}),this._vidyoCore.EventDispatcher.on(a.Events.UpdateSource,i.RenderListeners,function(e){return n._updateStreamSource(e)}),this._vidyoCore.EventDispatcher.on(a.Events.GridLayoutChanged,i.RenderListeners,function(){return n._updateGridLayouts()})},t.prototype.Destroy=function(){var e=this;if(this._parent){var t=this._parent.querySelectorAll(".video-container");for(Array.prototype.forEach.call(t,function(t){var n=t.getAttribute("data-participant-id");n&&e._safelyRemoveAllMediaElement(n)});this._parent.lastChild;)this._parent.removeChild(this._parent.lastChild)}},t.prototype._createParent=function(e){if(e){var t=document.getElementById(e);if(t)return t}var n=new Error(p["default"].Format(o.TheElementIdDoesntExist,{id:e}));throw this._vidyoCore.Controllers.LogController.LogError(n),n},t.prototype._onUpdate=function(e){var t=this,n=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Active:!0}),r=n.map(function(e){return e.Id});e&&(r=d["default"].Difference(r,e));var i=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream;i&&r.push(i.Id),Array.prototype.forEach.call(document.querySelectorAll(".video-type.video-container"),function(e){var n=e.getAttribute("data-participant-id");n&&r.indexOf(n)<0&&(t._updateContainerState(),t._safelyRemoveVideoElement(n))}),n.forEach(function(e){var n=t._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantVideoStream(e.Id);n&&t._addStream(n,e.Id,e.Name,!1)}),i&&this._addStream(i,i.Id,"Preview",!0),this._updateApplicationsStreams(),this._updateContainerState(),this._updateAudioStreams(),this._onRecheckEachVideoSize()},t.prototype._addStream=function(e,t,n,r){var i=this._getOrCreateContainer(),o={name:n,displayCropped:!0,allowZoom:!0};this._updateContainerState();var a=this._elementsVideoForParticipant(t).length>0;if(!a){var c=".video-grid",u=i.querySelector(c);this._addVideoElement(s.trackTemplate,u,o,e,t,r,!1)}this._updateParticipantApplications(t,r)},t.prototype._fitParticipantNames=function(e){Array.prototype.forEach.call(e.querySelectorAll(".media-grid span.video-display-name"),function(e){for(var t=function(){var t=window.getComputedStyle(e).getPropertyValue("font-size"),n=10,r=parseInt(t,n)-1+"px";e.style.fontSize=r};e.scrollWidth>e.offsetWidth;)t()})},t.prototype._getOrCreateContainer=function(){var e=this._parent.querySelector(".vidyo-rendering-container");if(!e&&(this._parent.innerHTML=s.containerTemplate,e=this._parent.querySelector(".vidyo-rendering-container"),!e)){var t=new Error(p["default"].Format(o.TheElementIdDoesntExist,{id:"vidyo-rendering-container"}));throw this._vidyoCore.Controllers.LogController.LogError(t),t}return this._updateGridLayouts(),e},t.prototype._updateApplicationsStreams=function(){var e=this,t=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:c.ParticipantOrigin.Remote}),n=t.map(function(e){return e.Id});Array.prototype.forEach.call(document.querySelectorAll(".application-type.video-container"),function(t){var r=t.getAttribute("data-participant-id");r&&n.indexOf(r)<0&&e._safelyRemoveApplicationElement(r)}),t.forEach(function(t){e._updateParticipantApplications(t.Id,!1)})},t.prototype._updateAudioStreams=function(){var e=this,t="video",n=this._getOrCreateContainer(),r=n.querySelector(".audio-container");if(r){var i=this._vidyoCore.Controllers.ParticipantController.GetParticipants({Origin:"remote"}),o=i.map(function(e){return e.Id}),a=[];o.forEach(function(n){var i=e._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantAudioStream(n);if(i&&(a.push(i.Id),!document.getElementById(i.Id))){var o=document.createElement(t);o.id=i.Id,o.style.display="none",o.autoplay=!0,o.srcObject=i.GetClonedMediaStream();var s=e._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Speaker;"boolean"!=typeof s&&s.Id&&e._setSinkId(o,s.Id),r.appendChild(o)}});var s=r.getElementsByTagName(t);Array.prototype.forEach.call(s,function(e){-1===a.indexOf(e.id)&&e.remove()})}},t.prototype._updateContainerState=function(){this._getOrCreateContainer()},t.prototype._updateGridLayouts=function(){var e=this._parent.querySelector(".vidyo-rendering-container");if(e){var t="",n=this._vidyoCore.Controllers.RendererController.VideoGridLayout,r=".video-grid";t+=p["default"].Format(s.compositeLayoutStyle,{scope:r,columns:n.Columns,rows:n.Rows}),n.SpaceBefore.forEach(function(e){t+=p["default"].Format(s.compositeLayoutStyleSpaceBeforeVideo,{index:e,scope:r})});var i=this._vidyoCore.Controllers.RendererController.ApplicationGridLayout,o=i.Cells>0,a="VideoOnly";o&&(a="horizontal"===this._vidyoCore.Controllers.RendererController.MediaGridSplit?"HorizontalSplit":"VerticalSplit",r=".application-grid",t+=p["default"].Format(s.compositeLayoutStyle,{scope:r,columns:i.Columns,rows:i.Rows}),i.SpaceBefore.forEach(function(e){t+=p["default"].Format(s.compositeLayoutStyleSpaceBeforeVideo,{index:e,scope:r})})),t+=s.compositeLayoutGridSplitStyle(a,n.Columns);var c=e.querySelector("style");if(!c)throw new Error("Failed to find style element in rendering container, cannot update grid layout");c.innerHTML=t;var u=e.querySelector(".video-grid");if(!u)throw new Error("Failed to find video grid in rendering container, cannot update picture-in-picture settings");var l=2;u.classList.toggle("picture-in-picture",!o&&n.Cells===l),Array.prototype.forEach.call(e.querySelectorAll(".media-grid video"),function(e){e.style.marginLeft="",e.style.marginTop=""}),this._fitParticipantNames(e)}},t.prototype._updateParticipantApplications=function(e,t){var n=this,r=[],i="";if(t)r=this._vidyoCore.Controllers.RendererController.ShowLocalSharePreview?this._vidyoCore.Controllers.LocalStreamController.GetApplicationStreams():[],i="Preview share";else{var o=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e);o&&(r=this._vidyoCore.Controllers.RemoteStreamController.GetParticipantApplicationStreams(e),i=o.Name)}var a=this._getOrCreateContainer(),c=a.querySelector(".application-grid");if(c){for(var u={name:i,displayCropped:!0,allowZoom:!0},l=r.map(function(e){return e.Id}),d=c.querySelectorAll(".vidyo-rendering-container .video-container[data-participant-id='"+e+"']"),p=d.length-1;p>=0;--p){var f=d[p];-1===l.indexOf(f.getAttribute("data-stream-id"))&&f.parentNode&&f.parentNode.removeChild(f)}for(var h=0,m=Object.entries(this._streamPopups);h<m.length;h++){var v=m[h],g=v[0],y=v[1];y.participantId===e&&-1===l.indexOf(g)&&this._closeStreamPopup(g)}r.forEach(function(r){document.querySelector(".vidyo-rendering-container .video-container[data-stream-id='"+r.Id+"']")||n._streamPopups[r.Id]||n._addVideoElement(s.trackTemplate,c,u,r,e,t,!0)})}},t.prototype._updateStreamSource=function(e){this._updateContainerState();var t=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantVideoStream(e),n=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantAudioStream(e),r=!1;if(!t){var i=this._vidyoCore.Controllers.LocalStreamController.AudioVideoStream;i&&(r=!0,n=t=i)}var o,a=!1,s=!1;if(r||(o=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(e),o&&(a=o.HasVideoSource(),s=o.HasAudioSource())),t){var c=a||r&&t.GetVideoTracks().length&&t.GetVideoTracks()[0].IsActive(),u=s||r&&n&&n.GetAudioTracks().length&&n.GetAudioTracks()[0].IsActive(),d=this._parent.querySelector("[data-stream-id='"+t.Id+"']");if(d){var p=d.querySelector("video");if(p){{t.GetClonedMediaStream()}if(r&&navigator.userAgent.indexOf("Safari")>=0&&navigator.userAgent.indexOf("Chrome")<0&&p.load(),d.classList.toggle("audio-muted",!u),d.classList.toggle("video-muted",!c),n)if(u){l.AudioAnalyser.StopMonitoring(n.Id);var f=d.getElementsByClassName("volume-indicator"),h=f[0];h&&this._monitorTrackAudio(n.GetClonedMediaStream(),h)}else l.AudioAnalyser.StopMonitoring(n.Id)}}(r||o&&o.IsRemote)&&this._updateParticipantApplications(e,r),this._updateGridLayouts(),this._onRecheckEachVideoSize()}},t}(u.RendererBase);n.VidyoRenderer=f},{"../../core/events/EventDispatcher":372,"../../core/events/RenderEvents":375,"../../core/models/Participant":383,"../../core/utils/AudioAnalyser":421,"../../core/utils/Messages":432,"../../core/utils/ObjectUtils":435,"../../core/utils/StringUtils":441,"../RendererBase":481,"../Templates":483}],485:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../../core/events/EventDispatcher"),o=e("../../core/utils/Messages"),a=e("../../core/events/RenderEvents"),s=e("../RendererBase"),c=e("../Templates"),u=e("../../core/utils/ObjectUtils"),l=e("../../core/utils/StringUtils"),d=function(e){function t(t){return e.call(this,t)||this}return r(t,e),t.prototype.CreateView=function(t){var n=this;e.prototype.CreateView.call(this,t),this._vidyoCore.EventDispatcher.on(a.Events.Update,i.RenderListeners,function(e){return n._onUpdate(e)}),this._vidyoCore.EventDispatcher.on(a.Events.Hide,i.RenderListeners,function(e){return n._onHide(e)}),this._vidyoCore.EventDispatcher.on(a.Events.UpdatePosition,i.RenderListeners,function(e){return n._onUpdatePostion(e)})},t.prototype._createParent=function(){return document.body},t.prototype._onHide=function(e){var t=this._vidyoCore.Controllers.RendererController.Views[e.viewId];t&&this._hideView(t)},t.prototype._onUpdate=function(e){var t=this,n=this._vidyoCore.Controllers.RendererController.Views,r=u["default"].MapObject(n,function(e){return e.streamId});e&&(r=u["default"].Difference(r,e)),u["default"].Filter(n,function(e){return!r.includes(e.streamId)}).forEach(function(e){t._hideView(e)});for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];this._updateView(o)}},t.prototype._onUpdatePostion=function(e){var t=this._vidyoCore.Controllers.RendererController.Views[e.viewId];t&&this._setViewPosition(t)},t.prototype._findElementByClassName=function(e,t){var n=e.getElementsByClassName(t)[0];if(!n){var r=new Error(l["default"].Format(o.TheElementOfClassDoesntExist,{className:t}));this._vidyoCore.Controllers.LogController.LogError(r)}return n},t.prototype._findElementById=function(e){var t=document.getElementById(e);if(!t){var n=new Error(l["default"].Format(o.TheElementIdDoesntExist,{id:e}));throw this._vidyoCore.Controllers.LogController.LogError(n),n}return t},t.prototype._hideView=function(e){var t=this,n=this._findElementById(e.viewId);if(n){var r=n.querySelectorAll(".video-container");for(Array.prototype.forEach.call(r,function(e){var n=e.getAttribute("data-participant-id");n&&t._safelyRemoveVideoElement(n)});n.lastChild;)n.removeChild(n.lastChild)}},t.prototype._setViewPosition=function(e){var t=this._findElementById(e.viewId);if(t){var n=this._findElementByClassName(t,"video-container");n&&e.position&&(n.style.position="absolute",n.style.left=e.position.x+"px",n.style.top=e.position.y+"px",n.style.width=e.position.width+"px",n.style.height=e.position.height+"px")}},t.prototype._updateView=function(e){var t=this._findElementById(e.viewId),n=this._vidyoCore.Controllers.RemoteStreamController.TryGetParticipantVideoStream(e.streamId),r=e.label;if(n){var i={name:r,displayCropped:e.displayCropped,allowZoom:e.allowZoom},o=this._vidyoCore.Controllers.ParticipantController.TryGetParticipant(n.Id),a=this._elementsVideoForParticipant(n.Id).length>0;if(!a&&(e.isLocal||o&&o.Active)){var s=o&&o.Id||n.Id;this._addVideoElement(c.customTrackTemplate,t,i,n,s,e.isLocal,!1)}}},t}(s.RendererBase);n.CustomVidyoRenderer=d},{"../../core/events/EventDispatcher":372,"../../core/events/RenderEvents":375,"../../core/utils/Messages":432,"../../core/utils/ObjectUtils":435,"../../core/utils/StringUtils":441,"../RendererBase":481,"../Templates":483}],486:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("../vidyo_simple_api/VidyoSimple"),o=e("../core/utils/AssignHiddenPropertyValue"),a=e("../core/utils/PromiseHelper"),s=e("es6-promise"),c=e("uuid"),u=e("../core/utils/Constants"),l=e("../core/events/ConnectionEvents"),d=e("../core/utils/VidyoDebugger"),p=function(){};!function(e){e.Idle="VIDYO_CONNECTORSTATE_Idle",e.Ready="VIDYO_CONNECTORSTATE_Ready",e.EstablishingConnection="VIDYO_CONNECTORSTATE_EstablishingConnection",e.FindingResource="VIDYO_CONNECTORSTATE_FindingResource",e.ConnectingToResource="VIDYO_CONNECTORSTATE_ConnectingToResource",e.EnablingMedia="VIDYO_CONNECTORSTATE_EnablingMedia",e.Connected="VIDYO_CONNECTORSTATE_Connected"}(r=n.VidyoConnectorState||(n.VidyoConnectorState={}));var f;!function(e){e.Disconnected="VIDYO_CONNECTORDISCONNECTREASON_Disconnected",e.ConnectionLost="VIDYO_CONNECTORDISCONNECTREASON_ConnectionLost",e.ConnectionTimeout="VIDYO_CONNECTORDISCONNECTREASON_ConnectionTimeout",e.NoResponse="VIDYO_CONNECTORDISCONNECTREASON_NoResponse",e.Terminated="VIDYO_CONNECTORDISCONNECTREASON_Terminated",e.MiscLocalError="VIDYO_CONNECTORDISCONNECTREASON_MiscLocalError",e.MiscRemoteError="VIDYO_CONNECTORDISCONNECTREASON_MiscRemoteError",e.MiscError="VIDYO_CONNECTORDISCONNECTREASON_MiscError"}(f=n.VidyoConnectorDisconnectReason||(n.VidyoConnectorDisconnectReason={}));var h=function(){function e(){this.State=r.Idle,this.VidyoParticipantCallbacks={}}return e}(),m=function(){function e(){this.objType="VidyoConnector",o.AssignHiddenPropertyValue(this,"_hidden",new h),this._hidden.VidyoSimple=new i.VidyoSimple,this.objId=c.v4(),d.VidyoDebugger.Debug(this,d.API.VidyoConnector,t)}return e.prototype.AssignViewToLocalCamera=function(e){var t=e.viewId,n=e.localCamera,r=e.displayCropped,i=e.allowZoom;return this._hidden.VidyoEndpoint.AssignViewToLocalCamera(t,n,r,i),s.Promise.resolve(!0)},e.prototype.AssignViewToRemoteCamera=function(e){var t=e.viewId,n=e.remoteCamera,r=e.displayCropped,i=e.allowZoom;return this._hidden.VidyoEndpoint.AssignViewToRemoteCamera(t,n,r,i),s.Promise.resolve(!0)},e.prototype.Connect=function(e){var t=this,n=e.host,i=e.token,o=e.displayName,s=e.resourceId,c=e.onSuccess,u=e.onFailure,d=e.onDisconnected;this._hidden.VidyoUser.SetDisplayName(o);var h=a.MakePromiseWithCallback(),m=h.promise,v=h.resolve,g=a.MakePromiseWithCallback(),y=g.promise,_=g.resolve;this._hidden.DisconnectionPromise=y,this._hidden.DisconnectionPromise.then(function(e){e&&e!==l.ConnectionEventsInfo.MediaSessionEnded&&e!==l.ConnectionEventsInfo.Disconnected?u(e.reasonCode):d(e.reasonCode)}),this._hidden.VidyoUser.LoginWithTenantToken(i,n,void 0,void 0,v,_,function(){},function(){},function(){});var S=a.MakePromiseWithCallback(),b=S.promise,C=S.resolve,w=a.MakePromiseWithCallback(),E=w.promise,R=w.resolve,P=a.MakePromiseWithCallback(),x=P.promise,T=P.resolve;return this._changeState(r.EstablishingConnection),m.then(function(){return t._changeState(r.FindingResource),t._hidden.VidyoUser.CreateRoomFromId(s,i,C),b}).then(function(e){return t._hidden.VidyoRoom=e,t._changeState(r.ConnectingToResource),e.Enter(R,function(){}),E}).then(function(){return t._hidden.VidyoRoom.RegisterParticipantEventListener(t._hidden.VidyoParticipantCallbacks.onJoined||p,t._hidden.VidyoParticipantCallbacks.onLeft||p,t._hidden.VidyoParticipantCallbacks.onDynamicChanged||p,t._hidden.VidyoParticipantCallbacks.onLoudestChanged||p),t._changeState(r.EnablingMedia),t._hidden.VidyoRoom.EnableMedia(T,u,function(){}),x}).then(function(){return t._changeState(r.Connected),c(),!0})["catch"](function(e){return t._changeState(r.Ready),u(f.MiscError),!1})},e.prototype.CycleCamera=function(){return this._hidden.VidyoEndpoint.CycleCamera(),s.Promise.resolve(!0)},e.prototype.CycleMicrophone=function(){return this._hidden.VidyoEndpoint.CycleMicrophone(),s.Promise.resolve(!0)},e.prototype.CycleSpeaker=function(){return this._hidden.VidyoEndpoint.CycleSpeaker(),s.Promise.resolve(!0)},e.prototype.Destruct=function(){return this.Disable()},e.prototype.Disable=function(){return this._hidden.VidyoSimple.Disable()},e.prototype.Disconnect=function(){return this._hidden.VidyoUser.Logout(),this._changeState(r.Ready),this._hidden.DisconnectionPromise},e.prototype.EnableDebug=function(e){e.port,e.logFilter;return this._noopPromise()},e.prototype.GetState=function(){return s.Promise.resolve(this._hidden.State)},e.prototype.GetStatsJson=function(){return this._hidden.VidyoEndpoint.GetStatsJson()},e.prototype.GetVersion=function(){return s.Promise.resolve(u.LibVersion+"."+u.LibBuild)},e.prototype.GetVersionWithoutBuildNumber=function(){
return s.Promise.resolve(u.LibVersion)},e.prototype.HideView=function(e){var t=e.viewId;return this._hidden.VidyoEndpoint.HideView(t),s.Promise.resolve(!0)},e.prototype.RegisterLocalCameraEventListener=function(e){var t=e.onAdded,n=e.onRemoved,r=e.onSelected,i=e.onStateUpdated;return this._hidden.VidyoEndpoint.RegisterLocalCameraEventListener(t,n,r,i)},e.prototype.RegisterLocalMicrophoneEnergyListener=function(e){return this._hidden.VidyoEndpoint.RegisterLocalMicrophoneEnergyListener(e)},e.prototype.RegisterLocalMicrophoneEventListener=function(e){var t=e.onAdded,n=e.onRemoved,r=e.onSelected,i=e.onStateUpdated;return this._hidden.VidyoEndpoint.RegisterLocalMicrophoneEventListener(t,n,r,i)},e.prototype.RegisterLocalMonitorEventListener=function(e){var t=e.onAdded,n=e.onRemoved,r=e.onSelected,i=e.onStateUpdated;return this._hidden.VidyoEndpoint.RegisterLocalMonitorEventListener(t,n,r,i)},e.prototype.RegisterLocalSpeakerEventListener=function(e){var t=e.onAdded,n=e.onRemoved,r=e.onSelected,i=e.onStateUpdated;return this._hidden.VidyoEndpoint.RegisterLocalSpeakerEventListener(t,n,r,i)},e.prototype.RegisterLocalWindowShareEventListener=function(e){var t=e.onAdded,n=e.onRemoved,r=e.onSelected,i=e.onStateUpdated;return this._hidden.VidyoEndpoint.RegisterLocalWindowShareEventListener(t,n,r,i)},e.prototype.RegisterParticipantEventListener=function(e){var t=s.Promise.resolve(!0);return this._hidden.VidyoParticipantCallbacks=e,this._hidden.VidyoRoom&&(t=this._hidden.VidyoRoom.RegisterParticipantEventListener(this._hidden.VidyoParticipantCallbacks.onJoined||p,this._hidden.VidyoParticipantCallbacks.onLeft||p,this._hidden.VidyoParticipantCallbacks.onDynamicChanged||p,this._hidden.VidyoParticipantCallbacks.onLoudestChanged||p)),t},e.prototype.RegisterRemoteCameraEventListener=function(e){var t=e.onAdded,n=e.onRemoved,r=e.onStateUpdated;return this._hidden.VidyoEndpoint.RegisterRemoteCameraEventListener(t,n,r)},e.prototype.RegisterRemoteMicrophoneEnergyListener=function(e){return this._hidden.VidyoEndpoint.RegisterRemoteMicrophoneEnergyListener(e)},e.prototype.RegisterRemoteMicrophoneEventListener=function(e){var t=e.onAdded,n=e.onRemoved,r=e.onStateUpdated;return this._hidden.VidyoEndpoint.RegisterRemoteMicrophoneEventListener(t,n,r)},e.prototype.RegisterRemoteWindowShareEventListener=function(e){var t=e.onAdded,n=e.onRemoved,r=e.onStateUpdated;return this._hidden.VidyoEndpoint.RegisterRemoteWindowShareEventListener(t,n,r)},e.prototype.SelectDefaultCamera=function(){return this._hidden.VidyoEndpoint.SelectDefaultCamera(),s.Promise.resolve(!0)},e.prototype.SelectDefaultMicrophone=function(){return this._hidden.VidyoEndpoint.SelectDefaultMicrophone(),s.Promise.resolve(!0)},e.prototype.SelectDefaultSpeaker=function(){return this._hidden.VidyoEndpoint.SelectDefaultSpeaker(),s.Promise.resolve(!0)},e.prototype.SelectLocalCamera=function(e){var t=e.localCamera;return this._hidden.VidyoEndpoint.SelectCamera(t),s.Promise.resolve(!0)},e.prototype.SelectLocalMicrophone=function(e){var t=e.localMicrophone;return this._hidden.VidyoEndpoint.SelectMicrophone(t),s.Promise.resolve(!0)},e.prototype.SelectLocalMonitor=function(e){var t=e.localMonitor;return this._hidden.VidyoEndpoint.SelectLocalMonitor(t)},e.prototype.SelectLocalSpeaker=function(e){var t=e.localSpeaker;return this._hidden.VidyoEndpoint.SelectSpeaker(t),s.Promise.resolve(!0)},e.prototype.SelectLocalWindowShare=function(e){var t=e.localWindowShare;return this._hidden.VidyoEndpoint.SelectLocalWindowShare(t)},e.prototype.SetAdvancedConfiguration=function(e){this._hidden.VidyoEndpoint.SetAdvancedConfiguration(e)},e.prototype.SetCameraPrivacy=function(e){var t=e.privacy;return this._hidden.VidyoEndpoint.SetCameraPrivacy(t),s.Promise.resolve(!0)},e.prototype.SetMicrophonePrivacy=function(e){var t=e.privacy;return this._hidden.VidyoEndpoint.SetMicrophonePrivacy(t),s.Promise.resolve(!0)},e.prototype.SetSpeakerPrivacy=function(e){var t=e.privacy;return this._hidden.VidyoEndpoint.SetSpeakerPrivacy(t),s.Promise.resolve(!0)},e.prototype.ShowViewAt=function(e,t,n,r,i){return this._hidden.VidyoEndpoint.ShowViewAt(e,t,n,r,i)},e.prototype.ShowWindowSharePreview=function(e){var t=e.preview;return this._hidden.VidyoEndpoint.ShowWindowSharePreview(t),s.Promise.resolve(!0)},e.prototype.UnregisterLocalCameraEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalCameraEventListener()},e.prototype.UnregisterLocalMicrophoneEnergyListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalMicrophoneEnergyListener()},e.prototype.UnregisterLocalMicrophoneEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalMicrophoneEventListener()},e.prototype.UnregisterLocalMonitorEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalMonitorEventListener()},e.prototype.UnregisterLocalSpeakerEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalSpeakerEventListener()},e.prototype.UnregisterLocalWindowShareEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterLocalWindowShareEventListener()},e.prototype.UnregisterParticipantEventListener=function(){return this._hidden.VidyoRoom.UnregisterParticipantEventListener(),s.Promise.resolve(!0)},e.prototype.UnregisterRemoteCameraEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterRemoteCameraEventListener()},e.prototype.UnregisterRemoteMicrophoneEnergyListener=function(){return this._hidden.VidyoEndpoint.UnregisterRemoteMicrophoneEnergyListener()},e.prototype.UnregisterRemoteMicrophoneEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterRemoteMicrophoneEventListener()},e.prototype.UnregisterRemoteWindowShareEventListener=function(){return this._hidden.VidyoEndpoint.UnregisterRemoteWindowShareEventListener(),s.Promise.resolve(!0)},e.prototype._changeState=function(e){this._hidden.State=e},e.prototype._initialize=function(e,t,n,i,o,a){var s=this;return this._hidden.VidyoSimple.Initialize().then(function(){return s._hidden.VidyoEndpoint=s._hidden.VidyoSimple.CreateVidyoEndpoint(e,t,n,i,i,o),s._hidden.VidyoUser=s._hidden.VidyoSimple.CreateVidyoUser(s._hidden.VidyoEndpoint),s._changeState(r.Ready),!0})},e.prototype._noopPromise=function(){return console.warn("Not Implemented"),console.trace(),new s.Promise(function(){return!1})},e.prototype._registerAdvancedSettingsEventListener=function(e){var t=e.onAddGoogleConferenceFlagChanged,n=e.onDisableStatsChanged,r=e.onEnableSimpleAPILoggingChanged,i=e.onEnableSimulcastChanged,o=e.onEnableXMPPMessageLoggingChanged,a=e.onParticipantLimitChanged,s=e.onShowStatisticsOverlayChanged,c=e.onCodecExcludeFilterChanged;this._hidden.VidyoEndpoint.RegisterAdvancedSettingsEventListener(t,c,n,i,a,s,o,r)},e.CreateVidyoConnector=function(t){var n=t.viewId,r=t.viewStyle,i=t.remoteParticipants,o=t.logFileFilter,a=t.logFileName,s=t.userData,c=new e;return c._initialize(n,r,i,o,a,s).then(function(){return window.vidyoConnector=c,c})},e}();n.VidyoConnector=m}).call(this,"/src/vidyo_connector_api/VidyoConnector.ts")},{"../core/events/ConnectionEvents":370,"../core/utils/AssignHiddenPropertyValue":420,"../core/utils/Constants":426,"../core/utils/PromiseHelper":438,"../core/utils/VidyoDebugger":446,"../vidyo_simple_api/VidyoSimple":495,"es6-promise":31,uuid:310}],487:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t,n,r,i){this.id=e,this.name=t,this.objId=n,this.objType="Vidyo"+r+i}return e}();n.BaseModel=r},{}],488:[function(e,t,n){(function(t){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./BaseModel"),o=e("../core/utils/NotImplemented"),a=e("./Origin"),s=e("../core/utils/VidyoDebugger"),c=function(e){function n(n,r){void 0===r&&(r=a.Origin.Local);var i=e.call(this,n.Id,n.Name,n.ObjId,r,n.Type)||this;return s.VidyoDebugger.Debug(i,s.API.Simple,t),i}return r(n,e),n}(i.BaseModel);n.Device=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.GetPosition=function(){o.NotImplemented()},t.prototype.IsSuspended=function(){o.NotImplemented()},t}(c);n.Camera=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(c);n.Microphone=l;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(c);n.Speaker=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.GetPosition=function(){o.NotImplemented()},t.prototype.IsSuspended=function(){o.NotImplemented()},t}(c);n.RemoteCamera=p;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(c);n.RemoteMicrophone=f;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(c);n.RemoteWindowShare=h}).call(this,"/src/vidyo_simple_api/Devices.ts")},{"../core/utils/NotImplemented":434,"../core/utils/VidyoDebugger":446,"./BaseModel":487,"./Origin":491}],489:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../core/events/AdvancedSettingsEvents"),i=e("../core/events/DeviceEvents"),o=e("../core/events/StreamEvents"),a=e("uuid"),s=e("../core/utils/AssignHiddenPropertyValue"),c=e("../core/models/device/Camera"),u=e("./Devices"),l=e("../core/utils/VidyoDebugger"),d=e("../core/models/device/Microphone"),p=e("../core/utils/NotImplemented"),f=e("../vidyo_simple_api/Participant"),h=e("../core/models/device/Speaker"),m=e("../core/events/EventDispatcher"),v=e("./stats/Stats"),g=e("./WindowShare"),y=e("./Monitor"),_=e("es6-promise"),S=e("./Origin"),b=function(){function e(e){this.objType="VidyoEndpoint",s.AssignHiddenPropertyValue(this,"_vidyoCore",e),this._vidyoCore.Controllers.CallStateController.EnableMedia(),this.objId=this._createEndpointID(),l.VidyoDebugger.Debug(this,l.API.Simple,t)}return e.prototype.AssignViewToLocalCamera=function(e,t,n,r){this._vidyoCore.Controllers.RendererController.AssignViewToLocalCamera({viewId:e,sourceId:t.id,displayCropped:n,allowZoom:r})},e.prototype.AssignViewToRemoteCamera=function(e,t,n,r){this._vidyoCore.Controllers.RendererController.AssignViewToRemoteCamera({viewId:e,sourceId:t.id,displayCropped:n,allowZoom:r}),this._vidyoCore.Controllers.ConferenceController.ActivateParticipant(t.id)},e.prototype.AssignViewToRemoteWindowShare=function(e,t,n,r){p.NotImplemented()},e.prototype.CycleCamera=function(){this._vidyoCore.Controllers.DeviceController.CycleCamera()},e.prototype.CycleMicrophone=function(){this._vidyoCore.Controllers.DeviceController.CycleMicrophone()},e.prototype.CycleSpeaker=function(){this._vidyoCore.Controllers.DeviceController.CycleSpeaker()},e.prototype.Disable=function(){p.NotImplemented()},e.prototype.DisableDebug=function(){p.NotImplemented()},e.prototype.EnableDebug=function(e,t){p.NotImplemented()},e.prototype.EnableFileLogger=function(){p.NotImplemented()},e.prototype.GetId=function(){p.NotImplemented()},e.prototype.GetStats=function(){var e=this._vidyoCore.Controllers.StatisticsController.GetEndpointStatistics(),t=new v.EndpointStats(e);return t},e.prototype.GetStatsJson=function(){return _.Promise.resolve(JSON.stringify(this.GetStats()))},e.prototype.HideView=function(e){this._vidyoCore.Controllers.RendererController.HideView({viewId:e})},e.prototype.RegisterAdvancedSettingsEventListener=function(e,t,n,i,o,a,s,c,u){e&&(e(this._vidyoCore.Controllers.AdvancedSettingsController.AddGoogleConferenceFlag),this._vidyoCore.EventDispatcher.on(r.Events.AddGoogleConferenceFlagChanged,m.VidyoAdvancedSettingsEventListeners,e)),t&&(t(this._vidyoCore.Controllers.AdvancedSettingsController.CodecExcludeFilter),this._vidyoCore.EventDispatcher.on(r.Events.CodecExcludeFilterChanged,m.VidyoAdvancedSettingsEventListeners,t)),n&&(n(this._vidyoCore.Controllers.AdvancedSettingsController.DisableStats),this._vidyoCore.EventDispatcher.on(r.Events.DisableStatsChanged,m.VidyoAdvancedSettingsEventListeners,n)),i&&(i(this._vidyoCore.Controllers.AdvancedSettingsController.EnableSimulcast),this._vidyoCore.EventDispatcher.on(r.Events.EnableSimulcastChanged,m.VidyoAdvancedSettingsEventListeners,i)),o&&(o(this._vidyoCore.Controllers.AdvancedSettingsController.ParticipantLimit),this._vidyoCore.EventDispatcher.on(r.Events.ParticipantLimitChanged,m.VidyoAdvancedSettingsEventListeners,o)),a&&(a(this._vidyoCore.Controllers.AdvancedSettingsController.ShowStatisticsOverlay),this._vidyoCore.EventDispatcher.on(r.Events.ShowStatisticsOverlayChanged,m.VidyoAdvancedSettingsEventListeners,a)),s&&(s(this._vidyoCore.Controllers.AdvancedSettingsController.EnableXMPPMessageLogging),this._vidyoCore.EventDispatcher.on(r.Events.EnableXMPPMessageLoggingChanged,m.VidyoAdvancedSettingsEventListeners,s)),c&&(c(this._vidyoCore.Controllers.AdvancedSettingsController.EnableSimpleAPILogging),this._vidyoCore.EventDispatcher.on(r.Events.EnableSimpleAPILoggingChanged,m.VidyoAdvancedSettingsEventListeners,c)),u&&(u(this._vidyoCore.Controllers.AdvancedSettingsController.EnableVidyoConnectorAPILogging),this._vidyoCore.EventDispatcher.on(r.Events.EnableVidyoConnectorAPILoggingChanged,m.VidyoAdvancedSettingsEventListeners,u))},e.prototype.RegisterLocalCameraEventListener=function(e,t,n,r){var o=this,a=function(t){e(new u.Camera(t.camera))};this._vidyoCore.EventDispatcher.on(i.Events.CameraAdded,m.VidyoLocalCameraEventListeners,a);var s=function(e){t(new u.Camera(e.camera))};this._vidyoCore.EventDispatcher.on(i.Events.CameraRemoved,m.VidyoLocalCameraEventListeners,s);var c=function(e){n(new u.Camera(e.camera))};this._vidyoCore.EventDispatcher.on(i.Events.CameraSelected,m.VidyoLocalCameraEventListeners,c);var l;return this._vidyoCore.Controllers.DeviceController.DevicesAreBeingDetected?(this._vidyoCore.Controllers.DeviceController.GetCameraList().forEach(function(e){return a({camera:e})}),l=_.Promise.resolve(!0)):l=this._vidyoCore.Controllers.DeviceController.StartDeviceDetection(),l.then(function(){if(o._vidyoCore.Controllers.DeviceController.IsCameraSelected()){var e=o._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Camera;"boolean"!=typeof e&&c({camera:e})}else o._vidyoCore.Controllers.DeviceController.SelectDefaultCamera();return o._registerLocalCameraPlugInOutManager(),!0})["catch"](function(){return!1})},e.prototype.RegisterLocalMicrophoneEnergyListener=function(e){return this._vidyoCore.Controllers.MicrophoneEnergyLevelController.RegisterLocalMicrophoneEnergyListener(e)},e.prototype.RegisterLocalMicrophoneEventListener=function(e,t,n,r){var o=this,a=function(t){e(new u.Microphone(t.microphone))};this._vidyoCore.EventDispatcher.on(i.Events.MicrophoneAdded,m.VidyoLocalMicrophoneEventListeners,a);var s=function(e){t(new u.Microphone(e.microphone))};this._vidyoCore.EventDispatcher.on(i.Events.MicrophoneRemoved,m.VidyoLocalMicrophoneEventListeners,s);var c=function(e){n(new u.Microphone(e.microphone))};this._vidyoCore.EventDispatcher.on(i.Events.MicrophoneSelected,m.VidyoLocalMicrophoneEventListeners,c);var l;return this._vidyoCore.Controllers.DeviceController.DevicesAreBeingDetected?(this._vidyoCore.Controllers.DeviceController.GetMicrophoneList().forEach(function(e){return a({microphone:e})}),l=_.Promise.resolve(!0)):l=this._vidyoCore.Controllers.DeviceController.StartDeviceDetection(),l.then(function(){if(o._vidyoCore.Controllers.DeviceController.IsMicrophoneSelected()){var e=o._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Microphone;"boolean"!=typeof e&&c({microphone:e})}else o._vidyoCore.Controllers.DeviceController.SelectDefaultMicrophone();return o._registerLocalMicrophonePlugInOutManager(),!0})["catch"](function(){return!1})},e.prototype.RegisterLocalMonitorEventListener=function(e,t,n,r){var i=new y.Monitor("Select Monitor");return this._vidyoCore.EventDispatcher.on(o.Events.LocalMonitorAdded,m.VidyoLocalMonitorEventListeners,function(){return e(i)}),this._vidyoCore.EventDispatcher.on(o.Events.LocalMonitorSelected,m.VidyoLocalMonitorEventListeners,function(){return n(i)}),this._vidyoCore.EventDispatcher.on(o.Events.LocalMonitorDeselected,m.VidyoLocalMonitorEventListeners,function(){return n(void 0)}),this._vidyoCore.EventDispatcher.on(o.Events.LocalMonitorRemoved,m.VidyoLocalMonitorEventListeners,function(){return t(i)}),e(i),_.Promise.resolve(!0)},e.prototype.RegisterLocalSpeakerEventListener=function(e,t,n,r){var o=this,a=function(t){e(new u.Speaker(t.speaker))};this._vidyoCore.EventDispatcher.on(i.Events.SpeakerAdded,m.VidyoLocalSpeakerEventListeners,a);var s=function(e){t(new u.Speaker(e.speaker))};this._vidyoCore.EventDispatcher.on(i.Events.SpeakerRemoved,m.VidyoLocalSpeakerEventListeners,s);var c=function(e){n(new u.Speaker(e.speaker))};this._vidyoCore.EventDispatcher.on(i.Events.SpeakerSelected,m.VidyoLocalSpeakerEventListeners,c);var l;return this._vidyoCore.Controllers.DeviceController.DevicesAreBeingDetected?(this._vidyoCore.Controllers.DeviceController.GetSpeakerList().forEach(function(e){return a({speaker:e})}),l=_.Promise.resolve(!0)):l=this._vidyoCore.Controllers.DeviceController.StartDeviceDetection(),l.then(function(){if(o._vidyoCore.Controllers.DeviceController.IsSpeakerSelected()){var e=o._vidyoCore.Controllers.DeviceController.GetSelectedDevices().Speaker;"boolean"!=typeof e&&c({speaker:e})}else o._vidyoCore.Controllers.DeviceController.SelectDefaultSpeaker();return o._registerLocalSpeakerPlugInOutManager(),!0})["catch"](function(){return!1})},e.prototype.RegisterLocalWindowShareEventListener=function(e,t,n,r){var i=new g.WindowShare("Select Share",S.Origin.Local,"Application");return this._vidyoCore.EventDispatcher.on(o.Events.LocalWindowShareAdded,m.VidyoLocalWindowShareEventListeners,function(){return e(i)}),this._vidyoCore.EventDispatcher.on(o.Events.LocalWindowShareSelected,m.VidyoLocalWindowShareEventListeners,function(){return n(i)}),this._vidyoCore.EventDispatcher.on(o.Events.LocalWindowShareDeselected,m.VidyoLocalWindowShareEventListeners,function(){return n(void 0)}),this._vidyoCore.EventDispatcher.on(o.Events.LocalWindowShareRemoved,m.VidyoLocalWindowShareEventListeners,function(){return t(i)}),e(i),_.Promise.resolve(!0)},e.prototype.RegisterLogEventListener=function(){p.NotImplemented()},e.prototype.RegisterRemoteCameraEventListener=function(e,t,n){return this._vidyoCore.EventDispatcher.on(o.Events.RemoteCameraAdded,m.VidyoRemoteCameraEventListeners,function(t){e(new u.RemoteCamera(t.camera,S.Origin.Remote),new f.Participant(t.participant))}),this._vidyoCore.EventDispatcher.on(o.Events.RemoteCameraRemoved,m.VidyoRemoteCameraEventListeners,function(e){t(new u.RemoteCamera(e.camera,S.Origin.Remote),new f.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(o.Events.RemoteCameraStateUpdated,m.VidyoRemoteCameraEventListeners,function(e){n(new u.RemoteCamera(e.camera,S.Origin.Remote),new f.Participant(e.participant))}),_.Promise.resolve(!0)},e.prototype.RegisterRemoteMicrophoneEnergyListener=function(e){return this._vidyoCore.Controllers.MicrophoneEnergyLevelController.RegisterRemoteMicrophoneEnergyListener(e)},e.prototype.RegisterRemoteMicrophoneEventListener=function(e,t,n){return this._vidyoCore.EventDispatcher.on(o.Events.RemoteMicrophoneAdded,m.VidyoRemoteMicrophoneEventListeners,function(t){e(new u.RemoteMicrophone(t.microphone,S.Origin.Remote),new f.Participant(t.participant))}),this._vidyoCore.EventDispatcher.on(o.Events.RemoteMicrophoneRemoved,m.VidyoRemoteMicrophoneEventListeners,function(e){t(new u.RemoteMicrophone(e.microphone,S.Origin.Remote),new f.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(o.Events.RemoteMicrophoneStateUpdated,m.VidyoRemoteMicrophoneEventListeners,function(e){n(new u.RemoteMicrophone(e.microphone,S.Origin.Remote),new f.Participant(e.participant))}),_.Promise.resolve(!0)},e.prototype.RegisterRemoteWindowShareEventListener=function(e,t,n){return this._vidyoCore.EventDispatcher.on(o.Events.RemoteWindowShareAdded,m.VidyoRemoteWindowShareEventListeners,function(t){e(new u.RemoteWindowShare(t.windowShare,S.Origin.Remote),new f.Participant(t.participant))}),this._vidyoCore.EventDispatcher.on(o.Events.RemoteWindowShareRemoved,m.VidyoRemoteWindowShareEventListeners,function(e){t(new u.RemoteWindowShare(e.windowShare,S.Origin.Remote),new f.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(o.Events.RemoteWindowShareStateUpdated,m.VidyoRemoteWindowShareEventListeners,function(e){n(new u.RemoteWindowShare(e.windowShare,S.Origin.Remote),new f.Participant(e.participant))}),_.Promise.resolve(!0)},e.prototype.SelectCamera=function(e){e?this._vidyoCore.Controllers.DeviceController.SelectCamera(new c.Camera(e.name,e.id,e.objId)):this._vidyoCore.Controllers.DeviceController.SelectCamera(),this._setDefaultCamera(e)},e.prototype.SelectDefaultCamera=function(){this._vidyoCore.Controllers.DeviceController.SelectDefaultCamera()},e.prototype.SelectDefaultMicrophone=function(){this._vidyoCore.Controllers.DeviceController.SelectDefaultMicrophone()},e.prototype.SelectDefaultSpeaker=function(){this._vidyoCore.Controllers.DeviceController.SelectDefaultSpeaker()},e.prototype.SelectLocalMicrophone=function(){p.NotImplemented()},e.prototype.SelectLocalMonitor=function(e){return this._vidyoCore.Controllers.DeviceController.SelectMonitor(e).then(function(){return!0},function(){return!1})["catch"](function(){return!1})},e.prototype.SelectLocalSpeaker=function(){p.NotImplemented()},e.prototype.SelectLocalWindowShare=function(e){return this._vidyoCore.Controllers.DeviceController.SelectWindowShare(e).then(function(){return!0},function(){return!1})["catch"](function(){return!1})},e.prototype.SelectMicrophone=function(e){e?this._vidyoCore.Controllers.DeviceController.SelectMicrophone(new d.Microphone(e.name,e.id,e.objId)):this._vidyoCore.Controllers.DeviceController.SelectMicrophone(),this._setDefaultMicrophone(e)},e.prototype.SelectSpeaker=function(e){var t=e?new h.Speaker(e.name,e.id,e.objId):new h.Speaker("","","");this._vidyoCore.Controllers.DeviceController.SelectSpeaker(t)},e.prototype.SetAdvancedConfiguration=function(e){"undefined"!=typeof e.addGoogleConferenceFlag&&(this._vidyoCore.Controllers.AdvancedSettingsController.AddGoogleConferenceFlag=e.addGoogleConferenceFlag),"undefined"!=typeof e.codecExcludeFilter&&(this._vidyoCore.Controllers.AdvancedSettingsController.CodecExcludeFilter=e.codecExcludeFilter),"undefined"!=typeof e.disableStats&&(this._vidyoCore.Controllers.AdvancedSettingsController.DisableStats=e.disableStats),"undefined"!=typeof e.enableSimulcast&&(this._vidyoCore.Controllers.AdvancedSettingsController.EnableSimulcast=e.enableSimulcast),"undefined"!=typeof e.participantLimit&&this._vidyoCore.Controllers.ResourcesController.ResetParticipantLimit(Number(e.participantLimit)),"undefined"!=typeof e.showStatisticsOverlay&&(this._vidyoCore.Controllers.AdvancedSettingsController.ShowStatisticsOverlay=e.showStatisticsOverlay),"undefined"!=typeof e.enableXMPPMessageLogging&&(this._vidyoCore.Controllers.AdvancedSettingsController.EnableXMPPMessageLogging=e.enableXMPPMessageLogging),"undefined"!=typeof e.enableSimpleAPILogging&&(this._vidyoCore.Controllers.AdvancedSettingsController.EnableSimpleAPILogging=e.enableSimpleAPILogging),"undefined"!=typeof e.enableVidyoConnectorAPILogging&&(this._vidyoCore.Controllers.AdvancedSettingsController.EnableVidyoConnectorAPILogging=e.enableVidyoConnectorAPILogging)},e.prototype.SetCameraPrivacy=function(e){this._vidyoCore.Controllers.DeviceController.SetVideoMuteState(e)},e.prototype.SetConsoleLoggerFilter=function(){p.NotImplemented()},e.prototype.SetFileLoggerFilter=function(){p.NotImplemented()},e.prototype.SetLocation=function(){p.NotImplemented()},e.prototype.SetMicrophonePrivacy=function(e){this._vidyoCore.Controllers.DeviceController.SetAudioMuteState(e)},e.prototype.SetMode=function(){p.NotImplemented()},e.prototype.SetPreview=function(e){this._vidyoCore.Controllers.RendererController.SetPreview({preview:e})},e.prototype.SetSpeakerPrivacy=function(e){this._vidyoCore.Controllers.DeviceController.SetSpeakerMuteState(e)},e.prototype.SetViewAnimationSpeed=function(e,t){p.NotImplemented()},e.prototype.SetViewBackgroundColor=function(e,t,n,r){p.NotImplemented()},e.prototype.ShowViewAt=function(e,t,n,r,i){return this._vidyoCore.Controllers.RendererController.ShowViewAt({viewId:e,x:t,y:n,width:r,height:i})},e.prototype.ShowViewLabel=function(e,t){p.NotImplemented()},e.prototype.ShowWindowSharePreview=function(e){this._vidyoCore.Controllers.RendererController.ShowLocalShare(e)},e.prototype.StartDeviceDetection=function(){return this._vidyoCore.Controllers.DeviceController.StartDeviceDetection()},e.prototype.StartLocationDetection=function(){p.NotImplemented()},e.prototype.StartShareDetection=function(){p.NotImplemented()},e.prototype.StopDeviceDetection=function(){p.NotImplemented()},e.prototype.StopLocationDetection=function(){p.NotImplemented()},e.prototype.StopShareDetection=function(){p.NotImplemented()},e.prototype.UnregisterLocalCameraEventListener=function(){return this._vidyoCore.Controllers.DeviceController.ClearLocalCameras(),this._vidyoCore.EventDispatcher.releaseGroup(m.VidyoLocalCameraEventListeners),_.Promise.resolve(!0)},e.prototype.UnregisterLocalMicrophoneEnergyListener=function(){return this._vidyoCore.Controllers.MicrophoneEnergyLevelController.UnregisterLocalMicrophoneEnergyListener()},e.prototype.UnregisterLocalMicrophoneEventListener=function(){return this._vidyoCore.Controllers.DeviceController.ClearLocalMicrophones(),this._vidyoCore.EventDispatcher.releaseGroup(m.VidyoLocalMicrophoneEventListeners),_.Promise.resolve(!0)},e.prototype.UnregisterLocalMonitorEventListener=function(){return this._vidyoCore.EventDispatcher.emit(o.Events.LocalMonitorRemoved),this._vidyoCore.EventDispatcher.releaseGroup(m.VidyoLocalMonitorEventListeners),_.Promise.resolve(!0)},e.prototype.UnregisterLocalRendererEventListener=function(){p.NotImplemented()},e.prototype.UnregisterLocalSpeakerEventListener=function(){return this._vidyoCore.Controllers.DeviceController.ClearLocalSpeakers(),this._vidyoCore.EventDispatcher.releaseGroup(m.VidyoLocalSpeakerEventListeners),_.Promise.resolve(!0)},e.prototype.UnregisterLocalWindowShareEventListener=function(){return this._vidyoCore.EventDispatcher.emit(o.Events.LocalWindowShareRemoved),this._vidyoCore.EventDispatcher.releaseGroup(m.VidyoLocalWindowShareEventListeners),_.Promise.resolve(!0)},e.prototype.UnregisterLogEventListener=function(){p.NotImplemented()},e.prototype.UnregisterRemoteCameraEventListener=function(){return this._vidyoCore.EventDispatcher.releaseGroup(m.VidyoRemoteCameraEventListeners),_.Promise.resolve(!0)},e.prototype.UnregisterRemoteMicrophoneEnergyListener=function(){return this._vidyoCore.Controllers.MicrophoneEnergyLevelController.UnregisterRemoteMicrophoneEnergyListener()},e.prototype.UnregisterRemoteMicrophoneEventListener=function(){return this._vidyoCore.EventDispatcher.releaseGroup(m.VidyoRemoteMicrophoneEventListeners),_.Promise.resolve(!0)},e.prototype.UnregisterRemoteRendererEventListener=function(){p.NotImplemented()},e.prototype.UnregisterRemoteSpeakerEventListener=function(){p.NotImplemented()},e.prototype.UnregisterRemoteWindowShareEventListener=function(){return this._vidyoCore.EventDispatcher.releaseGroup(m.VidyoRemoteWindowShareEventListeners),_.Promise.resolve(!0)},e.prototype._createEndpointID=function(){var e="VidyoCore::EndpointID",t=this._vidyoCore.Storage.GetLocal(e);return t||(t=a.v4(),this._vidyoCore.Storage.SetLocal(e,t)),t},e.prototype._onLocalCameraAdded=function(e){if(!this._vidyoCore.Controllers.DeviceController.IsDefaultCameraSelected()){var t=new u.Camera(e.camera);this.SelectCamera(t),this._setDefaultCamera(t)}},e.prototype._onLocalCameraRemoved=function(e){this._vidyoCore.Controllers.DeviceController.IsDefaultCamera(e.camera)&&this._setDefaultCamera(null),this._vidyoCore.Controllers.DeviceController.IsDefaultCameraSelected()||this.SelectDefaultCamera()},e.prototype._onLocalMicrophoneAdded=function(e){if(!this._vidyoCore.Controllers.DeviceController.IsDefaultMicrophoneSelected()){var t=new u.Microphone(e.microphone);this.SelectMicrophone(t),this._setDefaultMicrophone(t)}},e.prototype._onLocalMicrophoneRemoved=function(e){this._vidyoCore.Controllers.DeviceController.IsDefaultMicrophone(e.microphone)&&this._setDefaultMicrophone(null),this.SelectDefaultMicrophone()},e.prototype._onLocalSpeakerAdded=function(e){if(!this._vidyoCore.Controllers.DeviceController.IsDefaultSpeakerSelected()){var t=new u.Speaker(e.speaker);this.SelectSpeaker(t),this._setDefaultSpeaker(t)}},e.prototype._onLocalSpeakerRemoved=function(e){this._vidyoCore.Controllers.DeviceController.IsDefaultSpeaker(e.speaker)&&this._setDefaultSpeaker(null),this.SelectDefaultSpeaker()},e.prototype._registerLocalCameraPlugInOutManager=function(){var e=this;this._vidyoCore.EventDispatcher.on(i.Events.CameraAdded,m.VidyoLocalCameraEventListeners,function(t){e._onLocalCameraAdded(t)}),this._vidyoCore.EventDispatcher.on(i.Events.CameraRemoved,m.VidyoLocalCameraEventListeners,function(t){e._onLocalCameraRemoved(t)})},e.prototype._registerLocalMicrophonePlugInOutManager=function(){var e=this;this._vidyoCore.EventDispatcher.on(i.Events.MicrophoneAdded,m.VidyoLocalMicrophoneEventListeners,function(t){e._onLocalMicrophoneAdded(t)}),this._vidyoCore.EventDispatcher.on(i.Events.MicrophoneRemoved,m.VidyoLocalMicrophoneEventListeners,function(t){e._onLocalMicrophoneRemoved(t)})},e.prototype._registerLocalSpeakerPlugInOutManager=function(){var e=this;this._vidyoCore.EventDispatcher.on(i.Events.SpeakerAdded,m.VidyoLocalSpeakerEventListeners,function(t){e._onLocalSpeakerAdded(t)}),this._vidyoCore.EventDispatcher.on(i.Events.SpeakerRemoved,m.VidyoLocalSpeakerEventListeners,function(t){e._onLocalSpeakerRemoved(t)})},e.prototype._setDefaultCamera=function(e){this._vidyoCore.Controllers.DeviceController.SetDefaultCamera(null!==e?new c.Camera(e.name,e.id,e.objId):null)},e.prototype._setDefaultMicrophone=function(e){this._vidyoCore.Controllers.DeviceController.SetDefaultMicrophone(null!==e?new d.Microphone(e.name,e.id,e.objId):null)},e.prototype._setDefaultSpeaker=function(e){this._vidyoCore.Controllers.DeviceController.SetDefaultSpeaker(null!==e?new h.Speaker(e.name,e.id,e.objId):null)},e}();n.EndPoint=b}).call(this,"/src/vidyo_simple_api/EndPoint.ts")},{"../core/events/AdvancedSettingsEvents":367,"../core/events/DeviceEvents":371,"../core/events/EventDispatcher":372,"../core/events/StreamEvents":378,"../core/models/device/Camera":390,"../core/models/device/Microphone":394,"../core/models/device/Speaker":395,"../core/utils/AssignHiddenPropertyValue":420,"../core/utils/NotImplemented":434,"../core/utils/VidyoDebugger":446,"../vidyo_simple_api/Participant":492,"./Devices":488,"./Monitor":490,"./Origin":491,"./WindowShare":496,"./stats/Stats":515,"es6-promise":31,uuid:310}],490:[function(e,t,n){(function(t){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("uuid"),o=e("./Origin"),a=e("./BaseModel"),s=e("../core/utils/VidyoDebugger"),c=function(e){function n(n,r){void 0===r&&(r=o.Origin.Local);var a=e.call(this,i.v4(),n,i.v4(),r,"Monitor")||this;return s.VidyoDebugger.Debug(a,s.API.Simple,t),a}return r(n,e),n.prototype.GetId=function(){return this.id},n.prototype.GetName=function(){return this.name},n.prototype.SetFrameInterval=function(e){},n}(a.BaseModel);n.Monitor=c}).call(this,"/src/vidyo_simple_api/Monitor.ts");

},{"../core/utils/VidyoDebugger":446,"./BaseModel":487,"./Origin":491,uuid:310}],491:[function(e,t,n){"use strict";function r(e){switch(e){case o.ParticipantOrigin.Local:return i.Local;case o.ParticipantOrigin.Remote:return i.Remote}}Object.defineProperty(n,"__esModule",{value:!0});var i,o=e("../core/models/Participant");!function(e){e.Local="Local",e.Remote="Remote"}(i=n.Origin||(n.Origin={})),n.FromCoreOrigin=r},{"../core/models/Participant":383}],492:[function(e,t,n){(function(t){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./BaseModel"),o=e("./Origin"),a=e("../core/utils/NotImplemented"),s=e("es6-promise"),c=e("../core/utils/VidyoDebugger"),u=function(e){function n(n){var r=e.call(this,n.Id,n.Name,n.ObjId,o.FromCoreOrigin(n.Origin),"Participant")||this;return c.VidyoDebugger.Debug(r,c.API.Simple,t),r}return r(n,e),n.prototype.GetId=function(){a.NotImplemented()},n.prototype.GetName=function(){return s.Promise.resolve(this.name)},n.prototype.GetUserId=function(){a.NotImplemented()},n.prototype.IsHidden=function(){a.NotImplemented()},n.prototype.IsRecording=function(){a.NotImplemented()},n.prototype.IsSelectable=function(){a.NotImplemented()},n}(i.BaseModel);n.Participant=u}).call(this,"/src/vidyo_simple_api/Participant.ts")},{"../core/utils/NotImplemented":434,"../core/utils/VidyoDebugger":446,"./BaseModel":487,"./Origin":491,"es6-promise":31}],493:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../core/events/ParticipantEvents"),i=e("uuid"),o=e("../core/utils/AssignHiddenPropertyValue"),a=e("../vidyo_simple_api/Devices"),s=e("../core/events/RoomEvents"),c=e("../core/events/StreamEvents"),u=e("../core/utils/NotImplemented"),l=e("../vidyo_simple_api/Participant"),d=e("../core/events/EventDispatcher"),p=e("../core/utils/VidyoDebugger"),f=function(){function e(e,n){this.objType="VidyoRoom",this.objId=i.v4(),o.AssignHiddenPropertyValue(this,"_vidyoCore",e),o.AssignHiddenPropertyValue(this,"_coreRoom",n),p.VidyoDebugger.Debug(this,p.API.Simple,t)}return e.prototype.AcceptIncoming=function(){u.NotImplemented()},e.prototype.Delete=function(){u.NotImplemented()},e.prototype.DisableMedia=function(){u.NotImplemented()},e.prototype.EnableMedia=function(e,t,n){return this._vidyoCore.EventDispatcher.releaseGroup(d.VidyoEnableMediaRoomListeners),this._vidyoCore.EventDispatcher.once(c.Events.MediaFailed,d.VidyoEnableMediaRoomListeners,function(e){t(e.reason)}),this._vidyoCore.EventDispatcher.once(c.Events.MediaDisabled,d.VidyoEnableMediaRoomListeners,function(e){n(e.reason)}),this._vidyoCore.Controllers.ConnectionController.StartMediaExchange(),e(),!0},e.prototype.Enter=function(e,t){return this._vidyoCore.EventDispatcher.releaseGroup(d.VidyoEnterRoomListeners),this._vidyoCore.EventDispatcher.once(s.Events.Entered,d.VidyoEnterRoomListeners,function(t){e()}),this._vidyoCore.EventDispatcher.once(s.Events.Left,d.VidyoEnterRoomListeners,function(e){t()}),this._vidyoCore.Controllers.RoomController.Enter(this._coreRoom),!0},e.prototype.GetHistory=function(){u.NotImplemented()},e.prototype.GetHistoryById=function(){u.NotImplemented()},e.prototype.GetHistoryByTime=function(){u.NotImplemented()},e.prototype.GetId=function(){u.NotImplemented()},e.prototype.GetRoomProperties=function(){u.NotImplemented()},e.prototype.GetType=function(){u.NotImplemented()},e.prototype.Invite=function(){u.NotImplemented()},e.prototype.InviteN=function(){u.NotImplemented()},e.prototype.Leave=function(){return this._vidyoCore.Controllers.RoomController.Leave(this._coreRoom),!0},e.prototype.MessageSearch=function(){u.NotImplemented()},e.prototype.RegisterMessageEventListener=function(){u.NotImplemented()},e.prototype.RegisterParticipantEventListener=function(e,t,n,i){return this._vidyoCore.EventDispatcher.releaseGroup(d.VidyoRoomParticipantEventListeners),this._vidyoCore.EventDispatcher.on(r.Events.ParticipantJoined,d.VidyoRoomParticipantEventListeners,function(t){e(new l.Participant(t.participant))}),this._vidyoCore.EventDispatcher.on(r.Events.ParticipantLeft,d.VidyoRoomParticipantEventListeners,function(e){t(new l.Participant(e.participant))}),this._vidyoCore.EventDispatcher.on(r.Events.DynamicParticipantChanged,d.VidyoRoomParticipantEventListeners,function(e){n(e.participants.map(function(e){return new l.Participant(e)}),e.cameras.map(function(e){return new a.Camera(e)}))}),this._vidyoCore.EventDispatcher.on(r.Events.LoudestParticipantChanged,d.VidyoRoomParticipantEventListeners,function(e){i(new l.Participant(e.participant),void 0)}),Promise.resolve(!0)},e.prototype.RegisterResourceManagerEventListener=function(){u.NotImplemented()},e.prototype.RegisterRoomPropertiesEventListener=function(){u.NotImplemented()},e.prototype.RegisterSubjectEventListener=function(){u.NotImplemented()},e.prototype.RejectIncoming=function(){u.NotImplemented()},e.prototype.SendMessage=function(){u.NotImplemented()},e.prototype.SendMessageAcknowledged=function(){u.NotImplemented()},e.prototype.SendMessageTypingIndication=function(){u.NotImplemented()},e.prototype.SetRoomProperties=function(){u.NotImplemented()},e.prototype.SetSubject=function(){u.NotImplemented()},e.prototype.UnregisterMessageEventListener=function(){u.NotImplemented()},e.prototype.UnregisterParticipantEventListener=function(){this._vidyoCore.EventDispatcher.releaseGroup(d.VidyoRoomParticipantEventListeners)},e.prototype.UnregisterResourceManagerEventListener=function(){u.NotImplemented()},e.prototype.UnregisterRoomPropertiesEventListener=function(){u.NotImplemented()},e.prototype.UnregisterSubjectEventListener=function(){u.NotImplemented()},e}();n.Room=f}).call(this,"/src/vidyo_simple_api/Room.ts")},{"../core/events/EventDispatcher":372,"../core/events/ParticipantEvents":374,"../core/events/RoomEvents":376,"../core/events/StreamEvents":378,"../core/utils/AssignHiddenPropertyValue":420,"../core/utils/NotImplemented":434,"../core/utils/VidyoDebugger":446,"../vidyo_simple_api/Devices":488,"../vidyo_simple_api/Participant":492,uuid:310}],494:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../core/events/ConnectionEvents"),i=e("uuid"),o=e("../core/utils/AssignHiddenPropertyValue"),a=e("../core/events/RoomEvents"),s=e("../core/utils/NotImplemented"),c=e("../core/events/EventDispatcher"),u=e("./stats/Stats"),l=e("../core/events/ConnectionEvents"),d=e("../core/utils/VidyoDebugger"),p=function(){function e(e){this.objType="VidyoUser",this.objId=i.v4(),o.AssignHiddenPropertyValue(this,"_vidyoCore",e),d.VidyoDebugger.Debug(this,d.API.Simple,t)}return e.prototype.AddRosterContact=function(){s.NotImplemented()},e.prototype.CreateRoomFromId=function(e,t,n){return this._vidyoCore.EventDispatcher.once(a.Events.Created,c.VidyoUserListeners,function(e){n(e.room,e.result,e.token)}),this._vidyoCore.Controllers.RoomController.CreateRoom({token:t,resourceId:e}),!0},e.prototype.CreateRoomWithId=function(e,t,n){return this._vidyoCore.EventDispatcher.once(a.Events.Created,c.VidyoUserListeners,function(e){n(e.room,e.result,e.token)}),this._vidyoCore.Controllers.RoomController.CreateRoom({token:t,isNewRoom:!0,resourceId:e}),!0},e.prototype.CreateTopicRoom=function(e,t,n,r){return this._vidyoCore.EventDispatcher.once(a.Events.Created,c.VidyoUserListeners,function(e){r(e.room,e.result,e.token)}),this._vidyoCore.Controllers.RoomController.CreateRoom({token:n,isNewRoom:!0,subject:t,resourceId:e}),!0},e.prototype.GetContact=function(){s.NotImplemented()},e.prototype.GetConversationRoom=function(){s.NotImplemented()},e.prototype.GetId=function(){s.NotImplemented()},e.prototype.GetRecentRooms=function(){s.NotImplemented()},e.prototype.GetStats=function(){var e=this._vidyoCore.Controllers.StatisticsController.GetUserStatistics(),t=new u.UserStats(e);return t},e.prototype.Login=function(e,t,n,i,o,a,s,u,l,d){return this._vidyoCore.EventDispatcher.releaseGroup(c.VidyoUserListeners),this._vidyoCore.EventDispatcher.on(r.Events.Connected,c.VidyoUserListeners,function(e){a(e.result,e.isSecure)}),this._vidyoCore.EventDispatcher.on(r.Events.Disconnected,c.VidyoUserListeners,function(e){s(e)}),this._vidyoCore.EventDispatcher.on(r.Events.ConnectionStatusChanged,c.VidyoUserListeners,function(e){u(e.reason)}),this._vidyoCore.EventDispatcher.on(r.Events.TokenReceived,c.VidyoUserListeners,function(e){l(e.token,e.tokenType)}),this._vidyoCore.EventDispatcher.on(r.Events.GetWebProxyCredentials,c.VidyoUserListeners,function(e){d(e.webProxyAddress)}),this._vidyoCore.Controllers.ConnectionController.CreateConnection({credentials:{username:e,password:t},host:n,port:i,serviceType:o}),this._vidyoCore.Controllers.ConnectionController.Connect(),!0},e.prototype.LoginAsGuest=function(e,t,n,i,o,a,s,u,l){return this._vidyoCore.EventDispatcher.releaseGroup(c.VidyoUserListeners),this._vidyoCore.EventDispatcher.on(r.Events.Connected,c.VidyoUserListeners,function(e){o(e.result,e.isSecure)}),this._vidyoCore.EventDispatcher.on(r.Events.Disconnected,c.VidyoUserListeners,function(e){a(e)}),this._vidyoCore.EventDispatcher.on(r.Events.ConnectionStatusChanged,c.VidyoUserListeners,function(e){s(e.reason)}),this._vidyoCore.EventDispatcher.on(r.Events.TokenReceived,c.VidyoUserListeners,function(e){u(e.token,e.tokenType)}),this._vidyoCore.EventDispatcher.on(r.Events.GetWebProxyCredentials,c.VidyoUserListeners,function(e){l(e.webProxyAddress)}),this._vidyoCore.Controllers.ConnectionController.CreateConnection({displayName:e,saslMechanisms:["anonymous"],host:t,port:n,serviceType:i}),this._vidyoCore.Controllers.ConnectionController.Connect(),!0},e.prototype.LoginWithAccessToken=function(e,t,n,r,i,o,a,s,c){return this.LoginWithTenantToken(e,t,n,r,i,o,a,s,c)},e.prototype.LoginWithRefreshToken=function(e,t,n,r,i,o,a,s,c){return this.LoginWithTenantToken(e,t,n,r,i,o,a,s,c)},e.prototype.LoginWithTenantToken=function(e,t,n,i,o,a,s,u,l){return this._vidyoCore.EventDispatcher.releaseGroup(c.VidyoUserListeners),this._vidyoCore.EventDispatcher.on(r.Events.Connected,c.VidyoUserListeners,function(e){o(e.result,e.isSecure)}),this._vidyoCore.EventDispatcher.on(r.Events.Disconnected,c.VidyoUserListeners,function(e){a(e)}),this._vidyoCore.EventDispatcher.on(r.Events.ConnectionStatusChanged,c.VidyoUserListeners,function(e){s(e.reason)}),this._vidyoCore.EventDispatcher.on(r.Events.TokenReceived,c.VidyoUserListeners,function(e){u(e.token,e.tokenType)}),this._vidyoCore.EventDispatcher.on(r.Events.GetWebProxyCredentials,c.VidyoUserListeners,function(e){l(e.webProxyAddress)}),this._vidyoCore.Controllers.ConnectionController.CreateConnection({credentials:{password:e,token:e},displayName:this._displayName,host:t,port:n,serviceType:i}),this._vidyoCore.Controllers.ConnectionController.Connect(),!0},e.prototype.Logout=function(){return this._vidyoCore.Controllers.ConnectionController.Disconnect(l.ConnectionEventsInfo.Disconnecting),!0},e.prototype.RegisterContactEventListener=function(){s.NotImplemented()},e.prototype.RegisterRoomEventListener=function(){s.NotImplemented()},e.prototype.RemoveRosterContact=function(){s.NotImplemented()},e.prototype.SearchConversationRooms=function(){s.NotImplemented()},e.prototype.SearchRooms=function(){s.NotImplemented()},e.prototype.SearchRoomsWithName=function(){s.NotImplemented()},e.prototype.SearchRoomsWithOwner=function(){s.NotImplemented()},e.prototype.SearchRoomsWithSubject=function(){s.NotImplemented()},e.prototype.SearchTopicRooms=function(){s.NotImplemented()},e.prototype.SearchUsers=function(){s.NotImplemented()},e.prototype.SetDisplayName=function(e){o.AssignHiddenPropertyValue(this,"_displayName",e)},e.prototype.SetWebProxyAddressCredentials=function(){s.NotImplemented()},e.prototype.UnregisterCallEventListener=function(){s.NotImplemented()},e.prototype.UnregisterContactEventListener=function(){s.NotImplemented()},e.prototype.UnregisterLicenseEventListener=function(){s.NotImplemented()},e.prototype.UnregisterRoomEventListener=function(){s.NotImplemented()},e.prototype.UpdatePresence=function(){s.NotImplemented()},e}();n.User=p}).call(this,"/src/vidyo_simple_api/User.ts")},{"../core/events/ConnectionEvents":370,"../core/events/EventDispatcher":372,"../core/events/RoomEvents":376,"../core/utils/AssignHiddenPropertyValue":420,"../core/utils/NotImplemented":434,"../core/utils/VidyoDebugger":446,"./stats/Stats":515,uuid:310}],495:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("uuid"),i=e("../core/utils/AssignHiddenPropertyValue"),o=e("../core/events/LogEvents"),a=e("../core/VidyoCore"),s=e("../core/utils/VidyoDebugger"),c=function(){function e(){this.objType="VidyoSimple",this.objId=r.v4(),i.AssignHiddenPropertyValue(this,"_vidyoCore",new a.VidyoCore),s.VidyoDebugger.Debug(this,s.API.Simple,t)}return e.prototype.CreateVidyoEndpoint=function(e,t,n,r,i,o){return this._vidyoCore.CreateEndpoint(e,t,n)},e.prototype.CreateVidyoUser=function(e){return this._vidyoCore.CreateUser(e)},e.prototype.Disable=function(){return this._vidyoCore.Disable()},e.prototype.Initialize=function(){var e=this;return this._vidyoCore.Initialize().then(function(){return e._vidyoCore.EventDispatcher.on(o.Events.Error,console.error.bind(console)),e._vidyoCore.EventDispatcher.on(o.Events.Info,console.log.bind(console)),e._vidyoCore.EventDispatcher.on(o.Events.Verbose,console.debug.bind(console)),e._vidyoCore.EventDispatcher.on(o.Events.Warning,console.warn.bind(console)),!0})},e}();n.VidyoSimple=c;var u=e("./Devices");n.VidyoCamera=u.Camera,n.VidyoMicrophone=u.Microphone,n.VidyoSpeaker=u.Speaker,n.VidyoRemoteCamera=u.RemoteCamera,n.VidyoRemoteMicrophone=u.RemoteMicrophone,n.VidyoRemoteWindowShare=u.RemoteWindowShare;var l=e("./Room");n.VidyoRoom=l.Room;var d=e("./User");n.VidyoUser=d.User;var p=e("./Participant");n.VidyoParticipant=p.Participant;var f=e("./EndPoint");n.VidyoEndpoint=f.EndPoint}).call(this,"/src/vidyo_simple_api/VidyoSimple.ts")},{"../core/VidyoCore":342,"../core/events/LogEvents":373,"../core/utils/AssignHiddenPropertyValue":420,"../core/utils/VidyoDebugger":446,"./Devices":488,"./EndPoint":489,"./Participant":492,"./Room":493,"./User":494,uuid:310}],496:[function(e,t,n){(function(t){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("uuid"),o=e("./Origin"),a=e("./BaseModel"),s=e("../core/utils/VidyoDebugger"),c=function(e){function n(n,r,a,c){void 0===r&&(r=o.Origin.Local);var u=e.call(this,i.v4(),n,i.v4(),r,"WindowShare")||this;return u.applicationName=a,u.processId=c,s.VidyoDebugger.Debug(u,s.API.Simple,t),u}return r(n,e),n.prototype.GetApplicationName=function(){return this.applicationName},n.prototype.GetId=function(){return this.id},n.prototype.GetName=function(){return this.name},n.prototype.GetProcessId=function(){return this.processId},n.prototype.IsApplicationNameSet=function(){return!!this.applicationName},n.prototype.IsNameSet=function(){return!!this.name},n.prototype.SetFrameInterval=function(e){},n}(a.BaseModel);n.WindowShare=c}).call(this,"/src/vidyo_simple_api/WindowShare.ts")},{"../core/utils/VidyoDebugger":446,"./BaseModel":487,"./Origin":491,uuid:310}],497:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.BandwidthSummaryStatistics),this.actualEncoderBitRate=e.ActualEncoderBitRate,this.availableBandwidth=e.AvailableBandwidth,this.leakyBucketDelay=e.LeakyBucketDelay,this.retransmitBitRate=e.RetransmitBitRate,this.targetEncoderBitRate=e.TargetEncoderBitRate,this.totalTransmitBitRate=e.TotalTransmitBitRate}return e}();n.BandwidthSummaryStats=i},{"../../core/models/statistics/Statistics":416}],498:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){function e(e){void 0===e&&(e=new r.EndpointStatistics),this.applicationTag=e.ApplicationTag,this.buildTag=e.BuildTag,this.bytesReceivedTcp=e.BytesReceivedTcp,this.bytesReceivedUdp=e.BytesReceivedUdp,this.bytesSentTcp=e.BytesSentTcp,this.bytesSentUdp=e.BytesSentUdp,this.connectTime=e.ConnectTime,this.id=e.Id,this.libraryVersion=e.LibraryVersion,this.localCameraStats=e.LocalCameraStats.map(function(e){return new i.LocalVideoSourceStats(e)}),this.localMicrophoneStats=e.LocalMicrophoneStats.map(function(e){return new i.LocalMicrophoneStats(e)}),this.localMonitorStats=e.LocalMonitorStats.map(function(e){return new i.LocalVideoSourceStats(e)}),this.localRendererStats=e.LocalRendererStats.map(function(e){return new i.LocalRendererStats(e)}),this.localSpeakerStats=e.LocalSpeakerStats.map(function(e){return new i.LocalSpeakerStats(e)}),this.localWindowShareStats=e.LocalWindowShareStats.map(function(e){return new i.LocalVideoSourceStats(e)}),this.loginTimeConsumedMs=e.LoginTimeConsumedMs,this.maxEncodePixelRateInitial=e.MaxEncodePixelRateInitial,this.mediaEnableTimeConsumedMs=e.MediaEnableTimeConsumedMs,this.mediaRouteAcquireTimeConsumedMs=e.MediaRouteAcquireTimeConsumedMs,this.networkInterfaceStats=e.NetworkInterfaceStats.map(function(e){return new i.NetworkInterfaceStats(e)}),this.osName=e.OsName,this.osVersion=e.OsVersion,this.processorBrand=e.ProcessorBrand,this.processorLogicalCores=e.ProcessorLogicalCores,this.processorModel=e.ProcessorModel,this.processorPhysicalCores=e.ProcessorPhysicalCores,this.processorSpeed=e.ProcessorSpeed,this.roomEnterTimeConsumedMs=e.RoomEnterTimeConsumedMs,this.timeStamp=e.TimeStamp,this.userStats=e.UserStats.map(function(e){return new i.UserStats(e)})}return e}();n.EndpointStats=o},{"../../core/models/statistics/Statistics":416,"./Stats":515}],499:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){function e(e){void 0===e&&(e=new r.LocalMicrophoneStatistics),this.aecEchoCoupling=e.AecEchoCoupling,this.agcAverageGain=e.AgcAverageGain,this.bitsPerSample=e.BitsPerSample,this.format=e.Format,this.id=e.Id,this.localSpeakerStreams=e.LocalSpeakerStreams.map(function(e){return new i.LocalSpeakerStreamStats(e)}),this.name=e.Name,this.noiseSuppressionSnr=e.NoiseSuppressionSnr,this.numberOfChannels=e.NumberOfChannels,this.remoteSpeakerStreams=e.RemoteSpeakerStreams.map(function(e){return new i.RemoteSpeakerStreamStats(e)}),this.sampleRateMeasured=e.SampleRateMeasured,this.sampleRateSet=e.SampleRateSet}return e}();n.LocalMicrophoneStats=o},{"../../core/models/statistics/Statistics":416,"./Stats":515}],500:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.LocalRendererStatistics),this.format=e.Format,this.frameIntervalMeasured=e.FrameIntervalMeasured,this.frameIntervalSet=e.FrameIntervalSet,this.height=e.Height,this.id=e.Id,this.name=e.Name,this.totalFrames=e.TotalFrames,this.totalPixels=e.TotalPixels,this.width=e.Width}return e}();n.LocalRendererStats=i},{"../../core/models/statistics/Statistics":416}],501:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.LocalRendererStreamStatistics),this.bufferDropped=e.BufferDropped,this.bufferSize=e.BufferSize,this.height=e.Height,this.id=e.Id,this.name=e.Name,this.width=e.Width}return e}();n.LocalRendererStreamStats=i},{"../../core/models/statistics/Statistics":416}],502:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.LocalSpeakerStatistics),this.bitsPerSample=e.BitsPerSample,this.format=e.Format,this.id=e.Id,this.name=e.Name,this.numberOfChannels=e.NumberOfChannels,this.sampleRateMeasured=e.SampleRateMeasured,this.sampleRateSet=e.SampleRateSet}return e}();n.LocalSpeakerStats=i},{"../../core/models/statistics/Statistics":416}],503:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.LocalSpeakerStreamStatistics),this.bitsPerSample=e.BitsPerSample,this.delay=e.Delay,this.format=e.Format,this.highestThreshold=e.HighestThreshold,this.highThreshold=e.HighThreshold,this.lastEnergy=e.LastEnergy,this.lastPlayed=e.LastPlayed,this.lowestThreshold=e.LowestThreshold,this.lowThreshold=e.LowThreshold,this.maxThreshold=e.MaxThreshold,this.name=e.Name,this.numberOfChannels=e.NumberOfChannels,this.overrun=e.Overrun,this.played=e.Played,this.sampleRate=e.SampleRate,this.underrun=e.Underrun}return e}();n.LocalSpeakerStreamStats=i},{"../../core/models/statistics/Statistics":416}],504:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){function e(e){void 0===e&&(e=new r.LocalVideoSourceStatistics),this.format="",this.format=e.Format,this.frameIntervalMeasured=e.FrameIntervalMeasured,this.frameIntervalSet=e.FrameIntervalSet,this.height=e.Height,this.id=e.Id,this.localRendererStreams=e.LocalRendererStreams.map(function(e){return new i.LocalRendererStreamStats(e)}),this.name=e.Name,this.remoteRendererStreams=e.RemoteRendererStreams.map(function(e){return new i.RemoteRendererStreamStats(e)}),this.totalFrames=e.TotalFrames,this.width=e.Width}return e}();n.LocalVideoSourceStats=o},{"../../core/models/statistics/Statistics":416,"./Stats":515}],505:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.MediaConnectionTransportInformation),this.addressType=e.AddressType,this.componentType=e.ComponentType,this.connectionId=e.ConnectionId,this.connectionType=e.ConnectionType,this.externalLocalAddr=e.ExternalLocalAddr,this.externalRemoteAddr=e.ExternalRemoteAddr,this.interfaceName=e.InterfaceName,this.interfaceType=e.InterfaceType,this.internalLocalAddr=e.InternalLocalAddr,this.internalRemoteAddr=e.InternalRemoteAddr,this.transportPlugIn=e.TransportPlugIn}return e}();n.MediaConnectionTransportInfo=i},{"../../core/models/statistics/Statistics":416}],506:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.NetworkInterfaceStatistics),this.isUp=e.IsUp,this.name=e.Name,this.type=e.Type}return e}();n.NetworkInterfaceStats=i},{"../../core/models/statistics/Statistics":416}],507:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.ParticipantGenerationStatistics),this.id="",this.name="",this.cameraId=e.CameraId,this.cameraName=e.CameraName,this.enabled=e.Enabled,this.frameInterval=e.FrameInterval,this.height=e.Height,this.id=e.Id,this.name=e.Name,this.pixelRate=e.PixelRate,this.width=e.Width}return e}();n.ParticipantGenerationStats=i},{"../../core/models/statistics/Statistics":416}],508:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){function e(e){void 0===e&&(e=new r.ParticipantStatistic),this.id=e.Id,this.name=e.Name,this.remoteCameraStats=e.RemoteCameraStats.map(function(e){return new i.RemoteVideoSourceStats(e)}),this.remoteMicrophoneStats=e.RemoteMicrophoneStats.map(function(e){return new i.RemoteMicrophoneStats(e)}),this.remoteWindowShareStats=e.RemoteWindowShareStats.map(function(e){return new i.RemoteVideoSourceStats(e)}),this.userId=e.UserId}return e}();n.ParticipantStats=o},{"../../core/models/statistics/Statistics":416,"./Stats":515}],509:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.RateShaperStatistics),this.delayNormal=e.DelayNormal,this.delayRetransmit=e.DelayRetransmit,this.dropNormal=e.DropNormal,this.packetsNormal=e.PacketsNormal,this.packetsRetransmit=e.PacketsRetransmit}return e}();n.RateShaperStats=i},{"../../core/models/statistics/Statistics":416}],510:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){function e(e){void 0===e&&(e=new r.RemoteMicrophoneStatistics),this.bitsPerSample=e.BitsPerSample,this.codecDtx=e.CodecDtx,this.codecName=e.CodecName,this.codecQualitySetting=e.CodecQualitySetting,this.id=e.Id,this.localSpeakerStreams=e.LocalSpeakerStreams.map(function(e){return new i.LocalSpeakerStreamStats(e)}),this.name=e.Name,this.numberOfChannels=e.NumberOfChannels,this.receiveNetworkBitRate=e.ReceiveNetworkBitRate,this.receiveNetworkDelay=e.ReceiveNetworkDelay,this.receiveNetworkDroppedPackets=e.ReceiveNetworkDroppedPackets,this.receiveNetworkJitter=e.ReceiveNetworkJitter,this.sampleRateMeasured=e.SampleRateMeasured,this.sampleRateSet=e.SampleRateSet}return e}();n.RemoteMicrophoneStats=o},{"../../core/models/statistics/Statistics":416,"./Stats":515}],511:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.RemoteRendererStreamStatistics),this.codecFir=e.CodecFir,this.codecIFrames=e.CodecIFrames,this.codecLayers=e.CodecLayers,this.codecNacks=e.CodecNacks,this.codecName=e.CodecName,this.fps=e.Fps,this.fpsInput=e.FpsInput,this.fpsSent=e.FpsSent,this.framesDropped=e.FramesDropped,this.height=e.Height,this.lastHeight=e.LastHeight,this.lastWidth=e.LastWidth,this.name=e.Name,this.sendNetworkBitRate=e.SendNetworkBitRate,this.sendNetworkRtt=e.SendNetworkRtt,this.width=e.Width}return e}();n.RemoteRendererStreamStats=i},{"../../core/models/statistics/Statistics":416}],512:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=function(){function e(e){void 0===e&&(e=new r.RemoteSpeakerStreamStatistics),this.bitsPerSample=e.BitsPerSample,this.codecDtx=e.CodecDtx,this.codecName=e.CodecName,this.codecQualitySetting=e.CodecQualitySetting,this.name=e.Name,this.numberOfChannels=e.NumberOfChannels,this.sampleRate=e.SampleRate,this.sendNetworkBitRate=e.SendNetworkBitRate,this.sendNetworkRtt=e.SendNetworkRtt}return e}();n.RemoteSpeakerStreamStats=i},{"../../core/models/statistics/Statistics":416}],513:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){function e(e){void 0===e&&(e=new r.RemoteVideoSourceStatistics),this.codecFir=e.CodecFir,this.codecIFrames=e.CodecIFrames,this.codecLayers=e.CodecLayers,this.codecNacks=e.CodecNacks,this.codecName=e.CodecName,this.fpsDecoded=e.FpsDecoded,this.fpsDecoderInput=e.FpsDecoderInput,this.fpsRendered=e.FpsRendered,this.height=e.Height,this.id=e.Id,this.localRendererStreams=e.LocalRendererStreams.map(function(e){return new i.LocalRendererStreamStats(e)}),this.maxStreamFrameRate=e.MaxStreamFrameRate,this.maxStreamHeight=e.MaxStreamHeight,this.maxStreamWidth=e.MaxStreamWidth,this.name=e.Name,this.receiveNetworkBitRate=e.ReceiveNetworkBitRate,this.receiveNetworkPacketsConcealed=e.ReceiveNetworkPacketsConcealed,this.receiveNetworkPacketsLost=e.ReceiveNetworkPacketsLost,this.receiveNetworkPacketsReordered=e.ReceiveNetworkPacketsReordered,this.receiveNetworkRecoveredWithFec=e.ReceiveNetworkRecoveredWithFec,this.showFrameRate=e.ShowFrameRate,this.showHeight=e.ShowHeight,this.showPixelRate=e.ShowPixelRate,this.showState=e.ShowState,this.showWidth=e.ShowWidth,this.width=e.Width}return e}();n.RemoteVideoSourceStats=o},{"../../core/models/statistics/Statistics":416,"./Stats":515}],514:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=e("./RateShaperStats"),a=e("./BandwidthSummaryStats"),s=function(){function e(e){void 0===e&&(e=new r.RoomStatistics),this.bandwidthApp=new a.BandwidthSummaryStats(e.BandwidthApp),this.bandwidthAudio=new a.BandwidthSummaryStats(e.BandwidthAudio),this.bandwidthVideo=new a.BandwidthSummaryStats(e.BandwidthVideo),this.conferenceId=e.ConferenceId,this.cpuUsage=e.CpuUsage,this.currentBandwidthDecodePixelRate=e.CurrentBandwidthDecodePixelRate,this.currentBandwidthEncodePixelRate=e.CurrentBandwidthEncodePixelRate,this.currentCpuDecodePixelRate=e.CurrentCpuDecodePixelRate,this.currentCpuEncodePixelRate=e.CurrentCpuEncodePixelRate,this.id=e.Id,this.maxDecodePixelRate=e.MaxDecodePixelRate,this.maxEncodePixelRate=e.MaxEncodePixelRate,this.maxVideoSources=e.MaxVideoSources,this.participantGenerationStats=e.ParticipantGenerationStats.map(function(e){return new i.ParticipantGenerationStats(e)}),this.participantStats=e.ParticipantStats.map(function(e){return new i.ParticipantStats(e)}),this.rateShaperApp=new o.RateShaperStats(e.RateShaperApp),this.rateShaperAudio=new o.RateShaperStats(e.RateShaperAudio),this.rateShaperVideo=new o.RateShaperStats(e.RateShaperVideo),this.receiveBitRateAvailable=e.ReceiveBitRateAvailable,this.receiveBitRateTotal=e.ReceiveBitRateTotal,this.reflectorId=e.ReflectorId,this.sendBitRateAvailable=e.SendBitRateAvailable,this.sendBitRateTotal=e.SendBitRateTotal,this.staticSources=e.StaticSources,this.transportInformation=e.TransportInformation.map(function(e){return new i.MediaConnectionTransportInfo(e)})}return e}();n.RoomStats=s},{"../../core/models/statistics/Statistics":416,"./BandwidthSummaryStats":497,"./RateShaperStats":509,"./Stats":515}],515:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./BandwidthSummaryStats");n.BandwidthSummaryStats=r.BandwidthSummaryStats;var i=e("./EndpointStats");n.EndpointStats=i.EndpointStats;var o=e("./LocalMicrophoneStats");n.LocalMicrophoneStats=o.LocalMicrophoneStats;var a=e("./LocalRendererStats");n.LocalRendererStats=a.LocalRendererStats;var s=e("./LocalRendererStreamStats");n.LocalRendererStreamStats=s.LocalRendererStreamStats;var c=e("./LocalSpeakerStats");n.LocalSpeakerStats=c.LocalSpeakerStats;var u=e("./LocalSpeakerStreamStats");n.LocalSpeakerStreamStats=u.LocalSpeakerStreamStats;var l=e("./LocalVideoSourceStats");n.LocalVideoSourceStats=l.LocalVideoSourceStats;var d=e("./MediaConnectionTransportInfo");n.MediaConnectionTransportInfo=d.MediaConnectionTransportInfo;var p=e("./NetworkInterfaceStats");n.NetworkInterfaceStats=p.NetworkInterfaceStats;var f=e("./ParticipantGenerationStats");n.ParticipantGenerationStats=f.ParticipantGenerationStats;var h=e("./ParticipantStats");n.ParticipantStats=h.ParticipantStats;var m=e("./RateShaperStats");n.RateShaperStats=m.RateShaperStats;var v=e("./RemoteMicrophoneStats");n.RemoteMicrophoneStats=v.RemoteMicrophoneStats;var g=e("./RemoteRendererStreamStats");n.RemoteRendererStreamStats=g.RemoteRendererStreamStats;var y=e("./RemoteSpeakerStreamStats");n.RemoteSpeakerStreamStats=y.RemoteSpeakerStreamStats;var _=e("./RemoteVideoSourceStats");n.RemoteVideoSourceStats=_.RemoteVideoSourceStats;var S=e("./RoomStats");n.RoomStats=S.RoomStats;var b=e("./UserStats");n.UserStats=b.UserStats},{"./BandwidthSummaryStats":497,"./EndpointStats":498,
"./LocalMicrophoneStats":499,"./LocalRendererStats":500,"./LocalRendererStreamStats":501,"./LocalSpeakerStats":502,"./LocalSpeakerStreamStats":503,"./LocalVideoSourceStats":504,"./MediaConnectionTransportInfo":505,"./NetworkInterfaceStats":506,"./ParticipantGenerationStats":507,"./ParticipantStats":508,"./RateShaperStats":509,"./RemoteMicrophoneStats":510,"./RemoteRendererStreamStats":511,"./RemoteSpeakerStreamStats":512,"./RemoteVideoSourceStats":513,"./RoomStats":514,"./UserStats":516}],516:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../../core/models/statistics/Statistics"),i=e("./Stats"),o=function(){function e(e){void 0===e&&(e=new r.UserStatistics),this.host=e.Host,this.id=e.Id,this.port=e.Port,this.roomStats=e.RoomStats.map(function(e){return new i.RoomStats(e)}),this.serviceType=e.ServiceType}return e}();n.UserStats=o},{"../../core/models/statistics/Statistics":416,"./Stats":515}],517:[function(e,t,n){arguments[4][7][0].apply(n,arguments)},{dup:7}]},{},[480,517]);